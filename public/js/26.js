/*! For license information please see 26.js.LICENSE.txt?id=841079d0cf1bbb5ea1ce */
(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{"+oOE":function(e,t,n){"use strict";n.r(t),n.d(t,"VERSION",(function(){return r})),n.d(t,"Parser",(function(){return un})),n.d(t,"CstParser",(function(){return cn})),n.d(t,"EmbeddedActionsParser",(function(){return ln})),n.d(t,"ParserDefinitionErrorType",(function(){return rn})),n.d(t,"EMPTY_ALT",(function(){return sn})),n.d(t,"Lexer",(function(){return K})),n.d(t,"LexerDefinitionErrorType",(function(){return W})),n.d(t,"createToken",(function(){return Q})),n.d(t,"createTokenInstance",(function(){return ee})),n.d(t,"EOF",(function(){return Z})),n.d(t,"tokenLabel",(function(){return q})),n.d(t,"tokenMatcher",(function(){return te})),n.d(t,"tokenName",(function(){return X})),n.d(t,"defaultGrammarResolverErrorProvider",(function(){return pt})),n.d(t,"defaultGrammarValidatorErrorProvider",(function(){return dt})),n.d(t,"defaultParserErrorProvider",(function(){return ht})),n.d(t,"EarlyExitException",(function(){return Rt})),n.d(t,"isRecognitionException",(function(){return wt})),n.d(t,"MismatchedTokenException",(function(){return St})),n.d(t,"NotAllInputParsedException",(function(){return Ot})),n.d(t,"NoViableAltException",(function(){return Tt})),n.d(t,"defaultLexerErrorProvider",(function(){return $})),n.d(t,"Alternation",(function(){return he})),n.d(t,"Flat",(function(){return ae})),n.d(t,"NonTerminal",(function(){return oe})),n.d(t,"Option",(function(){return se})),n.d(t,"Repetition",(function(){return le})),n.d(t,"RepetitionMandatory",(function(){return ue})),n.d(t,"RepetitionMandatoryWithSeparator",(function(){return ce})),n.d(t,"RepetitionWithSeparator",(function(){return fe})),n.d(t,"Rule",(function(){return ie})),n.d(t,"Terminal",(function(){return pe})),n.d(t,"serializeGrammar",(function(){return de})),n.d(t,"serializeProduction",(function(){return me})),n.d(t,"GAstVisitor",(function(){return ge})),n.d(t,"assignOccurrenceIndices",(function(){return bt})),n.d(t,"resolveGrammar",(function(){return yt})),n.d(t,"validateGrammar",(function(){return gt})),n.d(t,"clearCache",(function(){return Sn})),n.d(t,"createSyntaxDiagramsCode",(function(){return fn})),n.d(t,"generateParserFactory",(function(){return En})),n.d(t,"generateParserModule",(function(){return wn}));var r="6.5.0",o=n("d6pH"),i=n("iQ+w"),a={},s=new i.RegExpParser;function u(e){var t=e.toString();if(a.hasOwnProperty(t))return a[t];var n=s.pattern(t);return a[t]=n,n}var c,l=(c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),f='Unable to use "first char" lexer optimizations:\n';function h(e,t){void 0===t&&(t=!1);try{var n=u(e);return function e(t,n,r){switch(t.type){case"Disjunction":for(var i=0;i<t.value.length;i++)e(t.value[i],n,r);break;case"Alternative":var a=t.value;for(i=0;i<a.length;i++){var s=a[i];switch(s.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}var u=s;switch(u.type){case"Character":p(u.value,n,r);break;case"Set":if(!0===u.complement)throw Error("Complement Sets are not supported for first char optimization");Object(o.u)(u.value,(function(e){if("number"==typeof e)p(e,n,r);else{var t=e;if(!0===r)for(var o=t.from;o<=t.to;o++)p(o,n,r);else{for(o=t.from;o<=t.to&&o<P;o++)p(o,n,r);if(t.to>=P)for(var i=t.from>=P?t.from:P,a=t.to,s=L(i),u=L(a),c=s;c<=u;c++)n[c]=c}}}));break;case"Group":e(u.value,n,r);break;default:throw Error("Non Exhaustive Match")}var c=void 0!==u.quantifier&&0===u.quantifier.atLeast;if("Group"===u.type&&!1===m(u)||"Group"!==u.type&&!1===c)break}break;default:throw Error("non exhaustive match!")}return Object(o.U)(n)}(n.value,{},n.flags.ignoreCase)}catch(n){if("Complement Sets are not supported for first char optimization"===n.message)t&&Object(o.d)(f+"\tUnable to optimize: < "+e.toString()+" >\n\tComplement Sets cannot be automatically optimized.\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.");else{var r="";t&&(r="\n\tThis will disable the lexer's first char optimizations.\n\tSee: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."),Object(o.c)(f+"\n\tFailed parsing: < "+e.toString()+" >\n\tUsing the regexp-to-ast library version: "+i.VERSION+"\n\tPlease open an issue at: https://github.com/bd82/regexp-to-ast/issues"+r)}}return[]}function p(e,t,n){var r=L(e);t[r]=r,!0===n&&function(e,t){var n=String.fromCharCode(e),r=n.toUpperCase();if(r!==n){var o=L(r.charCodeAt(0));t[o]=o}else{var i=n.toLowerCase();if(i!==n){o=L(i.charCodeAt(0));t[o]=o}}}(e,t)}function d(e,t){return Object(o.q)(e.value,(function(e){if("number"==typeof e)return Object(o.j)(t,e);var n=e;return void 0!==Object(o.q)(t,(function(e){return n.from<=e&&e<=n.to}))}))}function m(e){return!(!e.quantifier||0!==e.quantifier.atLeast)||!!e.value&&(Object(o.y)(e.value)?Object(o.o)(e.value,m):m(e.value))}var v=function(e){function t(t){var n=e.call(this)||this;return n.targetCharCodes=t,n.found=!1,n}return l(t,e),t.prototype.visitChildren=function(t){if(!0!==this.found){switch(t.type){case"Lookahead":return void this.visitLookahead(t);case"NegativeLookahead":return void this.visitNegativeLookahead(t)}e.prototype.visitChildren.call(this,t)}},t.prototype.visitCharacter=function(e){Object(o.j)(this.targetCharCodes,e.value)&&(this.found=!0)},t.prototype.visitSet=function(e){e.complement?void 0===d(e,this.targetCharCodes)&&(this.found=!0):void 0!==d(e,this.targetCharCodes)&&(this.found=!0)},t}(i.BaseRegExpVisitor);function y(e,t){if(t instanceof RegExp){var n=u(t),r=new v(e);return r.visit(n),r.found}return void 0!==Object(o.q)(t,(function(t){return Object(o.j)(e,t.charCodeAt(0))}))}var g=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),b="PATTERN",E="boolean"==typeof new RegExp("(?:)").sticky;function w(e,t){var n,r=(t=Object(o.k)(t,{useSticky:E,debug:!1,safeMode:!1,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:function(e,t){return t()}})).tracer;r("initCharCodeToOptimizedIndexMap",(function(){!function(){if(Object(o.A)(F)){F=new Array(65536);for(var e=0;e<65536;e++)F[e]=e>255?255+~~(e/255):e}}()})),r("Reject Lexer.NA",(function(){n=Object(o.P)(e,(function(e){return e[b]===K.NA}))}));var i,a,s,u,c,l,p,d,m,v,g,w=!1;r("Transform Patterns",(function(){w=!1,i=Object(o.I)(n,(function(e){var n=e[b];if(Object(o.D)(n)){var r=n.source;return 1===r.length&&"^"!==r&&"$"!==r&&"."!==r?r:2!==r.length||"\\"!==r[0]||Object(o.j)(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],r[1])?t.useSticky?N(n):R(n):r[1]}if(Object(o.B)(n))return w=!0,{exec:n};if(Object(o.w)(n,"exec"))return w=!0,n;if("string"==typeof n){if(1===n.length)return n;var i=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),a=new RegExp(i);return t.useSticky?N(a):R(a)}throw Error("non exhaustive match")}))})),r("misc mapping",(function(){a=Object(o.I)(n,(function(e){return e.tokenTypeIdx})),s=Object(o.I)(n,(function(e){var t=e.GROUP;if(t!==K.SKIPPED){if(Object(o.E)(t))return t;if(Object(o.F)(t))return!1;throw Error("non exhaustive match")}})),u=Object(o.I)(n,(function(e){var t=e.LONGER_ALT;if(t)return Object(o.x)(n,t)})),c=Object(o.I)(n,(function(e){return e.PUSH_MODE})),l=Object(o.I)(n,(function(e){return Object(o.w)(e,"POP_MODE")}))})),r("Line Terminator Handling",(function(){var e=I(t.lineTerminatorCharacters);p=Object(o.I)(n,(function(e){return!1})),"onlyOffset"!==t.positionTracking&&(p=Object(o.I)(n,(function(t){return Object(o.w)(t,"LINE_BREAKS")?t.LINE_BREAKS:!1===x(t,e)?y(e,t.PATTERN):void 0})))})),r("Misc Mapping #2",(function(){d=Object(o.I)(n,A),m=Object(o.I)(i,C),v=Object(o.O)(n,(function(e,t){var n=t.GROUP;return Object(o.E)(n)&&n!==K.SKIPPED&&(e[n]=[]),e}),{}),g=Object(o.I)(i,(function(e,t){return{pattern:i[t],longerAlt:u[t],canLineTerminator:p[t],isCustom:d[t],short:m[t],group:s[t],push:c[t],pop:l[t],tokenTypeIdx:a[t],tokenType:n[t]}}))}));var S=!0,T=[];return t.safeMode||r("First Char Optimization",(function(){T=Object(o.O)(n,(function(e,n,r){if("string"==typeof n.PATTERN){var i=L(n.PATTERN.charCodeAt(0));_(e,i,g[r])}else if(Object(o.y)(n.START_CHARS_HINT)){var a;Object(o.u)(n.START_CHARS_HINT,(function(t){var n=L("string"==typeof t?t.charCodeAt(0):t);a!==n&&(a=n,_(e,n,g[r]))}))}else if(Object(o.D)(n.PATTERN))if(n.PATTERN.unicode)S=!1,t.ensureOptimizations&&Object(o.c)(f+"\tUnable to analyze < "+n.PATTERN.toString()+" > pattern.\n\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE");else{var s=h(n.PATTERN,t.ensureOptimizations);Object(o.A)(s)&&(S=!1),Object(o.u)(s,(function(t){_(e,t,g[r])}))}else t.ensureOptimizations&&Object(o.c)(f+"\tTokenType: <"+n.name+"> is using a custom token pattern without providing <start_chars_hint> parameter.\n\tThis will disable the lexer's first char optimizations.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE"),S=!1;return e}),[])})),r("ArrayPacking",(function(){T=Object(o.L)(T)})),{emptyGroups:v,patternIdxToConfig:g,charCodeToPatternIdxToConfig:T,hasCustom:w,canBeOptimized:S}}function S(e,t){var n=[],r=function(e){var t=Object(o.p)(e,(function(e){return!Object(o.w)(e,b)})),n=Object(o.I)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:W.MISSING_PATTERN,tokenTypes:[e]}})),r=Object(o.l)(e,t);return{errors:n,valid:r}}(e);n=n.concat(r.errors);var a=function(e){var t=Object(o.p)(e,(function(e){var t=e[b];return!(Object(o.D)(t)||Object(o.B)(t)||Object(o.w)(t,"exec")||Object(o.E)(t))})),n=Object(o.I)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:W.INVALID_PATTERN,tokenTypes:[e]}})),r=Object(o.l)(e,t);return{errors:n,valid:r}}(r.valid),s=a.valid;return n=(n=(n=(n=(n=n.concat(a.errors)).concat(function(e){var t=[],n=Object(o.p)(e,(function(e){return Object(o.D)(e[b])}));return t=(t=(t=(t=(t=t.concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return g(t,e),t.prototype.visitEndAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),n=Object(o.p)(e,(function(e){var n=e[b];try{var r=u(n),o=new t;return o.visit(r),o.found}catch(e){return T.test(n.source)}}));return Object(o.I)(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n\tSee sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:W.EOI_ANCHOR_FOUND,tokenTypes:[e]}}))}(n))).concat(function(e){var t=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.found=!1,t}return g(t,e),t.prototype.visitStartAnchor=function(e){this.found=!0},t}(i.BaseRegExpVisitor),n=Object(o.p)(e,(function(e){var n=e[b];try{var r=u(n),o=new t;return o.visit(r),o.found}catch(e){return O.test(n.source)}}));return Object(o.I)(n,(function(e){return{message:"Unexpected RegExp Anchor Error:\n\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#ANCHORS\tfor details.",type:W.SOI_ANCHOR_FOUND,tokenTypes:[e]}}))}(n))).concat(function(e){var t=Object(o.p)(e,(function(e){var t=e[b];return t instanceof RegExp&&(t.multiline||t.global)}));return Object(o.I)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:W.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]}}))}(n))).concat(function(e){var t=[],n=Object(o.I)(e,(function(n){return Object(o.O)(e,(function(e,r){return n.PATTERN.source!==r.PATTERN.source||Object(o.j)(t,r)||r.PATTERN===K.NA||(t.push(r),e.push(r)),e}),[])}));n=Object(o.i)(n);var r=Object(o.p)(n,(function(e){return e.length>1}));return Object(o.I)(r,(function(e){var t=Object(o.I)(e,(function(e){return e.name}));return{message:"The same RegExp pattern ->"+Object(o.s)(e).PATTERN+"<-has been used in all of the following Token Types: "+t.join(", ")+" <-",type:W.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}))}(n))).concat(function(e){var t=Object(o.p)(e,(function(e){return e[b].test("")}));return Object(o.I)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:W.EMPTY_MATCH_PATTERN,tokenTypes:[e]}}))}(n))}(s))).concat(function(e){var t=Object(o.p)(e,(function(e){if(!Object(o.w)(e,"GROUP"))return!1;var t=e.GROUP;return t!==K.SKIPPED&&t!==K.NA&&!Object(o.E)(t)}));return Object(o.I)(t,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:W.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]}}))}(s))).concat(function(e,t){var n=Object(o.p)(e,(function(e){return void 0!==e.PUSH_MODE&&!Object(o.j)(t,e.PUSH_MODE)}));return Object(o.I)(n,(function(e){return{message:"Token Type: ->"+e.name+"<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->"+e.PUSH_MODE+"<-which does not exist",type:W.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}))}(s,t))).concat(function(e){var t=[],n=Object(o.O)(e,(function(e,t,n){var r,i=t.PATTERN;return i===K.NA||(Object(o.E)(i)?e.push({str:i,idx:n,tokenType:t}):Object(o.D)(i)&&(r=i,void 0===Object(o.q)([".","\\","[","]","|","^","$","(",")","?","*","+","{"],(function(e){return-1!==r.source.indexOf(e)})))&&e.push({str:i.source,idx:n,tokenType:t})),e}),[]);return Object(o.u)(e,(function(e,r){Object(o.u)(n,(function(n){var i=n.str,a=n.idx,s=n.tokenType;if(r<a&&function(e,t){if(Object(o.D)(t)){var n=t.exec(e);return null!==n&&0===n.index}if(Object(o.B)(t))return t(e,0,[],{});if(Object(o.w)(t,"exec"))return t.exec(e,0,[],{});if("string"==typeof t)return t===e;throw Error("non exhaustive match")}(i,e.PATTERN)){var u="Token: ->"+s.name+"<- can never be matched.\nBecause it appears AFTER the Token Type ->"+e.name+"<-in the lexer's definition.\nSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#UNREACHABLE";t.push({message:u,type:W.UNREACHABLE_PATTERN,tokenTypes:[e,s]})}}))})),t}(s))}var T=/[^\\][\$]/;var O=/[^\\[][\^]|^\^/;function R(e){var t=e.ignoreCase?"i":"";return new RegExp("^(?:"+e.source+")",t)}function N(e){var t=e.ignoreCase?"iy":"y";return new RegExp(""+e.source,t)}function k(e,t,n){var r=[],i=!1,a=Object(o.i)(Object(o.t)(Object(o.J)(e.modes,(function(e){return e})))),s=Object(o.P)(a,(function(e){return e[b]===K.NA})),u=I(n);return t&&Object(o.u)(s,(function(e){var t=x(e,u);if(!1!==t){var n={message:function(e,t){if(t.issue===W.IDENTIFY_TERMINATOR)return"Warning: unable to identify line terminator usage in pattern.\n\tThe problem is in the <"+e.name+"> Token Type\n\t Root cause: "+t.errMsg+".\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR";if(t.issue===W.CUSTOM_LINE_BREAK)return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n\tThe problem is in the <"+e.name+"> Token Type\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK";throw Error("non exhaustive match")}(e,t),type:t.issue,tokenType:e};r.push(n)}else Object(o.w)(e,"LINE_BREAKS")?!0===e.LINE_BREAKS&&(i=!0):y(u,e.PATTERN)&&(i=!0)})),t&&!i&&r.push({message:"Warning: No LINE_BREAKS Found.\n\tThis Lexer has been defined to track line and column information,\n\tBut none of the Token Types can be identified as matching a line terminator.\n\tSee https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n\tfor details.",type:W.NO_LINE_BREAKS_FLAGS}),r}function A(e){var t=e.PATTERN;if(Object(o.D)(t))return!1;if(Object(o.B)(t))return!0;if(Object(o.w)(t,"exec"))return!0;if(Object(o.E)(t))return!1;throw Error("non exhaustive match")}function C(e){return!(!Object(o.E)(e)||1!==e.length)&&e.charCodeAt(0)}var M={test:function(e){for(var t=e.length,n=this.lastIndex;n<t;n++){var r=e.charCodeAt(n);if(10===r)return this.lastIndex=n+1,!0;if(13===r)return 10===e.charCodeAt(n+1)?this.lastIndex=n+2:this.lastIndex=n+1,!0}return!1},lastIndex:0};function x(e,t){if(Object(o.w)(e,"LINE_BREAKS"))return!1;if(Object(o.D)(e.PATTERN)){try{y(t,e.PATTERN)}catch(e){return{issue:W.IDENTIFY_TERMINATOR,errMsg:e.message}}return!1}if(Object(o.E)(e.PATTERN))return!1;if(A(e))return{issue:W.CUSTOM_LINE_BREAK};throw Error("non exhaustive match")}function I(e){return Object(o.I)(e,(function(e){return Object(o.E)(e)&&e.length>0?e.charCodeAt(0):e}))}function _(e,t,n){void 0===e[t]?e[t]=[n]:e[t].push(n)}var P=256;function L(e){return e<P?e:F[e]}var F=[];function D(e,t){var n=e.tokenTypeIdx;return n===t.tokenTypeIdx||!0===t.isParent&&!0===t.categoryMatchesMap[n]}function U(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}var j=1,B={};function V(e){var t=function(e){var t=Object(o.g)(e),n=e,r=!0;for(;r;){n=Object(o.i)(Object(o.t)(Object(o.I)(n,(function(e){return e.CATEGORIES}))));var i=Object(o.l)(n,t);t=t.concat(i),Object(o.A)(i)?r=!1:n=i}return t}(e);!function(e){Object(o.u)(e,(function(e){var t;H(e)||(B[j]=e,e.tokenTypeIdx=j++),G(e)&&!Object(o.y)(e.CATEGORIES)&&(e.CATEGORIES=[e.CATEGORIES]),G(e)||(e.CATEGORIES=[]),t=e,Object(o.w)(t,"categoryMatches")||(e.categoryMatches=[]),function(e){return Object(o.w)(e,"categoryMatchesMap")}(e)||(e.categoryMatchesMap={})}))}(t),function(e){Object(o.u)(e,(function(e){!function e(t,n){Object(o.u)(t,(function(e){n.categoryMatchesMap[e.tokenTypeIdx]=!0})),Object(o.u)(n.CATEGORIES,(function(r){var i=t.concat(n);Object(o.j)(i,r)||e(i,r)}))}([],e)}))}(t),function(e){Object(o.u)(e,(function(e){e.categoryMatches=[],Object(o.u)(e.categoryMatchesMap,(function(t,n){e.categoryMatches.push(B[n].tokenTypeIdx)}))}))}(t),Object(o.u)(t,(function(e){e.isParent=e.categoryMatches.length>0}))}function H(e){return Object(o.w)(e,"tokenTypeIdx")}function G(e){return Object(o.w)(e,"CATEGORIES")}function z(e){return Object(o.w)(e,"tokenTypeIdx")}var W,$={buildUnableToPopLexerModeMessage:function(e){return"Unable to pop Lexer Mode after encountering Token ->"+e.image+"<- The Mode Stack is empty"},buildUnexpectedCharactersMessage:function(e,t,n,r,o){return"unexpected character: ->"+e.charAt(t)+"<- at offset: "+t+", skipped "+n+" characters."}};!function(e){e[e.MISSING_PATTERN=0]="MISSING_PATTERN",e[e.INVALID_PATTERN=1]="INVALID_PATTERN",e[e.EOI_ANCHOR_FOUND=2]="EOI_ANCHOR_FOUND",e[e.UNSUPPORTED_FLAGS_FOUND=3]="UNSUPPORTED_FLAGS_FOUND",e[e.DUPLICATE_PATTERNS_FOUND=4]="DUPLICATE_PATTERNS_FOUND",e[e.INVALID_GROUP_TYPE_FOUND=5]="INVALID_GROUP_TYPE_FOUND",e[e.PUSH_MODE_DOES_NOT_EXIST=6]="PUSH_MODE_DOES_NOT_EXIST",e[e.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE",e[e.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY",e[e.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST",e[e.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED",e[e.SOI_ANCHOR_FOUND=11]="SOI_ANCHOR_FOUND",e[e.EMPTY_MATCH_PATTERN=12]="EMPTY_MATCH_PATTERN",e[e.NO_LINE_BREAKS_FLAGS=13]="NO_LINE_BREAKS_FLAGS",e[e.UNREACHABLE_PATTERN=14]="UNREACHABLE_PATTERN",e[e.IDENTIFY_TERMINATOR=15]="IDENTIFY_TERMINATOR",e[e.CUSTOM_LINE_BREAK=16]="CUSTOM_LINE_BREAK"}(W||(W={}));var Y={deferDefinitionErrorsHandling:!1,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:!1,safeMode:!1,errorMessageProvider:$,traceInitPerf:!1,skipValidations:!1};Object.freeze(Y);var K=function(){function e(e,t){var n=this;if(void 0===t&&(t=Y),this.lexerDefinition=e,this.lexerDefinitionErrors=[],this.lexerDefinitionWarning=[],this.patternIdxToConfig={},this.charCodeToPatternIdxToConfig={},this.modes=[],this.emptyGroups={},this.config=void 0,this.trackStartLines=!0,this.trackEndLines=!0,this.hasCustom=!1,this.canModeBeOptimized={},"boolean"==typeof t)throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\na boolean 2nd argument is no longer supported");this.config=Object(o.K)(Y,t);var r=this.config.traceInitPerf;!0===r?(this.traceInitMaxIdent=1/0,this.traceInitPerf=!0):"number"==typeof r&&(this.traceInitMaxIdent=r,this.traceInitPerf=!0),this.traceInitIndent=-1,this.TRACE_INIT("Lexer Constructor",(function(){var r,i=!0;n.TRACE_INIT("Lexer Config handling",(function(){if(n.config.lineTerminatorsPattern===Y.lineTerminatorsPattern)n.config.lineTerminatorsPattern=M;else if(n.config.lineTerminatorCharacters===Y.lineTerminatorCharacters)throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n\tFor details See: https://sap.github.io/chevrotain/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS");if(t.safeMode&&t.ensureOptimizations)throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.');n.trackStartLines=/full|onlyStart/i.test(n.config.positionTracking),n.trackEndLines=/full/i.test(n.config.positionTracking),Object(o.y)(e)?((r={modes:{}}).modes.defaultMode=Object(o.g)(e),r.defaultMode="defaultMode"):(i=!1,r=Object(o.h)(e))})),!1===n.config.skipValidations&&(n.TRACE_INIT("performRuntimeChecks",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(function(e,t,n){var r=[];return Object(o.w)(e,"defaultMode")||r.push({message:"A MultiMode Lexer cannot be initialized without a <defaultMode> property in its definition\n",type:W.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE}),Object(o.w)(e,"modes")||r.push({message:"A MultiMode Lexer cannot be initialized without a <modes> property in its definition\n",type:W.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY}),Object(o.w)(e,"modes")&&Object(o.w)(e,"defaultMode")&&!Object(o.w)(e.modes,e.defaultMode)&&r.push({message:"A MultiMode Lexer cannot be initialized with a defaultMode: <"+e.defaultMode+">which does not exist\n",type:W.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST}),Object(o.w)(e,"modes")&&Object(o.u)(e.modes,(function(e,t){Object(o.u)(e,(function(e,n){Object(o.F)(e)&&r.push({message:"A Lexer cannot be initialized using an undefined Token Type. Mode:<"+t+"> at index: <"+n+">\n",type:W.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}))})),r}(r,n.trackStartLines,n.config.lineTerminatorCharacters))})),n.TRACE_INIT("performWarningRuntimeChecks",(function(){n.lexerDefinitionWarning=n.lexerDefinitionWarning.concat(k(r,n.trackStartLines,n.config.lineTerminatorCharacters))}))),r.modes=r.modes?r.modes:{},Object(o.u)(r.modes,(function(e,t){r.modes[t]=Object(o.P)(e,(function(e){return Object(o.F)(e)}))}));var s=Object(o.G)(r.modes);if(Object(o.u)(r.modes,(function(e,r){n.TRACE_INIT("Mode: <"+r+"> processing",(function(){var i;(n.modes.push(r),!1===n.config.skipValidations&&n.TRACE_INIT("validatePatterns",(function(){n.lexerDefinitionErrors=n.lexerDefinitionErrors.concat(S(e,s))})),Object(o.A)(n.lexerDefinitionErrors))&&(V(e),n.TRACE_INIT("analyzeTokenTypes",(function(){i=w(e,{lineTerminatorCharacters:n.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:n.TRACE_INIT.bind(n)})})),n.patternIdxToConfig[r]=i.patternIdxToConfig,n.charCodeToPatternIdxToConfig[r]=i.charCodeToPatternIdxToConfig,n.emptyGroups=Object(o.K)(n.emptyGroups,i.emptyGroups),n.hasCustom=i.hasCustom||n.hasCustom,n.canModeBeOptimized[r]=i.canBeOptimized)}))})),n.defaultMode=r.defaultMode,!Object(o.A)(n.lexerDefinitionErrors)&&!n.config.deferDefinitionErrorsHandling){var u=Object(o.I)(n.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+u)}Object(o.u)(n.lexerDefinitionWarning,(function(e){Object(o.d)(e.message)})),n.TRACE_INIT("Choosing sub-methods implementations",(function(){if(E?(n.chopInput=o.a,n.match=n.matchWithTest):(n.updateLastIndex=o.b,n.match=n.matchWithExec),i&&(n.handleModes=o.b),!1===n.trackStartLines&&(n.computeNewColumn=o.a),!1===n.trackEndLines&&(n.updateTokenEndLineColumnLocation=o.b),/full/i.test(n.config.positionTracking))n.createTokenInstance=n.createFullToken;else if(/onlyStart/i.test(n.config.positionTracking))n.createTokenInstance=n.createStartOnlyToken;else{if(!/onlyOffset/i.test(n.config.positionTracking))throw Error('Invalid <positionTracking> config option: "'+n.config.positionTracking+'"');n.createTokenInstance=n.createOffsetOnlyToken}n.hasCustom?(n.addToken=n.addTokenUsingPush,n.handlePayload=n.handlePayloadWithCustom):(n.addToken=n.addTokenUsingMemberAccess,n.handlePayload=n.handlePayloadNoCustom)})),n.TRACE_INIT("Failed Optimization Warnings",(function(){var e=Object(o.O)(n.canModeBeOptimized,(function(e,t,n){return!1===t&&e.push(n),e}),[]);if(t.ensureOptimizations&&!Object(o.A)(e))throw Error("Lexer Modes: < "+e.join(", ")+' > cannot be optimized.\n\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n\t Or inspect the console log for details on how to resolve these issues.')})),n.TRACE_INIT("clearRegExpParserCache",(function(){a={}})),n.TRACE_INIT("toFastProperties",(function(){Object(o.S)(n)}))}))}return e.prototype.tokenize=function(e,t){if(void 0===t&&(t=this.defaultMode),!Object(o.A)(this.lexerDefinitionErrors)){var n=Object(o.I)(this.lexerDefinitionErrors,(function(e){return e.message})).join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+n)}return this.tokenizeInternal(e,t)},e.prototype.tokenizeInternal=function(e,t){var n,r,i,a,s,u,c,l,f,h,p,d,m,v,y,g,b,E=this,w=e,S=w.length,T=0,O=0,R=this.hasCustom?0:Math.floor(e.length/10),N=new Array(R),k=[],A=this.trackStartLines?1:void 0,C=this.trackStartLines?1:void 0,M=(y=this.emptyGroups,g={},b=Object(o.G)(y),Object(o.u)(b,(function(e){var t=y[e];if(!Object(o.y)(t))throw Error("non exhaustive match");g[e]=[]})),g),x=this.trackStartLines,I=this.config.lineTerminatorsPattern,_=0,P=[],F=[],D=[],U=[];Object.freeze(U);var j=void 0;function B(){return P}function V(e){var t=L(e),n=F[t];return void 0===n?U:n}var H,G=function(e){if(1===D.length&&void 0===e.tokenType.PUSH_MODE){var t=E.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);k.push({offset:e.startOffset,line:void 0!==e.startLine?e.startLine:void 0,column:void 0!==e.startColumn?e.startColumn:void 0,length:e.image.length,message:t})}else{D.pop();var n=Object(o.H)(D);P=E.patternIdxToConfig[n],F=E.charCodeToPatternIdxToConfig[n],_=P.length;var r=E.canModeBeOptimized[n]&&!1===E.config.safeMode;j=F&&r?V:B}};function z(e){D.push(e),F=this.charCodeToPatternIdxToConfig[e],P=this.patternIdxToConfig[e],_=P.length,_=P.length;var t=this.canModeBeOptimized[e]&&!1===this.config.safeMode;j=F&&t?V:B}for(z.call(this,t);T<S;){s=null;var W=w.charCodeAt(T),$=j(W),Y=$.length;for(n=0;n<Y;n++){var K=(H=$[n]).pattern;if(u=null,!1!==(oe=H.short)?W===oe&&(s=K):!0===H.isCustom?null!==(v=K.exec(w,T,N,M))?(s=v[0],void 0!==v.payload&&(u=v.payload)):s=null:(this.updateLastIndex(K,T),s=this.match(K,e,T)),null!==s){if(void 0!==(a=H.longerAlt)){var q=P[a],X=q.pattern;c=null,!0===q.isCustom?null!==(v=X.exec(w,T,N,M))?(i=v[0],void 0!==v.payload&&(c=v.payload)):i=null:(this.updateLastIndex(X,T),i=this.match(X,e,T)),i&&i.length>s.length&&(s=i,u=c,H=q)}break}}if(null!==s){if(l=s.length,void 0!==(f=H.group)&&(h=H.tokenTypeIdx,p=this.createTokenInstance(s,T,h,H.tokenType,A,C,l),this.handlePayload(p,u),!1===f?O=this.addToken(N,O,p):M[f].push(p)),e=this.chopInput(e,l),T+=l,C=this.computeNewColumn(C,l),!0===x&&!0===H.canLineTerminator){var J=0,Q=void 0,Z=void 0;I.lastIndex=0;do{!0===(Q=I.test(s))&&(Z=I.lastIndex-1,J++)}while(!0===Q);0!==J&&(A+=J,C=l-Z,this.updateTokenEndLineColumnLocation(p,f,Z,J,A,C,l))}this.handleModes(H,G,z,p)}else{for(var ee=T,te=A,ne=C,re=!1;!re&&T<S;)for(w.charCodeAt(T),e=this.chopInput(e,1),T++,r=0;r<_;r++){var oe,ie=P[r];K=ie.pattern;if(!1!==(oe=ie.short)?w.charCodeAt(T)===oe&&(re=!0):!0===ie.isCustom?re=null!==K.exec(w,T,N,M):(this.updateLastIndex(K,T),re=null!==K.exec(e)),!0===re)break}d=T-ee,m=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(w,ee,d,te,ne),k.push({offset:ee,line:te,column:ne,length:d,message:m})}}return this.hasCustom||(N.length=O),{tokens:N,groups:M,errors:k}},e.prototype.handleModes=function(e,t,n,r){if(!0===e.pop){var o=e.push;t(r),void 0!==o&&n.call(this,o)}else void 0!==e.push&&n.call(this,e.push)},e.prototype.chopInput=function(e,t){return e.substring(t)},e.prototype.updateLastIndex=function(e,t){e.lastIndex=t},e.prototype.updateTokenEndLineColumnLocation=function(e,t,n,r,o,i,a){var s,u;void 0!==t&&(u=(s=n===a-1)?-1:0,1===r&&!0===s||(e.endLine=o+u,e.endColumn=i-1-u))},e.prototype.computeNewColumn=function(e,t){return e+t},e.prototype.createTokenInstance=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return null},e.prototype.createOffsetOnlyToken=function(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}},e.prototype.createStartOnlyToken=function(e,t,n,r,o,i){return{image:e,startOffset:t,startLine:o,startColumn:i,tokenTypeIdx:n,tokenType:r}},e.prototype.createFullToken=function(e,t,n,r,o,i,a){return{image:e,startOffset:t,endOffset:t+a-1,startLine:o,endLine:o,startColumn:i,endColumn:i+a-1,tokenTypeIdx:n,tokenType:r}},e.prototype.addToken=function(e,t,n){return 666},e.prototype.addTokenUsingPush=function(e,t,n){return e.push(n),t},e.prototype.addTokenUsingMemberAccess=function(e,t,n){return e[t]=n,++t},e.prototype.handlePayload=function(e,t){},e.prototype.handlePayloadNoCustom=function(e,t){},e.prototype.handlePayloadWithCustom=function(e,t){null!==t&&(e.payload=t)},e.prototype.match=function(e,t,n){return null},e.prototype.matchWithTest=function(e,t,n){return!0===e.test(t)?t.substring(n,e.lastIndex):null},e.prototype.matchWithExec=function(e,t){var n=e.exec(t);return null!==n?n[0]:n},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=Object(o.R)(t),i=r.time,a=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}return t()},e.SKIPPED="This marks a skipped Token pattern, this means each token identified by it willbe consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.",e.NA=/NOT_APPLICABLE/,e}();function q(e){return J(e)?e.LABEL:e.name}function X(e){return e.name}function J(e){return Object(o.E)(e.LABEL)&&""!==e.LABEL}function Q(e){return function(e){var t=e.pattern,n={};n.name=e.name,Object(o.F)(t)||(n.PATTERN=t);if(Object(o.w)(e,"parent"))throw"The parent property is no longer supported.\nSee: https://github.com/SAP/chevrotain/issues/564#issuecomment-349062346 for details.";Object(o.w)(e,"categories")&&(n.CATEGORIES=e.categories);V([n]),Object(o.w)(e,"label")&&(n.LABEL=e.label);Object(o.w)(e,"group")&&(n.GROUP=e.group);Object(o.w)(e,"pop_mode")&&(n.POP_MODE=e.pop_mode);Object(o.w)(e,"push_mode")&&(n.PUSH_MODE=e.push_mode);Object(o.w)(e,"longer_alt")&&(n.LONGER_ALT=e.longer_alt);Object(o.w)(e,"line_breaks")&&(n.LINE_BREAKS=e.line_breaks);Object(o.w)(e,"start_chars_hint")&&(n.START_CHARS_HINT=e.start_chars_hint);return n}(e)}var Z=Q({name:"EOF",pattern:K.NA});function ee(e,t,n,r,o,i,a,s){return{image:t,startOffset:n,endOffset:r,startLine:o,endLine:i,startColumn:a,endColumn:s,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function te(e,t){return D(e,t)}V([Z]);var ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),re=function(){function e(e){this.definition=e}return e.prototype.accept=function(e){e.visit(this),Object(o.u)(this.definition,(function(t){t.accept(e)}))},e}(),oe=function(e){function t(t){var n=e.call(this,[])||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),Object.defineProperty(t.prototype,"definition",{get:function(){return void 0!==this.referencedRule?this.referencedRule.definition:[]},set:function(e){},enumerable:!0,configurable:!0}),t.prototype.accept=function(e){e.visit(this)},t}(re),ie=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.orgText="",Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),ae=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.ignoreAmbiguities=!1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),se=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),ue=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),ce=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),le=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),fe=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),he=function(e){function t(t){var n=e.call(this,t.definition)||this;return n.idx=1,n.ignoreAmbiguities=!1,n.hasPredicates=!1,Object(o.f)(n,Object(o.N)(t,(function(e){return void 0!==e}))),n}return ne(t,e),t}(re),pe=function(){function e(e){this.idx=1,Object(o.f)(this,Object(o.N)(e,(function(e){return void 0!==e})))}return e.prototype.accept=function(e){e.visit(this)},e}();function de(e){return Object(o.I)(e,me)}function me(e){function t(e){return Object(o.I)(e,me)}if(e instanceof oe)return{type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(e instanceof ae)return{type:"Flat",definition:t(e.definition)};if(e instanceof se)return{type:"Option",idx:e.idx,definition:t(e.definition)};if(e instanceof ue)return{type:"RepetitionMandatory",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof ce)return{type:"RepetitionMandatoryWithSeparator",name:e.name,idx:e.idx,separator:me(new pe({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof fe)return{type:"RepetitionWithSeparator",name:e.name,idx:e.idx,separator:me(new pe({terminalType:e.separator})),definition:t(e.definition)};if(e instanceof le)return{type:"Repetition",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof he)return{type:"Alternation",name:e.name,idx:e.idx,definition:t(e.definition)};if(e instanceof pe){var n={type:"Terminal",name:e.terminalType.name,label:q(e.terminalType),idx:e.idx},r=e.terminalType.PATTERN;return e.terminalType.PATTERN&&(n.pattern=Object(o.D)(r)?r.source:r),n}if(e instanceof ie)return{type:"Rule",name:e.name,orgText:e.orgText,definition:t(e.definition)};throw Error("non exhaustive match")}var ve=function(){function e(){}return e.prototype.walk=function(e,t){var n=this;void 0===t&&(t=[]),Object(o.u)(e.definition,(function(r,i){var a=Object(o.m)(e.definition,i+1);if(r instanceof oe)n.walkProdRef(r,a,t);else if(r instanceof pe)n.walkTerminal(r,a,t);else if(r instanceof ae)n.walkFlat(r,a,t);else if(r instanceof se)n.walkOption(r,a,t);else if(r instanceof ue)n.walkAtLeastOne(r,a,t);else if(r instanceof ce)n.walkAtLeastOneSep(r,a,t);else if(r instanceof fe)n.walkManySep(r,a,t);else if(r instanceof le)n.walkMany(r,a,t);else{if(!(r instanceof he))throw Error("non exhaustive match");n.walkOr(r,a,t)}}))},e.prototype.walkTerminal=function(e,t,n){},e.prototype.walkProdRef=function(e,t,n){},e.prototype.walkFlat=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkOption=function(e,t,n){var r=t.concat(n);this.walk(e,r)},e.prototype.walkAtLeastOne=function(e,t,n){var r=[new se({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkAtLeastOneSep=function(e,t,n){var r=ye(e,t,n);this.walk(e,r)},e.prototype.walkMany=function(e,t,n){var r=[new se({definition:e.definition})].concat(t,n);this.walk(e,r)},e.prototype.walkManySep=function(e,t,n){var r=ye(e,t,n);this.walk(e,r)},e.prototype.walkOr=function(e,t,n){var r=this,i=t.concat(n);Object(o.u)(e.definition,(function(e){var t=new ae({definition:[e]});r.walk(t,i)}))},e}();function ye(e,t,n){return[new se({definition:[new pe({terminalType:e.separator})].concat(e.definition)})].concat(t,n)}var ge=function(){function e(){}return e.prototype.visit=function(e){var t=e;switch(t.constructor){case oe:return this.visitNonTerminal(t);case ae:return this.visitFlat(t);case se:return this.visitOption(t);case ue:return this.visitRepetitionMandatory(t);case ce:return this.visitRepetitionMandatoryWithSeparator(t);case fe:return this.visitRepetitionWithSeparator(t);case le:return this.visitRepetition(t);case he:return this.visitAlternation(t);case pe:return this.visitTerminal(t);case ie:return this.visitRule(t);default:throw Error("non exhaustive match")}},e.prototype.visitNonTerminal=function(e){},e.prototype.visitFlat=function(e){},e.prototype.visitOption=function(e){},e.prototype.visitRepetition=function(e){},e.prototype.visitRepetitionMandatory=function(e){},e.prototype.visitRepetitionMandatoryWithSeparator=function(e){},e.prototype.visitRepetitionWithSeparator=function(e){},e.prototype.visitAlternation=function(e){},e.prototype.visitTerminal=function(e){},e.prototype.visitRule=function(e){},e}(),be=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function Ee(e,t){return void 0===t&&(t=[]),!!(e instanceof se||e instanceof le||e instanceof fe)||(e instanceof he?Object(o.Q)(e.definition,(function(e){return Ee(e,t)})):!(e instanceof oe&&Object(o.j)(t,e))&&(e instanceof re&&(e instanceof oe&&t.push(e),Object(o.o)(e.definition,(function(e){return Ee(e,t)})))))}function we(e){if(e instanceof oe)return"SUBRULE";if(e instanceof se)return"OPTION";if(e instanceof he)return"OR";if(e instanceof ue)return"AT_LEAST_ONE";if(e instanceof ce)return"AT_LEAST_ONE_SEP";if(e instanceof fe)return"MANY_SEP";if(e instanceof le)return"MANY";if(e instanceof pe)return"CONSUME";throw Error("non exhaustive match")}var Se=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.separator="-",t.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]},t}return be(t,e),t.prototype.reset=function(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}},t.prototype.visitTerminal=function(e){var t=e.terminalType.name+this.separator+"Terminal";Object(o.w)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitNonTerminal=function(e){var t=e.nonTerminalName+this.separator+"Terminal";Object(o.w)(this.dslMethods,t)||(this.dslMethods[t]=[]),this.dslMethods[t].push(e)},t.prototype.visitOption=function(e){this.dslMethods.option.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.dslMethods.repetitionWithSeparator.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.dslMethods.repetitionMandatory.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)},t.prototype.visitRepetition=function(e){this.dslMethods.repetition.push(e)},t.prototype.visitAlternation=function(e){this.dslMethods.alternation.push(e)},t}(ge),Te=new Se;function Oe(e){if(e instanceof oe)return Oe(e.referencedRule);if(e instanceof pe)return[e.terminalType];if(function(e){return e instanceof ae||e instanceof se||e instanceof le||e instanceof ue||e instanceof ce||e instanceof fe||e instanceof pe||e instanceof ie}(e))return function(e){var t,n=[],r=e.definition,i=0,a=r.length>i,s=!0;for(;a&&s;)t=r[i],s=Ee(t),n=n.concat(Oe(t)),i+=1,a=r.length>i;return Object(o.T)(n)}(e);if(function(e){return e instanceof he}(e))return function(e){var t=Object(o.I)(e.definition,(function(e){return Oe(e)}));return Object(o.T)(Object(o.t)(t))}(e);throw Error("non exhaustive match")}var Re="_~IN~_",Ne=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ke=function(e){function t(t){var n=e.call(this)||this;return n.topProd=t,n.follows={},n}return Ne(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.follows},t.prototype.walkTerminal=function(e,t,n){},t.prototype.walkProdRef=function(e,t,n){var r,o,i=(r=e.referencedRule,o=e.idx,r.name+o+Re+this.topProd.name),a=t.concat(n),s=Oe(new ae({definition:a}));this.follows[i]=s},t}(ve);function Ae(e,t,n){return n|t|e}function Ce(e,t,n,r){var o=r+1<<24;return Ae(e,t,n)|o}var Me=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function xe(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.endOffset=t.endOffset):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset)}function Ie(e,t){!0===isNaN(e.startOffset)?(e.startOffset=t.startOffset,e.startColumn=t.startColumn,e.startLine=t.startLine,e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine):e.endOffset<t.endOffset==!0&&(e.endOffset=t.endOffset,e.endColumn=t.endColumn,e.endLine=t.endLine)}function _e(e,t,n){void 0===e.children[t]?e.children[t]=[n]:e.children[t].push(n)}var Pe=function(e){function t(t){var n=e.call(this)||this;return n.result=[],n.ruleIdx=t,n}return Me(t,e),t.prototype.collectNamedDSLMethod=function(e,t,n){if(!Object(o.F)(e.name)){var r=void 0;if(e instanceof se||e instanceof le||e instanceof ue||e instanceof he)r=new t({definition:e.definition,idx:e.idx});else{if(!(e instanceof ce||e instanceof fe))throw Error("non exhaustive match");r=new t({definition:e.definition,idx:e.idx,separator:e.separator})}var i=[r],a=Ae(this.ruleIdx,n,e.idx);this.result.push({def:i,key:a,name:e.name,orgProd:e})}},t.prototype.visitOption=function(e){this.collectNamedDSLMethod(e,se,512)},t.prototype.visitRepetition=function(e){this.collectNamedDSLMethod(e,le,768)},t.prototype.visitRepetitionMandatory=function(e){this.collectNamedDSLMethod(e,ue,1024)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.collectNamedDSLMethod(e,ce,1536)},t.prototype.visitRepetitionWithSeparator=function(e){this.collectNamedDSLMethod(e,fe,1280)},t.prototype.visitAlternation=function(e){var t=this;this.collectNamedDSLMethod(e,he,256);var n=e.definition.length>1;Object(o.u)(e.definition,(function(r,i){if(!Object(o.F)(r.name)){var a=r.definition;a=n?[new se({definition:r.definition})]:r.definition;var s=Ce(t.ruleIdx,256,e.idx,i);t.result.push({def:a,key:s,name:r.name,orgProd:r})}}))},t}(ge);var Le=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fe=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.path=n,r.nextTerminalName="",r.nextTerminalOccurrence=0,r.nextTerminalName=r.path.lastTok.name,r.nextTerminalOccurrence=r.path.lastTokOccurrence,r}return Le(t,e),t.prototype.walkTerminal=function(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){var r=t.concat(n),o=new ae({definition:r});this.possibleTokTypes=Oe(o),this.found=!0}},t}(function(e){function t(t,n){var r=e.call(this)||this;return r.topProd=t,r.path=n,r.possibleTokTypes=[],r.nextProductionName="",r.nextProductionOccurrence=0,r.found=!1,r.isAtEndOfPath=!1,r}return Le(t,e),t.prototype.startWalking=function(){if(this.found=!1,this.path.ruleStack[0]!==this.topProd.name)throw Error("The path does not start with the walker's top Rule!");return this.ruleStack=Object(o.g)(this.path.ruleStack).reverse(),this.occurrenceStack=Object(o.g)(this.path.occurrenceStack).reverse(),this.ruleStack.pop(),this.occurrenceStack.pop(),this.updateExpectedNext(),this.walk(this.topProd),this.possibleTokTypes},t.prototype.walk=function(t,n){void 0===n&&(n=[]),this.found||e.prototype.walk.call(this,t,n)},t.prototype.walkProdRef=function(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){var r=t.concat(n);this.updateExpectedNext(),this.walk(e.referencedRule,r)}},t.prototype.updateExpectedNext=function(){Object(o.A)(this.ruleStack)?(this.nextProductionName="",this.nextProductionOccurrence=0,this.isAtEndOfPath=!0):(this.nextProductionName=this.ruleStack.pop(),this.nextProductionOccurrence=this.occurrenceStack.pop())},t}(ve)),De=function(e){function t(t,n){var r=e.call(this)||this;return r.topRule=t,r.occurrence=n,r.result={token:void 0,occurrence:void 0,isEndOfRule:void 0},r}return Le(t,e),t.prototype.startWalking=function(){return this.walk(this.topRule),this.result},t}(ve),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.prototype.walkMany=function(t,n,r){if(t.idx===this.occurrence){var i=Object(o.s)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof pe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkMany.call(this,t,n,r)},t}(De),je=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.prototype.walkManySep=function(t,n,r){if(t.idx===this.occurrence){var i=Object(o.s)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof pe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkManySep.call(this,t,n,r)},t}(De),Be=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.prototype.walkAtLeastOne=function(t,n,r){if(t.idx===this.occurrence){var i=Object(o.s)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof pe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOne.call(this,t,n,r)},t}(De),Ve=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Le(t,e),t.prototype.walkAtLeastOneSep=function(t,n,r){if(t.idx===this.occurrence){var i=Object(o.s)(n.concat(r));this.result.isEndOfRule=void 0===i,i instanceof pe&&(this.result.token=i.terminalType,this.result.occurrence=i.idx)}else e.prototype.walkAtLeastOneSep.call(this,t,n,r)},t}(De);function He(e,t,n){void 0===n&&(n=[]),n=Object(o.g)(n);var r=[],i=0;function a(a){var s=He(a.concat(Object(o.m)(e,i+1)),t,n);return r.concat(s)}for(;n.length<t&&i<e.length;){var s=e[i];if(s instanceof ae)return a(s.definition);if(s instanceof oe)return a(s.definition);if(s instanceof se)r=a(s.definition);else{if(s instanceof ue)return a(u=s.definition.concat([new le({definition:s.definition})]));if(s instanceof ce)return a(u=[new ae({definition:s.definition}),new le({definition:[new pe({terminalType:s.separator})].concat(s.definition)})]);if(s instanceof fe){var u=s.definition.concat([new le({definition:[new pe({terminalType:s.separator})].concat(s.definition)})]);r=a(u)}else if(s instanceof le){u=s.definition.concat([new le({definition:s.definition})]);r=a(u)}else{if(s instanceof he)return Object(o.u)(s.definition,(function(e){r=a(e.definition)})),r;if(!(s instanceof pe))throw Error("non exhaustive match");n.push(s.terminalType)}}i++}return r.push({partialPath:n,suffixDef:Object(o.m)(e,i)}),r}function Ge(e,t,n,r){var i=["EXIT_NONE_TERMINAL"],a=!1,s=t.length,u=s-r-1,c=[],l=[];for(l.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});!Object(o.A)(l);){var f=l.pop();if("EXIT_ALTERNATIVE"!==f){var h=f.def,p=f.idx,d=f.ruleStack,m=f.occurrenceStack;if(!Object(o.A)(h)){var v=h[0];if("EXIT_NONE_TERMINAL"===v){var y={idx:p,def:Object(o.m)(h),ruleStack:Object(o.n)(d),occurrenceStack:Object(o.n)(m)};l.push(y)}else if(v instanceof pe)if(p<s-1){var g=p+1;if(n(t[g],v.terminalType)){y={idx:g,def:Object(o.m)(h),ruleStack:d,occurrenceStack:m};l.push(y)}}else{if(p!==s-1)throw Error("non exhaustive match");c.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:d,occurrenceStack:m}),a=!0}else if(v instanceof oe){var b=Object(o.g)(d);b.push(v.nonTerminalName);var E=Object(o.g)(m);E.push(v.idx);y={idx:p,def:v.definition.concat(i,Object(o.m)(h)),ruleStack:b,occurrenceStack:E};l.push(y)}else if(v instanceof se){var w={idx:p,def:Object(o.m)(h),ruleStack:d,occurrenceStack:m};l.push(w),l.push("EXIT_ALTERNATIVE");var S={idx:p,def:v.definition.concat(Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(S)}else if(v instanceof ue){var T=new le({definition:v.definition,idx:v.idx});y={idx:p,def:v.definition.concat([T],Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(y)}else if(v instanceof ce){var O=new pe({terminalType:v.separator});T=new le({definition:[O].concat(v.definition),idx:v.idx}),y={idx:p,def:v.definition.concat([T],Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(y)}else if(v instanceof fe){w={idx:p,def:Object(o.m)(h),ruleStack:d,occurrenceStack:m};l.push(w),l.push("EXIT_ALTERNATIVE");O=new pe({terminalType:v.separator});var R=new le({definition:[O].concat(v.definition),idx:v.idx});S={idx:p,def:v.definition.concat([R],Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(S)}else if(v instanceof le){w={idx:p,def:Object(o.m)(h),ruleStack:d,occurrenceStack:m};l.push(w),l.push("EXIT_ALTERNATIVE");R=new le({definition:v.definition,idx:v.idx}),S={idx:p,def:v.definition.concat([R],Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(S)}else if(v instanceof he)for(var N=v.definition.length-1;N>=0;N--){var k={idx:p,def:v.definition[N].definition.concat(Object(o.m)(h)),ruleStack:d,occurrenceStack:m};l.push(k),l.push("EXIT_ALTERNATIVE")}else if(v instanceof ae)l.push({idx:p,def:v.definition.concat(Object(o.m)(h)),ruleStack:d,occurrenceStack:m});else{if(!(v instanceof ie))throw Error("non exhaustive match");l.push(ze(v,p,d,m))}}}else a&&Object(o.H)(l).idx<=u&&l.pop()}return c}function ze(e,t,n,r){var i=Object(o.g)(n);i.push(e.name);var a=Object(o.g)(r);return a.push(1),{idx:t,def:e.definition,ruleStack:i,occurrenceStack:a}}var We,$e=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){e[e.OPTION=0]="OPTION",e[e.REPETITION=1]="REPETITION",e[e.REPETITION_MANDATORY=2]="REPETITION_MANDATORY",e[e.REPETITION_MANDATORY_WITH_SEPARATOR=3]="REPETITION_MANDATORY_WITH_SEPARATOR",e[e.REPETITION_WITH_SEPARATOR=4]="REPETITION_WITH_SEPARATOR",e[e.ALTERNATION=5]="ALTERNATION"}(We||(We={}));var Ye=function(e){function t(t,n,r){var o=e.call(this)||this;return o.topProd=t,o.targetOccurrence=n,o.targetProdType=r,o}return $e(t,e),t.prototype.startWalking=function(){return this.walk(this.topProd),this.restDef},t.prototype.checkIsTarget=function(e,t,n,r){return e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.restDef=n.concat(r),!0)},t.prototype.walkOption=function(t,n,r){this.checkIsTarget(t,We.OPTION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOne=function(t,n,r){this.checkIsTarget(t,We.REPETITION_MANDATORY,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkAtLeastOneSep=function(t,n,r){this.checkIsTarget(t,We.REPETITION_MANDATORY_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkMany=function(t,n,r){this.checkIsTarget(t,We.REPETITION,n,r)||e.prototype.walkOption.call(this,t,n,r)},t.prototype.walkManySep=function(t,n,r){this.checkIsTarget(t,We.REPETITION_WITH_SEPARATOR,n,r)||e.prototype.walkOption.call(this,t,n,r)},t}(ve),Ke=function(e){function t(t,n,r){var o=e.call(this)||this;return o.targetOccurrence=t,o.targetProdType=n,o.targetRef=r,o.result=[],o}return $e(t,e),t.prototype.checkIsTarget=function(e,t){e.idx!==this.targetOccurrence||this.targetProdType!==t||void 0!==this.targetRef&&e!==this.targetRef||(this.result=e.definition)},t.prototype.visitOption=function(e){this.checkIsTarget(e,We.OPTION)},t.prototype.visitRepetition=function(e){this.checkIsTarget(e,We.REPETITION)},t.prototype.visitRepetitionMandatory=function(e){this.checkIsTarget(e,We.REPETITION_MANDATORY)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.checkIsTarget(e,We.REPETITION_MANDATORY_WITH_SEPARATOR)},t.prototype.visitRepetitionWithSeparator=function(e){this.checkIsTarget(e,We.REPETITION_WITH_SEPARATOR)},t.prototype.visitAlternation=function(e){this.checkIsTarget(e,We.ALTERNATION)},t}(ge);function qe(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=[];return t}function Xe(e){for(var t=[""],n=0;n<e.length;n++){for(var r=e[n],o=[],i=0;i<t.length;i++){var a=t[i];o.push(a+"_"+r.tokenTypeIdx);for(var s=0;s<r.categoryMatches.length;s++){var u="_"+r.categoryMatches[s];o.push(a+u)}}t=o}return t}function Je(e,t,n){for(var r=0;r<e.length;r++)if(r!==n)for(var o=e[r],i=0;i<t.length;i++){if(!0===o[t[i]])return!1}return!0}function Qe(e,t){for(var n=Object(o.I)(e,(function(e){return He([e],1)})),r=qe(n.length),i=Object(o.I)(n,(function(e){var t={};return Object(o.u)(e,(function(e){var n=Xe(e.partialPath);Object(o.u)(n,(function(e){t[e]=!0}))})),t})),a=n,s=1;s<=t;s++){var u=a;a=qe(u.length);for(var c=function(e){for(var n=u[e],c=0;c<n.length;c++){var l=n[c].partialPath,f=n[c].suffixDef,h=Xe(l);if(Je(i,h,e)||Object(o.A)(f)||l.length===t){var p=r[e];if(!1===tt(p,l)){p.push(l);for(var d=0;d<h.length;d++){var m=h[d];i[e][m]=!0}}}else{var v=He(f,s+1,l);a[e]=a[e].concat(v),Object(o.u)(v,(function(t){var n=Xe(t.partialPath);Object(o.u)(n,(function(t){i[e][t]=!0}))}))}}},l=0;l<u.length;l++)c(l)}return r}function Ze(e,t,n,r){var o=new Ke(e,We.ALTERNATION,r);return t.accept(o),Qe(o.result,n)}function et(e,t,n,r){var o=new Ke(e,n);t.accept(o);var i=o.result,a=new Ye(t,e,n).startWalking();return Qe([new ae({definition:i}),new ae({definition:a})],r)}function tt(e,t){e:for(var n=0;n<e.length;n++){var r=e[n];if(r.length===t.length){for(var o=0;o<r.length;o++){var i=t[o],a=r[o];if(!1===(i===a||void 0!==a.categoryMatchesMap[i.tokenTypeIdx]))continue e}return!0}}return!1}function nt(e){return Object(o.o)(e,(function(e){return Object(o.o)(e,(function(e){return Object(o.o)(e,(function(e){return Object(o.A)(e.categoryMatches)}))}))}))}var rt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();function ot(e,t,n,r,i,a){var s=o.I(e,(function(e){return function(e,t){var n=new st;e.accept(n);var r=n.allProductions,i=o.v(r,it),a=o.N(i,(function(e){return e.length>1}));return o.I(o.U(a),(function(n){var r=o.s(n),i=t.buildDuplicateFoundError(e,n),a=we(r),s={message:i,type:rn.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:a,occurrence:r.idx},u=at(r);return u&&(s.parameter=u),s}))}(e,i)})),u=o.I(e,(function(e){return function e(t,n,r,i){void 0===i&&(i=[]);var a=[],s=function e(t){var n=[];if(o.A(t))return n;var r=o.s(t);if(r instanceof oe)n.push(r.referencedRule);else if(r instanceof ae||r instanceof se||r instanceof ue||r instanceof ce||r instanceof fe||r instanceof le)n=n.concat(e(r.definition));else if(r instanceof he)n=o.t(o.I(r.definition,(function(t){return e(t.definition)})));else if(!(r instanceof pe))throw Error("non exhaustive match");var i=Ee(r),a=t.length>1;if(i&&a){var s=o.m(t);return n.concat(e(s))}return n}(n.definition);if(o.A(s))return[];var u=t.name;o.j(s,t)&&a.push({message:r.buildLeftRecursionError({topLevelRule:t,leftRecursionPath:i}),type:rn.LEFT_RECURSION,ruleName:u});var c=o.l(s,i.concat([t])),l=o.I(c,(function(n){var a=o.g(i);return a.push(n),e(t,n,r,a)}));return a.concat(o.t(l))}(e,e,i)})),c=[],l=[],f=[];Object(o.o)(u,o.A)&&(c=Object(o.I)(e,(function(e){return function(e,t){var n=new lt;e.accept(n);var r=n.alternations;return o.O(r,(function(n,r){var i=o.n(r.definition),a=o.I(i,(function(n,i){var a=Ge([n],[],null,1);return o.A(a)?{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:i}),type:rn.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:i+1}:null}));return n.concat(o.i(a))}),[])}(e,i)})),l=Object(o.I)(e,(function(e){return function(e,t,n,r){var i=new lt;e.accept(i);var a=i.alternations,s=n[e.name];s&&(a=Object(o.P)(a,(function(e){return s[we(e)+(0===e.idx?"":e.idx)]})));return a=Object(o.P)(a,(function(e){return!0===e.ignoreAmbiguities})),o.O(a,(function(n,i){var a=i.idx,s=i.maxLookahead||t,u=Ze(a,e,s,i),c=function(e,t,n,r){var i=[],a=Object(o.O)(e,(function(n,r,a){return!0===t.definition[a].ignoreAmbiguities||Object(o.u)(r,(function(r){var s=[a];Object(o.u)(e,(function(e,n){a!==n&&tt(e,r)&&!0!==t.definition[n].ignoreAmbiguities&&s.push(n)})),s.length>1&&!tt(i,r)&&(i.push(r),n.push({alts:s,path:r}))})),n}),[]);return o.I(a,(function(e){var i=Object(o.I)(e.alts,(function(e){return e+1}));return{message:r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:i,prefixPath:e.path}),type:rn.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:[e.alts]}}))}(u,i,e,r),l=function(e,t,n,r){var i=[],a=Object(o.O)(e,(function(e,t,n){var r=Object(o.I)(t,(function(e){return{idx:n,path:e}}));return e.concat(r)}),[]);return Object(o.u)(a,(function(e){if(!0!==t.definition[e.idx].ignoreAmbiguities){var s=e.idx,u=e.path,c=Object(o.r)(a,(function(e){return!0!==t.definition[e.idx].ignoreAmbiguities&&e.idx<s&&(n=e.path,r=u,n.length<r.length&&Object(o.o)(n,(function(e,t){var n=r[t];return e===n||n.categoryMatchesMap[e.tokenTypeIdx]})));var n,r})),l=Object(o.I)(c,(function(e){var o=[e.idx+1,s+1],i=0===t.idx?"":t.idx;return{message:r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:o,prefixPath:e.path}),type:rn.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:i,alternatives:o}}));i=i.concat(l)}})),i}(u,i,e,r);return n.concat(c,l)}),[])}(e,t,r,i)})),f=function(e,t,n){var r=[];return Object(o.u)(e,(function(e){var i=new ft;e.accept(i);var a=i.allProductions;Object(o.u)(a,(function(i){var a=function(e){if(e instanceof se)return We.OPTION;if(e instanceof le)return We.REPETITION;if(e instanceof ue)return We.REPETITION_MANDATORY;if(e instanceof ce)return We.REPETITION_MANDATORY_WITH_SEPARATOR;if(e instanceof fe)return We.REPETITION_WITH_SEPARATOR;if(e instanceof he)return We.ALTERNATION;throw Error("non exhaustive match")}(i),s=i.maxLookahead||t,u=et(i.idx,e,a,s)[0];if(Object(o.A)(Object(o.t)(u))){var c=n.buildEmptyRepetitionError({topLevelRule:e,repetition:i});r.push({message:c,type:rn.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))})),r}(e,t,i));var h=function(e,t,n){var r=[],i=Object(o.I)(t,(function(e){return e.name}));return Object(o.u)(e,(function(e){var t=e.name;if(Object(o.j)(i,t)){var a=n.buildNamespaceConflictError(e);r.push({message:a,type:rn.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}})),r}(e,n,i),p=o.I(n,(function(e){return function(e,t){var n=[];e.name.match(ut)||n.push({message:t.buildTokenNameError({tokenType:e,expectedPattern:ut}),type:rn.INVALID_TOKEN_NAME});return n}(e,i)})),d=function(e,t){var n=[];return Object(o.u)(e,(function(e){var r=new Pe("");e.accept(r);var i=Object(o.I)(r.result,(function(e){return e.orgProd}));n.push(Object(o.I)(i,(function(n){return function(e,t,n){var r,o=[];t.name.match(ct)||(r=n.buildInvalidNestedRuleNameError(e,t),o.push({message:r,type:rn.INVALID_NESTED_RULE_NAME,ruleName:e.name}));return o}(e,n,t)})))})),Object(o.t)(n)}(e,i),m=function(e,t){var n=[];return Object(o.u)(e,(function(e){var r=new Pe("");e.accept(r);var i=Object(o.v)(r.result,(function(e){return e.name})),a=Object(o.N)(i,(function(e){return e.length>1}));Object(o.u)(Object(o.U)(a),(function(r){var i=Object(o.I)(r,(function(e){return e.orgProd})),a=t.buildDuplicateNestedRuleNameError(e,i);n.push({message:a,type:rn.DUPLICATE_NESTED_NAME,ruleName:e.name})}))})),n}(e,i),v=Object(o.I)(e,(function(e){return function(e,t){var n=new lt;e.accept(n);var r=n.alternations;return o.O(r,(function(n,r){return r.definition.length>255&&n.push({message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:rn.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}),n}),[])}(e,i)})),y=Object(o.I)(e,(function(e){return function(e,t){var n=[],r=e.name;r.match(ut)||n.push({message:t.buildInvalidRuleNameError({topLevelRule:e,expectedPattern:ut}),type:rn.INVALID_RULE_NAME,ruleName:r});return n}(e,i)})),g=Object(o.I)(e,(function(t){return function(e,t,n,r){var i=[];if(Object(o.O)(t,(function(t,n){return n.name===e.name?t+1:t}),0)>1){var a=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});i.push({message:a,type:rn.DUPLICATE_RULE_NAME,ruleName:e.name})}return i}(t,e,a,i)}));return o.t(s.concat(p,d,m,f,u,c,l,h,v,y,g))}function it(e){return we(e)+"_#_"+e.idx+"_#_"+at(e)}function at(e){return e instanceof pe?e.terminalType.name:e instanceof oe?e.nonTerminalName:""}var st=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return rt(t,e),t.prototype.visitNonTerminal=function(e){this.allProductions.push(e)},t.prototype.visitOption=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t.prototype.visitAlternation=function(e){this.allProductions.push(e)},t.prototype.visitTerminal=function(e){this.allProductions.push(e)},t}(ge),ut=/^[a-zA-Z_]\w*$/,ct=new RegExp(ut.source.replace("^","^\\$"));var lt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.alternations=[],t}return rt(t,e),t.prototype.visitAlternation=function(e){this.alternations.push(e)},t}(ge);var ft=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.allProductions=[],t}return rt(t,e),t.prototype.visitRepetitionWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatory=function(e){this.allProductions.push(e)},t.prototype.visitRepetitionMandatoryWithSeparator=function(e){this.allProductions.push(e)},t.prototype.visitRepetition=function(e){this.allProductions.push(e)},t}(ge);var ht={buildMismatchTokenMessage:function(e){var t=e.expected,n=e.actual;e.previous,e.ruleName;return"Expecting "+(J(t)?"--\x3e "+q(t)+" <--":"token of type --\x3e "+t.name+" <--")+" but found --\x3e '"+n.image+"' <--"},buildNotAllInputParsedMessage:function(e){var t=e.firstRedundant;e.ruleName;return"Redundant input, expecting EOF but found: "+t.image},buildNoViableAltMessage:function(e){var t=e.expectedPathsPerAlt,n=e.actual,r=(e.previous,e.customUserDescription),i=(e.ruleName,"\nbut found: '"+Object(o.s)(n).image+"'");if(r)return"Expecting: "+r+i;var a=Object(o.O)(t,(function(e,t){return e.concat(t)}),[]),s=Object(o.I)(a,(function(e){return"["+Object(o.I)(e,(function(e){return q(e)})).join(", ")+"]"}));return"Expecting: "+("one of these possible Token sequences:\n"+Object(o.I)(s,(function(e,t){return"  "+(t+1)+". "+e})).join("\n"))+i},buildEarlyExitMessage:function(e){var t=e.expectedIterationPaths,n=e.actual,r=e.customUserDescription,i=(e.ruleName,"\nbut found: '"+Object(o.s)(n).image+"'");return r?"Expecting: "+r+i:"Expecting: "+("expecting at least one iteration which starts with one of these possible Token sequences::\n  <"+Object(o.I)(t,(function(e){return"["+Object(o.I)(e,(function(e){return q(e)})).join(",")+"]"})).join(" ,")+">")+i}};Object.freeze(ht);var pt={buildRuleNotFoundError:function(e,t){return"Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\ninside top level rule: ->"+e.name+"<-"}},dt={buildDuplicateFoundError:function(e,t){var n,r=e.name,i=Object(o.s)(t),a=i.idx,s=we(i),u=(n=i)instanceof pe?n.terminalType.name:n instanceof oe?n.nonTerminalName:"",c="->"+s+(a>0?a:"")+"<- "+(u?"with argument: ->"+u+"<-":"")+"\n                  appears more than once ("+t.length+" times) in the top level rule: ->"+r+"<-.                  \n                  For further details see: https://sap.github.io/chevrotain/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  ";return c=(c=c.replace(/[ \t]+/g," ")).replace(/\s\s+/g,"\n")},buildInvalidNestedRuleNameError:function(e,t){return"Invalid nested rule name: ->"+t.name+"<- inside rule: ->"+e.name+"<-\nit must match the pattern: ->"+ct.toString()+"<-.\nNote that this means a nested rule name must start with the '$'(dollar) sign."},buildDuplicateNestedRuleNameError:function(e,t){return"Duplicate nested rule name: ->"+Object(o.s)(t).name+"<- inside rule: ->"+e.name+"<-\nA nested name must be unique in the scope of a top level grammar rule."},buildNamespaceConflictError:function(e){return"Namespace conflict found in grammar.\nThe grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <"+e.name+">.\nTo resolve this make sure each Terminal and Non-Terminal names are unique\nThis is easy to accomplish by using the convention that Terminal names start with an uppercase letter\nand Non-Terminal names start with a lower case letter."},buildAlternationPrefixAmbiguityError:function(e){var t=Object(o.I)(e.prefixPath,(function(e){return q(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx;return"Ambiguous alternatives: <"+e.ambiguityIndices.join(" ,")+"> due to common lookahead prefix\nin <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\nSee: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\nFor Further details."},buildAlternationAmbiguityError:function(e){var t=Object(o.I)(e.prefixPath,(function(e){return q(e)})).join(", "),n=0===e.alternation.idx?"":e.alternation.idx,r="Ambiguous Alternatives Detected: <"+e.ambiguityIndices.join(" ,")+"> in <OR"+n+"> inside <"+e.topLevelRule.name+"> Rule,\n<"+t+"> may appears as a prefix path in all these alternatives.\n";return r+="See: https://sap.github.io/chevrotain/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\nFor Further details."},buildEmptyRepetitionError:function(e){var t=we(e.repetition);return 0!==e.repetition.idx&&(t+=e.repetition.idx),"The repetition <"+t+"> within Rule <"+e.topLevelRule.name+"> can never consume any tokens.\nThis could lead to an infinite loop."},buildTokenNameError:function(e){return"Invalid Grammar Token name: ->"+e.tokenType.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildEmptyAlternationError:function(e){return"Ambiguous empty alternative: <"+(e.emptyChoiceIdx+1)+"> in <OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\nOnly the last alternative may be an empty alternative."},buildTooManyAlternativesError:function(e){return"An Alternation cannot have more than 256 alternatives:\n<OR"+e.alternation.idx+"> inside <"+e.topLevelRule.name+"> Rule.\n has "+(e.alternation.definition.length+1)+" alternatives."},buildLeftRecursionError:function(e){var t=e.topLevelRule.name;return"Left Recursion found in grammar.\nrule: <"+t+"> can be invoked from itself (directly or indirectly)\nwithout consuming any Tokens. The grammar path that causes this is: \n "+(t+" --\x3e "+o.I(e.leftRecursionPath,(function(e){return e.name})).concat([t]).join(" --\x3e "))+"\n To fix this refactor your grammar to remove the left recursion.\nsee: https://en.wikipedia.org/wiki/LL_parser#Left_Factoring."},buildInvalidRuleNameError:function(e){return"Invalid grammar rule name: ->"+e.topLevelRule.name+"<- it must match the pattern: ->"+e.expectedPattern.toString()+"<-"},buildDuplicateRuleNameError:function(e){return"Duplicate definition, rule: ->"+(e.topLevelRule instanceof ie?e.topLevelRule.name:e.topLevelRule)+"<- is already defined in the grammar: ->"+e.grammarName+"<-"}},mt=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();var vt=function(e){function t(t,n){var r=e.call(this)||this;return r.nameToTopRule=t,r.errMsgProvider=n,r.errors=[],r}return mt(t,e),t.prototype.resolveRefs=function(){var e=this;Object(o.u)(Object(o.U)(this.nameToTopRule),(function(t){e.currTopLevel=t,t.accept(e)}))},t.prototype.visitNonTerminal=function(e){var t=this.nameToTopRule[e.nonTerminalName];if(t)e.referencedRule=t;else{var n=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:n,type:rn.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}},t}(ge);function yt(e){e=Object(o.k)(e,{errMsgProvider:pt});var t,n,r,i={};return Object(o.u)(e.rules,(function(e){i[e.name]=e})),t=i,n=e.errMsgProvider,(r=new vt(t,n)).resolveRefs(),r.errors}function gt(e){return ot((e=Object(o.k)(e,{errMsgProvider:dt,ignoredIssues:{}})).rules,e.maxLookahead,e.tokenTypes,e.ignoredIssues,e.errMsgProvider,e.grammarName)}function bt(e){Object(o.u)(e.rules,(function(e){var t=new Se;e.accept(t),Object(o.u)(t.dslMethods,(function(e){Object(o.u)(e,(function(e,t){e.idx=t+1}))}))}))}var Et=["MismatchedTokenException","NoViableAltException","EarlyExitException","NotAllInputParsedException"];function wt(e){return Object(o.j)(Et,e.name)}function St(e,t,n){this.name="MismatchedTokenException",this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function Tt(e,t,n){this.name="NoViableAltException",this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}function Ot(e,t){this.name="NotAllInputParsedException",this.message=e,this.token=t,this.resyncedTokens=[]}function Rt(e,t,n){this.name="EarlyExitException",this.message=e,this.token=t,this.previousToken=n,this.resyncedTokens=[]}Object.freeze(Et),St.prototype=Error.prototype,Tt.prototype=Error.prototype,Ot.prototype=Error.prototype,Rt.prototype=Error.prototype;var Nt={};function kt(e){this.name="InRuleRecoveryException",this.message=e}kt.prototype=Error.prototype;var At=function(){function e(){}return e.prototype.initRecoverable=function(e){this.firstAfterRepMap={},this.resyncFollows={},this.recoveryEnabled=Object(o.w)(e,"recoveryEnabled")?e.recoveryEnabled:on.recoveryEnabled,this.recoveryEnabled&&(this.attemptInRepetitionRecovery=Ct)},e.prototype.getTokenToInsert=function(e){var t=ee(e,"",NaN,NaN,NaN,NaN,NaN,NaN);return t.isInsertedInRecovery=!0,t},e.prototype.canTokenTypeBeInsertedInRecovery=function(e){return!0},e.prototype.tryInRepetitionRecovery=function(e,t,n,r){for(var i=this,a=this.findReSyncTokenType(),s=this.exportLexerState(),u=[],c=!1,l=this.LA(1),f=this.LA(1),h=function(){var e=i.LA(0),t=new St(i.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:l,previous:e,ruleName:i.getCurrRuleFullName()}),l,i.LA(0));t.resyncedTokens=Object(o.n)(u),i.SAVE_ERROR(t)};!c;){if(this.tokenMatcher(f,r))return void h();if(n.call(this))return h(),void e.apply(this,t);this.tokenMatcher(f,a)?c=!0:(f=this.SKIP_TOKEN(),this.addToResyncTokens(f,u))}this.importLexerState(s)},e.prototype.shouldInRepetitionRecoveryBeTried=function(e,t,n){return!1!==n&&(void 0!==e&&void 0!==t&&(!this.tokenMatcher(this.LA(1),e)&&(!this.isBackTracking()&&!this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t)))))},e.prototype.getFollowsForInRuleRecovery=function(e,t){var n=this.getCurrentGrammarPath(e,t);return this.getNextPossibleTokenTypes(n)},e.prototype.tryInRuleRecovery=function(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t))return this.getTokenToInsert(e);if(this.canRecoverWithSingleTokenDeletion(e)){var n=this.SKIP_TOKEN();return this.consumeToken(),n}throw new kt("sad sad panda")},e.prototype.canPerformInRuleRecovery=function(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)},e.prototype.canRecoverWithSingleTokenInsertion=function(e,t){var n=this;if(!this.canTokenTypeBeInsertedInRecovery(e))return!1;if(Object(o.A)(t))return!1;var r=this.LA(1);return void 0!==Object(o.q)(t,(function(e){return n.tokenMatcher(r,e)}))},e.prototype.canRecoverWithSingleTokenDeletion=function(e){return this.tokenMatcher(this.LA(2),e)},e.prototype.isInCurrentRuleReSyncSet=function(e){var t=this.getCurrFollowKey(),n=this.getFollowSetFromFollowKey(t);return Object(o.j)(n,e)},e.prototype.findReSyncTokenType=function(){for(var e=this.flattenFollowSet(),t=this.LA(1),n=2;;){var r=t.tokenType;if(Object(o.j)(e,r))return r;t=this.LA(n),n++}},e.prototype.getCurrFollowKey=function(){if(1===this.RULE_STACK.length)return Nt;var e=this.getLastExplicitRuleShortName(),t=this.getLastExplicitRuleOccurrenceIndex(),n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}},e.prototype.buildFullFollowKeyStack=function(){var e=this,t=this.RULE_STACK,n=this.RULE_OCCURRENCE_STACK;return Object(o.A)(this.LAST_EXPLICIT_RULE_STACK)||(t=Object(o.I)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_STACK[t]})),n=Object(o.I)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.RULE_OCCURRENCE_STACK[t]}))),Object(o.I)(t,(function(r,o){return 0===o?Nt:{ruleName:e.shortRuleNameToFullName(r),idxInCallingRule:n[o],inRule:e.shortRuleNameToFullName(t[o-1])}}))},e.prototype.flattenFollowSet=function(){var e=this,t=Object(o.I)(this.buildFullFollowKeyStack(),(function(t){return e.getFollowSetFromFollowKey(t)}));return Object(o.t)(t)},e.prototype.getFollowSetFromFollowKey=function(e){if(e===Nt)return[Z];var t=e.ruleName+e.idxInCallingRule+Re+e.inRule;return this.resyncFollows[t]},e.prototype.addToResyncTokens=function(e,t){return this.tokenMatcher(e,Z)||t.push(e),t},e.prototype.reSyncTo=function(e){for(var t=[],n=this.LA(1);!1===this.tokenMatcher(n,e);)n=this.SKIP_TOKEN(),this.addToResyncTokens(n,t);return Object(o.n)(t)},e.prototype.attemptInRepetitionRecovery=function(e,t,n,r,o,i,a){},e.prototype.getCurrentGrammarPath=function(e,t){return{ruleStack:this.getHumanReadableRuleStack(),occurrenceStack:Object(o.g)(this.RULE_OCCURRENCE_STACK),lastTok:e,lastTokOccurrence:t}},e.prototype.getHumanReadableRuleStack=function(){var e=this;return Object(o.A)(this.LAST_EXPLICIT_RULE_STACK)?Object(o.I)(this.RULE_STACK,(function(t){return e.shortRuleNameToFullName(t)})):Object(o.I)(this.LAST_EXPLICIT_RULE_STACK,(function(t){return e.shortRuleNameToFullName(e.RULE_STACK[t])}))},e}();function Ct(e,t,n,r,o,i,a){var s=this.getKeyForAutomaticLookahead(r,o),u=this.firstAfterRepMap[s];if(void 0===u){var c=this.getCurrRuleFullName();u=new i(this.getGAstProductions()[c],o).startWalking(),this.firstAfterRepMap[s]=u}var l=u.token,f=u.occurrence,h=u.isEndOfRule;1===this.RULE_STACK.length&&h&&void 0===l&&(l=Z,f=1),this.shouldInRepetitionRecoveryBeTried(l,f,a)&&this.tryInRepetitionRecovery(e,t,n,l)}var Mt=function(){function e(){}return e.prototype.initLooksAhead=function(e){this.dynamicTokensEnabled=Object(o.w)(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:on.dynamicTokensEnabled,this.maxLookahead=Object(o.w)(e,"maxLookahead")?e.maxLookahead:on.maxLookahead,this.lookAheadFuncsCache=Object(o.z)()?new Map:[],Object(o.z)()?(this.getLaFuncFromCache=this.getLaFuncFromMap,this.setLaFuncCache=this.setLaFuncCacheUsingMap):(this.getLaFuncFromCache=this.getLaFuncFromObj,this.setLaFuncCache=this.setLaFuncUsingObj)},e.prototype.preComputeLookaheadFunctions=function(e){var t=this;Object(o.u)(e,(function(e){t.TRACE_INIT(e.name+" Rule Lookahead",(function(){var n=function(e){Te.reset(),e.accept(Te);var t=Te.dslMethods;return Te.reset(),t}(e),r=n.alternation,i=n.repetition,a=n.option,s=n.repetitionMandatory,u=n.repetitionMandatoryWithSeparator,c=n.repetitionWithSeparator;Object(o.u)(r,(function(n){var r=0===n.idx?"":n.idx;t.TRACE_INIT(""+we(n)+r,(function(){var r,o,i,a,s,u,c,l=(r=n.idx,o=e,i=n.maxLookahead||t.maxLookahead,a=n.hasPredicates,s=t.dynamicTokensEnabled,u=t.lookAheadBuilderForAlternatives,c=Ze(r,o,i),u(c,a,nt(c)?U:D,s)),f=Ae(t.fullRuleNameToShort[e.name],256,n.idx);t.setLaFuncCache(f,l)}))})),Object(o.u)(i,(function(n){t.computeLookaheadFunc(e,n.idx,768,We.REPETITION,n.maxLookahead,we(n))})),Object(o.u)(a,(function(n){t.computeLookaheadFunc(e,n.idx,512,We.OPTION,n.maxLookahead,we(n))})),Object(o.u)(s,(function(n){t.computeLookaheadFunc(e,n.idx,1024,We.REPETITION_MANDATORY,n.maxLookahead,we(n))})),Object(o.u)(u,(function(n){t.computeLookaheadFunc(e,n.idx,1536,We.REPETITION_MANDATORY_WITH_SEPARATOR,n.maxLookahead,we(n))})),Object(o.u)(c,(function(n){t.computeLookaheadFunc(e,n.idx,1280,We.REPETITION_WITH_SEPARATOR,n.maxLookahead,we(n))}))}))}))},e.prototype.computeLookaheadFunc=function(e,t,n,r,o,i){var a=this;this.TRACE_INIT(""+i+(0===t?"":t),(function(){var i=function(e,t,n,r,o,i){var a=et(e,t,o,n),s=nt(a)?U:D;return i(a[0],s,r)}(t,e,o||a.maxLookahead,a.dynamicTokensEnabled,r,a.lookAheadBuilderForOptional),s=Ae(a.fullRuleNameToShort[e.name],n,t);a.setLaFuncCache(s,i)}))},e.prototype.lookAheadBuilderForOptional=function(e,t,n){return function(e,t,n){var r=Object(o.o)(e,(function(e){return 1===e.length})),i=e.length;if(r&&!n){var a=Object(o.t)(e);if(1===a.length&&Object(o.A)(a[0].categoryMatches)){var s=a[0].tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===s}}var u=Object(o.O)(a,(function(e,t,n){return e[t.tokenTypeIdx]=!0,Object(o.u)(t.categoryMatches,(function(t){e[t]=!0})),e}),[]);return function(){var e=this.LA(1);return!0===u[e.tokenTypeIdx]}}return function(){e:for(var n=0;n<i;n++){for(var r=e[n],o=r.length,a=0;a<o;a++){var s=this.LA(a+1);if(!1===t(s,r[a]))continue e}return!0}return!1}}(e,t,n)},e.prototype.lookAheadBuilderForAlternatives=function(e,t,n,r){return function(e,t,n,r){var i=e.length,a=Object(o.o)(e,(function(e){return Object(o.o)(e,(function(e){return 1===e.length}))}));if(t)return function(t){for(var r=Object(o.I)(t,(function(e){return e.GATE})),a=0;a<i;a++){var s=e[a],u=s.length,c=r[a];if(void 0===c||!1!==c.call(this))e:for(var l=0;l<u;l++){for(var f=s[l],h=f.length,p=0;p<h;p++){var d=this.LA(p+1);if(!1===n(d,f[p]))continue e}return a}}};if(a&&!r){var s=Object(o.I)(e,(function(e){return Object(o.t)(e)})),u=Object(o.O)(s,(function(e,t,n){return Object(o.u)(t,(function(t){Object(o.w)(e,t.tokenTypeIdx)||(e[t.tokenTypeIdx]=n),Object(o.u)(t.categoryMatches,(function(t){Object(o.w)(e,t)||(e[t]=n)}))})),e}),[]);return function(){var e=this.LA(1);return u[e.tokenTypeIdx]}}return function(){for(var t=0;t<i;t++){var r=e[t],o=r.length;e:for(var a=0;a<o;a++){for(var s=r[a],u=s.length,c=0;c<u;c++){var l=this.LA(c+1);if(!1===n(l,s[c]))continue e}return t}}}}(e,t,n,r)},e.prototype.getKeyForAutomaticLookahead=function(e,t){return Ae(this.getLastExplicitRuleShortName(),e,t)},e.prototype.getLaFuncFromCache=function(e){},e.prototype.getLaFuncFromMap=function(e){return this.lookAheadFuncsCache.get(e)},e.prototype.getLaFuncFromObj=function(e){return this.lookAheadFuncsCache[e]},e.prototype.setLaFuncCache=function(e,t){},e.prototype.setLaFuncCacheUsingMap=function(e,t){this.lookAheadFuncsCache.set(e,t)},e.prototype.setLaFuncUsingObj=function(e,t){this.lookAheadFuncsCache[e]=t},e}();var xt,It=/^\s*function\s*(\S*)\s*\(/;function _t(e){var t=e.name;return t||e.toString().match(It)[1]}function Pt(e,t){var n=Object.getOwnPropertyDescriptor(e,"name");return!(!Object(o.F)(n)&&!n.configurable)&&(Object.defineProperty(e,"name",{enumerable:!1,configurable:!0,writable:!1,value:t}),!0)}function Lt(e,t){for(var n=Object(o.G)(e),r=n.length,i=0;i<r;i++)for(var a=e[n[i]],s=a.length,u=0;u<s;u++){var c=a[u];void 0===c.tokenTypeIdx&&(void 0!==c.fullName?this[c.fullName](c.children,t):this[c.name](c.children,t))}}function Ft(e,t){var n=function(){};return Pt(n,e+"BaseSemantics"),(n.prototype={visit:function(e,t){if(Object(o.y)(e)&&(e=e[0]),!Object(o.F)(e))return void 0!==e.fullName?this[e.fullName](e.children,t):this[e.name](e.children,t)},validateVisitor:function(){var e=function(e,t){var n=function(e,t){var n=Object(o.I)(t,(function(t){if(!Object(o.B)(e[t]))return{msg:"Missing visitor method: <"+t+"> on "+_t(e.constructor)+" CST Visitor.",type:xt.MISSING_METHOD,methodName:t}}));return Object(o.i)(n)}(e,t),r=function(e,t){var n=[];for(var r in e)ut.test(r)&&Object(o.B)(e[r])&&!Object(o.j)(Dt,r)&&!Object(o.j)(t,r)&&n.push({msg:"Redundant visitor method: <"+r+"> on "+_t(e.constructor)+" CST Visitor\nThere is no Grammar Rule corresponding to this method's name.\nFor utility methods on visitor classes use methods names that do not match /"+ut.source+"/.",type:xt.REDUNDANT_METHOD,methodName:r});return n}(e,t);return n.concat(r)}(this,t);if(!Object(o.A)(e)){var n=Object(o.I)(e,(function(e){return e.msg}));throw Error("Errors Detected in CST Visitor <"+_t(this.constructor)+">:\n\t"+n.join("\n\n").replace(/\n/g,"\n\t"))}}}).constructor=n,n._RULE_NAMES=t,n}!function(e){e[e.REDUNDANT_METHOD=0]="REDUNDANT_METHOD",e[e.MISSING_METHOD=1]="MISSING_METHOD"}(xt||(xt={}));var Dt=["constructor","visit","validateVisitor"];var Ut=function(){function e(){}return e.prototype.initTreeBuilder=function(e){if(this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.outputCst=Object(o.w)(e,"outputCst")?e.outputCst:on.outputCst,this.nodeLocationTracking=Object(o.w)(e,"nodeLocationTracking")?e.nodeLocationTracking:on.nodeLocationTracking,this.outputCst)if(/full/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=Ie,this.setNodeLocationFromNode=Ie,this.cstPostRule=o.b,this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery):(this.setNodeLocationFromToken=o.b,this.setNodeLocationFromNode=o.b,this.cstPostRule=this.cstPostRuleFull,this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular);else if(/onlyOffset/i.test(this.nodeLocationTracking))this.recoveryEnabled?(this.setNodeLocationFromToken=xe,this.setNodeLocationFromNode=xe,this.cstPostRule=o.b,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery):(this.setNodeLocationFromToken=o.b,this.setNodeLocationFromNode=o.b,this.cstPostRule=this.cstPostRuleOnlyOffset,this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular);else{if(!/none/i.test(this.nodeLocationTracking))throw Error('Invalid <nodeLocationTracking> config option: "'+e.nodeLocationTracking+'"');this.setNodeLocationFromToken=o.b,this.setNodeLocationFromNode=o.b,this.cstPostRule=o.b,this.setInitialNodeLocation=o.b}else this.cstInvocationStateUpdate=o.b,this.cstFinallyStateUpdate=o.b,this.cstPostTerminal=o.b,this.cstPostNonTerminal=o.b,this.cstPostRule=o.b,this.getLastExplicitRuleShortName=this.getLastExplicitRuleShortNameNoCst,this.getPreviousExplicitRuleShortName=this.getPreviousExplicitRuleShortNameNoCst,this.getLastExplicitRuleOccurrenceIndex=this.getLastExplicitRuleOccurrenceIndexNoCst,this.manyInternal=this.manyInternalNoCst,this.orInternal=this.orInternalNoCst,this.optionInternal=this.optionInternalNoCst,this.atLeastOneInternal=this.atLeastOneInternalNoCst,this.manySepFirstInternal=this.manySepFirstInternalNoCst,this.atLeastOneSepFirstInternal=this.atLeastOneSepFirstInternalNoCst},e.prototype.setInitialNodeLocationOnlyOffsetRecovery=function(e){e.location={startOffset:NaN,endOffset:NaN}},e.prototype.setInitialNodeLocationOnlyOffsetRegular=function(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}},e.prototype.setInitialNodeLocationFullRecovery=function(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.setInitialNodeLocationFullRegular=function(e){var t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}},e.prototype.cstNestedInvocationStateUpdate=function(e,t){var n={name:e,fullName:this.shortRuleNameToFull[this.getLastExplicitRuleShortName()]+e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstInvocationStateUpdate=function(e,t){this.LAST_EXPLICIT_RULE_STACK.push(this.RULE_STACK.length-1);var n={name:e,children:{}};this.setInitialNodeLocation(n),this.CST_STACK.push(n)},e.prototype.cstFinallyStateUpdate=function(){this.LAST_EXPLICIT_RULE_STACK.pop(),this.CST_STACK.pop()},e.prototype.cstNestedFinallyStateUpdate=function(){var e=this.CST_STACK.pop();this.cstPostRule(e)},e.prototype.cstPostRuleFull=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?(n.endOffset=t.endOffset,n.endLine=t.endLine,n.endColumn=t.endColumn):(n.startOffset=NaN,n.startLine=NaN,n.startColumn=NaN)},e.prototype.cstPostRuleOnlyOffset=function(e){var t=this.LA(0),n=e.location;n.startOffset<=t.startOffset==!0?n.endOffset=t.endOffset:n.startOffset=NaN},e.prototype.cstPostTerminal=function(e,t){var n,r,o,i=this.CST_STACK[this.CST_STACK.length-1];r=t,o=e,void 0===(n=i).children[o]?n.children[o]=[r]:n.children[o].push(r),this.setNodeLocationFromToken(i.location,t)},e.prototype.cstPostNonTerminal=function(e,t){if(!0!==this.isBackTracking()){var n=this.CST_STACK[this.CST_STACK.length-1];_e(n,t,e),this.setNodeLocationFromNode(n.location,e.location)}},e.prototype.getBaseCstVisitorConstructor=function(){if(Object(o.F)(this.baseCstVisitorConstructor)){var e=Ft(this.className,this.allRuleNames);return this.baseCstVisitorConstructor=e,e}return this.baseCstVisitorConstructor},e.prototype.getBaseCstVisitorConstructorWithDefaults=function(){if(Object(o.F)(this.baseCstVisitorWithDefaultsConstructor)){var e=function(e,t,n){var r=function(){};Pt(r,e+"BaseSemanticsWithDefaults");var i=Object.create(n.prototype);return Object(o.u)(t,(function(e){i[e]=Lt})),(r.prototype=i).constructor=r,r}(this.className,this.allRuleNames,this.getBaseCstVisitorConstructor());return this.baseCstVisitorWithDefaultsConstructor=e,e}return this.baseCstVisitorWithDefaultsConstructor},e.prototype.nestedRuleBeforeClause=function(e,t){var n;return void 0!==e.NAME?(n=e.NAME,this.nestedRuleInvocationStateUpdate(n,t),n):void 0},e.prototype.nestedAltBeforeClause=function(e,t,n,r){var o,i=Ce(this.getLastExplicitRuleShortName(),n,t,r);return void 0!==e.NAME?(o=e.NAME,this.nestedRuleInvocationStateUpdate(o,i),{shortName:i,nestedName:o}):void 0},e.prototype.nestedRuleFinallyClause=function(e,t){var n=this.CST_STACK,r=n[n.length-1];this.nestedRuleFinallyStateUpdate();var o=n[n.length-1];_e(o,t,r),this.setNodeLocationFromNode(o.location,r.location)},e.prototype.getLastExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_STACK[e]},e.prototype.getLastExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-1]},e.prototype.getPreviousExplicitRuleShortName=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-2];return this.RULE_STACK[e]},e.prototype.getPreviousExplicitRuleShortNameNoCst=function(){var e=this.RULE_STACK;return e[e.length-2]},e.prototype.getLastExplicitRuleOccurrenceIndex=function(){var e=this.LAST_EXPLICIT_RULE_STACK[this.LAST_EXPLICIT_RULE_STACK.length-1];return this.RULE_OCCURRENCE_STACK[e]},e.prototype.getLastExplicitRuleOccurrenceIndexNoCst=function(){var e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]},e.prototype.nestedRuleInvocationStateUpdate=function(e,t){this.RULE_OCCURRENCE_STACK.push(1),this.RULE_STACK.push(t),this.cstNestedInvocationStateUpdate(e,t)},e.prototype.nestedRuleFinallyStateUpdate=function(){this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstNestedFinallyStateUpdate()},e}(),jt=function(){function e(){}return e.prototype.initLexerAdapter=function(){this.tokVector=[],this.tokVectorLength=0,this.currIdx=-1},Object.defineProperty(e.prototype,"input",{get:function(){return this.tokVector},set:function(e){if(!0!==this.selfAnalysisDone)throw Error("Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.");this.reset(),this.tokVector=e,this.tokVectorLength=e.length},enumerable:!0,configurable:!0}),e.prototype.SKIP_TOKEN=function(){return this.currIdx<=this.tokVector.length-2?(this.consumeToken(),this.LA(1)):nn},e.prototype.LA=function(e){var t=this.currIdx+e;return t<0||this.tokVectorLength<=t?nn:this.tokVector[t]},e.prototype.consumeToken=function(){this.currIdx++},e.prototype.exportLexerState=function(){return this.currIdx},e.prototype.importLexerState=function(e){this.currIdx=e},e.prototype.resetLexerState=function(){this.currIdx=-1},e.prototype.moveToTerminatedState=function(){this.currIdx=this.tokVector.length-1},e.prototype.getLexerPosition=function(){return this.exportLexerState()},e}(),Bt=function(){function e(){}return e.prototype.ACTION=function(e){return e.call(this)},e.prototype.consume=function(e,t,n){return this.consumeInternal(t,e,n)},e.prototype.subrule=function(e,t,n){return this.subruleInternal(t,e,n)},e.prototype.option=function(e,t){return this.optionInternal(t,e)},e.prototype.or=function(e,t){return this.orInternal(t,e)},e.prototype.many=function(e,t){return this.manyInternal(e,t)},e.prototype.atLeastOne=function(e,t){return this.atLeastOneInternal(e,t)},e.prototype.CONSUME=function(e,t){return this.consumeInternal(e,0,t)},e.prototype.CONSUME1=function(e,t){return this.consumeInternal(e,1,t)},e.prototype.CONSUME2=function(e,t){return this.consumeInternal(e,2,t)},e.prototype.CONSUME3=function(e,t){return this.consumeInternal(e,3,t)},e.prototype.CONSUME4=function(e,t){return this.consumeInternal(e,4,t)},e.prototype.CONSUME5=function(e,t){return this.consumeInternal(e,5,t)},e.prototype.CONSUME6=function(e,t){return this.consumeInternal(e,6,t)},e.prototype.CONSUME7=function(e,t){return this.consumeInternal(e,7,t)},e.prototype.CONSUME8=function(e,t){return this.consumeInternal(e,8,t)},e.prototype.CONSUME9=function(e,t){return this.consumeInternal(e,9,t)},e.prototype.SUBRULE=function(e,t){return this.subruleInternal(e,0,t)},e.prototype.SUBRULE1=function(e,t){return this.subruleInternal(e,1,t)},e.prototype.SUBRULE2=function(e,t){return this.subruleInternal(e,2,t)},e.prototype.SUBRULE3=function(e,t){return this.subruleInternal(e,3,t)},e.prototype.SUBRULE4=function(e,t){return this.subruleInternal(e,4,t)},e.prototype.SUBRULE5=function(e,t){return this.subruleInternal(e,5,t)},e.prototype.SUBRULE6=function(e,t){return this.subruleInternal(e,6,t)},e.prototype.SUBRULE7=function(e,t){return this.subruleInternal(e,7,t)},e.prototype.SUBRULE8=function(e,t){return this.subruleInternal(e,8,t)},e.prototype.SUBRULE9=function(e,t){return this.subruleInternal(e,9,t)},e.prototype.OPTION=function(e){return this.optionInternal(e,0)},e.prototype.OPTION1=function(e){return this.optionInternal(e,1)},e.prototype.OPTION2=function(e){return this.optionInternal(e,2)},e.prototype.OPTION3=function(e){return this.optionInternal(e,3)},e.prototype.OPTION4=function(e){return this.optionInternal(e,4)},e.prototype.OPTION5=function(e){return this.optionInternal(e,5)},e.prototype.OPTION6=function(e){return this.optionInternal(e,6)},e.prototype.OPTION7=function(e){return this.optionInternal(e,7)},e.prototype.OPTION8=function(e){return this.optionInternal(e,8)},e.prototype.OPTION9=function(e){return this.optionInternal(e,9)},e.prototype.OR=function(e){return this.orInternal(e,0)},e.prototype.OR1=function(e){return this.orInternal(e,1)},e.prototype.OR2=function(e){return this.orInternal(e,2)},e.prototype.OR3=function(e){return this.orInternal(e,3)},e.prototype.OR4=function(e){return this.orInternal(e,4)},e.prototype.OR5=function(e){return this.orInternal(e,5)},e.prototype.OR6=function(e){return this.orInternal(e,6)},e.prototype.OR7=function(e){return this.orInternal(e,7)},e.prototype.OR8=function(e){return this.orInternal(e,8)},e.prototype.OR9=function(e){return this.orInternal(e,9)},e.prototype.MANY=function(e){this.manyInternal(0,e)},e.prototype.MANY1=function(e){this.manyInternal(1,e)},e.prototype.MANY2=function(e){this.manyInternal(2,e)},e.prototype.MANY3=function(e){this.manyInternal(3,e)},e.prototype.MANY4=function(e){this.manyInternal(4,e)},e.prototype.MANY5=function(e){this.manyInternal(5,e)},e.prototype.MANY6=function(e){this.manyInternal(6,e)},e.prototype.MANY7=function(e){this.manyInternal(7,e)},e.prototype.MANY8=function(e){this.manyInternal(8,e)},e.prototype.MANY9=function(e){this.manyInternal(9,e)},e.prototype.MANY_SEP=function(e){this.manySepFirstInternal(0,e)},e.prototype.MANY_SEP1=function(e){this.manySepFirstInternal(1,e)},e.prototype.MANY_SEP2=function(e){this.manySepFirstInternal(2,e)},e.prototype.MANY_SEP3=function(e){this.manySepFirstInternal(3,e)},e.prototype.MANY_SEP4=function(e){this.manySepFirstInternal(4,e)},e.prototype.MANY_SEP5=function(e){this.manySepFirstInternal(5,e)},e.prototype.MANY_SEP6=function(e){this.manySepFirstInternal(6,e)},e.prototype.MANY_SEP7=function(e){this.manySepFirstInternal(7,e)},e.prototype.MANY_SEP8=function(e){this.manySepFirstInternal(8,e)},e.prototype.MANY_SEP9=function(e){this.manySepFirstInternal(9,e)},e.prototype.AT_LEAST_ONE=function(e){this.atLeastOneInternal(0,e)},e.prototype.AT_LEAST_ONE1=function(e){return this.atLeastOneInternal(1,e)},e.prototype.AT_LEAST_ONE2=function(e){this.atLeastOneInternal(2,e)},e.prototype.AT_LEAST_ONE3=function(e){this.atLeastOneInternal(3,e)},e.prototype.AT_LEAST_ONE4=function(e){this.atLeastOneInternal(4,e)},e.prototype.AT_LEAST_ONE5=function(e){this.atLeastOneInternal(5,e)},e.prototype.AT_LEAST_ONE6=function(e){this.atLeastOneInternal(6,e)},e.prototype.AT_LEAST_ONE7=function(e){this.atLeastOneInternal(7,e)},e.prototype.AT_LEAST_ONE8=function(e){this.atLeastOneInternal(8,e)},e.prototype.AT_LEAST_ONE9=function(e){this.atLeastOneInternal(9,e)},e.prototype.AT_LEAST_ONE_SEP=function(e){this.atLeastOneSepFirstInternal(0,e)},e.prototype.AT_LEAST_ONE_SEP1=function(e){this.atLeastOneSepFirstInternal(1,e)},e.prototype.AT_LEAST_ONE_SEP2=function(e){this.atLeastOneSepFirstInternal(2,e)},e.prototype.AT_LEAST_ONE_SEP3=function(e){this.atLeastOneSepFirstInternal(3,e)},e.prototype.AT_LEAST_ONE_SEP4=function(e){this.atLeastOneSepFirstInternal(4,e)},e.prototype.AT_LEAST_ONE_SEP5=function(e){this.atLeastOneSepFirstInternal(5,e)},e.prototype.AT_LEAST_ONE_SEP6=function(e){this.atLeastOneSepFirstInternal(6,e)},e.prototype.AT_LEAST_ONE_SEP7=function(e){this.atLeastOneSepFirstInternal(7,e)},e.prototype.AT_LEAST_ONE_SEP8=function(e){this.atLeastOneSepFirstInternal(8,e)},e.prototype.AT_LEAST_ONE_SEP9=function(e){this.atLeastOneSepFirstInternal(9,e)},e.prototype.RULE=function(e,t,n){if(void 0===n&&(n=an),Object(o.j)(this.definedRulesNames,e)){var r={message:dt.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className}),type:rn.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(r)}this.definedRulesNames.push(e);var i=this.defineRule(e,t,n);return this[e]=i,i},e.prototype.OVERRIDE_RULE=function(e,t,n){void 0===n&&(n=an);var r,i,a,s,u,c=[];c=c.concat((r=e,i=this.definedRulesNames,a=this.className,u=[],o.j(i,r)||(s="Invalid rule override, rule: ->"+r+"<- cannot be overridden in the grammar: ->"+a+"<-as it is not defined in any of the super grammars ",u.push({message:s,type:rn.INVALID_RULE_OVERRIDE,ruleName:r})),u)),this.definitionErrors.push.apply(this.definitionErrors,c);var l=this.defineRule(e,t,n);return this[e]=l,l},e.prototype.BACKTRACK=function(e,t){return function(){this.isBackTrackingStack.push(1);var n=this.saveRecogState();try{return e.apply(this,t),!0}catch(e){if(wt(e))return!1;throw e}finally{this.reloadRecogState(n),this.isBackTrackingStack.pop()}}},e.prototype.getGAstProductions=function(){return this.gastProductionsCache},e.prototype.getSerializedGastProductions=function(){return de(Object(o.U)(this.gastProductionsCache))},e}(),Vt=function(){function e(){}return e.prototype.initRecognizerEngine=function(e,t){if(this.className=_t(this.constructor),this.shortRuleNameToFull={},this.fullRuleNameToShort={},this.ruleShortNameIdx=256,this.tokenMatcher=U,this.definedRulesNames=[],this.tokensMap={},this.allRuleNames=[],this.isBackTrackingStack=[],this.RULE_STACK=[],this.RULE_OCCURRENCE_STACK=[],this.gastProductionsCache={},Object(o.w)(t,"serializedGrammar"))throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_6-0-0\n\tFor Further details.");if(Object(o.y)(e)){if(Object(o.A)(e))throw Error("A Token Vocabulary cannot be empty.\n\tNote that the first argument for the parser constructor\n\tis no longer a Token vector (since v4.0).");if("number"==typeof e[0].startOffset)throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n\tSee: https://sap.github.io/chevrotain/docs/changes/BREAKING_CHANGES.html#_4-0-0\n\tFor Further details.")}if(Object(o.y)(e))this.tokensMap=Object(o.O)(e,(function(e,t){return e[t.name]=t,e}),{});else if(Object(o.w)(e,"modes")&&Object(o.o)(Object(o.t)(Object(o.U)(e.modes)),z)){var n=Object(o.t)(Object(o.U)(e.modes)),r=Object(o.T)(n);this.tokensMap=Object(o.O)(r,(function(e,t){return e[t.name]=t,e}),{})}else{if(!Object(o.C)(e))throw new Error("<tokensDictionary> argument must be An Array of Token constructors, A dictionary of Token constructors or an IMultiModeLexerDefinition");this.tokensMap=Object(o.h)(e)}this.tokensMap.EOF=Z;var i=Object(o.o)(Object(o.U)(e),(function(e){return Object(o.A)(e.categoryMatches)}));this.tokenMatcher=i?U:D,V(Object(o.U)(this.tokensMap))},e.prototype.defineRule=function(e,t,n){if(this.selfAnalysisDone)throw Error("Grammar rule <"+e+"> may not be defined after the 'performSelfAnalysis' method has been called'\nMake sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.");var r,i=Object(o.w)(n,"resyncEnabled")?n.resyncEnabled:an.resyncEnabled,a=Object(o.w)(n,"recoveryValueFunc")?n.recoveryValueFunc:an.recoveryValueFunc,s=this.ruleShortNameIdx<<12;function u(e){try{if(!0===this.outputCst){t.apply(this,e);var n=this.CST_STACK[this.CST_STACK.length-1];return this.cstPostRule(n),n}return t.apply(this,e)}catch(e){return this.invokeRuleCatch(e,i,a)}finally{this.ruleFinallyStateUpdate()}}this.ruleShortNameIdx++,this.shortRuleNameToFull[s]=e,this.fullRuleNameToShort[e]=s;return(r=function(t,n){return void 0===t&&(t=0),this.ruleInvocationStateUpdate(s,e,t),u.call(this,n)}).ruleName=e,r.originalGrammarAction=t,r},e.prototype.invokeRuleCatch=function(e,t,n){var r=1===this.RULE_STACK.length,o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(wt(e)){var i=e;if(o){var a,s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s))return i.resyncedTokens=this.reSyncTo(s),this.outputCst?((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,a):n();throw this.outputCst&&((a=this.CST_STACK[this.CST_STACK.length-1]).recoveredNode=!0,i.partialCstResult=a),i}if(r)return this.moveToTerminatedState(),n();throw i}throw e},e.prototype.optionInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(512,t),r=this.nestedRuleBeforeClause(e,n);try{return this.optionInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.optionInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(512,t);return this.optionInternalLogic(e,t,n)},e.prototype.optionInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==e.DEF){if(r=e.DEF,void 0!==(o=e.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=e;if(!0===a.call(this))return r.call(this)},e.prototype.atLeastOneInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(1024,e),r=this.nestedRuleBeforeClause(t,n);try{return this.atLeastOneInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(1024,e);this.atLeastOneInternalLogic(e,t,n)},e.prototype.atLeastOneInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(o=t.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=t;if(!0!==a.call(this))throw this.raiseEarlyExitException(e,We.REPETITION_MANDATORY,t.ERR_MSG);for(var u=this.doSingleRepetition(r);!0===a.call(this)&&!0===u;)u=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],a,1024,e,Be)},e.prototype.atLeastOneSepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(1536,e),r=this.nestedRuleBeforeClause(t,n);try{this.atLeastOneSepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.atLeastOneSepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(1536,e);this.atLeastOneSepFirstInternalLogic(e,t,n)},e.prototype.atLeastOneSepFirstInternalLogic=function(e,t,n){var r=this,o=t.DEF,i=t.SEP;if(!0!==this.getLaFuncFromCache(n).call(this))throw this.raiseEarlyExitException(e,We.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG);o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,a,o,Ve],a,1536,e,Ve)},e.prototype.manyInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(768,e),r=this.nestedRuleBeforeClause(t,n);try{return this.manyInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manyInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(768,e);return this.manyInternalLogic(e,t,n)},e.prototype.manyInternalLogic=function(e,t,n){var r,o,i=this,a=this.getLaFuncFromCache(n);if(void 0!==t.DEF){if(r=t.DEF,void 0!==(o=t.GATE)){var s=a;a=function(){return o.call(i)&&s.call(i)}}}else r=t;for(var u=!0;!0===a.call(this)&&!0===u;)u=this.doSingleRepetition(r);this.attemptInRepetitionRecovery(this.manyInternal,[e,t],a,768,e,Ue,u)},e.prototype.manySepFirstInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(1280,e),r=this.nestedRuleBeforeClause(t,n);try{this.manySepFirstInternalLogic(e,t,n)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.manySepFirstInternalNoCst=function(e,t){var n=this.getKeyForAutomaticLookahead(1280,e);this.manySepFirstInternalLogic(e,t,n)},e.prototype.manySepFirstInternalLogic=function(e,t,n){var r=this,o=t.DEF,i=t.SEP;if(!0===this.getLaFuncFromCache(n).call(this)){o.call(this);for(var a=function(){return r.tokenMatcher(r.LA(1),i)};!0===this.tokenMatcher(this.LA(1),i);)this.CONSUME(i),o.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,i,a,o,je],a,1280,e,je)}},e.prototype.repetitionSepSecondInternal=function(e,t,n,r,o){for(;n();)this.CONSUME(t),r.call(this);this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,o],n,1536,e,o)},e.prototype.doSingleRepetition=function(e){var t=this.getLexerPosition();return e.call(this),this.getLexerPosition()>t},e.prototype.orInternalNoCst=function(e,t){var n=Object(o.y)(e)?e:e.DEF,r=this.getKeyForAutomaticLookahead(256,t),i=this.getLaFuncFromCache(r).call(this,n);if(void 0!==i)return n[i].ALT.call(this);this.raiseNoAltException(t,e.ERR_MSG)},e.prototype.orInternal=function(e,t){var n=this.getKeyForAutomaticLookahead(256,t),r=this.nestedRuleBeforeClause(e,n);try{var i=Object(o.y)(e)?e:e.DEF,a=this.getLaFuncFromCache(n).call(this,i);if(void 0!==a){var s=i[a],u=this.nestedAltBeforeClause(s,t,256,a);try{return s.ALT.call(this)}finally{void 0!==u&&this.nestedRuleFinallyClause(u.shortName,u.nestedName)}}this.raiseNoAltException(t,e.ERR_MSG)}finally{void 0!==r&&this.nestedRuleFinallyClause(n,r)}},e.prototype.ruleFinallyStateUpdate=function(){if(this.RULE_STACK.pop(),this.RULE_OCCURRENCE_STACK.pop(),this.cstFinallyStateUpdate(),0===this.RULE_STACK.length&&!1===this.isAtEndOfInput()){var e=this.LA(1),t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new Ot(t,e))}},e.prototype.subruleInternal=function(e,t,n){var r;try{var o=void 0!==n?n.ARGS:void 0;return r=e.call(this,t,o),this.cstPostNonTerminal(r,void 0!==n&&void 0!==n.LABEL?n.LABEL:e.ruleName),r}catch(t){this.subruleInternalError(t,n,e.ruleName)}},e.prototype.subruleInternalError=function(e,t,n){throw wt(e)&&void 0!==e.partialCstResult&&(this.cstPostNonTerminal(e.partialCstResult,void 0!==t&&void 0!==t.LABEL?t.LABEL:n),delete e.partialCstResult),e},e.prototype.consumeInternal=function(e,t,n){var r;try{var o=this.LA(1);!0===this.tokenMatcher(o,e)?(this.consumeToken(),r=o):this.consumeInternalError(e,o,n)}catch(n){r=this.consumeInternalRecovery(e,t,n)}return this.cstPostTerminal(void 0!==n&&void 0!==n.LABEL?n.LABEL:e.name,r),r},e.prototype.consumeInternalError=function(e,t,n){var r,o=this.LA(0);throw r=void 0!==n&&n.ERR_MSG?n.ERR_MSG:this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()}),this.SAVE_ERROR(new St(r,t,o))},e.prototype.consumeInternalRecovery=function(e,t,n){if(!this.recoveryEnabled||"MismatchedTokenException"!==n.name||this.isBackTracking())throw n;var r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(e){throw"InRuleRecoveryException"===e.name?n:e}},e.prototype.saveRecogState=function(){var e=this.errors,t=Object(o.g)(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK,LAST_EXPLICIT_RULE_STACK:this.LAST_EXPLICIT_RULE_STACK}},e.prototype.reloadRecogState=function(e){this.errors=e.errors,this.importLexerState(e.lexerState),this.RULE_STACK=e.RULE_STACK},e.prototype.ruleInvocationStateUpdate=function(e,t,n){this.RULE_OCCURRENCE_STACK.push(n),this.RULE_STACK.push(e),this.cstInvocationStateUpdate(t,e)},e.prototype.isBackTracking=function(){return 0!==this.isBackTrackingStack.length},e.prototype.getCurrRuleFullName=function(){var e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]},e.prototype.shortRuleNameToFullName=function(e){return this.shortRuleNameToFull[e]},e.prototype.isAtEndOfInput=function(){return this.tokenMatcher(this.LA(1),Z)},e.prototype.reset=function(){this.resetLexerState(),this.isBackTrackingStack=[],this.errors=[],this.RULE_STACK=[],this.LAST_EXPLICIT_RULE_STACK=[],this.CST_STACK=[],this.RULE_OCCURRENCE_STACK=[]},e}(),Ht=function(){function e(){}return e.prototype.initErrorHandler=function(e){this._errors=[],this.errorMessageProvider=Object(o.k)(e.errorMessageProvider,on.errorMessageProvider)},e.prototype.SAVE_ERROR=function(e){if(wt(e))return e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Object(o.g)(this.RULE_OCCURRENCE_STACK)},this._errors.push(e),e;throw Error("Trying to save an Error which is not a RecognitionException")},Object.defineProperty(e.prototype,"errors",{get:function(){return Object(o.g)(this._errors)},set:function(e){this._errors=e},enumerable:!0,configurable:!0}),e.prototype.raiseEarlyExitException=function(e,t,n){for(var r=this.getCurrRuleFullName(),o=et(e,this.getGAstProductions()[r],t,this.maxLookahead)[0],i=[],a=1;a<=this.maxLookahead;a++)i.push(this.LA(a));var s=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:o,actual:i,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new Rt(s,this.LA(1),this.LA(0)))},e.prototype.raiseNoAltException=function(e,t){for(var n=this.getCurrRuleFullName(),r=Ze(e,this.getGAstProductions()[n],this.maxLookahead),o=[],i=1;i<=this.maxLookahead;i++)o.push(this.LA(i));var a=this.LA(0),s=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:r,actual:o,previous:a,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new Tt(s,this.LA(1),a))},e}(),Gt=function(){function e(){}return e.prototype.initContentAssist=function(){},e.prototype.computeContentAssist=function(e,t){var n=this.gastProductionsCache[e];if(Object(o.F)(n))throw Error("Rule ->"+e+"<- does not exist in this grammar.");return Ge([n],t,this.tokenMatcher,this.maxLookahead)},e.prototype.getNextPossibleTokenTypes=function(e){var t=Object(o.s)(e.ruleStack),n=this.getGAstProductions()[t];return new Fe(n,e).startWalking()},e}(),zt={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(zt);var Wt=Math.pow(2,8)-1,$t=Q({name:"RECORDING_PHASE_TOKEN",pattern:K.NA});V([$t]);var Yt=ee($t,"This IToken indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(Yt);var Kt={name:"This CSTNode indicates the Parser is in Recording Phase\n\tSee: https://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording for details",children:{}},qt=function(){function e(){}return e.prototype.initGastRecorder=function(e){this.recordingProdStack=[],this.RECORDING_PHASE=!1},e.prototype.enableRecording=function(){var e=this;this.RECORDING_PHASE=!0,this.TRACE_INIT("Enable Recording",(function(){for(var t=function(t){var n=t>0?t:"";e["CONSUME"+n]=function(e,n){return this.consumeInternalRecord(e,t,n)},e["SUBRULE"+n]=function(e,n){return this.subruleInternalRecord(e,t,n)},e["OPTION"+n]=function(e){return this.optionInternalRecord(e,t)},e["OR"+n]=function(e){return this.orInternalRecord(e,t)},e["MANY"+n]=function(e){this.manyInternalRecord(t,e)},e["MANY_SEP"+n]=function(e){this.manySepFirstInternalRecord(t,e)},e["AT_LEAST_ONE"+n]=function(e){this.atLeastOneInternalRecord(t,e)},e["AT_LEAST_ONE_SEP"+n]=function(e){this.atLeastOneSepFirstInternalRecord(t,e)}},n=0;n<10;n++)t(n);e.consume=function(e,t,n){return this.consumeInternalRecord(t,e,n)},e.subrule=function(e,t,n){return this.subruleInternalRecord(t,e,n)},e.option=function(e,t){return this.optionInternalRecord(t,e)},e.or=function(e,t){return this.orInternalRecord(t,e)},e.many=function(e,t){this.manyInternalRecord(e,t)},e.atLeastOne=function(e,t){this.atLeastOneInternalRecord(e,t)},e.ACTION=e.ACTION_RECORD,e.BACKTRACK=e.BACKTRACK_RECORD,e.LA=e.LA_RECORD}))},e.prototype.disableRecording=function(){var e=this;this.RECORDING_PHASE=!1,this.TRACE_INIT("Deleting Recording methods",(function(){for(var t=0;t<10;t++){var n=t>0?t:"";delete e["CONSUME"+n],delete e["SUBRULE"+n],delete e["OPTION"+n],delete e["OR"+n],delete e["MANY"+n],delete e["MANY_SEP"+n],delete e["AT_LEAST_ONE"+n],delete e["AT_LEAST_ONE_SEP"+n]}delete e.consume,delete e.subrule,delete e.option,delete e.or,delete e.many,delete e.atLeastOne,delete e.ACTION,delete e.BACKTRACK,delete e.LA}))},e.prototype.ACTION_RECORD=function(e){},e.prototype.BACKTRACK_RECORD=function(e,t){return function(){return!0}},e.prototype.LA_RECORD=function(e){return nn},e.prototype.topLevelRuleRecord=function(e,t){try{var n=new ie({definition:[],name:e});return n.name=e,this.recordingProdStack.push(n),t.call(this),this.recordingProdStack.pop(),n}catch(e){if(!0!==e.KNOWN_RECORDER_ERROR)try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\thttps://sap.github.io/chevrotain/docs/guide/internals.html#grammar-recording'}catch(t){throw e}throw e}},e.prototype.optionInternalRecord=function(e,t){return Xt.call(this,se,e,t)},e.prototype.atLeastOneInternalRecord=function(e,t){Xt.call(this,ue,t,e)},e.prototype.atLeastOneSepFirstInternalRecord=function(e,t){Xt.call(this,ce,t,e,!0)},e.prototype.manyInternalRecord=function(e,t){Xt.call(this,le,t,e)},e.prototype.manySepFirstInternalRecord=function(e,t){Xt.call(this,fe,t,e,!0)},e.prototype.orInternalRecord=function(e,t){return Jt.call(this,e,t)},e.prototype.subruleInternalRecord=function(e,t,n){if(Zt(t),!e||!1===Object(o.w)(e,"ruleName")){var r=new Error("<SUBRULE"+Qt(t)+"> argument is invalid expecting a Parser method reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=Object(o.M)(this.recordingProdStack),a=e.ruleName,s=new oe({idx:t,nonTerminalName:a,referencedRule:void 0});return i.definition.push(s),this.outputCst?Kt:zt},e.prototype.consumeInternalRecord=function(e,t,n){if(Zt(t),!H(e)){var r=new Error("<CONSUME"+Qt(t)+"> argument is invalid expecting a TokenType reference but got: <"+JSON.stringify(e)+">\n inside top level rule: <"+this.recordingProdStack[0].name+">");throw r.KNOWN_RECORDER_ERROR=!0,r}var i=Object(o.M)(this.recordingProdStack),a=new pe({idx:t,terminalType:e});return i.definition.push(a),Yt},e}();function Xt(e,t,n,r){void 0===r&&(r=!1),Zt(n);var i=Object(o.M)(this.recordingProdStack),a=Object(o.B)(t)?t:t.DEF,s=new e({definition:[],idx:n});return Object(o.w)(t,"NAME")&&(s.name=t.NAME),r&&(s.separator=t.SEP),Object(o.w)(t,"MAX_LOOKAHEAD")&&(s.maxLookahead=t.MAX_LOOKAHEAD),this.recordingProdStack.push(s),a.call(this),i.definition.push(s),this.recordingProdStack.pop(),zt}function Jt(e,t){var n=this;Zt(t);var r=Object(o.M)(this.recordingProdStack),i=!1===Object(o.y)(e),a=!1===i?e:e.DEF,s=new he({definition:[],idx:t,ignoreAmbiguities:i&&!0===e.IGNORE_AMBIGUITIES});Object(o.w)(e,"NAME")&&(s.name=e.NAME),Object(o.w)(e,"MAX_LOOKAHEAD")&&(s.maxLookahead=e.MAX_LOOKAHEAD);var u=Object(o.Q)(a,(function(e){return Object(o.B)(e.GATE)}));return s.hasPredicates=u,r.definition.push(s),Object(o.u)(a,(function(e){var t=new ae({definition:[]});s.definition.push(t),Object(o.w)(e,"NAME")&&(t.name=e.NAME),Object(o.w)(e,"IGNORE_AMBIGUITIES")?t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES:Object(o.w)(e,"GATE")&&(t.ignoreAmbiguities=!0),n.recordingProdStack.push(t),e.ALT.call(n),n.recordingProdStack.pop()})),zt}function Qt(e){return 0===e?"":""+e}function Zt(e){if(e<0||e>Wt){var t=new Error("Invalid DSL Method idx value: <"+e+">\n\tIdx value must be a none negative value smaller than "+(Wt+1));throw t.KNOWN_RECORDER_ERROR=!0,t}}var en=function(){function e(){}return e.prototype.initPerformanceTracer=function(e){if(Object(o.w)(e,"traceInitPerf")){var t=e.traceInitPerf,n="number"==typeof t;this.traceInitMaxIdent=n?t:1/0,this.traceInitPerf=n?t>0:t}else this.traceInitMaxIdent=0,this.traceInitPerf=on.traceInitPerf;this.traceInitIndent=-1},e.prototype.TRACE_INIT=function(e,t){if(!0===this.traceInitPerf){this.traceInitIndent++;var n=new Array(this.traceInitIndent+1).join("\t");this.traceInitIndent<this.traceInitMaxIdent&&console.log(n+"--\x3e <"+e+">");var r=Object(o.R)(t),i=r.time,a=r.value,s=i>10?console.warn:console.log;return this.traceInitIndent<this.traceInitMaxIdent&&s(n+"<-- <"+e+"> time: "+i+"ms"),this.traceInitIndent--,a}return t()},e}(),tn=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nn=ee(Z,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(nn);var rn,on=Object.freeze({recoveryEnabled:!1,maxLookahead:4,ignoredIssues:{},dynamicTokensEnabled:!1,outputCst:!0,errorMessageProvider:ht,nodeLocationTracking:"none",traceInitPerf:!1,skipValidations:!1}),an=Object.freeze({recoveryValueFunc:function(){},resyncEnabled:!0});function sn(e){return void 0===e&&(e=void 0),function(){return e}}!function(e){e[e.INVALID_RULE_NAME=0]="INVALID_RULE_NAME",e[e.DUPLICATE_RULE_NAME=1]="DUPLICATE_RULE_NAME",e[e.INVALID_RULE_OVERRIDE=2]="INVALID_RULE_OVERRIDE",e[e.DUPLICATE_PRODUCTIONS=3]="DUPLICATE_PRODUCTIONS",e[e.UNRESOLVED_SUBRULE_REF=4]="UNRESOLVED_SUBRULE_REF",e[e.LEFT_RECURSION=5]="LEFT_RECURSION",e[e.NONE_LAST_EMPTY_ALT=6]="NONE_LAST_EMPTY_ALT",e[e.AMBIGUOUS_ALTS=7]="AMBIGUOUS_ALTS",e[e.CONFLICT_TOKENS_RULES_NAMESPACE=8]="CONFLICT_TOKENS_RULES_NAMESPACE",e[e.INVALID_TOKEN_NAME=9]="INVALID_TOKEN_NAME",e[e.INVALID_NESTED_RULE_NAME=10]="INVALID_NESTED_RULE_NAME",e[e.DUPLICATE_NESTED_NAME=11]="DUPLICATE_NESTED_NAME",e[e.NO_NON_EMPTY_LOOKAHEAD=12]="NO_NON_EMPTY_LOOKAHEAD",e[e.AMBIGUOUS_PREFIX_ALTS=13]="AMBIGUOUS_PREFIX_ALTS",e[e.TOO_MANY_ALTS=14]="TOO_MANY_ALTS"}(rn||(rn={}));var un=function(){function e(e,t){void 0===t&&(t=on),this.ignoredIssues=on.ignoredIssues,this.definitionErrors=[],this.selfAnalysisDone=!1;this.initErrorHandler(t),this.initLexerAdapter(),this.initLooksAhead(t),this.initRecognizerEngine(e,t),this.initRecoverable(t),this.initTreeBuilder(t),this.initContentAssist(),this.initGastRecorder(t),this.initPerformanceTracer(t),Object(o.w)(t,"ignoredIssues")&&t.ignoredIssues!==on.ignoredIssues&&Object(o.d)("The <ignoredIssues> IParserConfig property is soft-deprecated and will be removed in future versions.\n\tPlease use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead."),this.ignoredIssues=Object(o.w)(t,"ignoredIssues")?t.ignoredIssues:on.ignoredIssues,this.skipValidations=Object(o.w)(t,"skipValidations")?t.skipValidations:on.skipValidations}return e.performSelfAnalysis=function(e){e.performSelfAnalysis()},e.prototype.performSelfAnalysis=function(){var t=this;this.TRACE_INIT("performSelfAnalysis",(function(){var n;t.selfAnalysisDone=!0;var r=t.className;t.TRACE_INIT("toFastProps",(function(){Object(o.S)(t)})),t.TRACE_INIT("Grammar Recording",(function(){try{t.enableRecording(),Object(o.u)(t.definedRulesNames,(function(e){var n=t[e].originalGrammarAction,r=void 0;t.TRACE_INIT(e+" Rule",(function(){r=t.topLevelRuleRecord(e,n)})),t.gastProductionsCache[e]=r}))}finally{t.disableRecording()}}));var i=[];if(t.TRACE_INIT("Grammar Resolving",(function(){i=yt({rules:Object(o.U)(t.gastProductionsCache)}),t.definitionErrors.push.apply(t.definitionErrors,i)})),t.TRACE_INIT("Grammar Validations",(function(){if(Object(o.A)(i)&&!1===t.skipValidations){var e=gt({rules:Object(o.U)(t.gastProductionsCache),maxLookahead:t.maxLookahead,tokenTypes:Object(o.U)(t.tokensMap),ignoredIssues:t.ignoredIssues,errMsgProvider:dt,grammarName:r});t.definitionErrors.push.apply(t.definitionErrors,e)}})),Object(o.A)(t.definitionErrors)&&(t.recoveryEnabled&&t.TRACE_INIT("computeAllProdsFollows",(function(){var e,n,r=(e=Object(o.U)(t.gastProductionsCache),n={},Object(o.u)(e,(function(e){var t=new ke(e).startWalking();Object(o.f)(n,t)})),n);t.resyncFollows=r})),t.TRACE_INIT("ComputeLookaheadFunctions",(function(){t.preComputeLookaheadFunctions(Object(o.U)(t.gastProductionsCache))}))),t.TRACE_INIT("expandAllNestedRuleNames",(function(){var e,n,r,i=(e=Object(o.U)(t.gastProductionsCache),n=t.fullRuleNameToShort,r={allRuleNames:[]},Object(o.u)(e,(function(e){var t=n[e.name];r.allRuleNames.push(e.name);var i=new Pe(t);e.accept(i),Object(o.u)(i.result,(function(t){t.def,t.key;var n=t.name;r.allRuleNames.push(e.name+n)}))})),r);t.allRuleNames=i.allRuleNames})),!e.DEFER_DEFINITION_ERRORS_HANDLING&&!Object(o.A)(t.definitionErrors))throw n=Object(o.I)(t.definitionErrors,(function(e){return e.message})),new Error("Parser Definition Errors detected:\n "+n.join("\n-------------------------------\n"))}))},e.DEFER_DEFINITION_ERRORS_HANDLING=!1,e}();Object(o.e)(un,[At,Mt,Ut,jt,Vt,Bt,Ht,Gt,qt,en]);var cn=function(e){function t(t,n){void 0===n&&(n=on);var r=Object(o.h)(n);return r.outputCst=!0,e.call(this,t,r)||this}return tn(t,e),t}(un),ln=function(e){function t(t,n){void 0===n&&(n=on);var r=Object(o.h)(n);return r.outputCst=!1,e.call(this,t,r)||this}return tn(t,e),t}(un);function fn(e,t){var n=void 0===t?{}:t,o=n.resourceBase,i=void 0===o?"https://unpkg.com/chevrotain@"+r+"/diagrams/":o,a=n.css;return'\n\x3c!-- This is a generated file --\x3e\n<!DOCTYPE html>\n<meta charset="utf-8">\n<style>\n  body {\n    background-color: hsl(30, 20%, 95%)\n  }\n</style>\n\n'+("\n<link rel='stylesheet' href='"+(void 0===a?"https://unpkg.com/chevrotain@"+r+"/diagrams/diagrams.css":a)+"'>\n")+("\n<script src='"+i+"vendor/railroad-diagrams.js'><\/script>\n<script src='"+i+"src/diagrams_builder.js'><\/script>\n<script src='"+i+"src/diagrams_behavior.js'><\/script>\n<script src='"+i+"src/main.js'><\/script>\n")+'\n<div id="diagrams" align="center"></div>    \n'+("\n<script>\n    window.serializedGrammar = "+JSON.stringify(e,null,"  ")+";\n<\/script>\n")+'\n<script>\n    var diagramsDiv = document.getElementById("diagrams");\n    main.drawDiagramsFromSerializedGrammar(serializedGrammar, diagramsDiv);\n<\/script>\n'}var hn="\n";function pn(e){var t;return"\nfunction "+e.name+"(tokenVocabulary, config) {\n    // invoke super constructor\n    // No support for embedded actions currently, so we can 'hardcode'\n    // The use of CstParser.\n    chevrotain.CstParser.call(this, tokenVocabulary, config)\n\n    const $ = this\n\n    "+(t=e.rules,Object(o.I)(t,(function(e){return r=bn(n=1,'$.RULE("'+(t=e).name+'", function() {')+hn,r+=gn(t.definition,n+1),r+=bn(n+1,"})")+hn;var t,n,r})).join("\n")+"\n\n    // very important to call this after all the rules have been defined.\n    // otherwise the parser may not work correctly as it will lack information\n    // derived during the self analysis phase.\n    this.performSelfAnalysis(this)\n}\n\n// inheritance as implemented in javascript in the previous decade... :(\n")+e.name+".prototype = Object.create(chevrotain.CstParser.prototype)\n"+e.name+".prototype.constructor = "+e.name+"    \n    "}function dn(e,t){var n=bn(t,"$.OR"+e.idx+"([")+hn,r=Object(o.I)(e.definition,(function(e){return function(e,t){var n=bn(t,"{")+hn;e.name&&(n+=bn(t+1,'NAME: "'+e.name+'",')+hn);return n+=bn(t+1,"ALT: function() {")+hn,n+=gn(e.definition,t+1),n+=bn(t+1,"}")+hn,n+=bn(t,"}")}(e,t+1)}));return n+=r.join(",\n"),n+=hn+bn(t,"])\n")}function mn(e,t){if(e instanceof oe)return function(e,t){return bn(t,"$.SUBRULE"+e.idx+"($."+e.nonTerminalName+")"+hn)}(e,t);if(e instanceof se)return vn("OPTION",e,t);if(e instanceof ue)return vn("AT_LEAST_ONE",e,t);if(e instanceof ce)return vn("AT_LEAST_ONE_SEP",e,t);if(e instanceof fe)return vn("MANY_SEP",e,t);if(e instanceof le)return vn("MANY",e,t);if(e instanceof he)return dn(e,t);if(e instanceof pe)return function(e,t){var n=e.terminalType.name;return bn(t,"$.CONSUME"+e.idx+"(this.tokensMap."+n+")"+hn)}(e,t);if(e instanceof ae)return gn(e.definition,t);throw Error("non exhaustive match")}function vn(e,t,n){var r=bn(n,"$."+(e+t.idx)+"(");return t.name||t.separator?(r+="{\n",t.name&&(r+=bn(n+1,'NAME: "'+t.name+'"')+","+hn),t.separator&&(r+=bn(n+1,"SEP: this.tokensMap."+t.separator.name)+","+hn),r+="DEF: "+yn(t.definition,n+2)+hn,r+=bn(n,"}")+hn):r+=yn(t.definition,n+1),r+=bn(n,")")+hn}function yn(e,t){var n="function() {\n";return n+=gn(e,t),n+=bn(t,"}")+hn}function gn(e,t){var n="";return Object(o.u)(e,(function(e){n+=mn(e,t+1)})),n}function bn(e,t){return Array(4*e+1).join(" ")+t}function En(e){var t=function(e){return"    \n"+pn(e)+"\nreturn new "+e.name+"(tokenVocabulary, config)    \n"}({name:e.name,rules:e.rules}),r=new Function("tokenVocabulary","config","chevrotain",t);return function(t){return r(e.tokenVocabulary,t,n("+oOE"))}}function wn(e){return function(e){return"\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        // AMD. Register as an anonymous module.\n        define(['chevrotain'], factory);\n    } else if (typeof module === 'object' && module.exports) {\n        // Node. Does not work with strict CommonJS, but\n        // only CommonJS-like environments that support module.exports,\n        // like Node.\n        module.exports = factory(require('chevrotain'));\n    } else {\n        // Browser globals (root is window)\n        root.returnExports = factory(root.b);\n    }\n}(typeof self !== 'undefined' ? self : this, function (chevrotain) {\n\n"+pn(e)+"\n    \nreturn {\n    "+e.name+": "+e.name+" \n}\n}));\n"}({name:e.name,rules:e.rules})}function Sn(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API.\n\t It performs no action other than printing this message.\n\t Please avoid using it as it will be completely removed in the future")}},"/5zm":function(e,t,n){var r=n("I+eb"),o=n("jrUv"),i=Math.cosh,a=Math.abs,s=Math.E;r({target:"Math",stat:!0,forced:!i||i(710)===1/0},{cosh:function(e){var t=o(a(e)-1)+1;return(t+1/(t*s*s))*(s/2)}})},"1gqn":function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},"4oU/":function(e,t,n){var r=n("2oRo").isFinite;e.exports=Number.isFinite||function(e){return"number"==typeof e&&r(e)}},"8A4j":function(e,t,n){"use strict";var r=n("BPDm");n.n(r).a},"8AyJ":function(e,t,n){n("I+eb")({target:"Number",stat:!0},{isFinite:n("4oU/")})},"9lTW":function(e,t,n){"use strict";(function(t){var r=n("MgzW");function o(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,o=0,i=Math.min(n,r);o<i;++o)if(e[o]!==t[o]){n=e[o],r=t[o];break}return n<r?-1:r<n?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var a=n("MCLT"),s=Object.prototype.hasOwnProperty,u=Array.prototype.slice,c="foo"===function(){}.name;function l(e){return Object.prototype.toString.call(e)}function f(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var h=e.exports=g,p=/\s*function\s+([^\(\s]*)\s*/;function d(e){if(a.isFunction(e)){if(c)return e.name;var t=e.toString().match(p);return t&&t[1]}}function m(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function v(e){if(c||!a.isFunction(e))return a.inspect(e);var t=d(e);return"[Function"+(t?": "+t:"")+"]"}function y(e,t,n,r,o){throw new h.AssertionError({message:n,actual:e,expected:t,operator:r,stackStartFunction:o})}function g(e,t){e||y(e,!0,t,"==",h.ok)}function b(e,t,n,r){if(e===t)return!0;if(i(e)&&i(t))return 0===o(e,t);if(a.isDate(e)&&a.isDate(t))return e.getTime()===t.getTime();if(a.isRegExp(e)&&a.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(f(e)&&f(t)&&l(e)===l(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===o(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var s=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==s&&s===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,n,r){if(null==e||null==t)return!1;if(a.isPrimitive(e)||a.isPrimitive(t))return e===t;if(n&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var o=E(e),i=E(t);if(o&&!i||!o&&i)return!1;if(o)return e=u.call(e),t=u.call(t),b(e,t,n);var s,c,l=T(e),f=T(t);if(l.length!==f.length)return!1;for(l.sort(),f.sort(),c=l.length-1;c>=0;c--)if(l[c]!==f[c])return!1;for(c=l.length-1;c>=0;c--)if(s=l[c],!b(e[s],t[s],n,r))return!1;return!0}(e,t,n,r))}return n?e===t:e==t}function E(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function w(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function S(e,t,n,r){var o;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof n&&(r=n,n=null),o=function(e){var t;try{e()}catch(e){t=e}return t}(t),r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),e&&!o&&y(o,n,"Missing expected exception"+r);var i="string"==typeof r,s=!e&&o&&!n;if((!e&&a.isError(o)&&i&&w(o,n)||s)&&y(o,n,"Got unwanted exception"+r),e&&o&&n&&!w(o,n)||!e&&o)throw o}h.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return m(v(e.actual),128)+" "+e.operator+" "+m(v(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||y;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var n=new Error;if(n.stack){var r=n.stack,o=d(t),i=r.indexOf("\n"+o);if(i>=0){var a=r.indexOf("\n",i+1);r=r.substring(a+1)}this.stack=r}}},a.inherits(h.AssertionError,Error),h.fail=y,h.ok=g,h.equal=function(e,t,n){e!=t&&y(e,t,n,"==",h.equal)},h.notEqual=function(e,t,n){e==t&&y(e,t,n,"!=",h.notEqual)},h.deepEqual=function(e,t,n){b(e,t,!1)||y(e,t,n,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(e,t,n){b(e,t,!0)||y(e,t,n,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(e,t,n){b(e,t,!1)&&y(e,t,n,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function e(t,n,r){b(t,n,!0)&&y(t,n,r,"notDeepStrictEqual",e)},h.strictEqual=function(e,t,n){e!==t&&y(e,t,n,"===",h.strictEqual)},h.notStrictEqual=function(e,t,n){e===t&&y(e,t,n,"!==",h.notStrictEqual)},h.throws=function(e,t,n){S(!0,e,t,n)},h.doesNotThrow=function(e,t,n){S(!1,e,t,n)},h.ifError=function(e){if(e)throw e},h.strict=r((function e(t,n){t||y(t,!0,n,"==",e)}),h,{equal:h.strictEqual,deepEqual:h.deepStrictEqual,notEqual:h.notStrictEqual,notDeepEqual:h.notDeepStrictEqual}),h.strict.strict=h.strict;var T=Object.keys||function(e){var t=[];for(var n in e)s.call(e,n)&&t.push(n);return t}}).call(this,n("yLpj"))},"9tb/":function(e,t,n){var r=n("I+eb"),o=n("I8vh"),i=String.fromCharCode,a=String.fromCodePoint;r({target:"String",stat:!0,forced:!!a&&1!=a.length},{fromCodePoint:function(e){for(var t,n=[],r=arguments.length,a=0;r>a;){if(t=+arguments[a++],o(t,1114111)!==t)throw RangeError(t+" is not a valid code point");n.push(t<65536?i(t):i(55296+((t-=65536)>>10),t%1024+56320))}return n.join("")}})},AmFO:function(e,t,n){var r=n("I+eb"),o=n("0Dky"),i=n("jrUv"),a=Math.abs,s=Math.exp,u=Math.E;r({target:"Math",stat:!0,forced:o((function(){return-2e-17!=Math.sinh(-2e-17)}))},{sinh:function(e){return a(e=+e)<1?(i(e)-i(-e))/2:(s(e-1)-s(-e-1))*(u/2)}})},BPDm:function(e,t,n){var r=n("IsuW");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},Bicq:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,".round-box[data-v-7d95293c]{cursor:pointer;position:absolute;bottom:-12px;right:0;left:0;margin-left:auto;margin-right:auto;border-radius:50%!important;width:30px;height:30px;background-color:#009688;color:#fff;z-index:99999}",""])},Dt6l:function(e,t,n){"use strict";function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return o(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var i={mounted:function(){for(var e=0,t=Object.entries(this.pageFlashes);e<t.length;e++){var n=r(t[e],2),o=n[0],i=n[1];i&&("success"==o&&this.$emit("onSuccess",!0),this.dismissCountDown=3,this.variant=o,this.msg=i,this.pageFlashes[index]=null)}},watch:{pageFlashes:{handler:function(e){var t=this;_.each(e,(function(e,n){e&&("success"==n&&t.$emit("onSuccess",!0),t.dismissCountDown=3,t.variant=n,t.msg=e,t.pageFlashes[n]=null)}))},deep:!0}},data:function(){return{variant:null,dismissCountDown:null,msg:""}}},a=n("KHd+"),s=Object(a.a)(i,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("b-alert",{staticClass:"position-fixed fixed-top m-0 rounded-0",staticStyle:{"z-index":"2000"},attrs:{dismissible:"",fade:"",variant:e.variant},model:{value:e.dismissCountDown,callback:function(t){e.dismissCountDown=t},expression:"dismissCountDown"}},[e._v("\n  "+e._s(e.msg)+"\n")])}),[],!1,null,null,null);t.a=s.exports},EWPF:function(e,t,n){"use strict";var r={props:["notif"],components:{SidebarItem:n("rYOV").a},data:function(){return{itemsNav:[{id:0,title:"Dashboard",link:"user.dashboard",index:"user.dashboard",icon:"fas fa-fw fa-tachometer-alt"},{id:1,title:"Memo",link:"#",icon:"fas fa-fw fa-clipboard",badge:this.notif.confirmed_paymentmemo||this.notif.memo_branch,child:[{title:"New Memo",link:"user.memo.create",index:"user.memo.create"},{title:"Draft",link:"user.memo.draft.*",index:"user.memo.draft.index"},{title:"Status Memo",link:"user.memo.statusmemo.*",index:"user.memo.statusmemo.index"},{title:"Status Payment",link:"user.memo.statuspayment.*",index:"user.memo.statuspayment.index"},{title:"Status PO",link:"user.memo.statuspo.*",index:"user.memo.statuspo.index"}]},{id:2,title:"Approval",link:"#",icon:"fas fa-fw fa-clipboard-check",badge:this.notif.approval_memo||this.notif.approval_memo_payment||this.notif.approval_memo_po,child:[{title:"Approval Memo",link:"user.memo.approval.memo.*",index:"user.memo.approval.memo.index",badge:this.notif.approval_memo},{title:"Approval Payment",link:"user.memo.approval.payment.*",index:"user.memo.approval.payment.index",badge:this.notif.approval_memo_payment},{title:"Approval PO",link:"user.memo.approval.po.*",index:"user.memo.approval.po.index",badge:this.notif.approval_memo_po}]}]}},methods:{sidebarMenuHandle:function(){window.innerWidth,$(window).width()<480&&$(".sidebar").hasClass("toggled")}},beforeMount:function(){var e=this.$inertia.page.props.userinfo,t=e.employee.overtake,n=e.employee.confirmed_payment;t&&this.itemsNav[1].child.push({title:"Status Memo Branch",link:"user.memo.statustakeovermemobranch.*",index:"user.memo.statustakeovermemobranch.index",badge:this.notif.memo_branch},{title:"Status Payment Branch",link:"user.memo.statustakeoverpaymentbranch.*",index:"user.memo.statustakeoverpaymentbranch.index"}),n&&this.itemsNav[1].child.push({title:"Confirm Payment",link:"user.memo.confirmpayment.*",index:"user.memo.confirmpayment.index",badge:this.notif.confirmed_paymentmemo})},mounted:function(){this.isMobile()&&($("body").addClass("sidebar-toggled"),$(".sidebar").addClass("toggled"),$(".sidebar .collapse").collapse("hide")),$("#sidebarToggle, #sidebarToggleTop").on("click",(function(e){$("body").toggleClass("sidebar-toggled"),$(".sidebar").toggleClass("toggled"),$(".sidebar").hasClass("toggled")&&$(".sidebar .collapse").collapse("hide")})),$(window).resize((function(){$(window).width()<768&&$(".sidebar .collapse").collapse("hide"),$(window).width()<480&&!$(".sidebar").hasClass("toggled")&&($("body").addClass("sidebar-toggled"),$(".sidebar").addClass("toggled"),$(".sidebar .collapse").collapse("hide"))}))},created:function(){window.addEventListener("resize",this.sidebarMenuHandle)},destroyed:function(){window.removeEventListener("resize",this.sidebarMenuHandle)}},o=n("KHd+"),i=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ul",{staticClass:"navbar-nav bg-gradient-primary sidebar sidebar-dark accordion",attrs:{id:"accordionSidebar"}},[n("inertia-link",{staticClass:"sidebar-brand d-flex align-items-center",attrs:{href:e.route("user.dashboard")}},[n("div",{staticClass:"sidebar-brand-text mx-3"},[e._v("User E-Memo")])]),e._v(" "),n("hr",{staticClass:"sidebar-divider my-0"}),e._v(" "),n("sidebar-item",{attrs:{items:e.itemsNav}}),e._v(" "),n("hr",{staticClass:"sidebar-divider d-none d-md-block"}),e._v(" "),e._m(0)],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"text-center d-none d-md-inline"},[t("button",{staticClass:"rounded-circle border-0",attrs:{id:"sidebarToggle"}})])}],!1,null,null,null).exports,a=n("o0o1"),s=n.n(a);function u(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}var c,l,f={props:["userdata","notif"],data:function(){return{show:!1,alertstatus:null,messagestatus:null,url_mark_read_notif:"user.api.notification.read"}},mounted:function(){},methods:{onClickNotification:function(e){var t=this;this.getMarkReadNotif(e.id).then((function(n){n.data.is_read||(t.notif.unreadNotification--,t.notif.notification=t.notif.notification.map((function(t){return t.id===e.id&&(t.read_at=moment().format()),t})))})),this.$inertia.replace(e.data.url)},getMarkReadNotif:(c=s.a.mark((function e(t){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(route(this.url_mark_read_notif,t)));case 1:case"end":return e.stop()}}),e,this)})),l=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=c.apply(e,t);function i(e){u(o,n,r,i,a,"next",e)}function a(e){u(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e){return l.apply(this,arguments)})}},h=Object(o.a)(f,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{staticClass:"\n    navbar navbar-expand navbar-light\n    bg-white\n    topbar\n    mb-4\n    static-top\n    shadow\n  ",class:e.isMobile()?"fixed-top":"static-top"},[e.isMobile()?e._e():n("button",{staticClass:"btn btn-link d-md-none rounded-circle mr-3",attrs:{id:"sidebarToggleTop"}},[n("i",{staticClass:"fa fa-bars"})]),e._v(" "),e.isMobile()?n("inertia-link",{attrs:{href:"#"}},[n("img",{attrs:{src:"/images/brand.png",alt:"",height:"24px"}})]):e._e(),e._v(" "),n("ul",{staticClass:"navbar-nav ml-auto"},[n("li",{staticClass:"nav-item dropdown no-arrow"},[n("a",{staticClass:"nav-link dropdown-toggle",attrs:{href:"#",id:"notifDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"true"}},[n("i",{staticClass:"fas fa-bell fa-fw"}),e._v(" "),e.notif.unreadNotification>0?n("span",{staticClass:"badge badge-danger badge-counter"},[e._v(e._s(e.notif.unreadNotification>10?"10+":e.notif.unreadNotification))]):e._e()]),e._v(" "),n("div",{staticClass:"\n          dropdown-list dropdown-menu dropdown-menu-right\n          shadow\n          animated--grow-in\n        ",attrs:{"aria-labelledby":"notifDropdown"}},[n("h6",{staticClass:"dropdown-header"},[e._v("Notifications")]),e._v(" "),e.notif.notification.length>0?n("div",e._l(e.notif.notification,(function(t){return n("a",{key:t.id,staticClass:"dropdown-item d-flex",attrs:{href:"#"},on:{click:function(n){return e.onClickNotification(t)}}},[n("div",{staticClass:"col px-0"},[n("div",{staticClass:"row"},[n("div",{staticClass:"col"},[n("div",{staticClass:"small",class:t.read_at?["text-gray-500"]:["text-"+t.data.content.type," font-weight-bold"]},[e._v("\n                    "+e._s(t.data.content.doc_no)+"\n                  ")])]),e._v(" "),n("div",{staticClass:"col"},[n("div",{staticClass:"small float-right",class:t.read_at?"text-gray-400":"text-gray-700"},[e._v("\n                    "+e._s(e._f("moment")(t.created_at,"D/M/YY,h:mm a"))+"\n                  ")])])]),e._v(" "),n("div",{staticClass:"row mb-1"},[n("div",{staticClass:"col-12 font-weight-bold text-truncate",class:t.read_at?"text-gray-500":""},[e._v("\n                  "+e._s(t.data.content.caption)+"\n                ")])]),e._v(" "),n("span",{class:t.read_at?"text-gray-500":"font-italic"},[e._v(e._s(t.data.content.subject))])])])})),0):n("div",[n("span",{staticClass:"dropdown-item text-gray-500 font-italic"},[e._v("No notification found.")])])])]),e._v(" "),n("div",{staticClass:"topbar-divider d-none d-sm-block"}),e._v(" "),n("li",{staticClass:"nav-item dropdown no-arrow"},[n("a",{staticClass:"nav-link dropdown-toggle",attrs:{href:"#",id:"userDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}},[n("span",{staticClass:"mr-2 d-none d-lg-inline text-gray-600 small"},[e._v(e._s(e.userdata.name))]),e._v(" "),n("b-avatar",{attrs:{variant:"primary",icon:"person-badge",size:"2rem"}})],1),e._v(" "),n("div",{staticClass:"dropdown-menu dropdown-menu-right shadow animated--grow-in",attrs:{"aria-labelledby":"userDropdown"}},[n("inertia-link",{staticClass:"dropdown-item",attrs:{href:e.route("user.setting.changepassword.index")}},[n("i",{staticClass:"fas fa-key fa-sm fa-fw mr-2 text-gray-400"}),e._v("\n          Change Password\n        ")]),e._v(" "),n("div",{staticClass:"dropdown-divider"}),e._v(" "),n("button",{staticClass:"dropdown-item",on:{click:function(t){e.show=!0}}},[n("i",{staticClass:"fas fa-sign-out-alt fa-sm fa-fw mr-2 text-gray-400"}),e._v("\n          Logout\n        ")])],1)])]),e._v(" "),n("b-modal",{attrs:{title:"Logout",centered:"","header-bg-variant":"primary","header-text-variant":"light"},scopedSlots:e._u([{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{variant:"secondary"},on:{click:function(t){e.show=!1}}},[e._v(" Cancel ")]),e._v(" "),n("b-link",{staticClass:"btn btn-primary",attrs:{size:"sm",href:e.route("logout")}},[e._v("\n        Log out\n      ")])]},proxy:!0}]),model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[e._v("\n    You will be log out\n    ")])],1)}),[],!1,null,null,null).exports,p={props:["notif"],data:function(){return{isOvertakeMemo:!1,isConfirmedPayment:!1,prevScrollpos:0}},beforeMount:function(){var e=this.$inertia.page.props.userinfo,t=e.employee.overtake,n=e.employee.confirmed_payment;this.isOvertakeMemo=t,this.isConfirmedPayment=n},mounted:function(){this.prevScrollpos=0,this.actionHideShowNav()},methods:{actionHideShowNav:function(){this.prevScrollpos=window.pageYOffset,window.onscroll=function(){var e=window.pageYOffset;this.prevScrollpos>e?$("#bottom-navbar").slideDown(100):$("#bottom-navbar").slideUp(100),this.prevScrollpos=e}}}},d=(n("fZLT"),{components:{Sidebar:i,Navbar:h,BottomNavbar:Object(o.a)(p,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("nav",{staticClass:"\n    navbar\n    border-top\n    navbar-expand\n    d-lg-none d-xl-none\n    fixed-bottom\n    bottom-navbar\n  ",attrs:{id:"bottom-navbar"}},[n("ul",{staticClass:"navbar-nav nav-justified mx-auto w-100"},[n("li",{staticClass:"nav-item"},[n("inertia-link",{staticClass:"nav-link",class:{active:e.isRoute("user.dashboard")||e.isRoute("user.setting.*")},attrs:{href:e.route("user.dashboard")}},[n("span",{staticClass:"icon-notif"},[n("i",{staticClass:"bx bx-home-alt"})]),e._v(" "),n("span",{staticClass:"title small d-block"},[e._v("Home")])])],1),e._v(" "),n("li",{staticClass:"nav-item"},[n("inertia-link",{staticClass:"nav-link",class:{active:e.isRoute("user.memo.draft.*")},attrs:{href:e.route("user.memo.draft.index")}},[n("span",{staticClass:"icon-notif"},[n("i",{staticClass:"bx bx-box"})]),e._v(" "),n("span",{staticClass:"title small d-block"},[e._v("Draft")])])],1),e._v(" "),n("li",{staticClass:"nav-item"},[n("inertia-link",{staticClass:"nav-link",class:{active:e.isRoute("user.memo.create")},attrs:{href:e.route("user.memo.create")}},[n("span",{staticClass:"icon-notif"},[n("i",{staticClass:"bx bx-plus-circle"})]),e._v(" "),n("span",{staticClass:"title small d-block"},[e._v("Create")])])],1),e._v(" "),n("li",{staticClass:"nav-item"},[n("div",{staticClass:"dropdown dropup"},[n("a",{staticClass:"nav-link nav-icon",class:{active:e.isRoute("user.memo.statusmemo.*")||e.isRoute("user.memo.statuspayment.*")||e.isRoute("user.memo.statuspo.*")||e.isRoute("user.memo.statustakeovermemobranch.*")||e.isRoute("user.memo.statustakeoverpaymentbranch.*")||e.isRoute("user.memo.confirmpayment.*")},attrs:{href:"#",id:"dropdownMenuButtonStatus","data-toggle":"dropdown"}},[n("span",{staticClass:"icon-notif"},[n("i",{staticClass:"bx bx-info-square"}),e._v(" "),e.notif.memo_branch||e.notif.confirmed_paymentmemo?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1),e._v(" "),n("span",{staticClass:"title small d-block"},[e._v("Status")])]),e._v(" "),n("div",{staticClass:"dropdown-menu dropdown-menu-right shadow animated--grow-in",attrs:{"aria-labelledby":"dropdownMenuButtonStatus"}},[n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.statusmemo.*")},attrs:{href:e.route("user.memo.statusmemo.index")}},[e._v("Memo\n          ")]),e._v(" "),n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.statuspayment.*")},attrs:{href:e.route("user.memo.statuspayment.index")}},[e._v("Payment\n          ")]),e._v(" "),n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.statuspo.*")},attrs:{href:e.route("user.memo.statuspo.index")}},[e._v("PO\n          ")]),e._v(" "),e.isOvertakeMemo?n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.statustakeovermemobranch.*")},attrs:{href:e.route("user.memo.statustakeovermemobranch.index")}},[e._v("Memo Branch\n            "),e.notif.memo_branch?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1):e._e(),e._v(" "),e.isOvertakeMemo?n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.statustakeoverpaymentbranch.*")},attrs:{href:e.route("user.memo.statustakeoverpaymentbranch.index")}},[e._v("Payment Branch\n          ")]):e._e(),e._v(" "),e.isConfirmedPayment?n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.confirmpayment.*")},attrs:{href:e.route("user.memo.confirmpayment.index")}},[e._v("Confirm Payment\n            "),e.notif.confirmed_paymentmemo?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1):e._e()],1)])]),e._v(" "),n("li",{staticClass:"nav-item"},[n("div",{staticClass:"dropdown dropup"},[n("a",{staticClass:"nav-link nav-icon",class:{active:e.isRoute("user.memo.approval.memo.*")||e.isRoute("user.memo.approval.payment.*")||e.isRoute("user.memo.approval.po.*")},attrs:{href:"#",id:"dropdownMenuButtonApproval","data-toggle":"dropdown"}},[n("span",{staticClass:"icon-notif"},[n("i",{staticClass:"bx bx-list-check"}),e._v(" "),e.notif.approval_memo||e.notif.approval_memo_payment||e.notif.approval_memo_po?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1),e._v(" "),n("span",{staticClass:"title small d-block"},[e._v("Approval")])]),e._v(" "),n("div",{staticClass:"dropdown-menu dropdown-menu-right shadow animated--grow-in",attrs:{"aria-labelledby":"dropdownMenuButtonApproval"}},[n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.approval.memo.*")},attrs:{href:e.route("user.memo.approval.memo.index")}},[e._v("Memo\n            "),e.notif.approval_memo?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1),e._v(" "),n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.approval.payment.*")},attrs:{href:e.route("user.memo.approval.payment.index")}},[e._v("Payment\n            "),e.notif.approval_memo_payment?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1),e._v(" "),n("inertia-link",{staticClass:"dropdown-item",class:{active:e.isRoute("user.memo.approval.po.*")},attrs:{href:e.route("user.memo.approval.po.index")}},[e._v("PO\n            "),e.notif.approval_memo_po?n("b-badge",{staticClass:"notif-badge",attrs:{pill:"",variant:"primary"}},[e._v("!")]):e._e()],1)],1)])])])])}),[],!1,null,"2d278c0c",null).exports,Footer:Object(o.a)({},(function(){var e=this.$createElement;this._self._c;return this._m(0)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("footer",{staticClass:"sticky-footer bg-white"},[t("div",{staticClass:"container my-auto"},[t("div",{staticClass:"copyright text-center my-auto"},[t("span",[this._v("Copyright © PT Sinarmas Hana Finance 2021")])])])])}],!1,null,null,null).exports},props:["userinfo","notif"],data:function(){return{sound:new Audio("/sound/notification.mp3")}},methods:{handleLogout:function(){alert("Ini Sudah Logout")}},created:function(){var e=this;window.Echo.private("App.User.".concat(this.userinfo.id)).notification((function(t){switch(t.type){case"App\\Notifications\\ApprovalNotification":e.notif.unreadNotification++,e.sound.play();var n={created_at:moment().format(),data:{content:t.content,url:t.url},id:t.id,notifiable_id:e.userinfo.id,notifiable_type:"AppUser",read_at:null,type:"AppNotificationsApprovalNotification",updated_at:moment().format()};e.notif.notification.unshift(n)}}))}}),m=(n("xpOo"),Object(o.a)(d,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"wrapper"}},[e.isMobile()?e._e():n("Sidebar",{attrs:{notif:e.notif}}),e._v(" "),n("div",{staticClass:"d-flex flex-column",attrs:{id:"content-wrapper"}},[n("div",{style:e.isMobile()&&{"margin-bottom":"5rem"},attrs:{id:"content"}},[n("Navbar",{attrs:{userdata:e.userinfo,notif:e.notif}}),e._v(" "),e.isMobile()?n("BottomNavbar",{attrs:{notif:e.notif}}):e._e(),e._v(" "),n("main",[n("div",{staticClass:"container-fluid",style:e.isMobile()&&{"margin-top":"6rem"}},[e._t("default")],2)])],1),e._v(" "),e.isMobile()?e._e():n("Footer")],1)],1)}),[],!1,null,null,null));t.a=m.exports},Ertq:function(e,t,n){var r=n("Iz27");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},HsHA:function(e,t){var n=Math.log;e.exports=Math.log1p||function(e){return(e=+e)>-1e-8&&e<1e-8?e-e*e/2:n(1+e)}},IsuW:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,'.editor{display:flex;flex-direction:column;max-height:400px;color:#0d0d0d;background-color:#fff;box-shadow:inset 0 1px 2px rgba(10,10,10,.1);border:1px solid #dbdbdb;border-radius:4px}.editor__content{display:block;max-width:100%;min-width:100%;padding:.625em;resize:vertical;background-color:#fff}.editor__header{display:flex;align-items:center;flex:0 0 auto;flex-wrap:wrap;padding:.25rem;border-bottom:1px solid #dbdbdb}.editor__content .ProseMirror{outline:none}.editor__content .ProseMirror .ProseMirror-focused{outline:none!important}.editor__content .ProseMirror table td,.editor__content .ProseMirror table th{min-width:1em;border:2px solid #ddd;padding:3px 5px;vertical-align:top;box-sizing:border-box;position:relative}.ProseMirror ol,.ProseMirror ul{padding:0 1rem}.ProseMirror h1,.ProseMirror h2,.ProseMirror h3,.ProseMirror h4,.ProseMirror h5,.ProseMirror h6{line-height:1.1}.ProseMirror code{background-color:rgba(97,97,97,.1);color:#616161}.ProseMirror pre{background:#0d0d0d;color:#fff;font-family:JetBrainsMono,monospace;padding:.75rem 1rem;border-radius:.5rem}.ProseMirror pre code{color:inherit;padding:0;background:none;font-size:.8rem}.ProseMirror mark{background-color:#faf594}.ProseMirror img{max-width:100%;height:auto}.ProseMirror hr{margin:1rem 0}.ProseMirror blockquote{padding-left:1rem;border-left:2px solid rgba(13,13,13,.1)}.ProseMirror hr{border:none;border-top:2px solid rgba(13,13,13,.1);margin:2rem 0}.ProseMirror ul[data-type=taskList]{list-style:none;padding:0}.ProseMirror ul[data-type=taskList] li{display:flex;align-items:center}.ProseMirror ul[data-type=taskList] li>label{flex:0 0 auto;margin-right:.5rem}.ProseMirror table{border-collapse:collapse;table-layout:fixed;width:100%;margin:0;overflow:hidden}.ProseMirror table td,.ProseMirror table th{min-width:1em;border:2px solid #ced4da;padding:3px 5px;vertical-align:top;box-sizing:border-box;position:relative}.ProseMirror table td>*,.ProseMirror table th>*{margin-bottom:0}.ProseMirror table th{font-weight:700;text-align:left;background-color:#f1f3f5}.ProseMirror table .selectedCell:after{z-index:2;position:absolute;content:"";left:0;right:0;top:0;bottom:0;background:rgba(200,200,255,.4);pointer-events:none}.ProseMirror table .column-resize-handle{position:absolute;right:-2px;top:0;bottom:-2px;width:4px;background-color:#adf;pointer-events:none}.tableWrapper{overflow-x:auto}.resize-cursor{cursor:ew-resize;cursor:col-resize}',""])},Iz27:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,".divider[data-v-2dc47bf6]{width:2px;height:1.25rem;margin-left:2px;margin-right:2px}",""])},JAR3:function(e,t,n){var r=n("Vvqk");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},KKCa:function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},LY3s:function(e,t,n){"use strict";var r=n("o0o1"),o=n.n(r);function i(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u,c,l={components:{CurrencyInput:n("w7Oj").a},props:{id_memo:{type:Number,required:!0},isEditMode:{type:Boolean,default:!0},editOnlyTax:{type:Boolean,default:!1}},data:function(){return{editRow:null,editInvoice:null,dataInvoices:[],url_data_invoices:"user.api.invoice.datainvoices",url_add_data_invoices:"user.api.invoice.addinvoice",url_save_item_invoice:"user.api.invoice.additeminvoice",url_update_item_invoice:"user.api.invoice.updateiteminvoice",url_update_data_invoice:"user.api.invoice.updateinvoice",url_delete_item_invoice:"user.api.invoice.deleteiteminvoice",url_delete_data_invoice:"user.api.invoice.deletedatainvoice",isLoadingData:!0}},mounted:function(){this.getData()},methods:{onClickOutside:function(){this.editMode(null,null)},onMouseOverTableInvoice:function(e){this.isMobile()||($(e.target).find("div.round-box").removeClass("d-none").addClass("d-flex"),$(e.target).removeClass("bg-secondary"),$(e.target).addClass("bg-primary"))},onMouseLeaveTableInvoice:function(e){this.isMobile()||($(e.target).find("div.round-box").addClass("d-none").removeClass("d-flex"),$(e.target).removeClass("bg-primary"),$(e.target).addClass("bg-secondary"))},deleteInvoice:function(e,t){var n=this;this.dataInvoices=this.dataInvoices.filter((function(t,n){return n!=e})),axios.delete(route(this.url_delete_data_invoice,t)).then((function(e){n.dataInvoices=_.filter(n.dataInvoices,(function(e){return e.id_invoice!=t})),e.data.status}))},addNewInvoice:function(){var e=this;axios.post(route(this.url_add_data_invoices,this.id_memo)).then((function(t){var n=t.data.dataInvoice;n.item_invoices=[e.generateItemInvoice(n.id)],n.others=JSON.parse(n.others),e.dataInvoices=[].concat(a(e.dataInvoices),[n]),e.editMode(0,e.dataInvoices.length-1),t.data.status})).catch((function(e){}))},deleteItemInvoice:function(e,t,n){this.dataInvoices[e].item_invoices.length<=1&&e>0?this.deleteInvoice(e):(this.dataInvoices[e].item_invoices=this.dataInvoices[e].item_invoices.filter((function(e,n){return n!=t})),null!=n&&axios.delete(route(this.url_delete_item_invoice,n)).then((function(e){e.data.status})))},addItemInvoice:function(e){var t=this.dataInvoices[e];t.item_invoices=[].concat(a(t.item_invoices),[this.generateItemInvoice(t.id)]);var n=this.dataInvoices[e].item_invoices.length-1;this.editMode(n,e)},addOthers:function(e){var t=this.dataInvoices[e].others.length+1,n={index:t,title:"Other"+t,value:0};this.dataInvoices[e].others.push(n)},removeOthers:function(e,t){this.dataInvoices[e].others=_.filter(this.dataInvoices[e].others,(function(e){return e.index!=t})),this.countTotal(e)},editMode:function(e,t){this.isEditMode&&!this.editOnlyTax&&(this.editRow=e,this.editInvoice=t)},submitItemInvoice:function(e,t,n){this.countTotal(t);var r=this.dataInvoices[t].item_invoices[e];_.debounce(this.autoSaveItemInvoice(r,n),2e3)},autoSaveItemInvoice:function(e,t){var n=this;null==e.id?axios.post(route(this.url_save_item_invoice),e).then((function(e){n.getData(),e.data.status})).catch((function(e){})):axios.put(route(this.url_update_item_invoice,e.id),_.pick(e,t)).then((function(e){e.data.status})).catch((function(e){}))},updateInvoice:function(e,t){axios.put(route(this.url_update_data_invoice,t),_.pick(this.dataInvoices[e],["no_invoice","ppn","pph","npwp","grossup","ppn_value","grossup_value","pph_value","total","others"])).then((function(e){e.data.status})).catch((function(e){}))},generateItemInvoice:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return{id_invoice:e,description:"",description2:"",qty:1,price:0,type:"barang"}},generateItemOther:function(e){this.dataInvoices[e];return{}},sumItemInvoiceBy:function(e,t){return _.sumBy(this.dataInvoices[e].item_invoices,(function(e){return e.type==t&&e.price*e.qty}))},countPPN:function(e){var t=10*(this.sumItemInvoiceBy(e,"barang")+this.sumItemInvoiceBy(e,"jasa"))/100;return this.$set(this.dataInvoices[e],"ppn_value",t),t},actionOnChange:function(e){this.countTotal(e,!0,!0)},actionCheckNpwp:function(e){this.dataInvoices[e].npwp=this.dataInvoices[e].npwp,this.countTotal(e)},actionCheckGrossUp:function(e){this.dataInvoices[e].grossup=this.dataInvoices[e].grossup,this.countTotal(e)},countGrossUp:function(e,t){var n=this.dataInvoices[e],r=0;return"pph23"==t?(r=n.npwp?98:96,Math.floor(100*this.sumItemInvoiceBy(e,"jasa")/r)):("pph4_2_kon"==t&&(r=96),"pph4_2_kon_klas"==t&&(r=97),"pph4_2_rent"==t&&(r=90),Math.round(100*this.sumItemInvoiceBy(e,"jasa")/r))},countPph23:function(e){var t=this.dataInvoices[e],n=t.grossup?t.grossup_value:this.sumItemInvoiceBy(e,"jasa"),r=t.npwp?2:4,o=Math.floor(n*r/100);return this.$set(this.dataInvoices[e],"pph_value",o),o},countPph4_2_kon:function(e){var t=this.dataInvoices[e],n=t.grossup?t.grossup_value:this.sumItemInvoiceBy(e,"jasa"),r=Math.round(4*n/100);return this.$set(this.dataInvoices[e],"pph_value",r),r},countPph4_2_kon_klas:function(e){var t=this.dataInvoices[e],n=t.grossup?t.grossup_value:this.sumItemInvoiceBy(e,"jasa"),r=Math.round(2.65*n/100);return this.$set(this.dataInvoices[e],"pph_value",r),r},countPph4_2_rent:function(e){var t=this.dataInvoices[e],n=t.grossup?t.grossup_value:this.sumItemInvoiceBy(e,"jasa"),r=Math.round(10*n/100);return this.$set(this.dataInvoices[e],"pph_value",r),r},countTotal:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.dataInvoices[e],o=0,i=this.sumItemInvoiceBy(e,"barang"),a=this.sumItemInvoiceBy(e,"jasa"),s=0,u=0,c=0;r.ppn&&(o=t?r.ppn_value:this.countPPN(e)),r.grossup&&"none"!=r.pph?c="pph21"!=r.pph?n?r.grossup_value:this.$set(this.dataInvoices[e],"grossup_value",this.countGrossUp(e,r.pph)):n?r.grossup_value:a:(this.$set(this.dataInvoices[e],"grossup_value",0),c=a),s="pph21"==r.pph?r.pph_value:"pph23"==r.pph?this.countPph23(e):"pph4_2_kon"==r.pph?this.countPph4_2_kon(e):"pph4_2_kon_klas"==r.pph?this.countPph4_2_kon_klas(e):"pph4_2_rent"==r.pph?this.countPph4_2_rent(e):0,_.isEmpty(r.others)||(u=_.sumBy(r.others,(function(e){return e.value})));var l=i+c+o-s+u;this.$set(this.dataInvoices[e],"total",l),this.updateInvoice(e,r.id)},actioncheckItem:function(e,t){switch(t){case"ppn":this.dataInvoices[e].ppn=!this.dataInvoices[e].ppn;break;case"pph23":this.dataInvoices[e].pph="pph23"==this.dataInvoices[e].pph?"none":"pph23";break;case"pph21":this.dataInvoices[e].pph="pph21"==this.dataInvoices[e].pph?"none":"pph21",this.dataInvoices[e].pph_value=0,this.$set(this.dataInvoices[e],"grossup_value",0);break;case"pph4_2_kon":this.dataInvoices[e].pph="pph4_2_kon"==this.dataInvoices[e].pph?"none":"pph4_2_kon";break;case"pph4_2_kon_klas":this.dataInvoices[e].pph="pph4_2_kon_klas"==this.dataInvoices[e].pph?"none":"pph4_2_kon_klas";break;case"pph4_2_rent":this.dataInvoices[e].pph="pph4_2_kon_rent"==this.dataInvoices[e].pph?"none":"pph4_2_rent"}this.countTotal(e)},getData:function(){var e=this;Promise.all([this.getDataInvoices()]).then((function(t){e.isLoadingData=!1,e.dataInvoices=t[0].data,e.dataInvoices=_.map(e.dataInvoices,(function(e){return e.others=JSON.parse(e.others),e}))}))},getDataInvoices:(u=o.a.mark((function e(){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(route(this.url_data_invoices,this.id_memo)));case 1:case"end":return e.stop()}}),e,this)})),c=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=u.apply(e,t);function a(e){i(o,n,r,a,s,"next",e)}function s(e){i(o,n,r,a,s,"throw",e)}a(void 0)}))},function(){return c.apply(this,arguments)})}},f=(n("azOx"),n("KHd+")),h=Object(f.a)(l,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-row",[e.isLoadingData?n("b-col",{attrs:{cols:"12"}},[n("b-skeleton",{attrs:{animation:"fade",width:"15%"}}),e._v(" "),n("b-skeleton",{attrs:{animation:"fade",width:"100%"}}),e._v(" "),n("b-skeleton",{attrs:{animation:"fade",width:"80%"}}),e._v(" "),n("b-skeleton",{attrs:{animation:"fade",width:"100%"}}),e._v(" "),n("b-skeleton",{staticClass:"float-right",attrs:{animation:"fade",width:"30%"}})],1):n("b-col",[e._l(e.dataInvoices,(function(t,r){return n("b-col",{key:r,class:e.isEditMode&&!e.editOnlyTax?"my-5":"mb-5"},[n("b-row",{staticClass:"my-2"},[n("b-col",{attrs:{sm:"4",md:"2"}},[e.isEditMode&&!e.editOnlyTax?n("b-form-input",{attrs:{placeholder:"No Invoice"},on:{change:function(n){return e.updateInvoice(r,t.id)}},model:{value:t.no_invoice,callback:function(n){e.$set(t,"no_invoice",n)},expression:"invoice.no_invoice"}}):n("h6",[e._v("\n            No Invoice : "+e._s(t.no_invoice?t.no_invoice:"-")+"\n          ")])],1),e._v(" "),n("b-col",[r>=0&&e.isEditMode&&!e.editOnlyTax?n("b-button",{staticClass:"mx-auto float-right",attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(n){return e.deleteInvoice(r,t.id)}}},[n("i",{staticClass:"fa fa-times",attrs:{"aria-hidden":"true"}}),e._v(" Remove Invoice\n          ")]):e._e()],1)],1),e._v(" "),n("b-row",{staticClass:"mb-4"},[n("b-col",[n("div",{staticClass:"table-responsive mb-0"},[n("table",{staticClass:"table table-bordered"},[n("thead",{staticClass:"thead-light"},[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("Description")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Description 2")]),e._v(" "),n("th",{staticClass:"text-right",attrs:{scope:"col"}},[e._v("Price")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Qty")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Type")]),e._v(" "),n("th",{staticClass:"text-right",attrs:{scope:"col"}},[e._v("Total")]),e._v(" "),e.isEditMode&&!e.editOnlyTax?n("th",{attrs:{scope:"col"}},[e._v("#")]):e._e()])]),e._v(" "),n("tbody",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}]},[e._l(t.item_invoices,(function(t,o){return n("tr",{key:o,staticStyle:{cursor:"pointer"},on:{click:function(t){return e.editMode(o,r)}}},[n("td",{on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("b-form-textarea",{attrs:{placeholder:"Description",rows:"1",size:"sm"},on:{change:function(t){return e.submitItemInvoice(o,r,"description")}},model:{value:t.description,callback:function(n){e.$set(t,"description",n)},expression:"item.description"}}):n("p",[e._v("\n                      "+e._s(t.description)+"\n                    ")])],1),e._v(" "),n("td",{on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("b-form-textarea",{attrs:{placeholder:"Description 2",rows:"1",size:"sm"},on:{change:function(t){return e.submitItemInvoice(o,r,"description2")}},model:{value:t.description2,callback:function(n){e.$set(t,"description2",n)},expression:"item.description2"}}):n("p",[e._v("\n                      "+e._s(t.description2)+"\n                    ")])],1),e._v(" "),n("td",{staticClass:"text-right",on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp","thousand-separator":".","decimal-separator":",",precision:2,"empty-value":0},on:{change:function(t){return e.submitItemInvoice(o,r,"price")}},model:{value:t.price,callback:function(n){e.$set(t,"price",n)},expression:"item.price"}}):n("p",[e._v("\n                      "+e._s(e._f("currency")(t.price))+"\n                    ")])],1),e._v(" "),n("td",{staticStyle:{width:"7%"},on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{"empty-value":0,"thousand-separator":"."},on:{change:function(t){return e.submitItemInvoice(o,r,"qty")}},model:{value:t.qty,callback:function(n){e.$set(t,"qty",n)},expression:"item.qty"}}):n("p",[e._v("\n                      "+e._s(t.qty)+"\n                    ")])],1),e._v(" "),n("td",{on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("b-form-group",[n("b-form-radio",{attrs:{value:"barang"},on:{change:function(t){return e.submitItemInvoice(o,r,"type")}},model:{value:t.type,callback:function(n){e.$set(t,"type",n)},expression:"item.type"}},[e._v("barang")]),e._v(" "),n("b-form-radio",{attrs:{value:"jasa"},on:{change:function(t){return e.submitItemInvoice(o,r,"type")}},model:{value:t.type,callback:function(n){e.$set(t,"type",n)},expression:"item.type"}},[e._v("jasa")])],1):n("p",[e._v("\n                      "+e._s(t.type)+"\n                    ")])],1),e._v(" "),n("td",{staticClass:"text-right",on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp",separator:".","empty-value":0,value:t.qty*t.price,"read-only":"",placeholder:"Total"}}):n("p",[e._v("\n                      "+e._s(e._f("currency")(t.qty*t.price))+"\n                    ")])],1),e._v(" "),e.isEditMode&&!e.editOnlyTax?n("td",{on:{click:function(t){return e.editMode(o,r)}}},[e.editRow==o&&e.editInvoice==r?n("b-col",{staticClass:"px-auto"},[n("b-button",{attrs:{variant:"outline-secondary",size:"sm"},on:{click:function(n){return e.deleteItemInvoice(r,o,t.id)}}},[n("i",{staticClass:"fa fa-trash",attrs:{"aria-hidden":"true"}})])],1):e._e()],1):e._e()])})),e._v(" "),n("tr",[n("td",{staticClass:"p-0",attrs:{colspan:"7"}})])],2)])]),e._v(" "),e.isEditMode&&!e.editOnlyTax?n("div",{staticClass:"col px-0",class:e.isMobile()?"bg-primary":"bg-secondary",staticStyle:{height:"5px"},attrs:{id:"btnAddInvoice"+t.id},on:{mouseover:e.onMouseOverTableInvoice,mouseleave:e.onMouseLeaveTableInvoice}},[n("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"\n                round-box\n                align-items-center\n                justify-content-center\n                d-none\n              ",class:{"d-flex":e.isMobile()},attrs:{title:"add item"},on:{click:function(t){return e.addItemInvoice(r)}}},[n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])]):e._e(),e._v(" "),n("div",{staticClass:"row justify-content-center mt-0"})])],1),e._v(" "),n("b-row",{attrs:{"align-h":"end"}},[n("b-col",{attrs:{md:"6",lg:"1"}},[n("b-form-checkbox",{attrs:{disabled:!e.isEditMode,name:"checkbox-npwp",value:!1,"unchecked-value":!0},on:{change:function(t){return e.actionCheckNpwp(r)}},model:{value:t.npwp,callback:function(n){e.$set(t,"npwp",n)},expression:"invoice.npwp"}},[e._v("\n            non NPWP\n          ")]),e._v(" "),n("b-form-checkbox",{attrs:{disabled:!e.isEditMode,name:"checkbox-grossup",value:!0,"unchecked-value":!1},on:{change:function(t){return e.actionCheckGrossUp(r)}},model:{value:t.grossup,callback:function(n){e.$set(t,"grossup",n)},expression:"invoice.grossup"}},[e._v("\n            Gross Up\n          ")])],1),e._v(" "),n("b-col",{attrs:{md:"6",lg:"3"}},[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-bordered mb-0"},[n("tbody",[n("tr",{staticClass:"text-right"},[n("td",[e._v("Total Barang")]),e._v(" "),n("td",[e._v("\n                    "+e._s(e._f("currency")(e.sumItemInvoiceBy(r,"barang")?e.sumItemInvoiceBy(r,"barang"):"-"))+"\n                  ")])]),e._v(" "),n("tr",{staticClass:"text-right"},[n("td",[e._v("Total Jasa")]),e._v(" "),n("td",[e._v("\n                    "+e._s(e._f("currency")(e.sumItemInvoiceBy(r,"jasa")?e.sumItemInvoiceBy(r,"jasa"):"-"))+"\n                  ")])]),e._v(" "),n("tr",{staticClass:"text-right font-weight-bold bg-light"},[n("td",[e._v("Sub Total")]),e._v(" "),n("td",[e._v("\n                    "+e._s(e._f("currency")(e.sumItemInvoiceBy(r,"barang")+e.sumItemInvoiceBy(r,"jasa")))+"\n                  ")])]),e._v(" "),t.grossup?n("tr",{staticClass:"text-right"},[n("td",[e._v("Total Jasa Gross Up")]),e._v(" "),n("td",[e.isEditMode||e.editOnlyTax?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp","thousand-separator":".","decimal-separator":",",precision:2,"empty-value":0},on:{change:function(t){return e.actionOnChange(r)}},model:{value:t.grossup_value,callback:function(n){e.$set(t,"grossup_value",n)},expression:"invoice.grossup_value"}}),e._v(" "),n("b-dropdown",{attrs:{variant:"none",size:"sm","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("span",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!0)},[e._v(" "),n("b-dropdown-item",{on:{click:function(t){return e.countTotal(r,!0,!1)}}},[e._v("\n                          reset\n                        ")])],1)],1):n("span",[e._v("\n                      "+e._s(e._f("currency")(t.grossup_value))+"\n                    ")])])]):e._e(),e._v(" "),t.ppn?n("tr",{staticClass:"text-right"},[n("td",[e._v("PPN")]),e._v(" "),n("td",[e.isEditMode||e.editOnlyTax?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp","thousand-separator":".","decimal-separator":",",precision:2,"empty-value":0,"aria-readonly":!0},on:{change:function(t){return e.actionOnChange(r)}},model:{value:t.ppn_value,callback:function(n){e.$set(t,"ppn_value",n)},expression:"invoice.ppn_value"}}),e._v(" "),n("b-dropdown",{attrs:{variant:"none",size:"sm","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("span",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!0)},[e._v(" "),n("b-dropdown-item",{on:{click:function(t){return e.countTotal(r,!1,!0)}}},[e._v("\n                          reset\n                        ")])],1)],1):n("span",[e._v("\n                      "+e._s(e._f("currency")(t.ppn_value))+"\n                    ")])])]):e._e(),e._v(" "),t.pph?n("tr",{staticClass:"text-right"},["pph21"==t.pph?n("td",[e._v("Pph 21")]):e._e(),e._v(" "),"pph23"==t.pph?n("td",[e._v("Pph 23")]):e._e(),e._v(" "),"pph4_2_kon"==t.pph?n("td",[e._v("\n                    Pph 4(2) Konstruksi(non klasifikasi)\n                  ")]):e._e(),e._v(" "),"pph4_2_kon_klas"==t.pph?n("td",[e._v("\n                    Pph 4(2) Konstruksi (klasifikasi)\n                  ")]):e._e(),e._v(" "),"pph4_2_rent"==t.pph?n("td",[e._v("\n                    Pph 4(2) Sewa & Utility\n                  ")]):e._e(),e._v(" "),"none"!=t.pph?n("td",["pph21"==t.pph&&(e.isEditMode||e.editOnlyTax)?n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp","thousand-separator":".","decimal-separator":",",precision:2,"empty-value":0},on:{change:function(t){return e.actionOnChange(r)}},model:{value:t.pph_value,callback:function(n){e.$set(t,"pph_value",n)},expression:"invoice.pph_value"}}):n("span",[e._v("\n                      "+e._s(e._f("currency")(t.pph_value))+"\n                    ")])],1):e._e()]):e._e()]),e._v(" "),t.others?n("tbody",e._l(t.others,(function(t,o){return n("tr",{key:o,staticClass:"text-right"},[n("td",[e.isEditMode||e.editOnlyTax?n("b-input",{attrs:{type:"text",size:"sm",placeholder:"item other"},on:{change:function(t){return e.countTotal(r)}},model:{value:t.title,callback:function(n){e.$set(t,"title",n)},expression:"item.title"}}):n("span",[e._v(" "+e._s(t.title)+" ")])],1),e._v(" "),n("td",[e.isEditMode||e.editOnlyTax?n("div",{staticClass:"d-flex align-items-center justify-content-center"},[n("vue-numeric",{staticClass:"form-control form-control-sm",attrs:{currency:"Rp","thousand-separator":".","decimal-separator":",",precision:2},on:{change:function(t){return e.countTotal(r)}},model:{value:t.value,callback:function(n){e.$set(t,"value",n)},expression:"item.value"}}),e._v(" "),n("b-dropdown",{attrs:{variant:"none",size:"sm","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[n("span",{staticClass:"fas fa-ellipsis-v"})]},proxy:!0}],null,!0)},[e._v(" "),n("b-dropdown-item",{on:{click:function(n){return e.removeOthers(r,t.index)}}},[e._v("\n                          remove\n                        ")])],1)],1):n("span",[e._v("\n                      "+e._s(e._f("currency")(t.value))+"\n                    ")])])])})),0):e._e(),e._v(" "),n("tbody",[n("tr",[n("td",{staticClass:"p-0",attrs:{colspan:"2"}},[e.isEditMode||e.editOnlyTax?n("div",{staticClass:"col px-0",class:e.isMobile()?"bg-primary":"bg-secondary",staticStyle:{height:"5px",cursor:"pointer"},attrs:{id:"btnAddInvoice"+t.id},on:{mouseover:e.onMouseOverTableInvoice,mouseleave:e.onMouseLeaveTableInvoice}},[n("div",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"\n                          round-box\n                          align-items-center\n                          justify-content-center\n                          d-none\n                        ",class:{"d-flex":e.isMobile()},attrs:{title:"add others"},on:{click:function(t){return e.addOthers(r)}}},[n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})])]):e._e()])]),e._v(" "),n("tr",{staticClass:"text-right font-weight-bold bg-dark text-white"},[n("td",[e._v("Total")]),e._v(" "),n("td",[e._v("\n                    "+e._s(e._f("currency")(t.total))+"\n                  ")])])])])]),e._v(" "),n("div",{staticClass:"row justify-content-center my-2"},[e.isEditMode||e.editOnlyTax?n("b-dropdown",{attrs:{variant:"secondary",size:"sm","no-caret":""},scopedSlots:e._u([{key:"button-content",fn:function(){return[e._v("\n                add tax\n                "),n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}})]},proxy:!0}],null,!0)},[e._v(" "),n("b-dropdown-item",{attrs:{active:t.ppn},on:{click:function(t){return e.actioncheckItem(r,"ppn")}}},[e._v("PPN")]),e._v(" "),n("b-dropdown-item",{attrs:{active:"pph21"==t.pph},on:{click:function(t){return e.actioncheckItem(r,"pph21")}}},[e._v("Pph 21")]),e._v(" "),n("b-dropdown-item",{attrs:{active:"pph23"==t.pph},on:{click:function(t){return e.actioncheckItem(r,"pph23")}}},[e._v("Pph 23")]),e._v(" "),n("b-dropdown-item",{staticClass:"bg-light text-white",attrs:{disabled:"",active:"pph4_2_kon"==t.pph||"pph4_2_kon_klas"==t.pph||"pph4_2_rent"==t.pph}},[e._v("Pph 4(2)")]),e._v(" "),n("b-dropdown-item",{staticClass:"ml-2",attrs:{active:"pph4_2_kon_klas"==t.pph},on:{click:function(t){return e.actioncheckItem(r,"pph4_2_kon_klas")}}},[e._v("Konstruksi (klasifikasi)")]),e._v(" "),n("b-dropdown-item",{staticClass:"ml-2",attrs:{active:"pph4_2_kon"==t.pph},on:{click:function(t){return e.actioncheckItem(r,"pph4_2_kon")}}},[e._v("Konstruksi (nonklasifikasi)")]),e._v(" "),n("b-dropdown-item",{staticClass:"ml-2",attrs:{active:"pph4_2_rent"==t.pph},on:{click:function(t){return e.actioncheckItem(r,"pph4_2_rent")}}},[e._v("Sewa & Utility")])],1):e._e()],1)])],1)],1)})),e._v(" "),n("b-col",[e.isEditMode&&!e.editOnlyTax?n("b-button",{staticClass:"mx-auto",attrs:{variant:"outline-primary",size:"sm"},on:{click:e.addNewInvoice}},[n("i",{staticClass:"fa fa-plus",attrs:{"aria-hidden":"true"}}),e._v(" Add Invoice\n      ")]):e._e()],1)],2)],1)}),[],!1,null,"7d95293c",null);t.a=h.exports},MCLT:function(e,t,n){(function(e){var r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},o=/%[sdj%]/g;t.format=function(e){if(!y(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(s(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,i=r.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(n>=i)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),u=r[n];n<i;u=r[++n])m(u)||!E(u)?a+=" "+u:a+=" "+s(u);return a},t.deprecate=function(n,r){if(void 0!==e&&!0===e.noDeprecation)return n;if(void 0===e)return function(){return t.deprecate(n,r).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(r);e.traceDeprecation?console.trace(r):console.error(r),o=!0}return n.apply(this,arguments)}};var i,a={};function s(e,n){var r={seen:[],stylize:c};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&t._extend(r,n),g(r.showHidden)&&(r.showHidden=!1),g(r.depth)&&(r.depth=2),g(r.colors)&&(r.colors=!1),g(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=u),l(r,e,r.depth)}function u(e,t){var n=s.styles[t];return n?"["+s.colors[n][0]+"m"+e+"["+s.colors[n][1]+"m":e}function c(e,t){return e}function l(e,n,r){if(e.customInspect&&n&&T(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,e);return y(o)||(o=l(e,o,r)),o}var i=function(e,t){if(g(t))return e.stylize("undefined","undefined");if(y(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(v(t))return e.stylize(""+t,"number");if(d(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,n);if(i)return i;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return f(n);if(0===a.length){if(T(n)){var u=n.name?": "+n.name:"";return e.stylize("[Function"+u+"]","special")}if(b(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(w(n))return e.stylize(Date.prototype.toString.call(n),"date");if(S(n))return f(n)}var c,E="",O=!1,R=["{","}"];(p(n)&&(O=!0,R=["[","]"]),T(n))&&(E=" [Function"+(n.name?": "+n.name:"")+"]");return b(n)&&(E=" "+RegExp.prototype.toString.call(n)),w(n)&&(E=" "+Date.prototype.toUTCString.call(n)),S(n)&&(E=" "+f(n)),0!==a.length||O&&0!=n.length?r<0?b(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),c=O?function(e,t,n,r,o){for(var i=[],a=0,s=t.length;a<s;++a)A(t,String(a))?i.push(h(e,t,n,r,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(h(e,t,n,r,o,!0))})),i}(e,n,r,s,a):a.map((function(t){return h(e,n,r,s,t,O)})),e.seen.pop(),function(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(c,E,R)):R[0]+E+R[1]}function f(e){return"["+Error.prototype.toString.call(e)+"]"}function h(e,t,n,r,o,i){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),A(r,o)||(a="["+o+"]"),s||(e.seen.indexOf(u.value)<0?(s=m(n)?l(e,u.value,null):l(e,u.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),g(a)){if(i&&o.match(/^\d+$/))return s;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function d(e){return"boolean"==typeof e}function m(e){return null===e}function v(e){return"number"==typeof e}function y(e){return"string"==typeof e}function g(e){return void 0===e}function b(e){return E(e)&&"[object RegExp]"===O(e)}function E(e){return"object"==typeof e&&null!==e}function w(e){return E(e)&&"[object Date]"===O(e)}function S(e){return E(e)&&("[object Error]"===O(e)||e instanceof Error)}function T(e){return"function"==typeof e}function O(e){return Object.prototype.toString.call(e)}function R(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(n){if(g(i)&&(i=e.env.NODE_DEBUG||""),n=n.toUpperCase(),!a[n])if(new RegExp("\\b"+n+"\\b","i").test(i)){var r=e.pid;a[n]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",n,r,e)}}else a[n]=function(){};return a[n]},t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=p,t.isBoolean=d,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=v,t.isString=y,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=g,t.isRegExp=b,t.isObject=E,t.isDate=w,t.isError=S,t.isFunction=T,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n("1gqn");var N=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var e=new Date,t=[R(e.getHours()),R(e.getMinutes()),R(e.getSeconds())].join(":");return[e.getDate(),N[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",k(),t.format.apply(t,arguments))},t.inherits=n("KKCa"),t._extend=function(e,t){if(!t||!E(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function M(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,o)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},t.promisify.custom=C,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],r=0;r<arguments.length;r++)n.push(arguments[r]);var o=n.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,n).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(M,t,a)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(t)),Object.defineProperties(n,r(t)),n}}).call(this,n("8oxB"))},MgzW:function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;function a(e){if(null==e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,s,u=a(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))o.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var f=0;f<s.length;f++)i.call(n,s[f])&&(u[s[f]]=n[s[f]])}}return u}},Mw5X:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"AbsPlugin",(function(){return Vf})),n.d(r,"BitShiftPlugin",(function(){return qf})),n.d(r,"BitwiseLogicOperationsPlugin",(function(){return ah})),n.d(r,"BooleanPlugin",(function(){return dh})),n.d(r,"CharPlugin",(function(){return Sh})),n.d(r,"CodePlugin",(function(){return Mh})),n.d(r,"CountBlankPlugin",(function(){return Uh})),n.d(r,"CountUniquePlugin",(function(){return $h})),n.d(r,"DateTimePlugin",(function(){return ip})),n.d(r,"DegreesPlugin",(function(){return yp})),n.d(r,"DeltaPlugin",(function(){return Rp})),n.d(r,"ExpPlugin",(function(){return _p})),n.d(r,"FinancialPlugin",(function(){return Gp})),n.d(r,"FormulaTextPlugin",(function(){return nd})),n.d(r,"InformationPlugin",(function(){return ld})),n.d(r,"IsEvenPlugin",(function(){return gd})),n.d(r,"IsOddPlugin",(function(){return Nd})),n.d(r,"LogarithmPlugin",(function(){return Pd})),n.d(r,"MathConstantsPlugin",(function(){return Gd})),n.d(r,"MatrixPlugin",(function(){return Xd})),n.d(r,"MedianPlugin",(function(){return om})),n.d(r,"ModuloPlugin",(function(){return hm})),n.d(r,"NumericAggregationPlugin",(function(){return Rm})),n.d(r,"PowerPlugin",(function(){return Lm})),n.d(r,"RadiansPlugin",(function(){return Gm})),n.d(r,"RadixConversionPlugin",(function(){return Jm})),n.d(r,"RandomPlugin",(function(){return fv})),n.d(r,"RoundingPlugin",(function(){return wv})),n.d(r,"SqrtPlugin",(function(){return Cv})),n.d(r,"SumifPlugin",(function(){return iy})),n.d(r,"SumprodPlugin",(function(){return py})),n.d(r,"TextPlugin",(function(){return wy})),n.d(r,"TrigonometryPlugin",(function(){return Cy})),n.d(r,"LookupPlugin",(function(){return zy})),n.d(r,"RomanPlugin",(function(){return Qy})),n.d(r,"SimpleArithmerticPlugin",(function(){return ug})),n.d(r,"StatisticalPlugin",(function(){return Db})),n.d(r,"MathPlugin",(function(){return Yb})),n.d(r,"ComplexPlugin",(function(){return uE})),n.d(r,"StatisticalAggregationPlugin",(function(){return CE}));var o,i=n("o0o1"),a=n.n(i),s=n("EWPF"),u=n("Dt6l"),c=n("jMhu"),l=n("LY3s"),f=(n("NBAS"),n("cDke"),n("LKBx"),n("SuFq"),n("+2oP"),n("07d7"),n("sMBO"),n("pjDv"),n("PKPk"),n("pNMO"),n("4Brf"),n("0oug"),n("4mDm"),n("3bBZ"),n("zKZe"),n("ls82"),n("2B1R"),n("YGK4"),n("ma9I"),n("FZtP"),n("9lTW")),h=n.n(f);n("8AyJ"),n("qePV"),n("TWNs"),n("rB9j"),n("JfAA"),n("E9XD"),n("EnZy"),n("UxlC");function p(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.CELL_REFERENCE_RELATIVE="CELL_REFERENCE",e.CELL_REFERENCE_ABSOLUTE="CELL_REFERENCE_ABSOLUTE",e.CELL_REFERENCE_ABSOLUTE_COL="CELL_REFERENCE_ABSOLUTE_COL",e.CELL_REFERENCE_ABSOLUTE_ROW="CELL_REFERENCE_ABSOLUTE_ROW"}(o||(o={}));var d,m=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=n,this.row=r,this.type=o}var t,n,r;return t=e,r=[{key:"relative",value:function(t,n,r){return new e(t,n,r,o.CELL_REFERENCE_RELATIVE)}},{key:"absolute",value:function(t,n,r){return new e(t,n,r,o.CELL_REFERENCE_ABSOLUTE)}},{key:"absoluteCol",value:function(t,n,r){return new e(t,n,r,o.CELL_REFERENCE_ABSOLUTE_COL)}},{key:"absoluteRow",value:function(t,n,r){return new e(t,n,r,o.CELL_REFERENCE_ABSOLUTE_ROW)}}],(n=[{key:"toSimpleCellAddress",value:function(e){var t=Xo(this,e);return this.type===o.CELL_REFERENCE_ABSOLUTE?Yo(t,this.col,this.row):this.type===o.CELL_REFERENCE_ABSOLUTE_ROW?Yo(t,e.col+this.col,this.row):this.type===o.CELL_REFERENCE_ABSOLUTE_COL?Yo(t,this.col,e.row+this.row):Yo(t,e.col+this.col,e.row+this.row)}},{key:"toSimpleColumnAddress",value:function(e){var t=Xo(this,e),n=this.col;return this.isColumnRelative()&&(n+=e.col),Wo(t,n)}},{key:"toSimpleRowAddress",value:function(e){var t=Xo(this,e),n=this.row;return this.isRowRelative()&&(n+=e.row),Go(t,n)}},{key:"isRowAbsolute",value:function(){return this.type===o.CELL_REFERENCE_ABSOLUTE||this.type===o.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isColumnAbsolute",value:function(){return this.type===o.CELL_REFERENCE_ABSOLUTE||this.type===o.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isColumnRelative",value:function(){return this.type===o.CELL_REFERENCE_RELATIVE||this.type===o.CELL_REFERENCE_ABSOLUTE_ROW}},{key:"isRowRelative",value:function(){return this.type===o.CELL_REFERENCE_RELATIVE||this.type===o.CELL_REFERENCE_ABSOLUTE_COL}},{key:"isAbsolute",value:function(){return this.type===o.CELL_REFERENCE_ABSOLUTE&&null!==this.sheet}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.col,this.row+t,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.row,this.type)}},{key:"moved",value:function(t,n,r){return new e(null===this.sheet?null:t,this.col+n,this.row+r,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.row,this.type)}},{key:"isInvalid",value:function(e){return Ko(this.toSimpleCellAddress(e))}},{key:"shiftRelativeDimensions",value:function(t,n){var r=this.isColumnAbsolute()?this.col:this.col+t,o=this.isRowAbsolute()?this.row:this.row+n;return new e(this.sheet,r,o,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,n){var r=this.isColumnRelative()?this.col:this.col+t,o=this.isRowRelative()?this.row:this.row+n;return new e(this.sheet,r,o,this.type)}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case o.CELL_REFERENCE_RELATIVE:return"".concat(t,"#").concat(this.row,"R").concat(this.col);case o.CELL_REFERENCE_ABSOLUTE:return"".concat(t,"#").concat(this.row,"A").concat(this.col);case o.CELL_REFERENCE_ABSOLUTE_COL:return"".concat(t,"#").concat(this.row,"AC").concat(this.col);case o.CELL_REFERENCE_ABSOLUTE_ROW:return"".concat(t,"#").concat(this.row,"AR").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleCellAddress(e);if(!Ko(t)){var n=ae(t.col),r=this.type===o.CELL_REFERENCE_ABSOLUTE||this.type===o.CELL_REFERENCE_ABSOLUTE_ROW?"$":"",i=this.type===o.CELL_REFERENCE_ABSOLUTE||this.type===o.CELL_REFERENCE_ABSOLUTE_COL?"$":"";return"".concat(i).concat(n).concat(r).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.row>=t||this.col>=e}}])&&p(t.prototype,n),r&&p(t,r),e}();function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.RELATIVE="RELATIVE",e.ABSOLUTE="ABSOLUTE"}(d||(d={}));var y=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.col=n,this.type=r}var t,n,r;return t=e,r=[{key:"absolute",value:function(t,n){return new e(t,n,d.ABSOLUTE)}},{key:"relative",value:function(t,n){return new e(t,n,d.RELATIVE)}}],(n=[{key:"isColumnAbsolute",value:function(){return this.type===d.ABSOLUTE}},{key:"isColumnRelative",value:function(){return this.type===d.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===d.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,n,r){return new e(null===this.sheet?null:t,this.col+n,this.type)}},{key:"shiftedByColumns",value:function(t){return new e(this.sheet,this.col+t,this.type)}},{key:"toSimpleColumnAddress",value:function(e){var t=Xo(this,e),n=this.col;return this.isColumnRelative()&&(n=e.col+this.col),Wo(t,n)}},{key:"shiftRelativeDimensions",value:function(t,n){var r=this.isColumnRelative()?this.col+t:this.col;return new e(this.sheet,r,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,n){var r=this.isColumnAbsolute()?this.col+t:this.col;return new e(this.sheet,r,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.col,this.type)}},{key:"isInvalid",value:function(e){return this.toSimpleColumnAddress(e).col<0}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case d.RELATIVE:return"".concat(t,"#COLR").concat(this.col);case d.ABSOLUTE:return"".concat(t,"#COLA").concat(this.col)}}},{key:"unparse",value:function(e){var t=this.toSimpleColumnAddress(e);if(!$o(t)){var n=ae(t.col),r=this.type===d.ABSOLUTE?"$":"";return"".concat(r).concat(n)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.col>=e}}])&&v(t.prototype,n),r&&v(t,r),e}(),g=n("+oOE"),b=Object(g.createToken)({name:"AdditionOp",pattern:g.Lexer.NA}),E=Object(g.createToken)({name:"PlusOp",pattern:/\+/,categories:b}),w=Object(g.createToken)({name:"MinusOp",pattern:/-/,categories:b}),S=Object(g.createToken)({name:"MultiplicationOp",pattern:g.Lexer.NA}),T=Object(g.createToken)({name:"TimesOp",pattern:/\*/,categories:S}),O=Object(g.createToken)({name:"DivOp",pattern:/\//,categories:S}),R=Object(g.createToken)({name:"PowerOp",pattern:/\^/}),N=Object(g.createToken)({name:"PercentOp",pattern:/%/}),k=Object(g.createToken)({name:"BooleanOp",pattern:g.Lexer.NA}),A=Object(g.createToken)({name:"EqualsOp",pattern:/=/,categories:k}),C=Object(g.createToken)({name:"NotEqualOp",pattern:/<>/,categories:k}),M=Object(g.createToken)({name:"GreaterThanOp",pattern:/>/,categories:k}),x=Object(g.createToken)({name:"LessThanOp",pattern:/</,categories:k}),I=Object(g.createToken)({name:"GreaterThanOrEqualOp",pattern:/>=/,categories:k}),P=Object(g.createToken)({name:"LessThanOrEqualOp",pattern:/<=/,categories:k}),L=Object(g.createToken)({name:"ConcatenateOp",pattern:/&/}),F="(".concat("[A-Za-z0-9_À-ʯ]+","|").concat("'(((?!').|'')*)'",")!"),D=Object(g.createToken)({name:"CellReference",pattern:new RegExp("(".concat(F,")?\\$?[A-Za-z]+\\$?[0-9]+"))}),U=Object(g.createToken)({name:"ColumnRange",pattern:new RegExp("(".concat(F,")?\\$?[A-Za-z]+:(").concat(F,")?\\$?[A-Za-z]+"))}),j=Object(g.createToken)({name:"RowRange",pattern:new RegExp("(".concat(F,")?\\$?[0-9]+:(").concat(F,")?\\$?[0-9]+"))}),B=Object(g.createToken)({name:"RangeSeparator",pattern:/:/}),V=Object(g.createToken)({name:"LParen",pattern:/\(/}),H=Object(g.createToken)({name:"RParen",pattern:/\)/}),G=Object(g.createToken)({name:"ProcedureName",pattern:/([A-Za-z\u00C0-\u02AF][A-Za-z0-9\u00C0-\u02AF._]*)\(/}),z=Object(g.createToken)({name:"NamedExpression",pattern:/[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*/}),W=Object(g.createToken)({name:"StringLiteral",pattern:/"([^"\\]*(\\.[^"\\]*)*)"/}),$=Object(g.createToken)({name:"ErrorLiteral",pattern:/#[A-Za-z0-9\/]+[?!]?/}),Y=Object(g.createToken)({name:"WhiteSpace",pattern:/[ \t\n\r]+/}),K=function(e){var t=e.translationPackage.getFunctionTranslation("OFFSET"),n=e.errorMapping,r=e.translationPackage.buildFunctionMapping(),o=Object(g.createToken)({name:"ArgSeparator",pattern:e.functionArgSeparator}),i=Object(g.createToken)({name:"NumberLiteral",pattern:new RegExp("(([".concat(e.decimalSeparator,"]\\d+)|(\\d+([").concat(e.decimalSeparator,"]\\d*)?))(e[+-]?\\d+)?"))}),a=Object(g.createToken)({name:"OffsetProcedureName",pattern:new RegExp(t,"i")});return{ArgSeparator:o,NumberLiteral:i,OffsetProcedureName:a,allTokens:[Y,E,w,T,O,R,A,C,N,I,P,M,x,V,H,a,G,B,o,U,j,i,W,$,L,k,b,S,D,z],errorMapping:n,functionMapping:r,decimalSeparator:e.decimalSeparator,maxColumns:e.maxColumns,maxRows:e.maxRows}};function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var X=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.row=n,this.type=r}var t,n,r;return t=e,r=[{key:"absolute",value:function(t,n){return new e(t,n,d.ABSOLUTE)}},{key:"relative",value:function(t,n){return new e(t,n,d.RELATIVE)}}],(n=[{key:"isRowAbsolute",value:function(){return this.type===d.ABSOLUTE}},{key:"isRowRelative",value:function(){return this.type===d.RELATIVE}},{key:"isAbsolute",value:function(){return this.type===d.ABSOLUTE&&null!==this.sheet}},{key:"moved",value:function(t,n,r){return new e(null===this.sheet?null:t,this.row+r,this.type)}},{key:"shiftedByRows",value:function(t){return new e(this.sheet,this.row+t,this.type)}},{key:"toSimpleRowAddress",value:function(e){var t=Xo(this,e),n=this.row;return this.isRowRelative()&&(n=e.row+this.row),Go(t,n)}},{key:"shiftRelativeDimensions",value:function(t,n){var r=this.isRowRelative()?this.row+n:this.row;return new e(this.sheet,r,this.type)}},{key:"shiftAbsoluteDimensions",value:function(t,n){var r=this.isRowAbsolute()?this.row+n:this.row;return new e(this.sheet,r,this.type)}},{key:"withAbsoluteSheet",value:function(t){return new e(t,this.row,this.type)}},{key:"isInvalid",value:function(e){return this.toSimpleRowAddress(e).row<0}},{key:"hash",value:function(e){var t=e&&null!==this.sheet?"#".concat(this.sheet):"";switch(this.type){case d.RELATIVE:return"".concat(t,"#ROWR").concat(this.row);case d.ABSOLUTE:return"".concat(t,"#ROWA").concat(this.row)}}},{key:"unparse",value:function(e){var t=this.toSimpleRowAddress(e);if(!zo(t)){var n=this.type===d.ABSOLUTE?"$":"";return"".concat(n).concat(t.row+1)}}},{key:"exceedsSheetSizeLimits",value:function(e){return this.row>=e}}])&&q(t.prototype,n),r&&q(t,r),e}(),J=new RegExp("^(".concat(F,")?(\\$?)([A-Za-z]+)(\\$?)([0-9]+)$")),Q=new RegExp("^(".concat(F,")?(\\$?)([A-Za-z]+)$")),Z=new RegExp("^(".concat(F,")?(\\$?)([0-9]+)$")),ee=new RegExp("^".concat("[A-Za-z0-9_À-ʯ]+","$")),te=function(e,t,n){var r=J.exec(t),o=ie(r[6]),i=ue(r,e);if(void 0!==i){var a=Number(r[8])-1;return"$"===r[5]&&"$"===r[7]?m.absolute(i,o,a):"$"===r[5]?m.absoluteCol(i,o,a-n.row):"$"===r[7]?m.absoluteRow(i,o-n.col,a):m.relative(i,o-n.col,a-n.row)}},ne=function(e,t,n){var r=Q.exec(t),o=ue(r,e);if(void 0!==o){var i=ie(r[6]);return"$"===r[5]?y.absolute(o,i):y.relative(o,i-n.col)}},re=function(e,t,n){var r=Z.exec(t),o=ue(r,e);if(void 0!==o){var i=Number(r[6])-1;return"$"===r[5]?X.absolute(o,i):X.relative(o,i-n.row)}},oe=function(e,t,n){var r=ae(t.col),o=se(t.sheet,e);if(void 0!==o)return n!==t.sheet?"".concat(o,"!").concat(r).concat(t.row+1):"".concat(r).concat(t.row+1)};function ie(e){return 1===e.length?e.toUpperCase().charCodeAt(0)-65:e.split("").reduce((function(e,t){return 26*e+(t.toUpperCase().charCodeAt(0)-64)}),0)-1}function ae(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()}function se(e,t){var n=t(e);if(void 0!==n)return ee.test(n)?n:(n=n.replace(/'/g,"''"),"'".concat(n,"'"))}function ue(e,t){var n,r=null!==(n=e[3])&&void 0!==n?n:e[2],o=null;if(!r||void 0!==(o=t(r=r.replace(/''/g,"'"))))return o}n("oVuX");var ce,le,fe,he=function(e,t){return{type:e,message:t}};!function(e){e.LexingError="LexingError",e.ParserError="ParsingError",e.StaticOffsetError="StaticOffsetError",e.StaticOffsetOutOfRangeError="StaticOffsetOutOfRangeError",e.RangeOffsetNotAllowed="RangeOffsetNotAllowed"}(ce||(ce={})),function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.MINUS_UNARY_OP="MINUS_UNARY_OP",e.PLUS_UNARY_OP="PLUS_UNARY_OP",e.PERCENT_OP="PERCENT_OP",e.CONCATENATE_OP="CONCATENATE_OP",e.EQUALS_OP="EQUALS_OP",e.NOT_EQUAL_OP="NOT_EQUAL_OP",e.GREATER_THAN_OP="GREATER_THAN_OP",e.LESS_THAN_OP="LESS_THAN_OP",e.GREATER_THAN_OR_EQUAL_OP="GREATER_THAN_OR_EQUAL_OP",e.LESS_THAN_OR_EQUAL_OP="LESS_THAN_OR_EQUAL_OP",e.PLUS_OP="PLUS_OP",e.MINUS_OP="MINUS_OP",e.TIMES_OP="TIMES_OP",e.DIV_OP="DIV_OP",e.POWER_OP="POWER_OP",e.FUNCTION_CALL="FUNCTION_CALL",e.NAMED_EXPRESSION="NAMED_EXPRESSION",e.PARENTHESIS="PARENTHESES",e.CELL_REFERENCE="CELL_REFERENCE",e.CELL_RANGE="CELL_RANGE",e.COLUMN_RANGE="COLUMN_RANGE",e.ROW_RANGE="ROW_RANGE",e.ERROR="ERROR",e.ERROR_WITH_RAW_INPUT="ERROR_WITH_RAW_INPUT"}(le||(le={})),function(e){e[e.RELATIVE=0]="RELATIVE",e[e.START_ABSOLUTE=1]="START_ABSOLUTE",e[e.BOTH_ABSOLUTE=2]="BOTH_ABSOLUTE"}(fe||(fe={}));var pe,de=function(e,t){return{type:le.CELL_REFERENCE,reference:e,leadingWhitespace:null==t?void 0:t.image}},me=function(e,t,n,r){return be(e,t,n),{type:le.CELL_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:r}},ve=function(e,t){return{type:le.ERROR,error:e,leadingWhitespace:null==t?void 0:t.image}},ye=function(e,t,n){return{type:le.ERROR_WITH_RAW_INPUT,error:t,rawInput:e,leadingWhitespace:null==n?void 0:n.image}},ge=function(){return{type:le.ERROR,error:Ho.parsingError()}};function be(e,t,n){if(null!==e.sheet&&null===t.sheet||null===e.sheet&&null!==t.sheet)throw new Error("Start address inconsistent with end address");if(null===e.sheet&&n!==fe.RELATIVE||null!==e.sheet&&n===fe.RELATIVE)throw new Error("Sheet address inconsistent with sheet reference type")}function Ee(e,t){return(null!=t?t:"")+e}function we(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var Se=(we(pe={},le.PLUS_OP,"+"),we(pe,le.MINUS_OP,"-"),we(pe,le.TIMES_OP,"*"),we(pe,le.DIV_OP,"/"),we(pe,le.CONCATENATE_OP,"&"),we(pe,le.POWER_OP,"^"),we(pe,le.EQUALS_OP,"="),we(pe,le.NOT_EQUAL_OP,"<>"),we(pe,le.GREATER_THAN_OP,">"),we(pe,le.GREATER_THAN_OR_EQUAL_OP,">="),we(pe,le.LESS_THAN_OP,"<"),we(pe,le.LESS_THAN_OR_EQUAL_OP,"<="),pe);n("Tskq");function Te(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Oe=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functionRegistry=t,this.cache=new Map}var t,n,r;return t=e,(n=[{key:"set",value:function(e,t){var n=function(e,t,n,r){return{ast:e,relativeDependencies:t,hasVolatileFunction:n,hasStructuralChangeFunction:r}}(t,Ye(t,this.functionRegistry),Re(t,this.functionRegistry.isFunctionVolatile),Re(t,this.functionRegistry.isFunctionDependentOnSheetStructureChange));return this.cache.set(e,n),n}},{key:"get",value:function(e){return this.cache.get(e)||null}},{key:"maybeSetAndThenGet",value:function(e,t){var n=this.cache.get(e);return n?n.ast:(this.set(e,t),t)}},{key:"destroy",value:function(){this.cache.clear()}}])&&Te(t.prototype,n),r&&Te(t,r),e}(),Re=function e(t,n){switch(t.type){case le.EMPTY:case le.NUMBER:case le.STRING:case le.ERROR:case le.ERROR_WITH_RAW_INPUT:case le.CELL_REFERENCE:case le.CELL_RANGE:case le.COLUMN_RANGE:case le.ROW_RANGE:case le.NAMED_EXPRESSION:return!1;case le.PERCENT_OP:case le.PLUS_UNARY_OP:case le.MINUS_UNARY_OP:return e(t.value,n);case le.CONCATENATE_OP:case le.EQUALS_OP:case le.NOT_EQUAL_OP:case le.LESS_THAN_OP:case le.GREATER_THAN_OP:case le.LESS_THAN_OR_EQUAL_OP:case le.GREATER_THAN_OR_EQUAL_OP:case le.MINUS_OP:case le.PLUS_OP:case le.TIMES_OP:case le.DIV_OP:case le.POWER_OP:return e(t.left,n)||e(t.right,n);case le.PARENTHESIS:return e(t.expression,n);case le.FUNCTION_CALL:return!!n(t.procedureName)||t.args.some((function(t){return e(t,n)}))}};n("i6QF"),n("XUE8"),n("5DmW");var Ne=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)};function ke(e){return(ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ae(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ce(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ce(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ce(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Me(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ie(e,t,n){return t&&xe(e.prototype,t),n&&xe(e,n),e}function _e(e,t,n){return(_e="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=De(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Pe(e,t){return(Pe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Le(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=De(e);if(t){var o=De(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fe(this,n)}}function Fe(e,t){return!t||"object"!==ke(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function De(e){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Ne.DistinctSigns="Distinct signs.",Ne.WrongArgNumber="Wrong number of arguments.",Ne.EmptyArg="Empty function argument.",Ne.MatrixDimensions="Matrix dimensions are not compatible.",Ne.ValueSmall="Value too small.",Ne.ValueLarge="Value too large.",Ne.BadCriterion="Incorrect criterion.",Ne.RangeManySheets="Range spans more than one sheet.",Ne.CellRangeExpected="Cell range expected.",Ne.ScalarExpected="Cell range not allowed.",Ne.NumberCoercion="Value cannot be coerced to number.",Ne.NumberExpected="Number argument expected.",Ne.IntegerExpected="Value needs to be an integer.",Ne.BadMode="Mode not recognized.",Ne.DateBounds="Date outside of bounds.",Ne.OutOfSheet="Resulting reference is out of the sheet.",Ne.WrongType="Wrong type of argument.",Ne.NaN="NaN or infinite value encountered.",Ne.EqualLength="Ranges need to be of equal length.",Ne.Negative="Value cannot be negative.",Ne.NotBinary="String does not represent a binary number.",Ne.NotOctal="String does not represent an octal number.",Ne.NotHex="String does not represent a hexadecimal number.",Ne.EndStartPeriod="End period needs to be at least start period.",Ne.CellRefExpected="Cell reference expected.",Ne.BadRef="Address is not correct.",Ne.NumberRange="Number-only range expected.",Ne.ValueNotFound="Value not found.",Ne.ValueBaseLarge="Value in base too large.",Ne.ValueBaseSmall="Value in base too small.",Ne.ValueBaseLong="Value in base too long.",Ne.NegativeLength="Length cannot be negative.",Ne.PatternNotFound="Pattern not found.",Ne.MatrixParams="Matrix function parameters are not compatible.",Ne.OneValue="Needs at least one value.",Ne.TwoValues="Range needs to contain at least two elements.",Ne.ThreeValues="Range needs to contain at least three elements.",Ne.IndexBounds="Index out of bounds.",Ne.IndexLarge="Index too large.",Ne.Formula="Expected formula.",Ne.NegativeCount="Count cannot be negative.",Ne.ParseError="Parsing error.",Ne.SheetRef="Sheet does not exist.",Ne.MatrixFunction="Matrix function not recognized.",Ne.PeriodLong="Period number cannot exceed life length.",Ne.InvalidDate="Invalid date.",Ne.BitshiftLong="Result of bitshift is too long.",Ne.EmptyString="Empty-string argument not allowed.",Ne.LengthBounds="Length out of bounds.",Ne.NegativeTime="Time cannot be negative.",Ne.NoDefault="No default option.",Ne.Selector="Selector cannot exceed the number of arguments.",Ne.StartEndDate="Start date needs to be earlier than end date.",Ne.IncorrectDateTime="String does not represent correct DateTime.",Ne.CharacterCodeBounds="Character code out of bounds.",Ne.NonZero="Argument cannot be 0.",Ne.LessThanOne="Argument cannot be less than 1.",Ne.WeekendString="Incorrect weekend bitmask string.",Ne.InvalidRoman="Invalid roman numeral.",Ne.WrongOrder="Wrong order of values.",Ne.ComplexNumberExpected="Complex number expected.",Ne.ShouldBeIorJ="Should be 'i' or 'j'.",Ne.FunctionName=function(e){return"Function name ".concat(e," not recognized.")},Ne.NamedExpressionName=function(e){return"Named expression ".concat(e," not recognized.")},Ne.LicenseKey=function(e){return"License key is ".concat(e,".")};var Ue=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Pe(e,t)}(n,e);var t=Le(n);function n(e,r){var o;return Me(this,n),(o=t.call(this,e.allTokens,{outputCst:!1,maxLookahead:7})).formula=o.RULE("formula",(function(){return o.CONSUME(A),o.SUBRULE(o.booleanExpression)})),o.booleanExpression=o.RULE("booleanExpression",(function(){var e=o.SUBRULE(o.concatenateExpression);return o.MANY((function(){var t,n,r,i=o.CONSUME(k),a=o.SUBRULE2(o.concatenateExpression);Object(g.tokenMatcher)(i,A)?(t=e,n=a,r=i.leadingWhitespace,e={type:le.EQUALS_OP,left:t,right:n,leadingWhitespace:null==r?void 0:r.image}):Object(g.tokenMatcher)(i,C)?e=function(e,t,n){return{type:le.NOT_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):Object(g.tokenMatcher)(i,M)?e=function(e,t,n){return{type:le.GREATER_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):Object(g.tokenMatcher)(i,x)?e=function(e,t,n){return{type:le.LESS_THAN_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):Object(g.tokenMatcher)(i,I)?e=function(e,t,n){return{type:le.GREATER_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):Object(g.tokenMatcher)(i,P)?e=function(e,t,n){return{type:le.LESS_THAN_OR_EQUAL_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):o.ACTION((function(){throw Error("Operator not supported")}))})),e})),o.booleanExpressionOrEmpty=o.RULE("booleanExpressionOrEmpty",(function(){return o.OR([{ALT:function(){return o.SUBRULE(o.booleanExpression)}},{ALT:Object(g.EMPTY_ALT)({type:le.EMPTY,leadingWhitespace:null==e?void 0:e.image})}]);var e})),o.concatenateExpression=o.RULE("concatenateExpression",(function(){var e=o.SUBRULE(o.additionExpression);return o.MANY((function(){var t,n,r,i=o.CONSUME(L),a=o.SUBRULE2(o.additionExpression);t=e,n=a,r=i.leadingWhitespace,e={type:le.CONCATENATE_OP,left:t,right:n,leadingWhitespace:null==r?void 0:r.image}})),e})),o.additionExpression=o.RULE("additionExpression",(function(){var e=o.SUBRULE(o.multiplicationExpression);return o.MANY((function(){var t,n,r,i=o.CONSUME(b),a=o.SUBRULE2(o.multiplicationExpression);Object(g.tokenMatcher)(i,E)?(t=e,n=a,r=i.leadingWhitespace,e={type:le.PLUS_OP,left:t,right:n,leadingWhitespace:null==r?void 0:r.image}):Object(g.tokenMatcher)(i,w)?e=function(e,t,n){return{type:le.MINUS_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):o.ACTION((function(){throw Error("Operator not supported")}))})),e})),o.multiplicationExpression=o.RULE("multiplicationExpression",(function(){var e=o.SUBRULE(o.powerExpression);return o.MANY((function(){var t,n,r,i=o.CONSUME(S),a=o.SUBRULE2(o.powerExpression);Object(g.tokenMatcher)(i,T)?(t=e,n=a,r=i.leadingWhitespace,e={type:le.TIMES_OP,left:t,right:n,leadingWhitespace:null==r?void 0:r.image}):Object(g.tokenMatcher)(i,O)?e=function(e,t,n){return{type:le.DIV_OP,left:e,right:t,leadingWhitespace:null==n?void 0:n.image}}(e,a,i.leadingWhitespace):o.ACTION((function(){throw Error("Operator not supported")}))})),e})),o.powerExpression=o.RULE("powerExpression",(function(){var e=o.SUBRULE(o.atomicExpression);return o.MANY((function(){var t,n,r,i=o.CONSUME(R),a=o.SUBRULE2(o.atomicExpression);Object(g.tokenMatcher)(i,R)?(t=e,n=a,r=i.leadingWhitespace,e={type:le.POWER_OP,left:t,right:n,leadingWhitespace:null==r?void 0:r.image}):o.ACTION((function(){throw Error("Operator not supported")}))})),e})),o.atomicExpression=o.RULE("atomicExpression",(function(){return o.OR([{ALT:function(){var e=o.CONSUME(b),t=o.SUBRULE(o.atomicExpression);return Object(g.tokenMatcher)(e,E)?function(e,t){return{type:le.PLUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}}(t,e.leadingWhitespace):Object(g.tokenMatcher)(e,w)?function(e,t){return{type:le.MINUS_UNARY_OP,value:e,leadingWhitespace:null==t?void 0:t.image}}(t,e.leadingWhitespace):(o.customParsingError=he(ce.ParserError,"Mismatched token type"),o.customParsingError)}},{ALT:function(){return o.SUBRULE2(o.rightUnaryOpAtomicExpression)}}])})),o.rightUnaryOpAtomicExpression=o.RULE("rightUnaryOpAtomicExpression",(function(){var e,t,n=o.SUBRULE(o.positiveAtomicExpression),r=o.OPTION((function(){return o.CONSUME(N)}));return r?(e=n,t=r.leadingWhitespace,{type:le.PERCENT_OP,value:e,leadingWhitespace:null==t?void 0:t.image}):n})),o.positiveAtomicExpression=o.RULE("positiveAtomicExpression",(function(){return o.OR(o.atomicExpCache||(o.atomicExpCache=[{ALT:function(){return o.SUBRULE(o.parenthesisExpression)}},{ALT:function(){return o.SUBRULE(o.cellRangeExpression)}},{ALT:function(){return o.SUBRULE(o.columnRangeExpression)}},{ALT:function(){return o.SUBRULE(o.rowRangeExpression)}},{ALT:function(){return o.SUBRULE(o.offsetExpression)}},{ALT:function(){return o.SUBRULE(o.cellReference)}},{ALT:function(){return o.SUBRULE(o.procedureExpression)}},{ALT:function(){return o.SUBRULE(o.namedExpressionExpression)}},{ALT:function(){var e,t,n=o.CONSUME(o.lexerConfig.NumberLiteral);return e=o.numericStringToNumber(n.image),t=n.leadingWhitespace,{type:le.NUMBER,value:e,leadingWhitespace:null==t?void 0:t.image}}},{ALT:function(){var e,t,n=o.CONSUME(W);return e=n,{type:le.STRING,value:e.image.slice(1,-1),leadingWhitespace:null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image}}},{ALT:function(){var e=o.CONSUME($),t=e.image.toUpperCase(),n=o.lexerConfig.errorMapping[t];return n?ve(new Ho(n),e.leadingWhitespace):o.parsingError(ce.ParserError,"Unknown error literal")}}]))})),o.procedureExpression=o.RULE("procedureExpression",(function(){var e,t=o.CONSUME(G),n=t.image.toUpperCase().slice(0,-1),r=null!==(e=o.lexerConfig.functionMapping[n])&&void 0!==e?e:n,i=[],a=o.SUBRULE(o.booleanExpressionOrEmpty);o.MANY((function(){var e,t=o.CONSUME(o.lexerConfig.ArgSeparator);a.type===le.EMPTY&&(a.leadingWhitespace=null===(e=t.leadingWhitespace)||void 0===e?void 0:e.image),i.push(a),a=o.SUBRULE2(o.booleanExpressionOrEmpty)})),i.push(a),1===i.length&&i[0].type===le.EMPTY&&(i.length=0);var s=o.CONSUME(H);return function(e,t,n,r){return{type:le.FUNCTION_CALL,procedureName:e,args:t,leadingWhitespace:null==n?void 0:n.image,internalWhitespace:null==r?void 0:r.image}}(r,i,t.leadingWhitespace,s.leadingWhitespace)})),o.namedExpressionExpression=o.RULE("namedExpressionExpression",(function(){var e,t,n=o.CONSUME(z);return e=n.image,t=n.leadingWhitespace,{type:le.NAMED_EXPRESSION,expressionName:e,leadingWhitespace:null==t?void 0:t.image}})),o.offsetExpression=o.RULE("offsetExpression",(function(){var e,t=o.SUBRULE(o.offsetProcedureExpression);return o.OPTION((function(){o.CONSUME(B),e=t.type===le.CELL_RANGE?o.parsingError(ce.RangeOffsetNotAllowed,"Range offset not allowed here"):o.SUBRULE(o.endOfRangeWithOffsetStartExpression,{ARGS:[t]})})),void 0!==e?e:t})),o.offsetProcedureExpression=o.RULE("offsetProcedureExpression",(function(){var e=[];return o.CONSUME(o.lexerConfig.OffsetProcedureName),o.CONSUME(V),o.MANY_SEP({SEP:o.lexerConfig.ArgSeparator,DEF:function(){e.push(o.SUBRULE(o.booleanExpression))}}),o.CONSUME(H),o.handleOffsetHeuristic(e)})),o.cellRangeExpression=o.RULE("cellRangeExpression",(function(){var e=o.CONSUME(D);return o.CONSUME2(B),o.SUBRULE(o.endOfRangeExpression,{ARGS:[e]})})),o.columnRangeExpression=o.RULE("columnRangeExpression",(function(){var e=o.CONSUME(U),t=Ae(e.image.split(":"),2),n=t[0],r=t[1],i=o.ACTION((function(){return ne(o.sheetMapping,n,o.formulaAddress)})),a=o.ACTION((function(){return ne(o.sheetMapping,r,o.formulaAddress)}));if(void 0===i||void 0===a)return ve(new Ho(Mo.REF));if(i.exceedsSheetSizeLimits(o.lexerConfig.maxColumns)||a.exceedsSheetSizeLimits(o.lexerConfig.maxColumns))return ye(e.image,new Ho(Mo.NAME),e.leadingWhitespace);if(null===i.sheet&&null!==a.sheet)return o.parsingError(ce.ParserError,"Malformed range expression");var s=o.rangeSheetReferenceType(i.sheet,a.sheet);return null!==i.sheet&&null===a.sheet&&(a=a.withAbsoluteSheet(i.sheet)),function(e,t,n,r){return be(e,t,n),{type:le.COLUMN_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}}(i,a,s,e.leadingWhitespace)})),o.rowRangeExpression=o.RULE("rowRangeExpression",(function(){var e=o.CONSUME(j),t=Ae(e.image.split(":"),2),n=t[0],r=t[1],i=o.ACTION((function(){return re(o.sheetMapping,n,o.formulaAddress)})),a=o.ACTION((function(){return re(o.sheetMapping,r,o.formulaAddress)}));if(void 0===i||void 0===a)return ve(new Ho(Mo.REF));if(i.exceedsSheetSizeLimits(o.lexerConfig.maxRows)||a.exceedsSheetSizeLimits(o.lexerConfig.maxRows))return ye(e.image,new Ho(Mo.NAME),e.leadingWhitespace);if(null===i.sheet&&null!==a.sheet)return o.parsingError(ce.ParserError,"Malformed range expression");var s=o.rangeSheetReferenceType(i.sheet,a.sheet);return null!==i.sheet&&null===a.sheet&&(a=a.withAbsoluteSheet(i.sheet)),function(e,t,n,r){return be(e,t,n),{type:le.ROW_RANGE,start:e,end:t,sheetReferenceType:n,leadingWhitespace:null==r?void 0:r.image}}(i,a,s,e.leadingWhitespace)})),o.cellReference=o.RULE("cellReference",(function(){var e=o.CONSUME(D),t=o.ACTION((function(){return te(o.sheetMapping,e.image,o.formulaAddress)}));return void 0===t?ye(e.image,new Ho(Mo.REF),e.leadingWhitespace):t.exceedsSheetSizeLimits(o.lexerConfig.maxColumns,o.lexerConfig.maxRows)?ye(e.image,new Ho(Mo.NAME),e.leadingWhitespace):de(t,e.leadingWhitespace)})),o.endOfRangeExpression=o.RULE("endOfRangeExpression",(function(e){return o.OR([{ALT:function(){return o.SUBRULE(o.endRangeReference,{ARGS:[e]})}},{ALT:function(){var t,n=o.SUBRULE(o.offsetProcedureExpression),r=o.ACTION((function(){return te(o.sheetMapping,e.image,o.formulaAddress)}));if(void 0===r)return ve(new Ho(Mo.REF));if(n.type===le.CELL_REFERENCE){var i=n.reference,a=fe.RELATIVE;return null!==r.sheet&&(a=fe.START_ABSOLUTE,i=i.withAbsoluteSheet(r.sheet)),me(r,i,a,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)}return o.parsingError(ce.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),o.endOfRangeWithOffsetStartExpression=o.RULE("endOfRangeWithOffsetStartExpression",(function(e){return o.OR([{ALT:function(){return o.SUBRULE(o.endRangeWithOffsetStartReference,{ARGS:[e]})}},{ALT:function(){var t=o.SUBRULE(o.offsetProcedureExpression);if(t.type===le.CELL_REFERENCE){var n=t.reference,r=fe.RELATIVE;return null!==e.reference.sheet&&(r=fe.START_ABSOLUTE,n=n.withAbsoluteSheet(e.reference.sheet)),me(e.reference,n,r,e.leadingWhitespace)}return o.parsingError(ce.RangeOffsetNotAllowed,"Range offset not allowed here")}}])})),o.endRangeReference=o.RULE("endRangeReference",(function(e){var t,n=o.CONSUME(D),r=o.ACTION((function(){return te(o.sheetMapping,e.image,o.formulaAddress)})),i=o.ACTION((function(){return te(o.sheetMapping,n.image,o.formulaAddress)}));return void 0===r||void 0===i?o.ACTION((function(){return ye("".concat(e.image,":").concat(n.image),new Ho(Mo.REF),e.leadingWhitespace)})):r.exceedsSheetSizeLimits(o.lexerConfig.maxColumns,o.lexerConfig.maxRows)||i.exceedsSheetSizeLimits(o.lexerConfig.maxColumns,o.lexerConfig.maxRows)?o.ACTION((function(){return ye("".concat(e.image,":").concat(n.image),new Ho(Mo.NAME),e.leadingWhitespace)})):o.buildCellRange(r,i,null===(t=e.leadingWhitespace)||void 0===t?void 0:t.image)})),o.endRangeWithOffsetStartReference=o.RULE("endRangeWithOffsetStartReference",(function(e){var t=o.CONSUME(D),n=o.ACTION((function(){return te(o.sheetMapping,t.image,o.formulaAddress)}));return void 0===n?o.ACTION((function(){return ve(new Ho(Mo.REF))})):o.buildCellRange(e.reference,n,e.leadingWhitespace)})),o.parenthesisExpression=o.RULE("parenthesisExpression",(function(){var e=o.CONSUME(V),t=o.SUBRULE(o.booleanExpression),n=o.CONSUME(H);return function(e,t,n){return{type:le.PARENTHESIS,expression:e,leadingWhitespace:null==t?void 0:t.image,internalWhitespace:null==n?void 0:n.image}}(t,e.leadingWhitespace,n.leadingWhitespace)})),o.numericStringToNumber=function(e){var t=e.replace(o.lexerConfig.decimalSeparator,".");return Number(t)},o.lexerConfig=e,o.sheetMapping=r,o.formulaAddress=Yo(0,0,0),o.performSelfAnalysis(),o}return Ie(n,[{key:"parseFromTokens",value:function(e,t){this.input=e;var n=this.formulaWithContext(t),r=[];return this.customParsingError&&r.push(this.customParsingError),(r=r.concat(this.errors.map((function(e){return{type:ce.ParserError,message:e.message}})))).length>0&&(n=ge()),{ast:n,errors:r}}},{key:"formulaWithContext",value:function(e){return this.formulaAddress=e,this.formula()}},{key:"reset",value:function(){_e(De(n.prototype),"reset",this).call(this),this.customParsingError=void 0}},{key:"buildCellRange",value:function(e,t,n){if(null===e.sheet&&null!==t.sheet)return this.parsingError(ce.ParserError,"Malformed range expression");var r=this.rangeSheetReferenceType(e.sheet,t.sheet);return null!==e.sheet&&null===t.sheet&&(t=t.withAbsoluteSheet(e.sheet)),me(e,t,r,n)}},{key:"handleOffsetHeuristic",value:function(e){var t=e[0];if(t.type!==le.CELL_REFERENCE)return this.parsingError(ce.StaticOffsetError,"First argument to OFFSET is not a reference");var n,r=e[1];if(r.type===le.NUMBER&&Number.isInteger(r.value))n=r.value;else if(r.type===le.PLUS_UNARY_OP&&r.value.type===le.NUMBER&&Number.isInteger(r.value.value))n=r.value.value;else{if(r.type!==le.MINUS_UNARY_OP||r.value.type!==le.NUMBER||!Number.isInteger(r.value.value))return this.parsingError(ce.StaticOffsetError,"Second argument to OFFSET is not a static number");n=-r.value.value}var i,a=e[2];if(a.type===le.NUMBER&&Number.isInteger(a.value))i=a.value;else if(a.type===le.PLUS_UNARY_OP&&a.value.type===le.NUMBER&&Number.isInteger(a.value.value))i=a.value.value;else{if(a.type!==le.MINUS_UNARY_OP||a.value.type!==le.NUMBER||!Number.isInteger(a.value.value))return this.parsingError(ce.StaticOffsetError,"Third argument to OFFSET is not a static number");i=-a.value.value}var s,u=e[3];if(void 0===u)s=1;else{if(u.type!==le.NUMBER)return this.parsingError(ce.StaticOffsetError,"Fourth argument to OFFSET is not a static number");if((s=u.value)<1)return this.parsingError(ce.StaticOffsetError,"Fourth argument to OFFSET is too small number");if(!Number.isInteger(s))return this.parsingError(ce.StaticOffsetError,"Fourth argument to OFFSET is not integer")}var c,l=e[4];if(void 0===l)c=1;else{if(l.type!==le.NUMBER)return this.parsingError(ce.StaticOffsetError,"Fifth argument to OFFSET is not a static number");if((c=l.value)<1)return this.parsingError(ce.StaticOffsetError,"Fifth argument to OFFSET is too small number");if(!Number.isInteger(c))return this.parsingError(ce.StaticOffsetError,"Fifth argument to OFFSET is not integer")}var f=new m(null,t.reference.col+i,t.reference.row+n,t.reference.type),h=f.col,p=f.row;if(t.reference.type!==o.CELL_REFERENCE_RELATIVE&&t.reference.type!==o.CELL_REFERENCE_ABSOLUTE_COL||(p+=this.formulaAddress.row),t.reference.type!==o.CELL_REFERENCE_RELATIVE&&t.reference.type!==o.CELL_REFERENCE_ABSOLUTE_ROW||(h+=this.formulaAddress.col),h<0||p<0)return ve(new Ho(Mo.REF,Ne.OutOfSheet));if(1===c&&1===s)return de(f);var d=new m(null,f.col+c-1,f.row+s-1,f.type);return me(f,d,fe.RELATIVE)}},{key:"parsingError",value:function(e,t){return this.customParsingError=he(e,t),ge()}},{key:"rangeSheetReferenceType",value:function(e,t){return null===e?fe.RELATIVE:null===t?fe.START_ABSOLUTE:fe.BOTH_ABSOLUTE}}]),n}(g.EmbeddedActionsParser),je=function(){function e(t){Me(this,e),this.lexerConfig=t,this.lexer=new g.Lexer(t.allTokens,{ensureOptimizations:!0})}return Ie(e,[{key:"tokenizeFormula",value:function(e){var t=this.lexer.tokenize(e),n=t.tokens;return n=this.trimTrailingWhitespaces(n),n=this.skipWhitespacesInsideRanges(n),n=this.skipWhitespacesBeforeArgSeparators(n),t.tokens=n,t}},{key:"skipWhitespacesInsideRanges",value:function(e){return this.filterTokensByNeighbors(e,(function(e,t,n){return(Object(g.tokenMatcher)(e,D)||Object(g.tokenMatcher)(e,B))&&Object(g.tokenMatcher)(t,Y)&&(Object(g.tokenMatcher)(n,D)||Object(g.tokenMatcher)(n,B))}))}},{key:"skipWhitespacesBeforeArgSeparators",value:function(e){var t=this;return this.filterTokensByNeighbors(e,(function(e,n,r){return!Object(g.tokenMatcher)(e,t.lexerConfig.ArgSeparator)&&Object(g.tokenMatcher)(n,Y)&&Object(g.tokenMatcher)(r,t.lexerConfig.ArgSeparator)}))}},{key:"filterTokensByNeighbors",value:function(e,t){if(e.length<3)return e;for(var n=0,r=[e[n++]];n<e.length-1;)t(e[n-1],e[n],e[n+1])||r.push(e[n]),++n;return r.push(e[n]),r}},{key:"trimTrailingWhitespaces",value:function(e){return e.length>0&&Object(g.tokenMatcher)(e[e.length-1],Y)&&e.pop(),e}}]),e}();function Be(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ve=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.lexerConfig=n,this.sheetMappingFn=r,this.namedExpressions=o}var t,n,r;return t=e,(n=[{key:"unparse",value:function(e,t){return"="+this.unparseAst(e,t)}},{key:"unparseAst",value:function(e,t){var n,r,o=this;switch(e.type){case le.EMPTY:return Ee("",e.leadingWhitespace);case le.NUMBER:return Ee(He(e.value,this.config.decimalSeparator),e.leadingWhitespace);case le.STRING:return Ee('"'+e.value+'"',e.leadingWhitespace);case le.FUNCTION_CALL:var i=e.args.map((function(e){return void 0!==e?o.unparseAst(e,t):""})).join(this.config.functionArgSeparator),a=(this.config.translationPackage.isFunctionTranslated(e.procedureName)?this.config.translationPackage.getFunctionTranslation(e.procedureName):e.procedureName)+"("+i+Ee(")",e.internalWhitespace);return Ee(a,e.leadingWhitespace);case le.NAMED_EXPRESSION:return Ee((null===(n=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet))||void 0===n?void 0:n.displayName)||e.expressionName,e.leadingWhitespace);case le.CELL_REFERENCE:var s;return s=null!==e.reference.sheet?this.unparseSheetName(e.reference.sheet)+"!":"",Ee(s+=null!==(r=e.reference.unparse(t))&&void 0!==r?r:this.config.translationPackage.getErrorTranslation(Mo.REF),e.leadingWhitespace);case le.COLUMN_RANGE:case le.ROW_RANGE:case le.CELL_RANGE:return Ee(this.formatRange(e,t),e.leadingWhitespace);case le.PLUS_UNARY_OP:var u=this.unparseAst(e.value,t);return Ee("+",e.leadingWhitespace)+u;case le.MINUS_UNARY_OP:var c=this.unparseAst(e.value,t);return Ee("-",e.leadingWhitespace)+c;case le.PERCENT_OP:return this.unparseAst(e.value,t)+Ee("%",e.leadingWhitespace);case le.ERROR:return Ee(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:Mo.ERROR),e.leadingWhitespace);case le.ERROR_WITH_RAW_INPUT:return Ee(e.rawInput,e.leadingWhitespace);case le.PARENTHESIS:var l="("+this.unparseAst(e.expression,t)+Ee(")",e.internalWhitespace);return Ee(l,e.leadingWhitespace);default:var f=this.unparseAst(e.left,t),h=this.unparseAst(e.right,t);return f+Ee(Se[e.type],e.leadingWhitespace)+h}}},{key:"unparseSheetName",value:function(e){var t=se(e,this.sheetMappingFn);if(void 0===t)throw new Sn(e);return t}},{key:"formatRange",value:function(e,t){var n="",r="";null!==e.start.sheet&&e.sheetReferenceType!==fe.RELATIVE&&(n=this.unparseSheetName(e.start.sheet)+"!"),null!==e.end.sheet&&e.sheetReferenceType===fe.BOTH_ABSOLUTE&&(r=this.unparseSheetName(e.end.sheet)+"!");var o=e.start.unparse(t),i=e.end.unparse(t);return void 0===o||void 0===i?this.config.translationPackage.getErrorTranslation(Mo.REF):"".concat(n).concat(o,":").concat(r).concat(i)}}])&&Be(t.prototype,n),r&&Be(t,r),e}();function He(e,t){return e.toString().replace(".",t)}function Ge(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ze(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ze(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ze(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function We(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $e=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functionRegistry=n,this.sheetMapping=r,this.statsCacheUsed=0,this.lexerConfig=K(t),this.lexer=new je(this.lexerConfig),this.formulaParser=new Ue(this.lexerConfig,this.sheetMapping),this.cache=new Oe(this.functionRegistry)}var t,n,r;return t=e,(n=[{key:"parse",value:function(e,t){var n=this.lexer.tokenizeFormula(e);if(n.errors.length>0){var r=n.errors.map((function(e){return{type:ce.LexingError,message:e.message}}));return{ast:ge(),errors:r,hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]}}var o=this.computeHashFromTokens(n.tokens,t),i=this.cache.get(o);if(i)++this.statsCacheUsed;else{var a=function(e){var t=[],n=e[0];Object(g.tokenMatcher)(n,Y)||t.push(n);for(var r=1;r<e.length;++r){var o=e[r];if(!Object(g.tokenMatcher)(o,Y)){var i=e[r-1];Object(g.tokenMatcher)(i,Y)&&(o.leadingWhitespace=i),t.push(o)}}return t}(n.tokens),s=this.formulaParser.parseFromTokens(a,t);if(s.errors.length>0)return Object.assign(Object.assign({},s),{hasVolatileFunction:!1,hasStructuralChangeFunction:!1,dependencies:[]});i=this.cache.set(o,s.ast)}var u=i;return{ast:u.ast,errors:[],hasVolatileFunction:u.hasVolatileFunction,hasStructuralChangeFunction:u.hasStructuralChangeFunction,dependencies:u.relativeDependencies}}},{key:"fetchCachedResultForAst",value:function(e){var t=this.computeHashFromAst(e);return this.fetchCachedResult(t)}},{key:"fetchCachedResult",value:function(e){var t=this.cache.get(e);if(null===t)throw new Error("There is no AST with such key in the cache");return{ast:t.ast,errors:[],hasVolatileFunction:t.hasVolatileFunction,hasStructuralChangeFunction:t.hasStructuralChangeFunction,dependencies:t.relativeDependencies}}},{key:"computeHashFromTokens",value:function(e,t){for(var n,r="",o=0;o<e.length;){var i=e[o];if(Object(g.tokenMatcher)(i,D)){var a=te(this.sheetMapping,i.image,t);r=void 0===a?r.concat(i.image):r.concat(a.hash(!0))}else if(Object(g.tokenMatcher)(i,G)){var s=i.image.toUpperCase().slice(0,-1),u=null!==(n=this.lexerConfig.functionMapping[s])&&void 0!==n?n:s;r=r.concat(u,"(")}else if(Object(g.tokenMatcher)(i,U)){var c=Ge(i.image.split(":"),2),l=c[0],f=c[1],h=ne(this.sheetMapping,l,t),p=ne(this.sheetMapping,f,t);r=void 0===h||void 0===p?r.concat("!REF"):r.concat(h.hash(!0),":",p.hash(!0))}else if(Object(g.tokenMatcher)(i,j)){var d=Ge(i.image.split(":"),2),m=d[0],v=d[1],y=re(this.sheetMapping,m,t),b=re(this.sheetMapping,v,t);r=void 0===y||void 0===b?r.concat("!REF"):r.concat(y.hash(!0),":",b.hash(!0))}else r=r.concat(i.image);o++}return r}},{key:"rememberNewAst",value:function(e){var t=this.computeHashFromAst(e);return this.cache.maybeSetAndThenGet(t,e)}},{key:"computeHashFromAst",value:function(e){return"="+this.computeHashOfAstNode(e)}},{key:"destroy",value:function(){this.cache.destroy()}},{key:"computeHashOfAstNode",value:function(e){var t=this;switch(e.type){case le.EMPTY:return e.leadingWhitespace||"";case le.NUMBER:return Ee(He(e.value,this.config.decimalSeparator),e.leadingWhitespace);case le.STRING:return Ee('"'+e.value+'"',e.leadingWhitespace);case le.NAMED_EXPRESSION:return Ee(e.expressionName,e.leadingWhitespace);case le.FUNCTION_CALL:var n=e.args.map((function(e){return t.computeHashOfAstNode(e)})).join(this.config.functionArgSeparator),r=e.procedureName+"("+n+Ee(")",e.internalWhitespace);return Ee(r,e.leadingWhitespace);case le.CELL_REFERENCE:return Ee(e.reference.hash(!0),e.leadingWhitespace);case le.COLUMN_RANGE:case le.ROW_RANGE:case le.CELL_RANGE:return Ee(e.start.hash(e.sheetReferenceType!==fe.RELATIVE)+":"+e.end.hash(e.sheetReferenceType===fe.BOTH_ABSOLUTE),e.leadingWhitespace);case le.MINUS_UNARY_OP:return Ee("-"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case le.PLUS_UNARY_OP:return Ee("+"+this.computeHashOfAstNode(e.value),e.leadingWhitespace);case le.PERCENT_OP:return this.computeHashOfAstNode(e.value)+Ee("%",e.leadingWhitespace);case le.ERROR:return Ee(this.config.translationPackage.getErrorTranslation(e.error?e.error.type:Mo.ERROR),e.leadingWhitespace);case le.ERROR_WITH_RAW_INPUT:return Ee(e.rawInput,e.leadingWhitespace);case le.PARENTHESIS:var o="("+this.computeHashOfAstNode(e.expression)+Ee(")",e.internalWhitespace);return Ee(o,e.leadingWhitespace);default:return this.computeHashOfAstNode(e.left)+Ee(Se[e.type],e.leadingWhitespace)+this.computeHashOfAstNode(e.right)}}}])&&We(t.prototype,n),r&&We(t,r),e}();var Ye=function(e,t){var n=new Array;return function e(t,n,r,o){switch(t.type){case le.EMPTY:case le.NUMBER:case le.STRING:case le.ERROR:return;case le.NAMED_EXPRESSION:return void(o&&r.push(new tt(t.expressionName)));case le.CELL_REFERENCE:return void(o&&r.push(new Je(t.reference)));case le.CELL_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new Qe(t.start,t.end)));case le.COLUMN_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new Ze(t.start,t.end)));case le.ROW_RANGE:return void(o&&t.start.sheet===t.end.sheet&&r.push(new et(t.start,t.end)));case le.PERCENT_OP:case le.PLUS_UNARY_OP:case le.MINUS_UNARY_OP:return void e(t.value,n,r,!0);case le.CONCATENATE_OP:case le.EQUALS_OP:case le.NOT_EQUAL_OP:case le.LESS_THAN_OP:case le.GREATER_THAN_OP:case le.LESS_THAN_OR_EQUAL_OP:case le.GREATER_THAN_OR_EQUAL_OP:case le.MINUS_OP:case le.PLUS_OP:case le.TIMES_OP:case le.DIV_OP:case le.POWER_OP:return e(t.left,n,r,!0),void e(t.right,n,r,!0);case le.PARENTHESIS:return void e(t.expression,n,r,o);case le.FUNCTION_CALL:var i=!n.doesFunctionNeedArgumentToBeComputed(t.procedureName);return void t.args.forEach((function(t){return e(t,n,r,i)}))}}(e,t,n,!0),n};function Ke(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function qe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Xe(e,t,n){return t&&qe(e.prototype,t),n&&qe(e,n),e}var Je=function(){function e(t){Ke(this,e),this.dependency=t}return Xe(e,[{key:"absolutize",value:function(e){return this.dependency.toSimpleCellAddress(e)}}]),e}(),Qe=function(){function e(t,n){Ke(this,e),this.start=t,this.end=n}return Xe(e,[{key:"absolutize",value:function(e){return new yt(this.start.toSimpleCellAddress(e),this.end.toSimpleCellAddress(e))}}]),e}(),Ze=function(){function e(t,n){Ke(this,e),this.start=t,this.end=n}return Xe(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleColumnAddress(e),n=this.end.toSimpleColumnAddress(e);return new gt(t.sheet,t.col,n.col)}}]),e}(),et=function(){function e(t,n){Ke(this,e),this.start=t,this.end=n}return Xe(e,[{key:"absolutize",value:function(e){var t=this.start.toSimpleRowAddress(e),n=this.end.toSimpleRowAddress(e);return new bt(t.sheet,t.row,n.row)}}]),e}(),tt=function(){function e(t){Ke(this,e),this.name=t}return Xe(e,[{key:"absolutize",value:function(e){return this}}]),e}();function nt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ot(e,t,n){return t&&rt(e.prototype,t),n&&rt(e,n),e}var it=function(){function e(t,n,r){if(nt(this,e),this.sheet=t,this.rowStart=n,this.rowEnd=r,n<0)throw Error("Starting row cant be less than 0");if(r<n)throw Error("Row span cant end before start")}return ot(e,[{key:"numberOfRows",get:function(){return this.rowEnd-this.rowStart+1}},{key:"rows",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.rowStart;case 1:if(!(t<=this.rowEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.rowStart,t.rowStart),r=Math.min(this.rowEnd,t.rowEnd);return n>r?null:new e(this.sheet,n,r)}},{key:"firstRow",value:function(){return new e(this.sheet,this.rowStart,this.rowStart)}},{key:"start",get:function(){return this.rowStart}},{key:"end",get:function(){return this.rowEnd}}],[{key:"fromNumberOfRows",value:function(t,n,r){return new e(t,n,n+r-1)}},{key:"fromRowStartAndEnd",value:function(t,n,r){return new e(t,n,r)}}]),e}(),at=function(){function e(t,n,r){if(nt(this,e),this.sheet=t,this.columnStart=n,this.columnEnd=r,n<0)throw Error("Starting column cant be less than 0");if(r<n)throw Error("Column span cant end before start")}return ot(e,[{key:"numberOfColumns",get:function(){return this.columnEnd-this.columnStart+1}},{key:"columns",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.columnStart;case 1:if(!(t<=this.columnEnd)){e.next=7;break}return e.next=4,t;case 4:++t,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"intersect",value:function(t){if(this.sheet!==t.sheet)throw Error("Can't intersect spans from different sheets");var n=Math.max(this.columnStart,t.columnStart),r=Math.min(this.columnEnd,t.columnEnd);return n>r?null:new e(this.sheet,n,r)}},{key:"firstColumn",value:function(){return new e(this.sheet,this.columnStart,this.columnStart)}},{key:"start",get:function(){return this.columnStart}},{key:"end",get:function(){return this.columnEnd}}],[{key:"fromNumberOfColumns",value:function(t,n,r){return new e(t,n,n+r-1)}},{key:"fromColumnStartAndEnd",value:function(t,n,r){return new e(t,n,r)}}]),e}();function st(e){return(st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ct(e,t)}function ct(e,t){return(ct=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function lt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ht(e);if(t){var o=ht(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ft(this,n)}}function ft(e,t){return!t||"object"!==st(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ht(e){return(ht=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function pt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mt(e,t,n){return t&&dt(e.prototype,t),n&&dt(e,n),e}var vt="AbsoluteCellRange: Start and end are in different sheets",yt=function(){function e(t,n){if(pt(this,e),t.sheet!==n.sheet)throw new Error(vt);this.start=Yo(t.sheet,t.col,t.row),this.end=Yo(n.sheet,n.col,n.row)}return mt(e,[{key:"sheet",get:function(){return this.start.sheet}},{key:"isFinite",value:function(){return Number.isFinite(this.size())}},{key:"doesOverlap",value:function(e){return this.start.sheet==e.start.sheet&&(!(this.end.row<e.start.row||this.start.row>e.end.row)&&!(this.end.col<e.start.col||this.start.col>e.end.col))}},{key:"addressInRange",value:function(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row&&this.start.col<=e.col&&this.end.col>=e.col)}},{key:"columnInRange",value:function(e){return this.sheet===e.sheet&&(this.start.col<=e.col&&this.end.col>=e.col)}},{key:"rowInRange",value:function(e){return this.sheet===e.sheet&&(this.start.row<=e.row&&this.end.row>=e.row)}},{key:"containsRange",value:function(e){return this.addressInRange(e.start)&&this.addressInRange(e.end)}},{key:"intersectionWith",value:function(t){if(this.sheet!==t.start.sheet)return null;var n=Math.max(this.start.row,t.start.row),r=Math.min(this.end.row,t.end.row),o=Math.max(this.start.col,t.start.col),i=Math.min(this.end.col,t.end.col);return n>r||o>i?null:new e(Yo(this.sheet,o,n),Yo(this.sheet,i,r))}},{key:"includesRow",value:function(e){return this.start.row<e&&this.end.row>=e}},{key:"includesColumn",value:function(e){return this.start.col<e&&this.end.col>=e}},{key:"shiftByRows",value:function(e){this.start.row+=e,this.end.row+=e}},{key:"expandByRows",value:function(e){this.end.row+=e}},{key:"shiftByColumns",value:function(e){this.start.col+=e,this.end.col+=e}},{key:"shifted",value:function(t,n){return e.spanFrom(Yo(this.sheet,this.start.col+t,this.start.row+n),this.width(),this.height())}},{key:"expandByColumns",value:function(e){this.end.col+=e}},{key:"moveToSheet",value:function(e){this.start.sheet=e,this.end.sheet=e}},{key:"removeSpan",value:function(e){e instanceof it?this.removeRows(e.start,e.end):this.removeColumns(e.start,e.end)}},{key:"removeRows",value:function(e,t){if(!(e>this.end.row)){if(t<this.start.row){var n=t-e+1;return this.shiftByRows(-n)}e<=this.start.row&&(this.start.row=e),this.end.row-=Math.min(t,this.end.row)-e+1}}},{key:"removeColumns",value:function(e,t){if(!(e>this.end.col)){if(t<this.start.col){var n=t-e+1;return this.shiftByColumns(-n)}e<=this.start.col&&(this.start.col=e),this.end.col-=Math.min(t,this.end.col)-e+1}}},{key:"shouldBeRemoved",value:function(){return this.width()<=0||this.height()<=0}},{key:"rangeWithSameWidth",value:function(t,n){return e.spanFrom(Yo(this.sheet,this.start.col,t),this.width(),n)}},{key:"rangeWithSameHeight",value:function(t,n){return e.spanFrom(Yo(this.sheet,t,this.start.row),n,this.height())}},{key:"toString",value:function(){return"".concat(this.start.sheet,",").concat(this.start.col,",").concat(this.start.row,",").concat(this.end.col,",").concat(this.end.row)}},{key:"width",value:function(){return this.end.col-this.start.col+1}},{key:"height",value:function(){return this.end.row-this.start.row+1}},{key:"size",value:function(){return this.height()*this.width()}},{key:"arrayOfAddressesInRange",value:function(){for(var e=[],t=0;t<this.height();++t){e[t]=[];for(var n=0;n<this.width();++n){var r=Yo(this.sheet,this.start.col+n,this.start.row+t);e[t].push(r)}}return e}},{key:"withStart",value:function(t){return new e(t,this.end)}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}},{key:"addresses",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.start.row;case 1:if(!(n<=this.effectiveEndRow(t))){e.next=12;break}r=this.start.col;case 3:if(!(r<=this.effectiveEndColumn(t))){e.next=9;break}return e.next=6,Yo(this.start.sheet,r,n);case 6:r++,e.next=3;break;case 9:n++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"addressesWithDirection",value:regeneratorRuntime.mark((function e(t,n,r){var o,i,a,s,u,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>0)){e.next=30;break}if(!(n>0)){e.next=16;break}o=this.effectiveEndRow(r);case 3:if(!(o>=this.start.row)){e.next=14;break}i=this.effectiveEndColumn(r);case 5:if(!(i>=this.start.col)){e.next=11;break}return e.next=8,Yo(this.start.sheet,i,o);case 8:i-=1,e.next=5;break;case 11:o-=1,e.next=3;break;case 14:e.next=28;break;case 16:a=this.start.row;case 17:if(!(a<=this.effectiveEndRow(r))){e.next=28;break}s=this.effectiveEndColumn(r);case 19:if(!(s>=this.start.col)){e.next=25;break}return e.next=22,Yo(this.start.sheet,s,a);case 22:s-=1,e.next=19;break;case 25:a+=1,e.next=17;break;case 28:e.next=57;break;case 30:if(!(n>0)){e.next=45;break}u=this.effectiveEndRow(r);case 32:if(!(u>=this.start.row)){e.next=43;break}c=this.start.col;case 34:if(!(c<=this.effectiveEndColumn(r))){e.next=40;break}return e.next=37,Yo(this.start.sheet,c,u);case 37:c+=1,e.next=34;break;case 40:u-=1,e.next=32;break;case 43:e.next=57;break;case 45:l=this.start.row;case 46:if(!(l<=this.effectiveEndRow(r))){e.next=57;break}f=this.start.col;case 48:if(!(f<=this.effectiveEndColumn(r))){e.next=54;break}return e.next=51,Yo(this.start.sheet,f,l);case 51:f+=1,e.next=48;break;case 54:l+=1,e.next=46;break;case 57:case"end":return e.stop()}}),e,this)}))},{key:"getAddress",value:function(e,t){if(e<0||t<0||t>this.height()-1||e>this.width()-1)throw Error("Index out of bound");return Yo(this.start.sheet,this.start.col+e,this.start.row+t)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e||this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return this.end.col}},{key:"effectiveEndRow",value:function(e){return this.end.row}}],[{key:"fromAst",value:function(t,n){return t.type===le.CELL_RANGE?e.fromCellRange(t,n):t.type===le.COLUMN_RANGE?gt.fromColumnRange(t,n):bt.fromRowRange(t,n)}},{key:"fromCellRange",value:function(t,n){return new e(new m(t.start.sheet,t.start.col,t.start.row,t.start.type).toSimpleCellAddress(n),new m(t.end.sheet,t.end.col,t.end.row,t.end.type).toSimpleCellAddress(n))}},{key:"spanFrom",value:function(t,n,r){if(!Number.isFinite(n)&&Number.isFinite(r))return new bt(t.sheet,t.row,t.row+r-1);if(!Number.isFinite(r)&&Number.isFinite(n))return new gt(t.sheet,t.col,t.col+n-1);if(Number.isFinite(r)&&Number.isFinite(n))return new e(t,Yo(t.sheet,t.col+n-1,t.row+r-1));throw new Error("AbsoluteCellRange: Wrong range size")}},{key:"fromCoordinates",value:function(t,n,r,o,i){return new e(Yo(t,n,r),Yo(t,o,i))}},{key:"singleRangeFromCellAddress",value:function(t,n){var r=t.toSimpleCellAddress(n);return new e(r,r)}}]),e}(),gt=function(e){ut(n,e);var t=lt(n);function n(e,r,o){return pt(this,n),t.call(this,Yo(e,r,0),Yo(e,o,Number.POSITIVE_INFINITY))}return mt(n,[{key:"shouldBeRemoved",value:function(){return this.width()<=0}},{key:"shiftByRows",value:function(e){}},{key:"expandByRows",value:function(e){}},{key:"shifted",value:function(e,t){return new n(this.sheet,this.start.col+e,this.end.col+e)}},{key:"removeRows",value:function(e,t){}},{key:"rangeWithSameHeight",value:function(e,t){return new n(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.col>=e}},{key:"effectiveEndRow",value:function(e){return e.getSheetHeight(this.sheet)-1}}],[{key:"fromColumnRange",value:function(e,t){var r=e.start.toSimpleColumnAddress(t),o=e.end.toSimpleColumnAddress(t);if(r.sheet!==o.sheet)throw new Error(vt);return new n(r.sheet,r.col,o.col)}}]),n}(yt),bt=function(e){ut(n,e);var t=lt(n);function n(e,r,o){return pt(this,n),t.call(this,Yo(e,0,r),Yo(e,Number.POSITIVE_INFINITY,o))}return mt(n,[{key:"shouldBeRemoved",value:function(){return this.height()<=0}},{key:"shiftByColumns",value:function(e){}},{key:"expandByColumns",value:function(e){}},{key:"shifted",value:function(e,t){return new n(this.sheet,this.start.row+t,this.end.row+t)}},{key:"removeColumns",value:function(e,t){}},{key:"rangeWithSameWidth",value:function(e,t){return new n(this.sheet,e,e+t-1)}},{key:"exceedsSheetSizeLimits",value:function(e,t){return this.end.row>=t}},{key:"effectiveEndColumn",value:function(e){return e.getSheetWidth(this.sheet)-1}}],[{key:"fromRowRange",value:function(e,t){var r=e.start.toSimpleRowAddress(t),o=e.end.toSimpleRowAddress(t);if(r.sheet!==o.sheet)throw new Error(vt);return new n(r.sheet,r.row,o.row)}}]),n}(yt),Et=(n("TeQF"),function(e,t){return e.map((function(e){return e.absolutize(t)}))});function wt(e){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function St(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Tt(e,t)}function Tt(e,t){return(Tt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ot(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Nt(e);if(t){var o=Nt(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Rt(this,n)}}function Rt(e,t){return!t||"object"!==wt(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Nt(e){return(Nt=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function kt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function At(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ct(e,t,n){return t&&At(e.prototype,t),n&&At(e,n),e}var Mt=Symbol("Empty value");function xt(e){return e instanceof It?e.val:e}var It=function(){function e(t,n){kt(this,e),this.val=t,this.format=n}return Ct(e,[{key:"fromNumber",value:function(e){return new this.constructor(e)}}]),e}();function _t(e,t){if("number"==typeof e)return t;var n=e.fromNumber(t);return n.format=e.format,n}var Pt,Lt=function(e){St(n,e);var t=Ot(n);function n(){return kt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getDetailedType",value:function(){return Pt.NUMBER_DATE}}]),n}(It),Ft=function(e){St(n,e);var t=Ot(n);function n(){return kt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getDetailedType",value:function(){return Pt.NUMBER_CURRENCY}}]),n}(It),Dt=function(e){St(n,e);var t=Ot(n);function n(){return kt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getDetailedType",value:function(){return Pt.NUMBER_TIME}}]),n}(It),Ut=function(e){St(n,e);var t=Ot(n);function n(){return kt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getDetailedType",value:function(){return Pt.NUMBER_DATETIME}}]),n}(It),jt=function(e){St(n,e);var t=Ot(n);function n(){return kt(this,n),t.apply(this,arguments)}return Ct(n,[{key:"getDetailedType",value:function(){return Pt.NUMBER_PERCENT}}]),n}(It);function Bt(e){return"number"==typeof e||e instanceof It}function Vt(e){return e instanceof It?{type:e.getDetailedType(),format:e.format}:{type:Pt.NUMBER_RAW}}function Ht(e){return function(e){if(Array.isArray(e))return Wt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||zt(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Gt(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=zt(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function zt(e,t){if(e){if("string"==typeof e)return Wt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Wt(e,t):void 0}}function Wt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Kt(e,t,n){return t&&Yt(e.prototype,t),n&&Yt(e,n),e}!function(e){e.NUMBER_RAW="NUMBER_RAW",e.NUMBER_DATE="NUMBER_DATE",e.NUMBER_TIME="NUMBER_TIME",e.NUMBER_DATETIME="NUMBER_DATETIME",e.NUMBER_CURRENCY="NUMBER_CURRENCY",e.NUMBER_PERCENT="NUMBER_PERCENT"}(Pt||(Pt={}));var qt,Xt=function(){function e(t,n,r){$t(this,e),this.size=t,this.data=n,this._hasOnlyNumbers=r}return Kt(e,[{key:"range",value:function(){}},{key:"hasOnlyNumbers",value:function(){return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"valuesFromTopLeftCorner",value:function(){for(var e=[],t=0;t<this.size.height;t++)for(var n=0;n<this.size.width;n++)e.push(this.data[t][n]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.size.height)){e.next=12;break}n=0;case 3:if(!(n<this.size.width)){e.next=9;break}return e.next=6,this.data[t][n];case 6:n++,e.next=3;break;case 9:t++,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"raw",value:function(){return this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}}]),e}(),Jt=function(){function e(t,n,r){$t(this,e),this.size=t,this._range=n,this.dependencyGraph=r}return Kt(e,[{key:"raw",value:function(){return this.ensureThatComputed(),this.data}},{key:"rawNumbers",value:function(){if(this.hasOnlyNumbers())return this.data;throw new Error("Data is not only numbers")}},{key:"hasOnlyNumbers",value:function(){if(this.ensureThatComputed(),void 0===this._hasOnlyNumbers){var e,t=Gt(this.iterateValuesFromTopLeftCorner());try{for(t.s();!(e=t.n()).done;){if("number"!=typeof e.value){this._hasOnlyNumbers=!1;break}}}catch(e){t.e(e)}finally{t.f()}this._hasOnlyNumbers=!0}return this._hasOnlyNumbers}},{key:"topLeftCorner",value:function(){if(void 0!==this.data&&this.size.height>0&&this.size.width>0)return this.data[0][0]}},{key:"range",value:function(){return this._range}},{key:"valuesFromTopLeftCorner",value:function(){this.ensureThatComputed();for(var e=[],t=0;t<this.data.length;t++)for(var n=0;n<this.data[0].length;n++)e.push(this.data[t][n]);return e}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.ensureThatComputed(),t=0;case 2:if(!(t<this.data.length)){e.next=13;break}n=0;case 4:if(!(n<this.data[0].length)){e.next=10;break}return e.next=7,this.data[t][n];case 7:n++,e.next=4;break;case 10:t++,e.next=2;break;case 13:case"end":return e.stop()}}),e,this)}))},{key:"ensureThatComputed",value:function(){void 0===this.data&&(this.data=this.computeDataFromDependencyGraph())}},{key:"computeDataFromDependencyGraph",value:function(){var e,t=[],n=0,r=[],o=Gt(this._range.addresses(this.dependencyGraph));try{for(o.s();!(e=o.n()).done;){var i=e.value,a=this.dependencyGraph.getCellValue(i);a instanceof Qt?r.push(new Ho(Mo.VALUE,Ne.ScalarExpected)):Bt(a)?r.push(a):(r.push(a),this._hasOnlyNumbers=!1),++n%this.size.width==0&&(n=0,t.push(Ht(r)),r=[])}}catch(e){o.e(e)}finally{o.f()}return t}}]),e}(),Qt=function(){function e(t,n){$t(this,e),this.data=t,this._range=n}return Kt(e,[{key:"size",get:function(){return this.data.size}},{key:"width",value:function(){return this.data.size.width}},{key:"height",value:function(){return this.data.size.height}},{key:"raw",value:function(){return this.data.raw()}},{key:"topLeftCornerValue",value:function(){return this.data.topLeftCorner()}},{key:"valuesFromTopLeftCorner",value:function(){return this.data.valuesFromTopLeftCorner()}},{key:"iterateValuesFromTopLeftCorner",value:regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.data.iterateValuesFromTopLeftCorner(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"numberOfElements",value:function(){return this.data.size.width*this.data.size.height}},{key:"hasOnlyNumbers",value:function(){return this.data.hasOnlyNumbers()}},{key:"rawNumbers",value:function(){return this.data.rawNumbers()}},{key:"range",value:function(){var e;return null!==(e=this._range)&&void 0!==e?e:this.data.range()}},{key:"sameDimensionsAs",value:function(e){return this.width()===e.width()&&this.height()===e.height()}}],[{key:"onlyNumbersDataWithRange",value:function(t,n,r){return new e(new Xt(n,t,!0),r)}},{key:"onlyNumbersDataWithoutRange",value:function(t,n){return new e(new Xt(n,t,!0))}},{key:"onlyRange",value:function(t,n){return new e(new Jt({width:t.width(),height:t.height()},t,n))}},{key:"fromScalar",value:function(t){var n=Bt(t);return new e(new Xt({width:1,height:1},[[t]],n))}}]),e}();function Zt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.BUILD_ENGINE_TOTAL="BUILD_ENGINE_TOTAL",e.PARSER="PARSER",e.GRAPH_BUILD="GRAPH_BUILD",e.TOP_SORT="TOP_SORT",e.MATRIX_DETECTION="MATRIX_DETECTION",e.BUILD_COLUMN_INDEX="BUILD_COLUMN_INDEX",e.EVALUATION="EVALUATION",e.VLOOKUP="VLOOKUP",e.TRANSFORM_ASTS="TRANSFORM_ASTS",e.TRANSFORM_ASTS_POSTPONED="TRANSFORM_ASTS_POSTPONED",e.ADJUSTING_ADDRESS_MAPPING="ADJUSTING_ADDRESS_MAPPING",e.ADJUSTING_MATRIX_MAPPING="ADJUSTING_MATRIX_MAPPING",e.ADJUSTING_RANGES="ADJUSTING_RANGES",e.ADJUSTING_GRAPH="ADJUSTING_GRAPH",e.CRITERION_FUNCTION_FULL_CACHE_USED="CRITERION_FUNCTION_FULL_CACHE_USED",e.CRITERION_FUNCTION_PARTIAL_CACHE_USED="CRITERION_FUNCTION_PARTIAL_CACHE_USED"}(qt||(qt={}));var en=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=new Map([[qt.CRITERION_FUNCTION_FULL_CACHE_USED,0],[qt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0]]),this.startTimes=new Map}var t,n,r;return t=e,(n=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){var e=(this.stats.get(qt.CRITERION_FUNCTION_FULL_CACHE_USED)||0)+1;this.stats.set(qt.CRITERION_FUNCTION_FULL_CACHE_USED,e)}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){var e=(this.stats.get(qt.CRITERION_FUNCTION_PARTIAL_CACHE_USED)||0)+1;this.stats.set(qt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,e)}},{key:"reset",value:function(){this.stats.clear(),this.startTimes.clear(),this.stats.set(qt.CRITERION_FUNCTION_FULL_CACHE_USED,0),this.stats.set(qt.CRITERION_FUNCTION_PARTIAL_CACHE_USED,0)}},{key:"start",value:function(e){if(this.startTimes.get(e))throw Error("Statistics ".concat(e," already started"));this.startTimes.set(e,Date.now())}},{key:"end",value:function(e){var t=Date.now(),n=this.startTimes.get(e);if(!n)throw Error("Statistics ".concat(e," not started"));var r=this.stats.get(e)||0;r+=t-n,this.stats.set(e,r),this.startTimes.delete(e)}},{key:"measure",value:function(e,t){this.start(e);var n=t();return this.end(e),n}},{key:"snapshot",value:function(){return new Map(this.stats)}},{key:"destroy",value:function(){this.stats.clear(),this.startTimes.clear()}}])&&Zt(t.prototype,n),r&&Zt(t,r),e}();function tn(e){return(tn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function on(e,t){return(on=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function an(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=un(e);if(t){var o=un(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return sn(this,n)}}function sn(e,t){return!t||"object"!==tn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function un(e){return(un=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&on(e,t)}(i,e);var t,n,r,o=an(i);function i(){return nn(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"incrementCriterionFunctionFullCacheUsed",value:function(){}},{key:"incrementCriterionFunctionPartialCacheUsed",value:function(){}},{key:"start",value:function(e){}},{key:"end",value:function(e){}}])&&rn(t.prototype,n),r&&rn(t,r),i}(en);n("yyme");function ln(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function fn(e,t,n){return t&&ln(e.prototype,t),n&&ln(e,n),e}function hn(e){return(hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pn(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dn(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}function mn(e){var t=bn();return function(){var n,r=wn(e);if(t){var o=wn(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vn(this,n)}}function vn(e,t){return!t||"object"!==hn(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yn(e){var t="function"==typeof Map?new Map:void 0;return(yn=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return gn(e,arguments,wn(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),En(r,e)})(e)}function gn(e,t,n){return(gn=bn()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var o=new(Function.bind.apply(e,r));return n&&En(o,n.prototype),o}).apply(null,arguments)}function bn(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function wn(e){return(wn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"There's no sheet with id = ".concat(e))}return n}(yn(Error)),Tn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"There's no sheet with name '".concat(e,"'"))}return n}(yn(Error)),On=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Sheet with name ".concat(e," already exists"))}return n}(yn(Error)),Rn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Sheet size limit exceeded")}return n}(yn(Error)),Nn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"This is not a formula")}return n}(yn(Error)),kn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Address (row = ".concat(e.row,", col = ").concat(e.col,") is invalid"))}return n}(yn(Error)),An=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Invalid arguments, expected ".concat(e))}return n}(yn(Error)),Cn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Name of Named Expression '".concat(e,"' is already present"))}return n}(yn(Error)),Mn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Name of Named Expression '".concat(e,"' is invalid"))}return n}(yn(Error)),xn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Named Expression '".concat(e,"' does not exist"))}return n}(yn(Error)),In=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"There is no operation to undo")}return n}(yn(Error)),_n=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"There is no operation to redo")}return n}(yn(Error)),Pn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"There is nothing to paste")}return n}(yn(Error));function Ln(e,t){switch(hn(t)){case"function":case"symbol":return t.toString();case"bigint":return"BigInt("+t.toString()+")";default:return t instanceof RegExp?"RegExp("+t.toString()+")":t}}var Fn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Unable to parse value: ".concat(JSON.stringify(e,Ln,4)))}return n}(yn(Error)),Dn=function(e){dn(n,e);var t=mn(n);function n(e,r){return pn(this,n),t.call(this,"Expected value of type: ".concat(e," for config parameter: ").concat(r))}return n}(yn(Error)),Un=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Config parameter ".concat(e," cannot be empty."))}return n}(yn(Error)),jn=function(e){dn(n,e);var t=mn(n);function n(e,r){return pn(this,n),t.call(this,"Config parameter ".concat(e," should be at least ").concat(r))}return n}(yn(Error)),Bn=function(e){dn(n,e);var t=mn(n);function n(e,r){return pn(this,n),t.call(this,"Config parameter ".concat(e," should be at most ").concat(r))}return n}(yn(Error)),Vn=function(e){dn(n,e);var t=mn(n);function n(e,r){return pn(this,n),t.call(this,"Expected one of ".concat(e," for config parameter: ").concat(r))}return n}(yn(Error)),Hn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Computations are suspended")}return n}(yn(Error)),Gn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Translation for ".concat(e," is missing in the translation package you're using."))}return n}(yn(Error)),zn=function(e){dn(n,e);var t=mn(n);function n(e){return pn(this,n),t.call(this,"Cannot register translation for function with id: ".concat(e))}return n}(yn(Error)),Wn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Language not registered.")}return n}(yn(Error)),$n=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Language already registered.")}return n}(yn(Error)),Yn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.apply(this,arguments)}return fn(n,null,[{key:"functionNotDeclaredInPlugin",value:function(e,t){return new n("Function with id ".concat(e," not declared in plugin ").concat(t))}},{key:"functionMethodNotFound",value:function(e,t){return new n("Function method ".concat(e," not found in plugin ").concat(t))}}]),n}(yn(Error)),Kn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.apply(this,arguments)}return fn(n,null,[{key:"cannotRegisterFunctionWithId",value:function(e){return new n("Cannot register function with id ".concat(e))}},{key:"cannotUnregisterFunctionWithId",value:function(e){return new n("Cannot unregister function with id ".concat(e))}},{key:"cannotUnregisterProtectedPlugin",value:function(){return new n("Cannot unregister protected plugin")}}]),n}(yn(Error)),qn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Cannot perform this operation, source location has a matrix inside.")}return n}(yn(Error)),Xn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Cannot perform this operation, target location has a matrix inside.")}return n}(yn(Error)),Jn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Matrix formulas are not supported in named expressions.")}return n}(yn(Error)),Qn=function(e){dn(n,e);var t=mn(n);function n(){return pn(this,n),t.call(this,"Relative addresses not allowed in named expressions.")}return n}(yn(Error)),Zn=function(e){dn(n,e);var t=mn(n);function n(e,r){return pn(this,n),t.call(this,"Alias id ".concat(e," in plugin ").concat(r," already defined as a function or alias."))}return n}(yn(Error));function er(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||nr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=nr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function nr(e,t){if(e){if("string"==typeof e)return rr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rr(e,t):void 0}}function rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function or(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ir=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.policy=t,this.mapping=new Map}var t,n,r;return t=e,(n=[{key:"getCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new Sn(e.sheet);return t.getCell(e)}},{key:"fetchCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw new Sn(e.sheet);var n=t.getCell(e);if(!n)throw Error("Vertex for address missing in AddressMapping");return n}},{key:"strategyFor",value:function(e){var t=this.mapping.get(e);if(!t)throw new Sn(e);return t}},{key:"addSheet",value:function(e,t){if(this.mapping.has(e))throw Error("Sheet already added");this.mapping.set(e,t)}},{key:"autoAddSheet",value:function(e,t,n){var r=n.height,o=n.width,i=n.fill,a=this.policy.call(i);this.addSheet(e,new a(o,r))}},{key:"getCellValue",value:function(e){var t=this.getCell(e);return null===t?Mt:t instanceof Or?t.getMatrixCellValue(e):t.getCellValue()}},{key:"getRawValue",value:function(e){var t=this.getCell(e);return t instanceof go?t.getValues().rawValue:t instanceof Or?t.getMatrixCellRawValue(e):null}},{key:"setCell",value:function(e,t){var n=this.mapping.get(e.sheet);if(!n)throw Error("Sheet not initialized");n.setCell(e,t)}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet not initialized");t.removeCell(e)}},{key:"has",value:function(e){var t=this.mapping.get(e.sheet);return!!t&&t.has(e)}},{key:"getHeight",value:function(e){var t=this.mapping.get(e);if(!t)throw new Sn(e);return t.getHeight()}},{key:"getWidth",value:function(e){var t=this.mapping.get(e);if(!t)throw new Sn(e);return t.getWidth()}},{key:"addRows",value:function(e,t,n){var r=this.mapping.get(e);if(!r)throw Error("Sheet does not exist");r.addRows(t,n)}},{key:"removeRows",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeRows(e)}},{key:"removeSheet",value:function(e){this.mapping.delete(e)}},{key:"addColumns",value:function(e,t,n){var r=this.mapping.get(e);if(!r)throw Error("Sheet does not exist");r.addColumns(t,n)}},{key:"removeColumns",value:function(e){var t=this.mapping.get(e.sheet);if(!t)throw Error("Sheet does not exist");t.removeColumns(e)}},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).verticesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.mapping.get(t.sheet).entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entries",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=tr(this.mapping.entries()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=8;break}return r=er(n.value,2),o=r[0],i=r[1],e.delegateYield(i.getEntries(o),"t0",6);case 6:e.next=3;break;case 8:e.next=13;break;case 10:e.prev=10,e.t1=e.catch(1),t.e(e.t1);case 13:return e.prev=13,t.f(),e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[1,10,13,16]])}))},{key:"sheetEntries",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.mapping.get(t))){e.next=5;break}return e.delegateYield(n.getEntries(t),"t0",3);case 3:e.next=6;break;case 5:throw new Error("Sheet does not exists");case 6:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.mapping.clear()}}])&&or(t.prototype,n),r&&or(t,r),e}();function ar(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return sr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return sr(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function sr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ur(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cr=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formula=t,this.cellAddress=n,this.version=r,this.formula=t,this.cellAddress=n,this.cachedCellValue=null}var t,n,r;return t=e,(n=[{key:"getFormula",value:function(e){return this.ensureRecentData(e),this.formula}},{key:"ensureRecentData",value:function(e){if(this.version!=e.version()){var t=ar(e.applyTransformations(this.formula,this.address,this.version),3),n=t[0],r=t[1],o=t[2];this.formula=n,this.cellAddress=r,this.version=o}}},{key:"getAddress",value:function(e){return this.ensureRecentData(e),this.cellAddress}},{key:"address",get:function(){return this.cellAddress}},{key:"setCellValue",value:function(e){this.cachedCellValue=e}},{key:"getCellValue",value:function(){if(null!==this.cachedCellValue)return this.cachedCellValue;throw Error("Value of the formula cell is not computed.")}},{key:"valueOrNull",value:function(){return this.cachedCellValue}},{key:"isComputed",value:function(){return null!==this.cachedCellValue}}])&&ur(t.prototype,n),r&&ur(t,r),e}();n("pDQq");function lr(e){return function(e){if(Array.isArray(e))return hr(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||fr(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fr(e,t){if(e){if("string"==typeof e)return hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?hr(e,t):void 0}}function hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dr(e,t,n){return t&&pr(e.prototype,t),n&&pr(e,n),e}function mr(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var vr=function e(t,n){if(mr(this,e),this.width=t,this.height=n,t<=0||n<=0)throw Error("Incorrect matrix size")};function yr(e){return new vr(e.height,e.width)}function gr(e,t){return new vr(t.width,e.height)}function br(e,t,n){return new vr(1+(e.width-t)/n,1+(e.height-t)/n)}var Er=function(){function e(t){mr(this,e),this.size=t}return dr(e,[{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"get",value:function(e,t){throw Error("Matrix not computed yet.")}}]),e}(),wr=function(){function e(t){mr(this,e),this.size=new vr(t.length>0?t[0].length:0,t.length),this.matrix=t}return dr(e,[{key:"addRows",value:function(e,t){var n;(n=this.matrix).splice.apply(n,[e,0].concat(lr(this.zeroArrays(t,this.width())))),this.size.height+=t}},{key:"addColumns",value:function(e,t){for(var n=0;n<this.height();n++){var r;(r=this.matrix[n]).splice.apply(r,[e,0].concat(lr(new Array(t).fill(0))))}this.size.width+=t}},{key:"removeRows",value:function(e,t){if(this.outOfBound(0,e)||this.outOfBound(0,t))throw Error("Matrix index out of bound");var n=t-e+1;this.matrix.splice(e,n),this.size.height-=n}},{key:"removeColumns",value:function(e,t){if(this.outOfBound(e,0)||this.outOfBound(t,0))throw Error("Matrix index out of bound");var n,r=t-e+1,o=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=fr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.matrix);try{for(o.s();!(n=o.n()).done;){n.value.splice(e,r)}}catch(e){o.e(e)}finally{o.f()}this.size.width-=r}},{key:"zeroArrays",value:function(e,t){for(var n=[],r=0;r<e;++r)n.push(new Array(t).fill(0));return n}},{key:"get",value:function(e,t){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");return this.matrix[t][e]}},{key:"set",value:function(e,t,n){if(this.outOfBound(e,t))throw Error("Matrix index out of bound");this.matrix[t][e]=n}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}},{key:"raw",value:function(){return this.matrix}},{key:"generateValues",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.size.height)){e.next=12;break}r=0;case 3:if(!(r<this.size.width)){e.next=9;break}return e.next=6,[this.matrix[n][r],Yo(t.sheet,t.col+r,t.row+n)];case 6:++r,e.next=3;break;case 9:++n,e.next=1;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"outOfBound",value:function(e,t){return e<0||t<0||t>this.size.height-1||e>this.size.width-1}}]),e}(),Sr=function(){function e(t,n){mr(this,e),this.error=t,this.size=n}return dr(e,[{key:"get",value:function(e,t){return this.error}},{key:"width",value:function(){return this.size.width}},{key:"height",value:function(){return this.size.height}}]),e}();function Tr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Or=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cellAddress=t,this.formula=o||null,this.matrix=new Er(new vr(n,r))}var t,n,r;return t=e,r=[{key:"fromRange",value:function(t,n){return new e(t.start,t.width(),t.height(),n)}}],(n=[{key:"width",get:function(){return this.matrix.width()}},{key:"height",get:function(){return this.matrix.height()}},{key:"sheet",get:function(){return this.cellAddress.sheet}},{key:"setCellValue",value:function(e){this.matrix=e}},{key:"setErrorValue",value:function(e){this.matrix=new Sr(e,this.matrix.size)}},{key:"getCellValue",value:function(){if(this.matrix instanceof Er)throw Error("Matrix not computed yet.");return this.matrix}},{key:"getMatrixCellValue",value:function(e){var t=e.col-this.cellAddress.col,n=e.row-this.cellAddress.row;return this.matrix.get(t,n)}},{key:"getMatrixCellRawValue",value:function(e){var t=this.getMatrixCellValue(e);return t instanceof Ho?void 0:t}},{key:"setMatrixCellValue",value:function(e,t){var n=e.col-this.cellAddress.col,r=e.row-this.cellAddress.row;this.matrix instanceof wr&&this.matrix.set(n,r,t)}},{key:"getRange",value:function(){return yt.spanFrom(this.cellAddress,this.width,this.height)}},{key:"getAddress",value:function(){return this.cellAddress}},{key:"setAddress",value:function(e){this.cellAddress=e}},{key:"getFormula",value:function(){return this.formula}},{key:"setFormula",value:function(e){this.formula=e}},{key:"isFormula",value:function(){return null!==this.formula}},{key:"isNumeric",value:function(){return null===this.formula}},{key:"spansThroughSheetRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.row<=n&&t<this.cellAddress.row+this.height}},{key:"spansThroughSheetColumn",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;return this.cellAddress.sheet===e&&this.cellAddress.col<=n&&t<this.cellAddress.col+this.width}},{key:"addRows",value:function(e,t,n){this.matrix instanceof wr&&this.matrix.addRows(t-this.getAddress().row,n)}},{key:"addColumns",value:function(e,t,n){this.matrix instanceof wr&&this.matrix.addColumns(t-this.getAddress().col,n)}},{key:"removeRows",value:function(e){if(this.matrix instanceof wr){var t=this.rowsFromMatrix().intersect(e);this.matrix.removeRows(t.rowStart-this.getAddress().row,t.rowEnd-this.getAddress().row)}}},{key:"removeColumns",value:function(e){if(this.matrix instanceof wr){var t=this.columnsFromMatrix().intersect(e);this.matrix.removeColumns(t.columnStart-this.getAddress().col,t.columnEnd-this.getAddress().col)}}},{key:"isComputed",value:function(){return!(this.matrix instanceof Er)}},{key:"columnsFromMatrix",value:function(){return at.fromNumberOfColumns(this.cellAddress.sheet,this.cellAddress.col,this.width)}},{key:"rowsFromMatrix",value:function(){return it.fromNumberOfRows(this.cellAddress.sheet,this.cellAddress.row,this.height)}}])&&Tr(t.prototype,n),r&&Tr(t,r),e}();function Rr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Nr,kr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.range=t,this.functionCache=new Map,this.criterionFunctionCache=new Map,this.dependentCacheRanges=new Set,this.bruteForce=!1}var t,n,r;return t=e,(n=[{key:"start",get:function(){return this.range.start}},{key:"end",get:function(){return this.range.end}},{key:"sheet",get:function(){return this.range.start.sheet}},{key:"getFunctionValue",value:function(e){return this.functionCache.get(e)||null}},{key:"setFunctionValue",value:function(e,t){this.functionCache.set(e,t)}},{key:"getCriterionFunctionValue",value:function(e,t){var n=this.getCriterionFunctionValues(e).get(t);return n?n[0]:null}},{key:"getCriterionFunctionValues",value:function(e){return this.criterionFunctionCache.get(e)||new Map}},{key:"setCriterionFunctionValues",value:function(e,t){this.criterionFunctionCache.set(e,t)}},{key:"addDependentCacheRange",value:function(e){e!==this&&this.dependentCacheRanges.add(e)}},{key:"clearCache",value:function(){this.functionCache.clear(),this.criterionFunctionCache.clear(),this.dependentCacheRanges.forEach((function(e){return e.criterionFunctionCache.clear()})),this.dependentCacheRanges.clear()}},{key:"getStart",value:function(){return this.start}},{key:"getEnd",value:function(){return this.end}}])&&Rr(t.prototype,n),r&&Rr(t,r),e}(),Ar=function(e,t,n,r,o){var i,a,s=n.getRange();if(t instanceof kr){var u=t.range.intersectionWith(s);return null!==u?Array.from(u.addresses(o)):[]}if(t instanceof cr)i=t.getFormula(r),a=t.getAddress(r);else{if(!(t instanceof Or&&t.isFormula()))return[];i=t.getFormula(),a=t.getAddress()}return Ye(i,e).filter((function(e){return e instanceof Je})).map((function(e){return e.dependency.toSimpleCellAddress(a)})).filter((function(e){return s.addressInRange(e)}))};n("Junv");function Cr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Mr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e[e.ON_STACK=0]="ON_STACK",e[e.PROCESSED=1]="PROCESSED",e[e.POPPED=2]="POPPED"}(Nr||(Nr={}));var Ir=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyQuery=t,this.nodes=new Set,this.specialNodes=new Set,this.specialNodesStructuralChanges=new Set,this.specialNodesRecentlyChanged=new Set,this.infiniteRanges=new Set,this.edges=new Map}var t,n,r;return t=e,(n=[{key:"addNode",value:function(e){this.nodes.add(e),this.edges.has(e)||this.edges.set(e,new Set)}},{key:"addEdge",value:function(e,t){if(!this.nodes.has(e))throw new Error("Unknown node ".concat(e));if(!this.nodes.has(t))throw new Error("Unknown node ".concat(t));this.edges.get(e).add(t)}},{key:"removeEdge",value:function(e,t){if(!this.existsEdge(e,t))throw new Error("Edge does not exist");this.edges.get(e).delete(t)}},{key:"softRemoveEdge",value:function(e,t){var n;null===(n=this.edges.get(e))||void 0===n||n.delete(t)}},{key:"removeIncomingEdges",value:function(e){this.edges.forEach((function(t){t.delete(e)}))}},{key:"adjacentNodes",value:function(e){return this.edges.get(e)}},{key:"adjacentNodesCount",value:function(e){return this.adjacentNodes(e).size}},{key:"hasNode",value:function(e){return this.nodes.has(e)}},{key:"nodesCount",value:function(){return this.nodes.size}},{key:"edgesCount",value:function(){var e=0;return this.edges.forEach((function(t){return e+=t.size})),e}},{key:"removeNode",value:function(e){var t,n=Cr(this.adjacentNodes(e).values());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.markNodeAsSpecialRecentlyChanged(r)}}catch(e){n.e(e)}finally{n.f()}return this.edges.delete(e),this.nodes.delete(e),this.specialNodes.delete(e),this.specialNodesRecentlyChanged.delete(e),this.specialNodesStructuralChanges.delete(e),this.infiniteRanges.delete(e),this.removeDependencies(e)}},{key:"markNodeAsSpecial",value:function(e){this.specialNodes.add(e)}},{key:"markNodeAsSpecialRecentlyChanged",value:function(e){this.nodes.has(e)&&this.specialNodesRecentlyChanged.add(e)}},{key:"markNodeAsChangingWithStructure",value:function(e){this.specialNodesStructuralChanges.add(e)}},{key:"clearSpecialNodesRecentlyChanged",value:function(){this.specialNodesRecentlyChanged.clear()}},{key:"markNodeAsInfiniteRange",value:function(e){this.infiniteRanges.add(e)}},{key:"existsEdge",value:function(e,t){var n,r;return null!==(r=null===(n=this.edges.get(e))||void 0===n?void 0:n.has(t))&&void 0!==r&&r}},{key:"topSortWithScc",value:function(){return this.getTopSortedWithSccSubgraphFrom(Array.from(this.nodes),(function(e){return!0}),(function(e){}))}},{key:"getTopSortedWithSccSubgraphFrom",value:function(e,t,n){var r=this,o=new Map,i=new Map,a=new Map,s=new Set,u=new Map,c=[],l=0,f=new Set;e.reverse(),e.forEach((function(e){if(void 0===u.get(e)){var t=[e],n=[];u.set(e,Nr.ON_STACK);for(var h=function(){var e=t[t.length-1];switch(u.get(e)){case Nr.ON_STACK:o.set(e,l),i.set(e,l),n.push(e),l++,r.adjacentNodes(e).forEach((function(n){void 0===o.get(n)&&(t.push(n),a.set(n,e),u.set(n,Nr.ON_STACK))})),u.set(e,Nr.PROCESSED);break;case Nr.PROCESSED:var h;if(h=o.get(e),r.adjacentNodes(e).forEach((function(t){s.has(t)||(h=a.get(t)===e?Math.min(h,i.get(t)):Math.min(h,o.get(t)))})),i.set(e,h),h===o.get(e)){var p=[];do{p.push(n[n.length-1]),n.pop()}while(p[p.length-1]!==e);p.forEach((function(e){s.add(e)})),c.push.apply(c,p),p.length>1&&p.forEach((function(e){f.add(e)}))}t.pop(),u.set(e,Nr.POPPED);break;case Nr.POPPED:t.pop()}};t.length>0;)h()}}));var h=new Set(e),p=[],d=[];return c.reverse(),c.forEach((function(e){f.has(e)||r.adjacentNodes(e).has(e)?(d.push(e),n(e),r.adjacentNodes(e).forEach((function(e){return h.add(e)}))):(p.push(e),h.has(e)&&t(e)&&r.adjacentNodes(e).forEach((function(e){return h.add(e)})))})),{sorted:p,cycled:d}}},{key:"getDependencies",value:function(e){var t=[];return this.edges.forEach((function(n,r){n.has(e)&&t.push(r)})),t}},{key:"destroy",value:function(){this.edges.clear(),this.nodes.clear(),this.specialNodes.clear(),this.specialNodesStructuralChanges.clear(),this.clearSpecialNodesRecentlyChanged()}},{key:"removeDependencies",value:function(e){var t=this.dependencyQuery(e);if(!t)return[];var n,r=Cr(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;this.softRemoveEdge(o,e)}}catch(e){r.e(e)}finally{r.f()}return t}}])&&xr(t.prototype,n),r&&xr(t,r),e}();function _r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Lr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Lr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Lr(e,t){if(e){if("string"==typeof e)return Fr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fr(e,t):void 0}}function Fr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Ur=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.matrixMapping=new Map}var t,n,r;return t=e,(n=[{key:"getMatrix",value:function(e){return this.matrixMapping.get(e.toString())}},{key:"setMatrix",value:function(e,t){this.matrixMapping.set(e.toString(),t)}},{key:"removeMatrix",value:function(e){this.matrixMapping.delete(e.toString())}},{key:"isFormulaMatrixInRow",value:function(e,t){var n,r=Pr(this.matrixMapping.values());try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.spansThroughSheetRows(e,t)&&o.isFormula())return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInRows",value:function(e){var t,n=Pr(e.rows());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.isFormulaMatrixInRow(e.sheet,r))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInColumn",value:function(e,t){var n,r=Pr(this.matrixMapping.values());try{for(r.s();!(n=r.n()).done;){var o=n.value;if(o.spansThroughSheetColumn(e,t)&&o.isFormula())return!0}}catch(e){r.e(e)}finally{r.f()}return!1}},{key:"isFormulaMatrixInColumns",value:function(e){var t,n=Pr(e.columns());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(this.isFormulaMatrixInColumn(e.sheet,r))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixInRange",value:function(e){var t,n=Pr(this.matrixMapping.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.isFormula()&&r.getRange().doesOverlap(e))return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"isFormulaMatrixAtAddress",value:function(e){var t,n=Pr(this.matrixMapping.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.getRange().addressInRange(e)&&r.isFormula())return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"numericMatrices",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Pr(this.matrixMapping.entries()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(r=_r(n.value,2),o=r[0],(i=r[1]).isFormula()){e.next=8;break}return e.next=8,[o,i];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRows",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Pr(this.matrixMapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=_r(r.value,2),i=o[0],!(a=o[1]).spansThroughSheetRows(t.sheet,t.rowStart,t.rowEnd)||a.isFormula()){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInColumns",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Pr(this.matrixMapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=_r(r.value,2),i=o[0],!(a=o[1]).spansThroughSheetColumn(t.sheet,t.columnStart,t.columnEnd)||a.isFormula()){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"numericMatricesInRange",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Pr(this.matrixMapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=_r(r.value,2),i=o[0],!(a=o[1]).getRange().doesOverlap(t)){e.next=8;break}return e.next=8,[i,a];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"truncateMatricesByRows",value:function(e){var t,n=Array(),r=Pr(this.numericMatricesInRows(e));try{for(r.s();!(t=r.n()).done;){var o=_r(t.value,2),i=o[0],a=o[1];a.removeRows(e),0===a.height&&(this.removeMatrix(i),n.push(a))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"truncateMatricesByColumns",value:function(e){var t,n=Array(),r=Pr(this.numericMatricesInColumns(e));try{for(r.s();!(t=r.n()).done;){var o=_r(t.value,2),i=o[0],a=o[1];a.removeColumns(e),0===a.width&&(this.removeMatrix(i),n.push(a))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"destroy",value:function(){this.matrixMapping.clear()}}])&&Dr(t.prototype,n),r&&Dr(t,r),e}();n("ToJy");function jr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Vr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Br(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Vr(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Vr(e,t){if(e){if("string"==typeof e)return Hr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Hr(e,t):void 0}}function Hr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var zr=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.rangeMapping=new Map}var t,n,r;return t=e,(n=[{key:"getMappingSize",value:function(e){var t,n;return null!==(n=null===(t=this.rangeMapping.get(e))||void 0===t?void 0:t.size)&&void 0!==n?n:0}},{key:"setRange",value:function(e){var t=this.rangeMapping.get(e.getStart().sheet);void 0===t&&(t=new Map,this.rangeMapping.set(e.getStart().sheet,t));var n=Wr(e.getStart(),e.getEnd());t.set(n,e)}},{key:"removeRange",value:function(e){var t=e.getStart().sheet,n=this.rangeMapping.get(t);if(void 0!==n){var r=Wr(e.getStart(),e.getEnd());n.delete(r),0===n.size&&this.rangeMapping.delete(t)}}},{key:"getRange",value:function(e,t){var n=this.rangeMapping.get(e.sheet),r=Wr(e,t);return null==n?void 0:n.get(r)}},{key:"fetchRange",value:function(e,t){var n=this.getRange(e,t);if(!n)throw Error("Range does not exist");return n}},{key:"truncateRanges",value:function(e,t){var n,r=Array(),o=Array(),i=e.sheet,a=Br(this.entriesFromSheet(e.sheet));try{for(a.s();!(n=a.n()).done;){var s=jr(n.value,2),u=s[0],c=s[1],l=c.range;e.start<=t(c.range.end)&&(l.removeSpan(e),l.shouldBeRemoved()?(this.removeByKey(i,u),r.push(c)):o.push([u,c]))}}catch(e){a.e(e)}finally{a.f()}var f=[];o.sort((function(e,n){return Yr(e[1],n[1],t)}));for(var h=0,p=o;h<p.length;h++){var d=jr(p[h],2),m=d[0],v=d[1],y=$r(v.range);if(y!==m){var g=this.getByKey(i,y);this.removeByKey(i,m),void 0!==g&&v!=g?f.push([g,v]):this.setRange(v)}}return{verticesToRemove:r,verticesToMerge:f}}},{key:"moveAllRangesInSheetAfterRowByRows",value:function(e,t,n){this.updateVerticesFromSheet(e,(function(e,r){return t<=r.start.row?(r.range.shiftByRows(n),r):t>r.start.row&&t<=r.end.row?(r.range.expandByRows(n),r):void 0}))}},{key:"moveAllRangesInSheetAfterColumnByColumns",value:function(e,t,n){this.updateVerticesFromSheet(e,(function(e,r){return t<=r.start.col?(r.range.shiftByColumns(n),r):t>r.start.col&&t<=r.end.col?(r.range.expandByColumns(n),r):void 0}))}},{key:"moveRangesInsideSourceRange",value:function(e,t,n,r){this.updateVerticesFromSheet(e.sheet,(function(o,i){return e.containsRange(i.range)?(i.range.shiftByColumns(t),i.range.shiftByRows(n),i.range.moveToSheet(r),i):void 0}))}},{key:"removeRangesInSheet",value:function(e){if(this.rangeMapping.has(e)){var t=this.rangeMapping.get(e).values();return this.rangeMapping.delete(e),t}return[][Symbol.iterator]()}},{key:"rangesInSheet",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(n.values(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"rangeVerticesContainedInRange",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Br(this.rangesInSheet(t.sheet)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=10;break}if(o=r.value,!t.containsRange(o.range)){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"findSmallerRange",value:function(e){if(e.height()>1&&Number.isFinite(e.height())){var t=Yo(e.end.sheet,e.end.col,e.end.row-1),n=this.getRange(e.start,t);if(void 0!==n)return{smallerRangeVertex:n,restRange:new yt(Yo(e.start.sheet,e.start.col,e.end.row),e.end)}}return{smallerRangeVertex:null,restRange:e}}},{key:"destroy",value:function(){this.rangeMapping.clear()}},{key:"entriesFromSheet",value:regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.rangeMapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:return e.delegateYield(n.entries(),"t0",4);case 4:case"end":return e.stop()}}),e,this)}))},{key:"removeByKey",value:function(e,t){this.rangeMapping.get(e).delete(t)}},{key:"getByKey",value:function(e,t){var n;return null===(n=this.rangeMapping.get(e))||void 0===n?void 0:n.get(t)}},{key:"updateVerticesFromSheet",value:function(e,t){var n,r=this,o=Array(),i=Br(this.entriesFromSheet(e));try{for(i.s();!(n=i.n()).done;){var a=jr(n.value,2),s=a[0],u=t(s,a[1]);void 0!==u&&(this.removeByKey(e,s),o.push(u))}}catch(e){i.e(e)}finally{i.f()}o.forEach((function(e){r.setRange(e)}))}}])&&Gr(t.prototype,n),r&&Gr(t,r),e}();function Wr(e,t){return"".concat(e.col,",").concat(e.row,",").concat(t.col,",").concat(t.row)}function $r(e){return Wr(e.start,e.end)}var Yr=function(e,t,n){var r=n(e.range.start),o=n(e.range.start);return r===o?n(e.range.end)-n(t.range.end):r-o};n("tkto"),n("B6y2");function Kr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function qr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xr(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Jr,Qr=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.functions=t,this.errors=n,this.ui=r,this._protectedTranslations={VERSION:"VERSION"},this.checkUI(),this.checkErrors(),this.checkFunctionTranslations(this.functions),Object.assign(this.functions,this._protectedTranslations)}var t,n,r;return t=e,(n=[{key:"extendFunctions",value:function(e){this.checkFunctionTranslations(e),Object.assign(this.functions,e)}},{key:"buildFunctionMapping",value:function(){var e=this;return Object.keys(this.functions).reduce((function(t,n){return t[e.functions[n]]=n,t}),{})}},{key:"buildErrorMapping",value:function(){var e=this;return Object.keys(this.errors).reduce((function(t,n){return t[e.errors[n]]=n,t}),{})}},{key:"isFunctionTranslated",value:function(e){return void 0!==this.functions[e]}},{key:"getFunctionTranslations",value:function(e){var t,n=[],r=Kr(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;this.isFunctionTranslated(o)&&n.push(this.functions[o])}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getFunctionTranslation",value:function(e){var t=this.functions[e];if(void 0===t)throw new Gn("functions.".concat(e));return t}},{key:"getMaybeFunctionTranslation",value:function(e){return this.functions[e]}},{key:"getErrorTranslation",value:function(e){if(e===Mo.LIC)return"#".concat(Mo.LIC,"!");var t=this.errors[e];if(void 0===t)throw new Gn("errors.".concat(e));return t}},{key:"getUITranslation",value:function(e){var t=this.ui[e];if(void 0===t)throw new Gn("ui.".concat(e));return t}},{key:"checkUI",value:function(){for(var e=0,t=Object.values(Jr);e<t.length;e++){var n=t[e];if(!(n in this.ui))throw new Gn("ui.".concat(n))}}},{key:"checkErrors",value:function(){for(var e=0,t=Object.values(Mo);e<t.length;e++){var n=t[e];if(!(n in this.errors)&&n!==Mo.LIC)throw new Gn("errors.".concat(n))}}},{key:"checkFunctionTranslations",value:function(e){var t,n=new Set(Object.getOwnPropertyNames(e)),r=Kr(Object.getOwnPropertyNames(this._protectedTranslations));try{for(r.s();!(t=r.n()).done;){var o=t.value;if(n.has(o))throw new zn(o)}}catch(e){r.e(e)}finally{r.f()}}}])&&Xr(t.prototype,n),r&&Xr(t,r),e}();function Zr(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return eo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eo(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function eo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function to(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function no(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ro(e,t,n){return t&&no(e.prototype,t),n&&no(e,n),e}function oo(e){return e.toLowerCase()}!function(e){e.NEW_SHEET_PREFIX="NEW_SHEET_PREFIX"}(Jr||(Jr={}));var io=function(){function e(t,n){to(this,e),this.id=t,this.displayName=n}return ro(e,[{key:"canonicalName",get:function(){return oo(this.displayName)}}]),e}(),ao=function(){function e(t){var n=this;to(this,e),this.languages=t,this.mappingFromCanonicalName=new Map,this.mappingFromId=new Map,this.lastSheetId=-1,this.fetch=function(e){var t=n.mappingFromCanonicalName.get(oo(e));if(void 0===t)throw new Tn(e);return t.id},this.get=function(e){var t=n.mappingFromCanonicalName.get(oo(e));return t?t.id:void 0},this.fetchDisplayName=function(e){return n.fetchSheetById(e).displayName},this.sheetNamePrefix=t.getUITranslation(Jr.NEW_SHEET_PREFIX)}return ro(e,[{key:"addSheet",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"".concat(this.sheetNamePrefix).concat(this.lastSheetId+2),t=oo(e);if(this.mappingFromCanonicalName.has(t))throw new On(e);this.lastSheetId++;var n=new io(this.lastSheetId,e);return this.store(n),n.id}},{key:"removeSheet",value:function(e){var t=this.fetchSheetById(e);e==this.lastSheetId&&--this.lastSheetId,this.mappingFromCanonicalName.delete(t.canonicalName),this.mappingFromId.delete(t.id)}},{key:"getDisplayName",value:function(e){var t=this.mappingFromId.get(e);return t?t.displayName:void 0}},{key:"getDisplayNameByName",value:function(e){var t=this.mappingFromCanonicalName.get(oo(e));return t?t.displayName:void 0}},{key:"displayNames",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Zr(this.mappingFromCanonicalName.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=9;break}return r=n.value,e.next=7,r.displayName;case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"numberOfSheets",value:function(){return this.mappingFromCanonicalName.size}},{key:"hasSheetWithId",value:function(e){return this.mappingFromId.has(e)}},{key:"hasSheetWithName",value:function(e){return this.mappingFromCanonicalName.has(oo(e))}},{key:"renameSheet",value:function(e,t){var n=this.fetchSheetById(e),r=n.displayName;if(r!==t){var o=this.mappingFromCanonicalName.get(oo(t));if(o&&o.id!==n.id)throw new On(t);var i=n.canonicalName;return this.mappingFromCanonicalName.delete(i),n.displayName=t,this.store(n),r}}},{key:"destroy",value:function(){this.mappingFromCanonicalName.clear(),this.mappingFromId.clear()}},{key:"sheetNames",value:function(){return Array.from(this.mappingFromId.values()).map((function(e){return e.displayName}))}},{key:"store",value:function(e){this.mappingFromId.set(e.id,e),this.mappingFromCanonicalName.set(e.canonicalName,e)}},{key:"fetchSheetById",value:function(e){var t=this.mappingFromId.get(e);if(void 0===t)throw new Sn(e);return t}}]),e}();function so(e){return function(e){if(Array.isArray(e))return fo(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lo(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function uo(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=lo(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function co(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||lo(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lo(e,t){if(e){if("string"==typeof e)return fo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fo(e,t):void 0}}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ho(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var po=function(){function e(t,n,r,o,i,a,s,u){var c=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.addressMapping=t,this.rangeMapping=n,this.sheetMapping=r,this.matrixMapping=o,this.stats=i,this.lazilyTransformingAstService=a,this.functionRegistry=s,this.namedExpressions=u,this.dependencyQueryAddresses=function(e){if(e instanceof kr)return c.rangeDependencyQuery(e).map((function(e){var t=co(e,2),n=t[0];t[1];return n}));var t=c.formulaDependencyQuery(e);if(void 0!==t){var n=co(t,2),r=n[0];return n[1].map((function(e){return e instanceof tt?c.namedExpressions.namedExpressionOrPlaceholder(e.name,r.sheet).address:e}))}},this.dependencyQueryVertices=function(e){if(e instanceof kr)return c.rangeDependencyQuery(e).map((function(e){var t=co(e,2);t[0];return t[1]}));var t=c.formulaDependencyQuery(e);if(void 0!==t){var n=co(t,2),r=n[0];return n[1].map((function(e){if(e instanceof yt)return c.rangeMapping.fetchRange(e.start,e.end);if(e instanceof tt){var t=c.namedExpressions.namedExpressionOrPlaceholder(e.name,r.sheet);return c.addressMapping.fetchCell(t.address)}return c.addressMapping.fetchCell(e)}))}},this.rangeDependencyQuery=function(e){var t,n=[],r=c.rangeMapping.findSmallerRange(e.range),o=r.smallerRangeVertex,i=r.restRange;null!==o&&c.graph.adjacentNodes(o).has(e)?(t=i,n.push([new yt(o.start,o.end),o])):t=e.range;var a,s=uo(t.addresses(c));try{for(s.s();!(a=s.n()).done;){var u=a.value,l=c.addressMapping.getCell(u);l instanceof vo&&(l.address=u),null!==l&&n.push([u,l])}}catch(e){s.e(e)}finally{s.f()}return n},this.formulaDependencyQuery=function(e){var t,n;if(e instanceof cr)n=e.getAddress(c.lazilyTransformingAstService),t=e.getFormula(c.lazilyTransformingAstService);else{if(!(e instanceof Or&&e.isFormula()))return;n=e.getAddress(),t=e.getFormula()}var r=Ye(t,c.functionRegistry);return[n,Et(r,n)]},this.graph=new Ir(this.dependencyQueryVertices)}var t,n,r;return t=e,r=[{key:"buildEmpty",value:function(t,n,r,o,i){return new e(new ir(n.chooseAddressMappingPolicy),new zr,new ao(n.translationPackage),new Ur,i,t,r,o)}}],(n=[{key:"setFormulaToCell",value:function(e,t,n,r,o){var i=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(i);var a=new cr(t,e,this.lazilyTransformingAstService.version());this.exchangeOrAddGraphNode(i,a),this.addressMapping.setCell(e,a),this.processCellDependencies(n,a),this.graph.markNodeAsSpecialRecentlyChanged(a),r&&this.markAsVolatile(a),o&&this.markAsDependentOnStructureChange(a),this.correctInfiniteRangesDependency(e)}},{key:"setParsingErrorToCell",value:function(e,t){var n=this.addressMapping.getCell(e);this.ensureThatVertexIsNonMatrixCellVertex(n),this.exchangeOrAddGraphNode(n,t),this.addressMapping.setCell(e,t),this.graph.markNodeAsSpecialRecentlyChanged(t),this.correctInfiniteRangesDependency(e)}},{key:"setValueToCell",value:function(e,t){var n=this.addressMapping.getCell(e);if(this.ensureThatVertexIsNonMatrixCellVertex(n),n instanceof go)n.getValues().rawValue!==t.rawValue&&(n.setValues(t),this.graph.markNodeAsSpecialRecentlyChanged(n));else{var r=new go(t.parsedValue,t.rawValue);this.exchangeOrAddGraphNode(n,r),this.addressMapping.setCell(e,r),this.graph.markNodeAsSpecialRecentlyChanged(r)}this.correctInfiniteRangesDependency(e)}},{key:"setCellEmpty",value:function(e){var t=this.addressMapping.getCell(e);if(null!==t)if(this.ensureThatVertexIsNonMatrixCellVertex(t),this.graph.adjacentNodes(t).size>0){var n=new vo(e);this.exchangeGraphNode(t,n),0===this.graph.adjacentNodesCount(n)?(this.removeVertex(n),this.addressMapping.removeCell(e)):(this.graph.markNodeAsSpecialRecentlyChanged(n),this.addressMapping.setCell(e,n))}else this.removeVertex(t),this.addressMapping.removeCell(e)}},{key:"ensureThatVertexIsNonMatrixCellVertex",value:function(e){h.a.ok(!(e instanceof Or),"Illegal operation")}},{key:"clearRecentlyChangedVertices",value:function(){this.graph.clearSpecialNodesRecentlyChanged()}},{key:"verticesToRecompute",value:function(){return new Set([].concat(so(this.graph.specialNodesRecentlyChanged),so(this.volatileVertices())))}},{key:"processCellDependencies",value:function(e,t){var n=this;e.forEach((function(e){if(e instanceof yt){var r=e,o=n.getRange(r.start,r.end);void 0===o&&(o=new kr(r),n.rangeMapping.setRange(o)),n.graph.addNode(o),r.isFinite()||n.graph.markNodeAsInfiniteRange(o);var i=n.rangeMapping.findSmallerRange(r),a=i.smallerRangeVertex,s=i.restRange;if(a){if(n.graph.addEdge(a,o),o.bruteForce){o.bruteForce=!1;var u,c=uo(r.addresses(n));try{for(c.s();!(u=c.n()).done;){var l=u.value;n.graph.removeEdge(n.fetchCell(l),o)}}catch(e){c.e(e)}finally{c.f()}}}else o.bruteForce=!0;var f=n.matrixMapping.getMatrix(s);if(void 0!==f)n.graph.addEdge(f,o);else{var h,p=uo(s.addresses(n));try{for(p.s();!(h=p.n()).done;){var d=h.value;n.graph.addEdge(n.fetchCellOrCreateEmpty(d),o)}}catch(e){p.e(e)}finally{p.f()}}n.graph.addEdge(o,t),r.isFinite()&&n.correctInfiniteRangesDependenciesByRangeVertex(o)}else if(e instanceof tt){var m=t.getAddress(n.lazilyTransformingAstService).sheet,v=n.fetchNamedExpressionVertex(e.name,m);n.graph.addEdge(v,t)}else n.graph.addEdge(n.fetchCellOrCreateEmpty(e),t)}))}},{key:"fetchNamedExpressionVertex",value:function(e,t){var n=this.namedExpressions.namedExpressionOrPlaceholder(e,t);return this.fetchCellOrCreateEmpty(n.address)}},{key:"exchangeNode",value:function(e,t){var n=this.fetchCellOrCreateEmpty(e),r=this.fetchCellOrCreateEmpty(t);this.addressMapping.removeCell(e),this.exchangeGraphNode(n,r)}},{key:"correctInfiniteRangesDependenciesByRangeVertex",value:function(e){var t,n=uo(this.graph.infiniteRanges);try{for(n.s();!(t=n.n()).done;){var r=t.value,o=r,i=e.range.intersectionWith(o.range);if(null!==i){var a,s=uo(i.addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),r)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"correctInfiniteRangesDependency",value:function(e){var t,n=null,r=uo(this.graph.infiniteRanges);try{for(r.s();!(t=r.n()).done;){var o=t.value;o.range.addressInRange(e)&&(n=n||this.fetchCellOrCreateEmpty(e),this.graph.addEdge(n,o))}}catch(e){r.e(e)}finally{r.f()}}},{key:"fetchCellOrCreateEmpty",value:function(e){var t=this.addressMapping.getCell(e);return t||(t=new vo(e),this.graph.addNode(t),this.addressMapping.setCell(e,t)),t}},{key:"removeRows",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInRows(e))throw Error("It is not possible to remove row with matrix");this.stats.measure(qt.ADJUSTING_GRAPH,(function(){var n,r=uo(t.addressMapping.verticesFromRowsSpan(e));try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=uo(t.graph.adjacentNodes(i));try{for(a.s();!(o=a.n()).done;){var s=o.value;t.graph.markNodeAsSpecialRecentlyChanged(s)}}catch(e){a.e(e)}finally{a.f()}i instanceof Or||t.removeVertex(i)}}catch(e){r.e(e)}finally{r.f()}})),this.stats.measure(qt.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingRows(e)})),this.stats.measure(qt.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeRows(e)})),this.stats.measure(qt.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.row}))})),this.addStructuralNodesToChangeSet()}},{key:"removeSheet",value:function(e){var t,n=this,r=new Set,o=uo(this.addressMapping.sheetEntries(e));try{for(o.s();!(t=o.n()).done;){var i=co(t.value,2),a=i[0],s=i[1];if(s instanceof Or){if(r.has(s))continue;r.add(s)}var u,c=uo(this.graph.adjacentNodes(s));try{for(c.s();!(u=c.n()).done;){var l=u.value;this.graph.markNodeAsSpecialRecentlyChanged(l)}}catch(e){c.e(e)}finally{c.f()}this.removeVertex(s),this.addressMapping.removeCell(a)}}catch(e){o.e(e)}finally{o.f()}this.stats.measure(qt.ADJUSTING_MATRIX_MAPPING,(function(){var e,t=uo(r.values());try{for(t.s();!(e=t.n()).done;){var o=e.value;n.matrixMapping.removeMatrix(o.getRange())}}catch(e){t.e(e)}finally{t.f()}})),this.stats.measure(qt.ADJUSTING_RANGES,(function(){var t,r=uo(n.rangeMapping.removeRangesInSheet(e));try{for(r.s();!(t=r.n()).done;){var o=t.value;n.removeVertex(o)}}catch(e){r.e(e)}finally{r.f()}n.stats.measure(qt.ADJUSTING_ADDRESS_MAPPING,(function(){n.addressMapping.removeSheet(e)}))})),this.addStructuralNodesToChangeSet()}},{key:"clearSheet",value:function(e){var t,n=new Set,r=uo(this.addressMapping.sheetEntries(e));try{for(r.s();!(t=r.n()).done;){var o=co(t.value,2),i=o[0],a=o[1];a instanceof Or?n.add(a):this.setCellEmpty(i)}}catch(e){r.e(e)}finally{r.f()}var s,u=uo(n.values());try{for(u.s();!(s=u.n()).done;){var c=s.value;this.setMatrixEmpty(c)}}catch(e){u.e(e)}finally{u.f()}this.addStructuralNodesToChangeSet()}},{key:"removeColumns",value:function(e){var t=this;if(this.matrixMapping.isFormulaMatrixInColumns(e))throw Error("It is not possible to remove column within matrix");this.stats.measure(qt.ADJUSTING_GRAPH,(function(){var n,r=uo(t.addressMapping.verticesFromColumnsSpan(e));try{for(r.s();!(n=r.n()).done;){var o,i=n.value,a=uo(t.graph.adjacentNodes(i));try{for(a.s();!(o=a.n()).done;){var s=o.value;t.graph.markNodeAsSpecialRecentlyChanged(s)}}catch(e){a.e(e)}finally{a.f()}i instanceof Or||t.removeVertex(i)}}catch(e){r.e(e)}finally{r.f()}})),this.stats.measure(qt.ADJUSTING_MATRIX_MAPPING,(function(){t.truncateMatricesAfterRemovingColumns(e)})),this.stats.measure(qt.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.removeColumns(e)})),this.stats.measure(qt.ADJUSTING_RANGES,(function(){t.truncateRanges(e,(function(e){return e.col}))})),this.addStructuralNodesToChangeSet()}},{key:"addRows",value:function(e){var t=this;this.stats.measure(qt.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(qt.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingRows(e.sheet,e.rowStart,e.numberOfRows)})),this.stats.measure(qt.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterRowByRows(e.sheet,e.rowStart,e.numberOfRows),t.fixRangesWhenAddingRows(e.sheet,e.rowStart,e.numberOfRows)}));var n,r=uo(this.addressMapping.verticesFromRowsSpan(e));try{for(r.s();!(n=r.n()).done;){var o=n.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(e){r.e(e)}finally{r.f()}this.addStructuralNodesToChangeSet()}},{key:"addColumns",value:function(e){var t=this;this.stats.measure(qt.ADJUSTING_ADDRESS_MAPPING,(function(){t.addressMapping.addColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(qt.ADJUSTING_MATRIX_MAPPING,(function(){t.expandMatricesAfterAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)})),this.stats.measure(qt.ADJUSTING_RANGES,(function(){t.rangeMapping.moveAllRangesInSheetAfterColumnByColumns(e.sheet,e.columnStart,e.numberOfColumns),t.fixRangesWhenAddingColumns(e.sheet,e.columnStart,e.numberOfColumns)}));var n,r=uo(this.addressMapping.verticesFromColumnsSpan(e));try{for(r.s();!(n=r.n()).done;){var o=n.value;this.graph.markNodeAsSpecialRecentlyChanged(o)}}catch(e){r.e(e)}finally{r.f()}this.addStructuralNodesToChangeSet()}},{key:"ensureNoMatrixInRange",value:function(e){if(this.matrixMapping.isFormulaMatrixInRange(e))throw Error("It is not possible to move / replace cells with matrix")}},{key:"moveCells",value:function(e,t,n,r){var o,i=uo(e.addressesWithDirection(t,n,this));try{for(i.s();!(o=i.n()).done;){var a=o.value,s=Yo(r,a.col+t,a.row+n),u=this.addressMapping.getCell(a),c=this.addressMapping.getCell(s);if(this.addressMapping.removeCell(a),null!==u){this.graph.markNodeAsSpecialRecentlyChanged(u),this.addressMapping.setCell(s,u);var l,f=null,h=uo(this.graph.adjacentNodes(u));try{for(h.s();!(l=h.n()).done;){var p=l.value;p instanceof kr&&!e.containsRange(p.range)&&(f=f||this.fetchCellOrCreateEmpty(a),this.graph.addEdge(f,p),this.graph.removeEdge(u,p))}}catch(e){h.e(e)}finally{h.f()}f&&(this.graph.markNodeAsSpecialRecentlyChanged(f),this.addressMapping.setCell(a,f))}if(null!==c){null===u&&this.addressMapping.removeCell(s);var d,m=uo(this.graph.adjacentNodes(c));try{for(m.s();!(d=m.n()).done;){var v=d.value;u=null!=u?u:this.fetchCellOrCreateEmpty(s),this.graph.addEdge(u,v),this.graph.markNodeAsSpecialRecentlyChanged(u)}}catch(e){m.e(e)}finally{m.f()}this.removeVertex(c)}}}catch(e){i.e(e)}finally{i.f()}var y,g=uo(this.rangeMapping.rangeVerticesContainedInRange(e));try{for(g.s();!(y=g.n()).done;){var b,E=y.value,w=uo(this.graph.adjacentNodes(E));try{for(w.s();!(b=w.n()).done;){var S=b.value;if(S instanceof kr&&!e.containsRange(S.range)){this.graph.removeEdge(E,S);var T,O=uo(E.range.addresses(this));try{for(O.s();!(T=O.n()).done;){var R=T.value,N=this.fetchCellOrCreateEmpty(R);this.graph.addEdge(N,S),this.addressMapping.setCell(R,N),this.graph.markNodeAsSpecialRecentlyChanged(N)}}catch(e){O.e(e)}finally{O.f()}}}}catch(e){w.e(e)}finally{w.f()}}}catch(e){g.e(e)}finally{g.f()}this.rangeMapping.moveRangesInsideSourceRange(e,t,n,r)}},{key:"disableNumericMatrices",value:function(){var e,t=uo(this.matrixMapping.numericMatrices());try{for(t.s();!(e=t.n()).done;){var n=co(e.value,2),r=(n[0],n[1]);this.breakNumericMatrix(r)}}catch(e){t.e(e)}finally{t.f()}}},{key:"breakNumericMatricesInRange",value:function(e){var t,n=uo(this.matrixMapping.numericMatricesInRange(e));try{for(n.s();!(t=n.n()).done;){var r=co(t.value,2),o=(r[0],r[1]);this.breakNumericMatrix(o)}}catch(e){n.e(e)}finally{n.f()}}},{key:"breakNumericMatrix",value:function(e){var t,n=yt.spanFrom(e.getAddress(),e.width,e.height),r=this.graph.adjacentNodes(e),o=uo(n.addresses(this));try{for(o.s();!(t=o.n()).done;){var i=t.value,a=new go(this.getCellValue(i),this.getRawValue(i));this.addVertex(i,a)}}catch(e){o.e(e)}finally{o.f()}var s,u=uo(r.values());try{for(u.s();!(s=u.n()).done;){var c,l=s.value,f=uo(Ar(this.functionRegistry,l,e,this.lazilyTransformingAstService,this));try{for(f.s();!(c=f.n()).done;){var h=c.value,p=this.fetchCell(h);this.graph.addEdge(p,l)}}catch(e){f.e(e)}finally{f.f()}}}catch(e){u.e(e)}finally{u.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"setMatrixEmpty",value:function(e){var t,n=yt.spanFrom(e.getAddress(),e.width,e.height),r=this.graph.adjacentNodes(e),o=uo(n.addresses(this));try{for(o.s();!(t=o.n()).done;){var i=t.value;this.addressMapping.removeCell(i)}}catch(e){o.e(e)}finally{o.f()}var a,s=uo(r.values());try{for(s.s();!(a=s.n()).done;){var u,c=a.value,l=Ar(this.functionRegistry,c,e,this.lazilyTransformingAstService,this),f=uo(l);try{for(f.s();!(u=f.n()).done;){var h=u.value,p=this.fetchCellOrCreateEmpty(h);this.graph.addEdge(p,c)}}catch(e){f.e(e)}finally{f.f()}l.length>0&&this.graph.markNodeAsSpecialRecentlyChanged(c)}}catch(e){s.e(e)}finally{s.f()}this.removeVertex(e),this.matrixMapping.removeMatrix(e.getRange())}},{key:"addVertex",value:function(e,t){this.graph.addNode(t),this.setVertexAddress(e,t)}},{key:"addMatrixVertex",value:function(e,t){this.graph.addNode(t),this.setAddressMappingForMatrixVertex(t,e)}},{key:"addNewMatrixVertex",value:function(e){var t,n=yt.spanFrom(e.getAddress(),e.width,e.height),r=uo(this.verticesFromRange(n));try{for(r.s();!(t=r.n()).done;)if(t.value instanceof Or)throw Error("You cannot modify only part of an array")}catch(e){r.e(e)}finally{r.f()}this.setMatrix(n,e);var o,i=uo(this.entriesFromRange(n));try{for(i.s();!(o=i.n()).done;){var a=co(o.value,2),s=a[0],u=a[1];u&&this.exchangeGraphNode(u,e),this.setVertexAddress(s,e)}}catch(e){i.e(e)}finally{i.f()}}},{key:"matrixFormulaNodes",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=uo(this.graph.nodes),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(!((r=n.value)instanceof Or&&r.isFormula())){e.next=8;break}return e.next=8,r;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromRowsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.addressMapping.entriesFromColumnsSpan(t),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"existsVertex",value:function(e){return this.addressMapping.has(e)}},{key:"fetchCell",value:function(e){return this.addressMapping.fetchCell(e)}},{key:"getCell",value:function(e){return this.addressMapping.getCell(e)}},{key:"getCellValue",value:function(e){return this.addressMapping.getCellValue(e)}},{key:"getRawValue",value:function(e){return this.addressMapping.getRawValue(e)}},{key:"getScalarValue",value:function(e){var t=this.addressMapping.getCellValue(e);return t instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):t}},{key:"setVertexAddress",value:function(e,t){this.addressMapping.setCell(e,t)}},{key:"existsEdge",value:function(e,t){return this.graph.existsEdge(e,t)}},{key:"getSheetId",value:function(e){return this.sheetMapping.fetch(e)}},{key:"getSheetName",value:function(e){return this.sheetMapping.fetchDisplayName(e)}},{key:"getSheetHeight",value:function(e){return this.addressMapping.getHeight(e)}},{key:"getSheetWidth",value:function(e){return this.addressMapping.getWidth(e)}},{key:"getMatrix",value:function(e){return this.matrixMapping.getMatrix(e)}},{key:"setMatrix",value:function(e,t){this.matrixMapping.setMatrix(e,t)}},{key:"getRange",value:function(e,t){return this.rangeMapping.getRange(e,t)}},{key:"topSortWithScc",value:function(){return this.graph.topSortWithScc()}},{key:"markAsVolatile",value:function(e){this.graph.markNodeAsSpecial(e)}},{key:"markAsDependentOnStructureChange",value:function(e){this.graph.markNodeAsChangingWithStructure(e)}},{key:"forceApplyPostponedTransformations",value:function(){var e,t=uo(this.graph.nodes.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n instanceof cr&&n.ensureRecentData(this.lazilyTransformingAstService)}}catch(e){t.e(e)}finally{t.f()}}},{key:"volatileVertices",value:function(){return this.graph.specialNodes}},{key:"destroy",value:function(){this.graph.destroy(),this.addressMapping.destroy(),this.rangeMapping.destroy(),this.sheetMapping.destroy(),this.matrixMapping.destroy()}},{key:"verticesFromRange",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=uo(t.addresses(this)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}if(o=r.value,!(i=this.getCell(o))){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"rawValuesFromRange",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=uo(t.addresses(this)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}if(o=r.value,(i=this.getScalarValue(o))===Mt){e.next=9;break}return e.next=9,[xt(i),o];case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"entriesFromRange",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=uo(t.addresses(this)),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=9;break}return o=r.value,e.next=7,[o,this.getCell(o)];case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),n.e(e.t0);case 14:return e.prev=14,n.f(),e.finish(14);case 17:case"end":return e.stop()}}),e,this,[[1,11,14,17]])}))},{key:"exchangeGraphNode",value:function(e,t){var n=this;this.graph.addNode(t);var r=this.graph.adjacentNodes(e);this.removeVertex(e),r.forEach((function(e){n.graph.hasNode(e)&&n.graph.addEdge(t,e)}))}},{key:"exchangeOrAddGraphNode",value:function(e,t){e?this.exchangeGraphNode(e,t):this.graph.addNode(t)}},{key:"computeListOfValuesInRange",value:function(e){var t,n=[],r=uo(e.addresses(this));try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.getScalarValue(o);n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"addStructuralNodesToChangeSet",value:function(){var e,t=uo(this.graph.specialNodesStructuralChanges);try{for(t.s();!(e=t.n()).done;){var n=e.value;this.graph.markNodeAsSpecialRecentlyChanged(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"fixRangesWhenAddingRows",value:function(e,t,n){for(var r=0,o=Array.from(this.rangeMapping.rangesInSheet(e));r<o.length;r++){var i=o[r];if(i.range.includesRow(t+n))if(i.bruteForce){var a,s=uo(i.range.rangeWithSameWidth(t,n).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),i)}}catch(e){s.e(e)}finally{s.f()}}else{var c=i,l=this.rangeMapping.findSmallerRange(c.range);if(null!==l.smallerRangeVertex)continue;for(;null===l.smallerRangeVertex;){var f=new kr(yt.spanFrom(c.range.start,c.range.width(),c.range.height()-1));this.rangeMapping.setRange(f),this.graph.addNode(f);var h=new yt(Yo(c.range.start.sheet,c.range.start.col,c.range.end.row),c.range.end);this.addAllFromRange(h,c),this.graph.addEdge(f,c),c=f,l=this.rangeMapping.findSmallerRange(c.range)}this.graph.addEdge(l.smallerRangeVertex,c),this.addAllFromRange(l.restRange,c),this.graph.removeEdge(l.smallerRangeVertex,i)}}}},{key:"addAllFromRange",value:function(e,t){var n,r=uo(e.addresses(this));try{for(r.s();!(n=r.n()).done;){var o=n.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(o),t)}}catch(e){r.e(e)}finally{r.f()}}},{key:"fixRangesWhenAddingColumns",value:function(e,t,n){var r,o=uo(this.rangeMapping.rangesInSheet(e));try{for(o.s();!(r=o.n()).done;){var i=r.value;if(i.range.includesColumn(t+n)){var a,s=uo((i.bruteForce?i.range.rangeWithSameHeight(t,n):yt.spanFrom(Yo(e,t,i.range.end.row),n,1)).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.graph.addEdge(this.fetchCellOrCreateEmpty(u),i)}}catch(e){s.e(e)}finally{s.f()}}}}catch(e){o.e(e)}finally{o.f()}}},{key:"setAddressMappingForMatrixVertex",value:function(e,t){if(this.setVertexAddress(t,e),e instanceof Or){var n=yt.spanFrom(t,e.width,e.height);this.setMatrix(n,e);var r,o=uo(n.addresses(this));try{for(o.s();!(r=o.n()).done;){var i=r.value;this.setVertexAddress(i,e)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"truncateMatricesAfterRemovingRows",value:function(e){var t=this;this.matrixMapping.truncateMatricesByRows(e).forEach((function(e){t.removeVertex(e)}))}},{key:"truncateRanges",value:function(e,t){var n,r=this.rangeMapping.truncateRanges(e,t),o=r.verticesToRemove,i=uo(r.verticesToMerge);try{for(i.s();!(n=i.n()).done;){var a=co(n.value,2),s=a[0],u=a[1];this.mergeRangeVertices(s,u)}}catch(e){i.e(e)}finally{i.f()}var c,l=uo(o);try{for(l.s();!(c=l.n()).done;){var f=c.value;this.removeVertexAndCleanupDependencies(f)}}catch(e){l.e(e)}finally{l.f()}}},{key:"truncateMatricesAfterRemovingColumns",value:function(e){var t=this;this.matrixMapping.truncateMatricesByColumns(e).forEach((function(e){t.removeVertex(e)}))}},{key:"expandMatricesAfterAddingRows",value:function(e,t,n){var r,o=uo(this.matrixMapping.numericMatricesInRows(it.fromRowStartAndEnd(e,t,t)));try{for(o.s();!(r=o.n()).done;){var i=co(r.value,2)[1];i.addRows(e,t,n);var a,s=uo(yt.spanFrom(Yo(e,i.getAddress().col,t),i.width,n).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.addressMapping.setCell(u,i)}}catch(e){s.e(e)}finally{s.f()}}}catch(e){o.e(e)}finally{o.f()}}},{key:"expandMatricesAfterAddingColumns",value:function(e,t,n){var r,o=uo(this.matrixMapping.numericMatricesInColumns(at.fromColumnStartAndEnd(e,t,t)));try{for(o.s();!(r=o.n()).done;){var i=co(r.value,2)[1];i.addColumns(e,t,n);var a,s=uo(yt.spanFrom(Yo(e,t,i.getAddress().row),n,i.height).addresses(this));try{for(s.s();!(a=s.n()).done;){var u=a.value;this.addressMapping.setCell(u,i)}}catch(e){s.e(e)}finally{s.f()}}}catch(e){o.e(e)}finally{o.f()}}},{key:"removeVertex",value:function(e){this.removeVertexAndCleanupDependencies(e),e instanceof kr&&this.rangeMapping.removeRange(e)}},{key:"mergeRangeVertices",value:function(e,t){var n=this,r=this.graph.adjacentNodes(t);this.removeVertexAndCleanupDependencies(t),this.graph.softRemoveEdge(e,t),r.forEach((function(t){n.graph.hasNode(t)&&n.graph.addEdge(e,t)}))}},{key:"removeVertexAndCleanupDependencies",value:function(e){for(var t=new Set(this.graph.removeNode(e));t.size>0;){var n=t.values().next().value;t.delete(n),this.graph.hasNode(n)&&0===this.graph.adjacentNodesCount(n)&&((n instanceof kr||n instanceof vo)&&this.graph.removeNode(n).forEach((function(e){return t.add(e)})),n instanceof kr?this.rangeMapping.removeRange(n):n instanceof vo&&this.addressMapping.removeCell(n.address))}}},{key:"getAdjacentNodesAddresses",value:function(e){var t=this,n=this.graph.adjacentNodes(e),r=[];return n.forEach((function(e){var n=e;n instanceof kr?r.push(new yt(n.start,n.end)):n instanceof cr?r.push(n.getAddress(t.lazilyTransformingAstService)):r.push(n.getAddress())})),r}}])&&ho(t.prototype,n),r&&ho(t,r),e}();function mo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var vo=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.address=t}var t,n,r;return t=e,(n=[{key:"getCellValue",value:function(){return Mt}}])&&mo(t.prototype,n),r&&mo(t,r),e}();function yo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var go=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.parsedValue=t,this.rawValue=n}var t,n,r;return t=e,(n=[{key:"getValues",value:function(){return{parsedValue:this.parsedValue,rawValue:this.rawValue}}},{key:"setValues",value:function(e){this.parsedValue=e.parsedValue,this.rawValue=e.rawValue}},{key:"getCellValue",value:function(){return this.parsedValue}},{key:"setCellValue",value:function(e){throw"SetCellValue is deprecated for ValueCellVertex"}}])&&yo(t.prototype,n),r&&yo(t,r),e}();function bo(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Eo=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.errors=t,this.rawInput=n}var t,n,r;return t=e,(n=[{key:"getCellValue",value:function(){return Ho.parsingError()}},{key:"getFormula",value:function(){return this.rawInput}}])&&bo(t.prototype,n),r&&bo(t,r),e}();function wo(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||To(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function So(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=To(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function To(e,t){if(e){if("string"==typeof e)return Oo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oo(e,t):void 0}}function Oo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ro(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var No=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n,this.mapping=new Map}var t,n,r;return t=e,(n=[{key:"getCell",value:function(e){var t=this.mapping.get(e.col);return t&&t.get(e.row)||null}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1);var n=this.mapping.get(e.col);n||(n=new Map,this.mapping.set(e.col,n)),n.set(e.row,t)}},{key:"has",value:function(e){var t=this.mapping.get(e.col);return!!t&&!!t.get(e.row)}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){var t=this.mapping.get(e.col);t&&t.delete(e.row)}},{key:"addRows",value:function(e,t){this.mapping.forEach((function(n){var r=new Map;n.forEach((function(o,i){i>=e&&(r.set(i+t,o),n.delete(i))})),r.forEach((function(e,t){n.set(t,e)}))})),this.height+=t}},{key:"addColumns",value:function(e,t){var n=this,r=new Map;this.mapping.forEach((function(o,i){i>=e&&(r.set(i+t,o),n.mapping.delete(i))})),r.forEach((function(e,t){n.mapping.set(t,e)})),this.width+=t}},{key:"removeRows",value:function(e){this.mapping.forEach((function(t){var n=new Map;t.forEach((function(r,o){o>=e.rowStart&&(t.delete(o),o>e.rowEnd&&n.set(o-e.numberOfRows,r))})),n.forEach((function(e,n){t.set(n,e)}))}));var t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){var t=this,n=new Map;this.mapping.forEach((function(r,o){o>=e.columnStart&&(t.mapping.delete(o),o>e.columnEnd&&n.set(o-e.numberOfColumns,r))})),n.forEach((function(e,n){t.mapping.set(n,e)}));var r=Math.min(this.width-1,e.columnEnd),o=Math.max(0,r-e.columnStart+1);this.width=Math.max(0,this.width-o)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,c,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(this.mapping),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=24;break}o=wo(r.value,2),i=o[0],a=o[1],s=So(a),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=14;break}return c=wo(u.value,2),l=c[0],f=c[1],e.next=12,[Yo(t,i,l),f];case 12:e.next=8;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(6),s.e(e.t0);case 19:return e.prev=19,s.f(),e.finish(19);case 22:e.next=3;break;case 24:e.next=29;break;case 26:e.prev=26,e.t1=e.catch(1),n.e(e.t1);case 29:return e.prev=29,n.f(),e.finish(29);case 32:case"end":return e.stop()}}),e,this,[[1,26,29,32],[6,16,19,22]])}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.mapping.get(t)){e.next=3;break}return e.abrupt("return");case 3:r=So(n),e.prev=4,r.s();case 6:if((o=r.n()).done){e.next=12;break}return(i=wo(o.value,2))[0],a=i[1],e.next=10,a;case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(this.mapping.values()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=11;break}if(o=r.value,!(i=o.get(t))){e.next=9;break}return e.next=9,i;case 9:e.next=3;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(1),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,this,[[1,13,16,19]])}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(t.columns()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=27;break}if(o=r.value,i=this.mapping.get(o)){e.next=8;break}return e.abrupt("continue",25);case 8:a=So(i),e.prev=9,a.s();case 11:if((s=a.n()).done){e.next=17;break}return(u=wo(s.value,2))[0],c=u[1],e.next=15,c;case 15:e.next=11;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(9),a.e(e.t0);case 22:return e.prev=22,a.f(),e.finish(22);case 25:e.next=3;break;case 27:e.next=32;break;case 29:e.prev=29,e.t1=e.catch(1),n.e(e.t1);case 32:return e.prev=32,n.f(),e.finish(32);case 35:case"end":return e.stop()}}),e,this,[[1,29,32,35],[9,19,22,25]])}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(this.mapping.values()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}o=r.value,i=So(t.rows()),e.prev=6,i.s();case 8:if((a=i.n()).done){e.next=16;break}if(s=a.value,!(u=o.get(s))){e.next=14;break}return e.next=14,u;case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),i.e(e.t0);case 21:return e.prev=21,i.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(this.mapping.entries()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}o=wo(r.value,2),i=o[0],a=o[1],s=So(t.rows()),e.prev=6,s.s();case 8:if((u=s.n()).done){e.next=16;break}if(c=u.value,!(l=a.get(c))){e.next=14;break}return e.next=14,[Yo(t.sheet,i,c),l];case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),s.e(e.t0);case 21:return e.prev=21,s.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[6,18,21,24]])}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o,i,a,s,u,c,l;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=So(t.columns()),e.prev=1,n.s();case 3:if((r=n.n()).done){e.next=26;break}if(o=r.value,!(i=this.mapping.get(o))){e.next=24;break}a=So(i.entries()),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=16;break}return u=wo(s.value,2),c=u[0],l=u[1],e.next=14,[Yo(t.sheet,o,c),l];case 14:e.next=10;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(8),a.e(e.t0);case 21:return e.prev=21,a.f(),e.finish(21);case 24:e.next=3;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(1),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:case"end":return e.stop()}}),e,this,[[1,28,31,34],[8,18,21,24]])}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i,a,s,u;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=So(this.mapping),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=25;break}(r=wo(n.value,2))[0],o=r[1],i=So(o),e.prev=6,i.s();case 8:if((a=i.n()).done){e.next=15;break}if((s=wo(a.value,2))[0],!(u=s[1])){e.next=13;break}return e.next=13,u;case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),i.e(e.t0);case 20:return e.prev=20,i.f(),e.finish(20);case 23:e.next=3;break;case 25:e.next=30;break;case 27:e.prev=27,e.t1=e.catch(1),t.e(e.t1);case 30:return e.prev=30,t.f(),e.finish(30);case 33:case"end":return e.stop()}}),e,this,[[1,27,30,33],[6,17,20,23]])}))}])&&Ro(t.prototype,n),r&&Ro(t,r),e}();function ko(e){return function(e){if(Array.isArray(e))return Ao(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Ao(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ao(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ao(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Co(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Mo,xo,Io=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.width=t,this.height=n,this.mapping=new Array(n);for(var r=0;r<n;r++)this.mapping[r]=new Array(t)}var t,n,r;return t=e,(n=[{key:"getCell",value:function(e){return this.getCellVertex(e.col,e.row)}},{key:"setCell",value:function(e,t){this.width=Math.max(this.width,e.col+1),this.height=Math.max(this.height,e.row+1),this.mapping[e.row]||(this.mapping[e.row]=new Array(this.width)),this.mapping[e.row][e.col]=t}},{key:"has",value:function(e){var t=this.mapping[e.row];return!!t&&!!t[e.col]}},{key:"getHeight",value:function(){return this.height}},{key:"getWidth",value:function(){return this.width}},{key:"removeCell",value:function(e){void 0!==this.mapping[e.row]&&delete this.mapping[e.row][e.col]}},{key:"addRows",value:function(e,t){for(var n,r=[],o=0;o<t;o++)r.push(new Array(this.width));(n=this.mapping).splice.apply(n,[e,0].concat(r)),this.height+=t}},{key:"addColumns",value:function(e,t){for(var n=0;n<this.height;n++){var r;(r=this.mapping[n]).splice.apply(r,[e,0].concat(ko(new Array(t))))}this.width+=t}},{key:"removeRows",value:function(e){this.mapping.splice(e.rowStart,e.numberOfRows);var t=Math.min(this.height-1,e.rowEnd),n=Math.max(0,t-e.rowStart+1);this.height=Math.max(0,this.height-n)}},{key:"removeColumns",value:function(e){for(var t=0;t<this.height;t++)this.mapping[t].splice(e.columnStart,e.numberOfColumns);var n=Math.min(this.width-1,e.columnEnd),r=Math.max(0,n-e.columnStart+1);this.width=Math.max(0,this.width-r)}},{key:"getEntries",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=14;break}r=0;case 3:if(!(r<this.width)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,[Yo(t,r,n),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumn",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=9;break}if(!(r=this.getCellVertex(t,n))){e.next=6;break}return e.next=6,r;case 6:++n,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRow",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=9;break}if(!(r=this.getCellVertex(n,t))){e.next=6;break}return e.next=6,r;case 6:++n,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.columnStart;case 1:if(!(n<=t.columnEnd)){e.next=14;break}r=0;case 3:if(!(r<this.height)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,o;case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"verticesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=14;break}r=t.rowStart;case 3:if(!(r<=t.rowEnd)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,o;case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromRowsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.width)){e.next=14;break}r=t.rowStart;case 3:if(!(r<=t.rowEnd)){e.next=11;break}if(!(o=this.getCellVertex(n,r))){e.next=8;break}return e.next=8,[Yo(t.sheet,n,r),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"entriesFromColumnsSpan",value:regeneratorRuntime.mark((function e(t){var n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=0;case 1:if(!(n<this.height)){e.next=14;break}r=t.columnStart;case 3:if(!(r<=t.columnEnd)){e.next=11;break}if(!(o=this.getCellVertex(r,n))){e.next=8;break}return e.next=8,[Yo(t.sheet,r,n),o];case 8:++r,e.next=3;break;case 11:++n,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"vertices",value:regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.height)){e.next=14;break}n=0;case 3:if(!(n<this.width)){e.next=11;break}if(!(r=this.getCellVertex(n,t))){e.next=8;break}return e.next=8,r;case 8:++n,e.next=3;break;case 11:++t,e.next=1;break;case 14:case"end":return e.stop()}}),e,this)}))},{key:"getCellVertex",value:function(e,t){return this.mapping[t]&&this.mapping[t][e]||null}}])&&Co(t.prototype,n),r&&Co(t,r),e}();function _o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.DIV_BY_ZERO="DIV_BY_ZERO",e.NAME="NAME",e.VALUE="VALUE",e.NUM="NUM",e.NA="NA",e.CYCLE="CYCLE",e.REF="REF",e.LIC="LIC",e.ERROR="ERROR"}(Mo||(Mo={})),function(e){e.FORMULA="FORMULA",e.VALUE="VALUE",e.MATRIX="MATRIX",e.EMPTY="EMPTY"}(xo||(xo={}));var Po,Lo;!function(e){e.EMPTY="EMPTY",e.NUMBER="NUMBER",e.STRING="STRING",e.BOOLEAN="BOOLEAN",e.ERROR="ERROR"}(Po||(Po={})),function(e){e.NUMBER="NUMBER"}(Lo||(Lo={}));var Fo=Object.assign(Object.assign({},Po),Lo),Do=Object.assign(Object.assign({},Po),Pt),Uo=function(e){switch(e){case Fo.EMPTY:return 0;case Fo.NUMBER:return 1;case Fo.STRING:return 2;case Fo.BOOLEAN:return 3;case Fo.ERROR:return 4}throw new Error("Cell value not computed")},jo=function(e){if(e===Mt)return Fo.EMPTY;if(e instanceof Ho||e instanceof Qt)return Fo.ERROR;if("string"==typeof e)return Fo.STRING;if(Bt(e))return Fo.NUMBER;if("boolean"==typeof e)return Fo.BOOLEAN;throw new Error("Cell value not computed")},Bo=function(e){return Bt(e)?(t=e)instanceof It?t.getDetailedType():Pt.NUMBER_RAW:jo(e);var t},Vo=function(e){return Bt(e)&&(t=e)instanceof It?t.format:void 0;var t},Ho=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.type=t,this.message=n,this.address=r}var t,n,r;return t=e,r=[{key:"parsingError",value:function(){return new e(Mo.ERROR,Ne.ParseError)}}],(n=[{key:"attachAddress",value:function(t){return void 0===this.address?new e(this.type,this.message,t):this}}])&&_o(t.prototype,n),r&&_o(t,r),e}(),Go=function(e,t){return{sheet:e,row:t}},zo=function(e){return e.row<0},Wo=function(e,t){return{sheet:e,col:t}},$o=function(e){return e.col<0},Yo=function(e,t,n){return{sheet:e,col:t,row:n}},Ko=function(e){return e.col<0||e.row<0},qo=function(e,t,n,r){return Yo(t,e.col+n,e.row+r)},Xo=function(e,t){return null===e.sheet?t.sheet:e.sheet};var Jo=function e(t,n,r){var o;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.value=n,this.address=r,this.type=t.type,this.message=null!==(o=t.message)&&void 0!==o?o:""};n("yq1k"),n("JTJg"),n("ENF9"),n("SYor"),n("inlA");var Qo=/^ss\.(s+|0+)$/;function Zo(e,t){if(void 0!==t){(t=t.toLowerCase()).endsWith("am/pm")?t=t.substring(0,t.length-5).trim():t.endsWith("a/p")&&(t=t.substring(0,t.length-3).trim());var n=t.split(":"),r=void 0;"am"===e[e.length-1]||"a"===e[e.length-1]?(r=!1,e.pop()):"pm"!==e[e.length-1]&&"p"!==e[e.length-1]||(r=!0,e.pop());var o=0;if(n.length>=1&&Qo.test(n[n.length-1])&&(o=n[n.length-1].length-3,n[n.length-1]="ss"),e.length===n.length){var i=n.indexOf("hh"),a=n.indexOf("mm"),s=n.indexOf("ss"),u=-1!==i?e[i]:"0";if(/^\d+$/.test(u)){var c=Number(u);if(void 0!==r){if(c<0||c>12)return;c%=12,r&&(c+=12)}var l=-1!==a?e[a]:"0";if(/^\d+$/.test(l)){var f=Number(l),h=-1!==s?e[s]:"0";if(/^\d+(\.\d+)?$/.test(h)){var p=Number(h);return{hours:c,minutes:f,seconds:p=Math.round(p*Math.pow(10,o))/Math.pow(10,o)}}}}}}}function ei(e,t){if(void 0!==t){var n=t.toLowerCase().split(/[ /.-]/g);if(e.length===n.length){var r=n.indexOf("mm"),o=n.indexOf("dd"),i=n.indexOf("yyyy"),a=n.indexOf("yy");if(r in e&&o in e&&(i in e||a in e)&&(!(i in e)||!(a in e))){var s;if(i in e){var u=e[i];if(!/^\d+$/.test(u))return;if((s=Number(u))<1e3||s>9999)return}else{var c=e[a];if(!/^\d+$/.test(c))return;if((s=Number(c))<0||s>99)return}var l=e[r];if(/^\d+$/.test(l)){var f=Number(l),h=e[o];if(/^\d+$/.test(h))return{year:s,month:f,day:Number(h)}}}}}}function ti(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ni(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ni(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ni(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ri(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oi(e){return(oi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var ii=[31,28,31,30,31,30,31,31,30,31,30,31],ai=[0,31,59,90,120,151,181,212,243,273,304,334];function si(e){return!(!e||"object"!==oi(e)&&"function"!=typeof e)&&("year"in e&&"number"==typeof e.year&&"month"in e&&"number"==typeof e.month&&"day"in e&&"number"==typeof e.day)}function ui(e){return!(!e||"object"!==oi(e)&&"function"!=typeof e)&&("hours"in e&&"number"==typeof e.hours&&"minutes"in e&&"number"==typeof e.minutes&&"seconds"in e&&"number"==typeof e.seconds)}var ci={year:9999,month:12,day:31},li=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.minDateAboluteValue=this.dateToNumberFromZero(t.nullDate),this.maxDateValue=this.dateToNumber(ci),this.leapYear1900=t.leapYear1900,!this.leapYear1900&&0<=this.dateToNumber({year:1900,month:2,day:28})?this.epochYearZero=this.numberToSimpleDate(2).year:this.epochYearZero=this.numberToSimpleDate(1).year,this.parseDateTime=t.parseDateTime}var t,n,r;return t=e,(n=[{key:"getWithinBounds",value:function(e){return e<=this.maxDateValue&&e>=0?e:void 0}},{key:"dateStringToDateNumber",value:function(e){var t=this.parseDateTimeFromConfigFormats(e),n=t.dateTime,r=t.dateFormat,o=void 0===r?"":r,i=t.timeFormat,a=void 0===i?"":i;if(void 0!==n)return ui(n)?si(n)?new Ut(di(n)+this.dateToNumber(n),o+" "+a):new Dt(di(n),a):si(n)?new Lt(this.dateToNumber(n),o):0}},{key:"parseSingleFormat",value:function(e,t,n){var r=this.parseDateTime(e,t,n);if(!si(r)||(r.year>=0&&r.year<100&&(r.year<this.getNullYear()?r.year+=2e3:r.year+=1900),this.isValidDate(r)))return r}},{key:"parseDateTimeFromConfigFormats",value:function(e){return this.parseDateTimeFromFormats(e,this.config.dateFormats,this.config.timeFormats)}},{key:"parseDateTimeFromFormats",value:function(e,t,n){var r,o=0===t.length?[void 0]:t,i=0===n.length?[void 0]:n,a=ti(o);try{for(a.s();!(r=a.n()).done;){var s,u=r.value,c=ti(i);try{for(c.s();!(s=c.n()).done;){var l=s.value,f=this.parseSingleFormat(e,u,l);if(void 0!==f)return{dateTime:f,timeFormat:l,dateFormat:u}}}catch(e){c.e(e)}finally{c.f()}}}catch(e){a.e(e)}finally{a.f()}return{}}},{key:"getNullYear",value:function(){return this.config.nullYear}},{key:"getEpochYearZero",value:function(){return this.epochYearZero}},{key:"isValidDate",value:function(e){return!(isNaN(e.year)||isNaN(e.month)||isNaN(e.day)||e.day!==Math.round(e.day)||e.month!==Math.round(e.month)||e.year!==Math.round(e.year)||e.year<1582||e.month<1||e.month>12||e.day<1||!(this.isLeapYear(e.year)&&2===e.month?e.day<=29:e.day<=ii[e.month-1]))}},{key:"dateToNumber",value:function(e){return this.dateToNumberFromZero(e)-this.minDateAboluteValue}},{key:"relativeNumberToAbsoluteNumber",value:function(e){return e+this.minDateAboluteValue-(this.leapYear1900?1:0)}},{key:"numberToSimpleDate",value:function(e){var t=Math.floor(e)+this.minDateAboluteValue,n=Math.floor(t/365.2425);this.dateToNumberFromZero({year:n+1,month:1,day:1})<=t?n++:this.dateToNumberFromZero({year:n-1,month:1,day:1})>t&&n--;var r=t-this.dateToNumberFromZero({year:n,month:1,day:1}),o=function(e){var t=0;return ai[t+6]<=e&&(t+=6),ai[t+3]<=e&&(t+=3),ai[t+2]<=e?t+=2:ai[t+1]<=e&&(t+=1),t}(r-(this.isLeapYear(n)&&r>=59?1:0));return{year:n,month:o+1,day:r-ai[o]-(this.isLeapYear(n)&&o>1?1:0)+1}}},{key:"numberToSimpleDateTime",value:function(e){return Object.assign(Object.assign({},this.numberToSimpleDate(Math.floor(e))),pi(e%1))}},{key:"leapYearsCount",value:function(e){return Math.floor(e/4)-Math.floor(e/100)+Math.floor(e/400)+(this.config.leapYear1900&&e>=1900?1:0)}},{key:"countLeapDays",value:function(e){return e.month>2||2===e.month&&e.day>=29?this.leapYearsCount(e.year):this.leapYearsCount(e.year-1)}},{key:"dateToNumberFromZero",value:function(e){return 365*e.year+ai[e.month-1]+e.day-1+(e.month<=2?this.leapYearsCount(e.year-1):this.leapYearsCount(e.year))}},{key:"isLeapYear",value:function(e){return!(e%4)&&(!!(e%100)||!(e%400)||1900===e&&this.config.leapYear1900)}},{key:"daysInMonth",value:function(e,t){return this.isLeapYear(e)&&2===t?29:ii[t-1]}},{key:"endOfMonth",value:function(e){return{year:e.year,month:e.month,day:this.daysInMonth(e.year,e.month)}}},{key:"toBasisUS",value:function(e,t){return 31===e.day&&(e.day=30),30===e.day&&31===t.day&&(t.day=30),2===e.month&&e.day===this.daysInMonth(e.year,e.month)&&(e.day=30,2===t.month&&t.day===this.daysInMonth(t.year,t.month)&&(t.day=30)),[e,t]}},{key:"yearLengthForBasis",value:function(e,t){return e.year!==t.year?e.year+1!==t.year||e.month<t.month||e.month===t.month&&e.day<t.day?(this.leapYearsCount(t.year)-this.leapYearsCount(e.year-1))/(t.year-e.year+1)+365:this.countLeapDays(t)!==this.countLeapDays({year:e.year,month:e.month,day:e.day-1})?366:365:this.isLeapYear(e.year)?366:365}}])&&ri(t.prototype,n),r&&ri(t,r),e}();function fi(e,t){var n=12*e.year+e.month-1+t;return{year:Math.floor(n/12),month:n%12+1,day:e.day}}function hi(e){return Math.round(3600*e*24)/86400}function pi(e){e=Math.round(24*e*60*60*1e5)/864e7,e*=24;var t=Math.floor(e);e-=t,e*=60;var n=Math.floor(e);return e-=n,e*=60,{hours:t,minutes:n,seconds:Math.round(1e5*e)/1e5}}function di(e){return((e.seconds/60+e.minutes)/60+e.hours)/24}function mi(e){return{year:e.year,month:e.month,day:Math.min(30,e.day)}}function vi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gi(e,t,n){return t&&yi(e.prototype,t),n&&yi(e,n),e}var bi,Ei,wi=function(){function e(){vi(this,e)}return gi(e,[{key:"call",value:function(){return Io}}]),e}(),Si=(n("toAj"),/(\\.|dd|DD|d|D|mm|MM|m|M|YYYY|YY|yyyy|yy|HH|hh|H|h|ss(\.(0+|s+))?|s|AM\/PM|am\/pm|A\/P|a\/p|\[mm]|\[MM]|\[hh]|\[HH])/g),Ti=/(\\.|[#0]+(\.[#0]*)?)/g;function Oi(e,t){return{type:e,value:t}}function Ri(e,t){for(var n=[],r=0,o=0;o<e.length;++o){var i=e[o];if(i.index!==r){var a=t.substr(r,i.index-r);n.push(Oi(bi.FREE_TEXT,a))}i[0].startsWith("\\")?n.push(Oi(bi.FREE_TEXT,i[0])):n.push(Oi(bi.FORMAT,i[0])),r=i.index+i[0].length}var s=e[e.length-1];if(s.index+s[0].length<t.length){var u=t.substr(s.index+s[0].length,t.length);n.push(Oi(bi.FREE_TEXT,u))}return n}function Ni(e){var t=function(e){Si.lastIndex=0;var t,n=[];do{null!==(t=Si.exec(e))&&n.push(t)}while(t);return n}(e);return t.every((function(e){return Ai(e)}))?void 0:{type:Ei.DATE,tokens:Ri(t,e)}}function ki(e){var t=function(e){Ti.lastIndex=0;var t=Ti.exec(e);return null!==t?[t]:[]}(e);return t.every((function(e){return Ai(e)}))?void 0:{type:Ei.NUMBER,tokens:Ri(t,e)}}function Ai(e){return e[0].startsWith("\\")}function Ci(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Mi(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Mi(e,t){if(e){if("string"==typeof e)return xi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xi(e,t):void 0}}function xi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ii(e,t,n,r){var o=n.stringifyDateTime(r.numberToSimpleDateTime(e),t);if(void 0!==o)return o;var i=n.stringifyDuration(pi(e),t);if(void 0!==i)return i;var a=ki(t);return void 0!==a?function(e,t){for(var n="",r=0;r<e.length;++r){var o=e[r];if(o.type!==bi.FREE_TEXT){var i=o.value.split("."),a=i[0],s=i[1]||"",u=i[1]?".":"",c=Number(t.toFixed(s.length)).toString().split("."),l=c[0]||"",f=c[1]||"";if(a.length>l.length){var h=Li(a.substr(0,a.length-l.length),"0");l=_i(l,h+l.length)}var p=Li(s.substr(f.length,s.length-f.length),"0");f=Pi(f,p+f.length),n+=l+u+f}else n+=o.value}return n}(a.tokens,e):t}function _i(e,t){for(var n=e+"";n.length<t;)n="0"+n;return n}function Pi(e,t){for(var n=e+"";n.length<t;)n+="0";return n}function Li(e,t){return e.split(t).length-1}function Fi(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||ji(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Di(e){return function(e){if(Array.isArray(e))return Bi(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ji(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ui(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ji(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function ji(e,t){if(e){if("string"==typeof e)return Bi(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Bi(e,t):void 0}}function Bi(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vi(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.FORMAT="FORMAT",e.FREE_TEXT="FREE_TEXT"}(bi||(bi={})),function(e){e.DATE="DATE",e.NUMBER="NUMBER",e.STRING="STRING"}(Ei||(Ei={}));var Hi=/^\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij]))\s*(([+-])\s*([+-]?)\s*(([\d\.,]+(e[+-]?\d+)?)\s*([ij]?)|([ij])))?$/,Gi=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.dateTimeHelper=n,this.numberLiteralsHelper=r,this.lt=function(e,t){return o.compare(e,t)<0},this.leq=function(e,t){return o.compare(e,t)<=0},this.gt=function(e,t){return o.compare(e,t)>0},this.geq=function(e,t){return o.compare(e,t)>=0},this.eq=function(e,t){return 0===o.compare(e,t)},this.neq=function(e,t){return 0!==o.compare(e,t)},this.pow=function(e,t){return Math.pow(xt(e),xt(t))},this.addWithEpsilonRaw=function(e,t){var n=e+t;return Math.abs(n)<o.actualEps*Math.abs(e)?0:n},this.addWithEpsilon=function(e,t){var n=ia(e,t);return o.ExtendedNumberFactory(o.addWithEpsilonRaw(xt(e),xt(t)),n)},this.unaryMinus=function(e){return _t(e,-xt(e))},this.unaryPlus=function(e){return e},this.unaryPercent=function(e){return new jt(xt(e)/100)},this.concat=function(e,t){return e.concat(t)},this.nonstrictadd=function(e,t){return e instanceof Ho?e:t instanceof Ho?t:"number"==typeof e?"number"==typeof t?o.addWithEpsilonRaw(e,t):e:"number"==typeof t?t:0},this.subtract=function(e,t){var n=ia(e,t),r=xt(e),i=r-xt(t);return Math.abs(i)<o.actualEps*Math.abs(r)&&(i=0),o.ExtendedNumberFactory(i,n)},this.divide=function(e,t){var n=xt(e),r=xt(t);if(0===r)return new Ho(Mo.DIV_BY_ZERO);var i=aa(e,t);return o.ExtendedNumberFactory(n/r,i)},this.multiply=function(e,t){var n=aa(e,t);return o.ExtendedNumberFactory(xt(e)*xt(t),n)},this.manyToExactComplex=function(e){var t,n=[],r=Ui(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof Ho)return i;if(Bt(i)||"string"==typeof i){var a=o.coerceScalarToComplex(i);a instanceof Ho||n.push(a)}}}catch(e){r.e(e)}finally{r.f()}return n},this.coerceNumbersExactRanges=function(e){return o.manyToNumbers(e,o.manyToExactNumbers)},this.coerceNumbersCoerceRangesDropNulls=function(e){return o.manyToNumbers(e,o.manyToCoercedNumbersDropNulls)},this.manyToExactNumbers=function(e){var t,n=[],r=Ui(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof Ho)return o;Bt(o)&&n.push(xt(o))}}catch(e){r.e(e)}finally{r.f()}return n},this.manyToOnlyNumbersDropNulls=function(e){var t,n=[],r=Ui(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof Ho)return o;if(o!==Mt){if(!Bt(o))return new Ho(Mo.VALUE,Ne.NumberExpected);n.push(xt(o))}}}catch(e){r.e(e)}finally{r.f()}return n},this.manyToCoercedNumbersDropNulls=function(e){var t,n=[],r=Ui(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i instanceof Ho)return i;if(i!==Mt){var a=o.coerceScalarToNumberOrError(i);Bt(a)&&n.push(xt(a))}}}catch(e){r.e(e)}finally{r.f()}return n},this.collator=function(e){var t=e.caseSensitive?e.accentSensitive?"variant":"case":e.accentSensitive?"accent":"base",n=e.caseFirst,r=e.ignorePunctuation;return new Intl.Collator(e.localeLang,{sensitivity:t,caseFirst:n,ignorePunctuation:r})}(t),this.actualEps=t.smartRounding?t.precisionEpsilon:0}var t,n,r;return t=e,(n=[{key:"eqMatcherFunction",value:function(e){var t=this,n=this.buildRegex(e);return function(e){return"string"==typeof e&&n.test(t.normalizeString(e))}}},{key:"neqMatcherFunction",value:function(e){var t=this,n=this.buildRegex(e);return function(e){return!("string"==typeof e&&n.test(t.normalizeString(e)))}}},{key:"searchString",value:function(e,t){var n,r=this.buildRegex(e,!1).exec(t);return null!==(n=null==r?void 0:r.index)&&void 0!==n?n:-1}},{key:"requiresRegex",value:function(e){if(!this.config.useRegularExpressions&&!this.config.useWildcards)return!this.config.matchWholeCell;for(var t=0;t<e.length;t++){var n=e.charAt(t);if(Qi(n)||this.config.useRegularExpressions&&ta(n))return!0}return!1}},{key:"buildRegex",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=this.normalizeString(e);var r=this.config.useWildcards,o=this.config.useRegularExpressions;if(o)try{RegExp(e)}catch(e){o=!1,r=!1}return t=o?oa(e,this.config.caseSensitive):r?na(e,this.config.caseSensitive):ra(e,this.config.caseSensitive),this.config.matchWholeCell&&n?RegExp("^("+t+")$"):RegExp(t)}},{key:"normalizeString",value:function(e){return this.config.caseSensitive||(e=e.toLowerCase()),this.config.accentSensitive||(e=e.normalize("NFD").replace(/[\u0300-\u036f]/g,"")),e}},{key:"compare",value:function(e,t){if("string"==typeof e||"string"==typeof t){var n="string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):e,r="string"==typeof t?this.dateTimeHelper.dateStringToDateNumber(t):t;if(Bt(n)&&Bt(r))return this.floatCmp(n,r)}return e===Mt?e=$i(t):t===Mt&&(t=$i(e)),"string"==typeof e&&"string"==typeof t?this.stringCmp(e,t):"boolean"==typeof e&&"boolean"==typeof t?qi(Wi(e),Wi(t)):Bt(e)&&Bt(t)?this.floatCmp(e,t):e===Mt&&t===Mt?0:qi(Uo(jo(e)),Uo(jo(t)))}},{key:"floatCmp",value:function(e,t){var n=xt(e),r=xt(t),o=1+this.actualEps;return r>=0&&n*o>=r&&n<=r*o||r<=0&&n*o<=r&&n>=r*o?0:n>r?1:-1}},{key:"stringCmp",value:function(e,t){return this.collator.compare(e,t)}},{key:"coerceScalarToNumberOrError",value:function(e){var t;return e instanceof Ho?e:null!==(t=this.coerceToMaybeNumber(e))&&void 0!==t?t:new Ho(Mo.VALUE,Ne.NumberCoercion)}},{key:"coerceToMaybeNumber",value:function(e){var t;return null!==(t=this.coerceNonDateScalarToMaybeNumber(e))&&void 0!==t?t:"string"==typeof e?this.dateTimeHelper.dateStringToDateNumber(e):void 0}},{key:"coerceNonDateScalarToMaybeNumber",value:function(e){return e===Mt?0:"string"==typeof e?""===e?0:this.numberLiteralsHelper.numericStringToMaybeNumber(e.trim()):Bt(e)?e:"boolean"==typeof e?Number(e):void 0}},{key:"coerceComplexExactRanges",value:function(e){var t,n=[],r=Ui(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;if(o instanceof Qt)n.push(o);else if(o!==Mt){var i=this.coerceScalarToComplex(o);if(i instanceof Ho)return i;n.push(i)}}}catch(e){r.e(e)}finally{r.f()}for(var a=[],s=0,u=n;s<u.length;s++){var c=u[s];if(c instanceof Qt){var l=this.manyToExactComplex(c.valuesFromTopLeftCorner());if(l instanceof Ho)return l;a.push.apply(a,Di(l))}else a.push(c)}return a}},{key:"manyToNumbers",value:function(e,t){var n,r=[],o=Ui(e);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i instanceof Qt)r.push(i);else{var a=xt(this.coerceScalarToNumberOrError(i));if(a instanceof Ho)return a;r.push(a)}}}catch(e){o.e(e)}finally{o.f()}for(var s=[],u=0,c=r;u<c.length;u++){var l=c[u];if(l instanceof Qt){var f=t(l.valuesFromTopLeftCorner());if(f instanceof Ho)return f;s.push.apply(s,Di(f))}else s.push(l)}return s}},{key:"coerceScalarToComplex",value:function(e){return e instanceof Ho?e:e===Mt?[0,0]:Bt(e)?[xt(e),0]:"string"==typeof e?this.coerceStringToComplex(e):new Ho(Mo.NUM,Ne.ComplexNumberExpected)}},{key:"coerceStringToComplex",value:function(e){var t,n,r=Hi.exec(e);return null===r?new Ho(Mo.NUM,Ne.ComplexNumberExpected):(t=void 0!==r[6]?"-"===r[1]?[0,-1]:[0,1]:this.parseComplexToken(r[1]+r[3],r[5]))instanceof Ho||void 0===r[8]?t:(n=void 0!==r[14]?"-"===r[9]?[0,-1]:[0,1]:this.parseComplexToken(r[9]+r[11],r[13]))instanceof Ho?n:""!==r[5]||""===r[13]?new Ho(Mo.NUM,Ne.ComplexNumberExpected):"+"===r[8]?[t[0]+n[0],t[1]+n[1]]:[t[0]-n[0],t[1]-n[1]]}},{key:"parseComplexToken",value:function(e,t){var n=xt(this.coerceNonDateScalarToMaybeNumber(e));return void 0===n?new Ho(Mo.NUM,Ne.ComplexNumberExpected):""===t?[n,0]:[0,n]}},{key:"ExtendedNumberFactory",value:function(e,t){var n=t.type,r=t.format;switch(n){case Pt.NUMBER_RAW:return e;case Pt.NUMBER_CURRENCY:return new Ft(e,null!=r?r:this.config.currencySymbol[0]);case Pt.NUMBER_DATE:return new Lt(e,r);case Pt.NUMBER_DATETIME:return new Ut(e,r);case Pt.NUMBER_TIME:return new Dt(e,r);case Pt.NUMBER_PERCENT:return new jt(e,r)}}}])&&Vi(t.prototype,n),r&&Vi(t,r),e}();function zi(e,t){var n=Fi(e,2),r=n[0],o=n[1];if(!isFinite(r)||!isFinite(o))return new Ho(Mo.NUM,Ne.NaN);if(t=null!=t?t:"i",0===o)return"".concat(r);var i="".concat(-1===o||1===o?"":Math.abs(o)).concat(t);return 0===r?"".concat(o<0?"-":"").concat(i):"".concat(r).concat(o<0?"-":"+").concat(i)}function Wi(e){return Number(e)}function $i(e){return"string"==typeof e?"":Bt(e)?0:"boolean"!=typeof e&&Mt}function Yi(e){return e instanceof Ho||"string"==typeof e?e:e===Mt?"":Bt(e)?xt(e).toString():e?"TRUE":"FALSE"}function Ki(e){return e===Mt?0:e}function qi(e,t){var n=xt(e),r=xt(t);return n>r?1:n<r?-1:0}function Xi(e){return isNaN(e)||e===1/0||e===-1/0}function Ji(e){return 0===e?0:e}function Qi(e){return["*","?"].includes(e)}var Zi,ea=["{","}","[","]","(",")","<",">","=",".","+","-",",","\\","$","^","!"];function ta(e){return ea.includes(e)}function na(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);if("~"===o){if(r==e.length-1){n+="~";continue}var i=e.charAt(r+1);Qi(i)||ta(i)?(n+="\\"+i,r++):(n+=i,r++)}else Qi(o)?n+="."+o:ta(o)?n+="\\"+o:n+=t?o:o.toLowerCase()}return n}function ra(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);Qi(o)||ta(o)?n+="\\"+o:n+=t?o:o.toLowerCase()}return n}function oa(e,t){for(var n="",r=0;r<e.length;r++){var o=e.charAt(r);Qi(o)||ta(o)?n+=o:n+=t?o:o.toLowerCase()}return n}function ia(e,t){var n=Vt(e),r=n.type,o=n.format,i=Vt(t),a=i.type,s=i.format;if(r===Pt.NUMBER_RAW)return{type:a,format:s};if(a===Pt.NUMBER_RAW)return{type:r,format:o};if(!(r!==Pt.NUMBER_DATETIME&&r!==Pt.NUMBER_DATE||a!==Pt.NUMBER_DATETIME&&a!==Pt.NUMBER_DATE))return{type:Pt.NUMBER_RAW};if(r===Pt.NUMBER_TIME){if(a===Pt.NUMBER_DATE)return{type:Pt.NUMBER_DATETIME,format:s+" "+o};if(a===Pt.NUMBER_DATETIME)return{type:Pt.NUMBER_DATETIME,format:s}}if(a===Pt.NUMBER_TIME){if(r===Pt.NUMBER_DATE)return{type:Pt.NUMBER_DATETIME,format:o+" "+s};if(r===Pt.NUMBER_DATETIME)return{type:Pt.NUMBER_DATETIME,format:o}}return{type:r,format:o}}function aa(e,t){var n=Vt(e),r=n.type,o=n.format,i=Vt(t),a=i.type,s=i.format;return r===Pt.NUMBER_PERCENT&&(r=Pt.NUMBER_RAW,o=void 0),a===Pt.NUMBER_PERCENT&&(a=Pt.NUMBER_RAW,s=void 0),r===Pt.NUMBER_RAW?{type:a,format:s}:a===Pt.NUMBER_RAW?{type:r,format:o}:{type:Pt.NUMBER_RAW}}function sa(e){return e.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"")}function ua(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||ca(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ca(e,t){if(e){if("string"==typeof e)return la(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?la(e,t):void 0}}function la(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function fa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ha(e,t,n){return t&&fa(e.prototype,t),n&&fa(e,n),e}function pa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function da(e){return"string"==typeof e&&(e.length>1&&e.startsWith("{")&&e.endsWith("}"))}!function(e){e.Number=function e(t){pa(this,e),this.value=t,this.value=_t(this.value,Ji(xt(this.value)))};e.String=function e(t){pa(this,e),this.value=t};e.Boolean=function e(t){pa(this,e),this.value=t};var t=function(){function e(){pa(this,e)}return ha(e,null,[{key:"getSingletonInstance",value:function(){return e.instance||(e.instance=new e),e.instance}}]),e}();e.Empty=t;e.Formula=function e(t){pa(this,e),this.formula=t};var n=function(){function e(t){pa(this,e),this.formula=t}return ha(e,[{key:"formulaWithBraces",value:function(){return"{"+this.formula+"}"}}]),e}();e.MatrixFormula=n;e.Error=function e(t){pa(this,e),this.value=new Ho(t)}}(Zi||(Zi={}));var ma,va,ya=function(){function e(t,n,r){pa(this,e),this.config=t,this.dateHelper=n,this.numberLiteralsHelper=r}return ha(e,[{key:"currencyMatcher",value:function(e){var t,n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=ca(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(this.config.currencySymbol);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e.startsWith(r))return[r,e.slice(r.length)];if(e.endsWith(r))return[r,e.slice(0,e.length-r.length)]}}catch(e){n.e(e)}finally{n.f()}}},{key:"parse",value:function(e){if(null==e)return Zi.Empty.getSingletonInstance();if("number"==typeof e)return Xi(e)?new Zi.Error(Mo.NUM):new Zi.Number(e);if("boolean"==typeof e)return new Zi.Boolean(e);if(e instanceof Date)return new Zi.Number(new Lt(this.dateHelper.dateToNumber({day:e.getDate(),month:e.getMonth()+1,year:e.getFullYear()}),"Date()"));if("string"==typeof e){if("true"===(c=e.toLowerCase())||"false"===c)return new Zi.Boolean("true"===e.toLowerCase());if(da(e))return new Zi.MatrixFormula(e.substr(1,e.length-2));if(function(e){return e.startsWith("=")}(e))return new Zi.Formula(e);if(function(e,t){var n=e.toUpperCase();return/#[A-Za-z0-9\/]+[?!]?/.test(n)&&Object.prototype.hasOwnProperty.call(t,n)}(e,this.config.errorMapping))return new Zi.Error(this.config.errorMapping[e.toUpperCase()]);var t,n=e.trim(),r=0;if(n.endsWith("%"))r=1,n=n.slice(0,n.length-1);else{var o=this.currencyMatcher(n);if(void 0!==o){r=2;var i=ua(o,2);t=i[0],n=i[1]}}var a,s=this.numberLiteralsHelper.numericStringToMaybeNumber(n);if(void 0!==s)return a=1===r?new jt(s/100):2===r?new Ft(s,t):s,new Zi.Number(a);var u=this.dateHelper.dateStringToDateNumber(n);return void 0!==u?new Zi.Number(u):new Zi.String(e.startsWith("'")?e.slice(1):e)}throw new Fn(e);var c}}]),e}();function ga(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ba(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ea(e,t,n){return t&&ba(e.prototype,t),n&&ba(e,n),e}!function(e){e[e.COPY=0]="COPY",e[e.CUT=1]="CUT"}(ma||(ma={})),function(e){e[e.VALUE=0]="VALUE",e[e.EMPTY=1]="EMPTY",e[e.FORMULA=2]="FORMULA",e[e.PARSING_ERROR=3]="PARSING_ERROR"}(va||(va={}));var wa=function(){function e(t,n,r,o,i){ga(this,e),this.sourceLeftCorner=t,this.width=n,this.height=r,this.type=o,this.content=i}return Ea(e,[{key:"getContent",value:regeneratorRuntime.mark((function e(t){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==this.content){e.next=4;break}return e.abrupt("return");case 4:n=0;case 5:if(!(n<this.height)){e.next=16;break}r=0;case 7:if(!(r<this.width)){e.next=13;break}return e.next=10,[Yo(t.sheet,t.col+r,t.row+n),this.content[n][r]];case 10:++r,e.next=7;break;case 13:++n,e.next=5;break;case 16:case"end":return e.stop()}}),e,this)}))}]),e}(),Sa=function(){function e(t,n,r,o,i){ga(this,e),this.dependencyGraph=t,this.operations=n,this.parser=r,this.lazilyTransformingAstService=o,this.config=i}return Ea(e,[{key:"cut",value:function(e,t,n){this.clipboard=new wa(e,t,n,ma.CUT)}},{key:"copy",value:function(e,t,n){for(var r=[],o=0;o<n;++o){r[o]=[];for(var i=0;i<t;++i){var a=this.operations.getClipboardCell(Yo(e.sheet,e.col+i,e.row+o));r[o].push(a)}}this.clipboard=new wa(e,t,n,ma.COPY,r)}},{key:"abortCut",value:function(){this.clipboard&&this.clipboard.type===ma.CUT&&this.clear()}},{key:"clear",value:function(){this.clipboard=void 0}},{key:"ensureItIsPossibleToCopyPaste",value:function(e){if(void 0!==this.clipboard){if(Ko(e)||!this.dependencyGraph.sheetMapping.hasSheetWithId(e.sheet))throw new An("a valid target address.");var t=yt.spanFrom(e,this.clipboard.width,this.clipboard.height);if(t.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new Rn;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(t))throw new Error("It is not possible to paste onto matrix")}}},{key:"isCutClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ma.CUT}},{key:"isCopyClipboard",value:function(){return void 0!==this.clipboard&&this.clipboard.type===ma.COPY}}]),e}();function Ta(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Ra(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Oa(e){return function(e){if(Array.isArray(e))return Na(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ra(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ra(e,t){if(e){if("string"==typeof e)return Na(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Na(e,t):void 0}}function Na(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ka(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Aa=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.changes=[]}var t,n,r;return t=e,r=[{key:"empty",value:function(){return new e}}],(n=[{key:"addAll",value:function(e){var t;return(t=this.changes).push.apply(t,Oa(e.changes)),this}},{key:"addMatrixChange",value:function(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Ra(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.generateValues(t));try{for(r.s();!(n=r.n()).done;){var o=Ta(n.value,2),i=o[0],a=o[1];this.addSingleCellValue(i,a)}}catch(e){r.e(e)}finally{r.f()}}},{key:"addChange",value:function(e,t){this.addSingleCellValue(e,t)}},{key:"add",value:function(){var e;(e=this.changes).push.apply(e,arguments)}},{key:"exportChanges",value:function(e){var t=this,n=[];return this.changes.forEach((function(r,o){n[o]=e.exportChange(t.changes[o])})),n}},{key:"getChanges",value:function(){return this.changes}},{key:"isEmpty",value:function(){return this.changes===[]}},{key:"addSingleCellValue",value:function(e,t){this.add({sheet:t.sheet,col:t.col,row:t.row,value:e})}}])&&ka(t.prototype,n),r&&ka(t,r),e}();function Ca(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Ma(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ma(e,t){if(e){if("string"==typeof e)return xa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xa(e,t):void 0}}function xa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ia(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var _a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,(n=[{key:"performEagerTransformations",value:function(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Ma(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.matrixFormulaNodes());try{for(r.s();!(n=r.n()).done;){var o=n.value,i=Ca(this.transformSingleAst(o.getFormula(),o.getAddress()),2),a=i[0],s=i[1],u=t.rememberNewAst(a);o.setFormula(u),o.setAddress(s)}}catch(e){r.e(e)}finally{r.f()}}},{key:"transformSingleAst",value:function(e,t){return[this.transformAst(e,t),this.fixNodeAddress(t)]}},{key:"transformAst",value:function(e,t){var n=this;switch(e.type){case le.CELL_REFERENCE:return this.transformCellReferenceAst(e,t);case le.CELL_RANGE:return this.transformCellRangeAst(e,t);case le.COLUMN_RANGE:return this.transformColumnRangeAst(e,t);case le.ROW_RANGE:return this.transformRowRangeAst(e,t);case le.EMPTY:case le.ERROR:case le.NUMBER:case le.NAMED_EXPRESSION:case le.ERROR_WITH_RAW_INPUT:case le.STRING:return e;case le.PERCENT_OP:case le.MINUS_UNARY_OP:case le.PLUS_UNARY_OP:return Object.assign(Object.assign({},e),{type:e.type,value:this.transformAst(e.value,t)});case le.FUNCTION_CALL:return Object.assign(Object.assign({},e),{type:e.type,procedureName:e.procedureName,args:e.args.map((function(e){return n.transformAst(e,t)}))});case le.PARENTHESIS:return Object.assign(Object.assign({},e),{type:e.type,expression:this.transformAst(e.expression,t)});default:return Object.assign(Object.assign({},e),{type:e.type,left:this.transformAst(e.left,t),right:this.transformAst(e.right,t)})}}},{key:"transformCellReferenceAst",value:function(e,t){var n=this.transformCellAddress(e.reference,t);return n instanceof m?Object.assign(Object.assign({},e),{reference:n}):n===Mo.REF?ve(new Ho(Mo.REF)):e}},{key:"transformCellRangeAst",value:function(e,t){var n=this.transformCellRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===Mo.REF?ve(new Ho(Mo.REF)):e}},{key:"transformColumnRangeAst",value:function(e,t){var n=this.transformColumnRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===Mo.REF?ve(new Ho(Mo.REF)):e}},{key:"transformRowRangeAst",value:function(e,t){var n=this.transformRowRange(e.start,e.end,t);return Array.isArray(n)?Object.assign(Object.assign({},e),{start:n[0],end:n[1]}):n===Mo.REF?ve(new Ho(Mo.REF)):e}}])&&Ia(t.prototype,n),r&&Ia(t,r),e}();function Pa(e){return(Pa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function La(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fa(e,t){return(Fa=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Da(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ja(e);if(t){var o=ja(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ua(this,n)}}function Ua(e,t){return!t||"object"!==Pa(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ja(e){return(ja=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ba=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Fa(e,t)}(i,e);var t,n,r,o=Da(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).columnsSpan=e,t}return t=i,(n=[{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformCellAddress",value:function(e,t){var n=Xo(e,t);if(n!==this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet)return!1;var r=e.toSimpleColumnAddress(t);return n===this.columnsSpan.sheet&&t.sheet!==this.columnsSpan.sheet?this.columnsSpan.columnStart<=r.col&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):t.sheet===this.columnsSpan.sheet&&n!==this.columnsSpan.sheet?!e.isColumnAbsolute()&&!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):e.isColumnAbsolute()?!(e.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(this.columnsSpan.numberOfColumns):e.toSimpleColumnAddress(t).col<this.columnsSpan.columnStart?!(t.col<this.columnsSpan.columnStart)&&e.shiftedByColumns(-this.columnsSpan.numberOfColumns):t.col<this.columnsSpan.columnStart&&e.shiftedByColumns(this.columnsSpan.numberOfColumns)}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col+this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return r===Mo.REF||o===Mo.REF?Mo.REF:!(!r&&!o)&&[r||e,o||t]}}])&&La(t.prototype,n),r&&La(t,r),i}(_a);function Va(e){return(Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ha(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ga(e,t){return(Ga=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function za(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$a(e);if(t){var o=$a(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wa(this,n)}}function Wa(e,t){return!t||"object"!==Va(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $a(e){return($a=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ya=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ga(e,t)}(i,e);var t,n,r,o=za(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).rowsSpan=e,t}return t=i,(n=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!1}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformCellAddress",value:function(e,t){var n=Xo(e,t);if(n!==this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet)return!1;var r=e.toSimpleRowAddress(t);return n===this.rowsSpan.sheet&&t.sheet!==this.rowsSpan.sheet?this.rowsSpan.rowStart<=r.row&&e.shiftedByRows(this.rowsSpan.numberOfRows):t.sheet===this.rowsSpan.sheet&&n!==this.rowsSpan.sheet?!e.isRowAbsolute()&&!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):e.isRowAbsolute()?!(e.row<this.rowsSpan.rowStart)&&e.shiftedByRows(this.rowsSpan.numberOfRows):r.row<this.rowsSpan.rowStart?!(t.row<this.rowsSpan.rowStart)&&e.shiftedByRows(-this.rowsSpan.numberOfRows):t.row<this.rowsSpan.rowStart&&e.shiftedByRows(this.rowsSpan.numberOfRows)}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row+this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return r===Mo.REF||o===Mo.REF?Mo.REF:!(!r&&!o)&&[r||e,o||t]}}])&&Ha(t.prototype,n),r&&Ha(t,r),i}(_a);function Ka(e){return(Ka="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function qa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Xa(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ja(e,t,n){return t&&Xa(e.prototype,t),n&&Xa(e,n),e}function Qa(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Za(e,t)}function Za(e,t){return(Za=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function es(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ns(e);if(t){var o=ns(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ts(this,n)}}function ts(e,t){return!t||"object"!==Ka(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ns(e){return(ns=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var rs=function(e){Qa(n,e);var t=es(n);function n(e,r,o,i){var a;return qa(this,n),(a=t.call(this)).sourceRange=e,a.toRight=r,a.toBottom=o,a.toSheet=i,a.dependentFormulaTransformer=new is(e,r,o,i),a}return Ja(n,[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"transformSingleAst",value:function(e,t){return this.sourceRange.addressInRange(t)?[this.transformAst(e,t),this.fixNodeAddress(t)]:this.dependentFormulaTransformer.transformSingleAst(e,t)}},{key:"fixNodeAddress",value:function(e){return Yo(this.toSheet,e.col+this.toRight,e.row+this.toBottom)}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e,t)}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformAddress",value:function(e,t){var n=this.sourceRange;if(e instanceof m){var r=e.toSimpleCellAddress(t);if(n.addressInRange(r))return e.shiftAbsoluteDimensions(this.toRight,this.toBottom)}return e.shiftRelativeDimensions(-this.toRight,-this.toBottom)}},{key:"transformRange",value:function(e,t,n){var r=this.sourceRange;if(e instanceof m&&t instanceof m){var o=e.toSimpleCellAddress(n),i=t.toSimpleCellAddress(n);if(r.addressInRange(o)&&r.addressInRange(i))return[e.shiftAbsoluteDimensions(this.toRight,this.toBottom),t.shiftAbsoluteDimensions(this.toRight,this.toBottom)]}return[e.shiftRelativeDimensions(-this.toRight,-this.toBottom),t.shiftRelativeDimensions(-this.toRight,-this.toBottom)]}}]),n}(_a),is=function(e){Qa(n,e);var t=es(n);function n(e,r,o,i){var a;return qa(this,n),(a=t.call(this)).sourceRange=e,a.toRight=r,a.toBottom=o,a.toSheet=i,a}return Ja(n,[{key:"sheet",get:function(){return this.sourceRange.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!this.shouldMove(e,t)&&e.moved(this.toSheet,this.toRight,this.toBottom)}},{key:"shouldMove",value:function(e,t){return e instanceof m?this.sourceRange.addressInRange(e.toSimpleCellAddress(t)):e instanceof X?this.sourceRange.rowInRange(e.toSimpleRowAddress(t))&&!this.sourceRange.isFinite():this.sourceRange.columnInRange(e.toSimpleColumnAddress(t))&&!this.sourceRange.isFinite()}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRange",value:function(e,t,n){var r=this.transformCellAddress(e,n),o=this.transformCellAddress(t,n);return!(!r||!o)&&[r,o]}}]),n}(_a);function as(e){return(as="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ss(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function us(e,t){return(us=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fs(e);if(t){var o=fs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ls(this,n)}}function ls(e,t){return!t||"object"!==as(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fs(e){return(fs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var hs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&us(e,t)}(i,e);var t,n,r,o=cs(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).columnsSpan=e,t}return t=i,(n=[{key:"isIrreversible",value:function(){return!0}},{key:"sheet",get:function(){return this.columnsSpan.sheet}},{key:"transformRowRangeAst",value:function(e,t){return e}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"transformColumnRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformCellAddress",value:function(e,t){var n=Xo(e,t);if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet!==n)return!1;if(this.columnsSpan.sheet!==t.sheet&&this.columnsSpan.sheet===n){var r=e.toSimpleColumnAddress(t);if(r.col<this.columnsSpan.columnStart)return!1;if(r.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet!==n){if(e.isColumnAbsolute())return!1;if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}if(this.columnsSpan.sheet===t.sheet&&this.columnsSpan.sheet===n)if(e.isColumnAbsolute()){if(e.col<this.columnsSpan.columnStart)return!1;if(e.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns)}else{var o=e.toSimpleColumnAddress(t);if(o.col<this.columnsSpan.columnStart){if(t.col<this.columnsSpan.columnStart)return!1;if(t.col>this.columnsSpan.columnEnd)return e.shiftedByColumns(this.columnsSpan.numberOfColumns)}else if(o.col>this.columnsSpan.columnEnd){if(t.col<this.columnsSpan.columnStart)return e.shiftedByColumns(-this.columnsSpan.numberOfColumns);if(t.col>this.columnsSpan.columnEnd)return!1}}return Mo.REF}},{key:"fixNodeAddress",value:function(e){return this.columnsSpan.sheet===e.sheet&&this.columnsSpan.columnStart<=e.col?Object.assign(Object.assign({},e),{col:e.col-this.columnsSpan.numberOfColumns}):e}},{key:"transformRange",value:function(e,t,n){var r=Xo(e,n),o=e,i=t;if(this.columnsSpan.sheet===r){var a=e.toSimpleColumnAddress(n),s=t.toSimpleColumnAddress(n);if(this.columnsSpan.columnStart<=a.col&&this.columnsSpan.columnEnd>=s.col)return Mo.REF;a.col>=this.columnsSpan.columnStart&&a.col<=this.columnsSpan.columnEnd&&(o=e.shiftedByColumns(this.columnsSpan.columnEnd-a.col+1)),s.col>=this.columnsSpan.columnStart&&s.col<=this.columnsSpan.columnEnd&&(i=t.shiftedByColumns(-(s.col-this.columnsSpan.columnStart+1)))}var u=this.transformCellAddress(o,n),c=this.transformCellAddress(i,n);if(!1===u&&!1===c)return[o,i];if(u===Mo.REF||c===Mo.REF)throw Error("Cannot happen");return[u||o,c||i]}}])&&ss(t.prototype,n),r&&ss(t,r),i}(_a);function ps(e){return(ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ds(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ms(e,t){return(ms=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gs(e);if(t){var o=gs(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ys(this,n)}}function ys(e,t){return!t||"object"!==ps(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gs(e){return(gs=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var bs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ms(e,t)}(i,e);var t,n,r,o=vs(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).rowsSpan=e,t}return t=i,(n=[{key:"sheet",get:function(){return this.rowsSpan.sheet}},{key:"isIrreversible",value:function(){return!0}},{key:"transformColumnRangeAst",value:function(e,t){return e}},{key:"transformCellAddress",value:function(e,t){var n=Xo(e,t);if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet!==n)return!1;if(this.rowsSpan.sheet!==t.sheet&&this.rowsSpan.sheet===n){var r=e.toSimpleRowAddress(t);if(r.row<this.rowsSpan.rowStart)return!1;if(r.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet!==n){if(e.isRowAbsolute())return!1;if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}if(this.rowsSpan.sheet===t.sheet&&this.rowsSpan.sheet===n)if(e.isRowAbsolute()){if(e.row<this.rowsSpan.rowStart)return!1;if(e.row>this.rowsSpan.rowEnd)return e.shiftedByRows(-this.rowsSpan.numberOfRows)}else{var o=e.toSimpleRowAddress(t);if(o.row<this.rowsSpan.rowStart){if(t.row<this.rowsSpan.rowStart)return!1;if(t.row>this.rowsSpan.rowEnd)return e.shiftedByRows(this.rowsSpan.numberOfRows)}else if(o.row>this.rowsSpan.rowEnd){if(t.row<this.rowsSpan.rowStart)return e.shiftedByRows(-this.rowsSpan.numberOfRows);if(t.row>this.rowsSpan.rowEnd)return!1}}return Mo.REF}},{key:"transformCellRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformRowRange",value:function(e,t,n){return this.transformRange(e,t,n)}},{key:"transformColumnRange",value:function(e,t,n){throw Error("Not implemented")}},{key:"fixNodeAddress",value:function(e){return this.rowsSpan.sheet===e.sheet&&this.rowsSpan.rowStart<=e.row?Object.assign(Object.assign({},e),{row:e.row-this.rowsSpan.numberOfRows}):e}},{key:"transformRange",value:function(e,t,n){var r=Xo(e,n),o=e,i=t;if(this.rowsSpan.sheet===r){var a=e.toSimpleRowAddress(n),s=t.toSimpleRowAddress(n);if(this.rowsSpan.rowStart<=a.row&&this.rowsSpan.rowEnd>=s.row)return Mo.REF;a.row>=this.rowsSpan.rowStart&&a.row<=this.rowsSpan.rowEnd&&(o=e.shiftedByRows(this.rowsSpan.rowEnd-a.row+1)),s.row>=this.rowsSpan.rowStart&&s.row<=this.rowsSpan.rowEnd&&(i=t.shiftedByRows(-(s.row-this.rowsSpan.rowStart+1)))}var u=this.transformCellAddress(o,n),c=this.transformCellAddress(i,n);if(!1===u&&!1===c)return[o,i];if(u===Mo.REF||c===Mo.REF)throw Error("Cannot happen");return[u||o,c||i]}}])&&ds(t.prototype,n),r&&ds(t,r),i}(_a);function Es(e){return(Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ws(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Ss(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ss(e,t){if(e){if("string"==typeof e)return Ts(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ts(e,t):void 0}}function Ts(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Os(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rs(e,t){return(Rs=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ns(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=As(e);if(t){var o=As(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ks(this,n)}}function ks(e,t){return!t||"object"!==Es(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function As(e){return(As=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cs=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rs(e,t)}(i,e);var t,n,r,o=Ns(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).sheet=e,t}return t=i,(n=[{key:"isIrreversible",value:function(){return!0}},{key:"performEagerTransformations",value:function(e,t){var n,r=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Ss(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(e.matrixFormulaNodes());try{for(r.s();!(n=r.n()).done;){var o=n.value,i=ws(this.transformSingleAst(o.getFormula(),o.getAddress()),1)[0];o.setFormula(i)}}catch(e){r.e(e)}finally{r.f()}}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return this.transformAddress(e)}},{key:"transformCellRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformColumnRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformRowRange",value:function(e,t,n){return this.transformAddress(e)}},{key:"transformAddress",value:function(e){return e.sheet===this.sheet&&Mo.REF}}])&&Os(t.prototype,n),r&&Os(t,r),i}(_a);function Ms(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xs(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function xs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Is(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ps(e,t,n){return t&&_s(e.prototype,t),n&&_s(e,n),e}var Ls=function(){function e(t){Is(this,e),this._size=t,this.array=new Array(t.height);for(var n=0;n<t.height;++n)this.array[n]=new Array(t.width)}return Ps(e,[{key:"set",value:function(e,t,n){this.array[t][e]=n}},{key:"get",value:function(e,t){var n=this.array[t];return n&&n[e]||null}},{key:"size",value:function(){return this._size}}],[{key:"fromArray",value:function(t){for(var n=new vr(t[0].length,t.length),r=new e(n),o=0;o<n.height;++o)for(var i=0;i<n.width;++i)r.set(i,o,t[o][i]);return r}}]),e}(),Fs=function(){function e(t,n,r,o){Is(this,e),this.dependencyGraph=t,this.columnSearch=n,this.threshold=r,this.cellContentParser=o,this.mapping=new Map}return Ps(e,[{key:"addSheet",value:function(e,t){this.mapping.set(e,new Ls(t))}},{key:"add",value:function(e){if(!this.mapping.has(e.sheet))throw Error("Sheet with id: ".concat(e.sheet," does not exists"));this.mapping.get(e.sheet).set(e.col,e.row,!0)}},{key:"run",value:function(e){var t=this,n=[];return this.findMatrices().forEach((function(r){if(!r.isMatrix||r.range.size()<t.threshold)n.push(r);else{var o=r.range,i=Or.fromRange(o),a=e[t.dependencyGraph.getSheetName(o.start.sheet)],s=t.matrixFromPlainValues(o,a);i.setCellValue(s),t.dependencyGraph.addMatrixVertex(i.getAddress(),i),t.columnSearch.add(s,i.getAddress())}})),this.mapping.clear(),n}},{key:"matrixFromPlainValues",value:function(e,t){for(var n=new Array(e.height()),r=0;r<e.height();++r)n[r]=new Array(e.width());var o,i=Ms(e.addresses(this.dependencyGraph));try{for(i.s();!(o=i.n()).done;){var a=o.value,s=t[a.row][a.col],u=this.cellContentParser.parse(s);if(!(u instanceof Zi.Number))throw new Error("Range contains not numeric values");n[a.row-e.start.row][a.col-e.start.col]=u.value}}catch(e){i.e(e)}finally{i.f()}return new wr(n)}},{key:"findMatrices",value:function(){var e=[];return this.mapping.forEach((function(t,n){var r,o=Ms(function(e,t){for(var n=t.size(),r=new Map,o=new Ls(n),i=0,a=n.height-1;a>=0;--a)for(var s=n.width-1;s>=0;--s){var u=t.get(s,a),c=[t.get(s+1,a),o.get(s+1,a)],l=c[0],f=c[1],h=[t.get(s,a+1),o.get(s,a+1)],p=h[0],d=h[1],m=[t.get(s+1,a+1),o.get(s+1,a+1)],v=m[0],y=m[1];if(u)if(u!==l&&f===d)o.set(s,a,++i),r.set(i,Ds(yt.fromCoordinates(e,s,a,s,a),!0,[Yo(e,s,a)])),r.has(f)&&(r.get(f).isMatrix=!1);else if(u!==v)if(l===u&&l===p)r.has(f)&&(r.get(f).isMatrix=!1),r.has(d)&&(r.get(d).isMatrix=!1),o.set(s,a,++i),r.set(i,Ds(yt.fromCoordinates(e,s,a,s,a),!0,[Yo(e,s,a)]));else if(l!==u&&p===u)if(r.has(d)&&r.get(d).isMatrix){o.set(s,a,d);var g=r.get(d);g.cells.push(Yo(e,s,a)),r.set(d,Ds(g.range.withStart(Yo(e,s,a)),!0,g.cells))}else o.set(s,a,++i),r.set(i,Ds(yt.fromCoordinates(e,s,a,s,a),!0,[Yo(e,s,a)]));else if(l===u&&p!==u){o.set(s,a,f);var b=r.get(f);b.cells.push(Yo(e,s,a)),r.set(f,Ds(b.range.withStart(Yo(e,s,a)),!0,b.cells))}else o.set(s,a,++i),r.set(i,Ds(yt.fromCoordinates(e,s,a,s,a),!0,[Yo(e,s,a)]));else if(u===v&&y===f&&y===d){o.set(s,a,f);var E=r.get(f);E.cells.push(Yo(e,s,a)),r.set(f,Ds(E.range.withStart(Yo(e,s,a)),!0,E.cells))}else u===v&&(o.set(s,a,++i),r.set(i,Ds(yt.fromCoordinates(e,s,a,s,a),!0,[Yo(e,s,a)])));else o.set(s,a,0),f===d&&r.has(f)&&(r.get(f).isMatrix=!1)}return r.values()}(n,t));try{for(o.s();!(r=o.n()).done;){var i=r.value;e.push(i)}}catch(e){o.e(e)}finally{o.f()}})),e}}]),e}();function Ds(e,t,n){return{isMatrix:t,range:e,cells:n}}function Us(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return js(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return js(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function js(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bs(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vs(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hs(e,t,n){return t&&Vs(e.prototype,t),n&&Vs(e,n),e}var Gs=function(){function e(t,n,r,o,i,a){Bs(this,e),this.dependencyGraph=t,this.columnSearch=n,this.parser=r,this.cellContentParser=o,this.config=i,this.stats=a,this.config.matrixDetection?this.buildStrategy=new Ws(this.dependencyGraph,this.columnSearch,this.parser,this.stats,i.matrixDetectionThreshold,this.cellContentParser):this.buildStrategy=new zs(this.dependencyGraph,this.columnSearch,this.parser,this.stats,this.cellContentParser)}return Hs(e,[{key:"buildGraph",value:function(e){var t=this.buildStrategy.run(e);this.processDependencies(t)}},{key:"processDependencies",value:function(e){var t=this;e.forEach((function(e,n){t.dependencyGraph.processCellDependencies(e,n)}))}}]),e}(),zs=function(){function e(t,n,r,o,i){Bs(this,e),this.dependencyGraph=t,this.columnIndex=n,this.parser=r,this.stats=o,this.cellContentParser=i}return Hs(e,[{key:"run",value:function(e){var t=this,n=new Map;for(var r in e)for(var o=this.dependencyGraph.getSheetId(r),i=e[r],a=0;a<i.length;++a)for(var s=i[a],u=function(e){var r=s[e],i=Yo(o,e,a),u=t.cellContentParser.parse(r);if(u instanceof Zi.MatrixFormula){if(t.dependencyGraph.existsVertex(i))return"continue";var c=t.stats.measure(qt.PARSER,(function(){return t.parser.parse(u.formula,i)}));if(c.errors.length>0){var l=new Eo(c.errors,u.formulaWithBraces());t.dependencyGraph.addVertex(i,l)}else{var f=$s(c.ast,i);n.set(f,Et(c.dependencies,i)),t.dependencyGraph.addMatrixVertex(i,f)}}else if(u instanceof Zi.Formula){var h=t.stats.measure(qt.PARSER,(function(){return t.parser.parse(u.formula,i)}));if(h.errors.length>0){var p=new Eo(h.errors,u.formula);t.dependencyGraph.addVertex(i,p)}else{var d=new cr(h.ast,i,0);n.set(d,Et(h.dependencies,i)),t.dependencyGraph.addVertex(i,d),h.hasVolatileFunction&&t.dependencyGraph.markAsVolatile(d),h.hasStructuralChangeFunction&&t.dependencyGraph.markAsDependentOnStructureChange(d)}}else if(u instanceof Zi.Empty);else{var m=new go(u.value,r);t.columnIndex.add(xt(u.value),i),t.dependencyGraph.addVertex(i,m)}},c=0;c<s.length;++c)u(c);return n}}]),e}(),Ws=function(){function e(t,n,r,o,i,a){Bs(this,e),this.dependencyGraph=t,this.columnSearch=n,this.parser=r,this.stats=o,this.threshold=i,this.cellContentParser=a}return Hs(e,[{key:"run",value:function(e){var t=this,n=new Map,r=new Fs(this.dependencyGraph,this.columnSearch,this.threshold,this.cellContentParser);for(var o in e){var i=this.dependencyGraph.getSheetId(o),a=e[o];r.addSheet(i,{width:this.dependencyGraph.getSheetWidth(i),height:this.dependencyGraph.getSheetHeight(i)});for(var s=0;s<a.length;++s)for(var u=a[s],c=function(e){var o=u[e],a=Yo(i,e,s),c=t.cellContentParser.parse(o);if(c instanceof Zi.MatrixFormula){if(t.dependencyGraph.existsVertex(a))return"continue";var l=t.stats.measure(qt.PARSER,(function(){return t.parser.parse(c.formula,a)}));if(l.errors.length>0){var f=new Eo(l.errors,c.formulaWithBraces());t.dependencyGraph.addVertex(a,f)}else{var h=$s(l.ast,a);n.set(h,Et(l.dependencies,a)),t.dependencyGraph.addMatrixVertex(a,h)}}else if(c instanceof Zi.Formula){var p=t.stats.measure(qt.PARSER,(function(){return t.parser.parse(c.formula,a)}));if(p.errors.length>0){var d=new Eo(p.errors,c.formula);t.dependencyGraph.addVertex(a,d)}else{var m=new cr(p.ast,a,0);n.set(m,Et(p.dependencies,a)),t.dependencyGraph.addVertex(a,m)}}else if(c instanceof Zi.Empty);else if(c instanceof Zi.Number)r.add(a);else{var v=new go(c.value,o);t.columnSearch.add(c.value,a),t.dependencyGraph.addVertex(a,v)}},l=0;l<u.length;++l)c(l)}this.stats.start(qt.MATRIX_DETECTION);for(var f=r.run(e),h=f.length-1;h>=0;--h){var p=f[h];p.cells.reverse();var d,m=Us(p.cells);try{for(m.s();!(d=m.n()).done;){var v=d.value,y=e[this.dependencyGraph.getSheetName(v.sheet)][v.row][v.col],g=new go(Number(y),y);this.columnSearch.add(Number(y),v),this.dependencyGraph.addVertex(v,g)}}catch(e){m.e(e)}finally{m.f()}}return this.stats.end(qt.MATRIX_DETECTION),n}}]),e}();function $s(e,t){var n=function e(t,n){if(t.type!==le.FUNCTION_CALL){if(t.type===le.CELL_RANGE){var r=yt.fromCellRange(t,n);return{width:r.width(),height:r.height()}}return t.type===le.NUMBER||t.type===le.CELL_REFERENCE?{width:1,height:1}:new Ho(Mo.VALUE)}switch(t.procedureName){case"MMULT":if(2!==t.args.length)return new Ho(Mo.NA,Ne.WrongArgNumber);if(t.args.some((function(e){return e.type===le.EMPTY})))return new Ho(Mo.NUM,Ne.EmptyArg);var o=e(t.args[0],n),i=e(t.args[1],n);return o instanceof Ho?o:i instanceof Ho?i:o.width!==i.height?new Ho(Mo.VALUE,Ne.MatrixDimensions):gr(o,i);case"MEDIANPOOL":case"MAXPOOL":if(t.args.length<2||t.args.length>3)return new Ho(Mo.NA,Ne.WrongArgNumber);if(t.args.some((function(e){return e.type===le.EMPTY})))return new Ho(Mo.NUM,Ne.EmptyArg);var a=e(t.args[0],n),s=t.args[1];if(a instanceof Ho)return a;if(s.type!==le.NUMBER)return new Ho(Mo.VALUE,Ne.NumberExpected);var u=s.value,c=s.value;if(3===t.args.length){var l=t.args[2];if(l.type!==le.NUMBER)return new Ho(Mo.VALUE,Ne.MatrixParams);c=l.value}return u>a.width||u>a.height||c>u||(a.width-u)%c!=0||(a.height-u)%c!=0?new Ho(Mo.VALUE):br(a,u,c);case"TRANSPOSE":if(1!==t.args.length)return new Ho(Mo.NA,Ne.WrongArgNumber);if(t.args[0].type===le.EMPTY)return new Ho(Mo.NUM,Ne.EmptyArg);var f=e(t.args[0],n);return f instanceof Ho?f:yr(f);default:return new Ho(Mo.VALUE,Ne.MatrixFunction)}}(e,t);return n instanceof Ho?new go(n,void 0):new Or(t,n.width,n.height,e)}function Ys(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ks(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function qs(e,t,n){return t&&Ks(e.prototype,t),n&&Ks(e,n),e}var Xs=function(){function e(t,n,r,o){Ys(this,e),this.displayName=t,this.address=n,this.added=r,this.options=o}return qs(e,[{key:"normalizeExpressionName",value:function(){return this.displayName.toLowerCase()}},{key:"copy",value:function(){return new e(this.displayName,this.address,this.added,this.options)}}]),e}(),Js=function(){function e(){Ys(this,e),this.mapping=new Map}return qs(e,[{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e),n=this.mapping.get(t);return!(n&&n.added)}},{key:"add",value:function(e){this.mapping.set(e.normalizeExpressionName(),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"getExisting",value:function(e){var t=this.mapping.get(this.normalizeExpressionName(e));return t&&t.added?t:void 0}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e),n=this.mapping.get(t);n&&(n.added=!1)}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}}]),e}(),Qs=function(){function e(){Ys(this,e),this.mapping=new Map}return qs(e,[{key:"add",value:function(e){this.mapping.set(this.normalizeExpressionName(e.displayName),e)}},{key:"get",value:function(e){return this.mapping.get(this.normalizeExpressionName(e))}},{key:"has",value:function(e){return this.mapping.has(this.normalizeExpressionName(e))}},{key:"getAllNamedExpressions",value:function(){return Array.from(this.mapping.values()).filter((function(e){return e.added}))}},{key:"normalizeExpressionName",value:function(e){return e.toLowerCase()}},{key:"isNameAvailable",value:function(e){var t=this.normalizeExpressionName(e);return!this.mapping.has(t)}},{key:"remove",value:function(e){var t=this.normalizeExpressionName(e);this.mapping.get(t)&&this.mapping.delete(t)}}]),e}(),Zs=function(){function e(){Ys(this,e),this.nextNamedExpressionRow=0,this.workbookStore=new Js,this.worksheetStores=new Map,this.addressCache=new Map}return qs(e,[{key:"isNameAvailable",value:function(e,t){var n,r;return void 0===t?this.workbookStore.isNameAvailable(e):null===(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.isNameAvailable(e))||void 0===r||r}},{key:"namedExpressionInAddress",value:function(e){var t=this.addressCache.get(e);return t&&t.added?t:void 0}},{key:"namedExpressionForScope",value:function(e,t){var n;return void 0===t?this.workbookStore.getExisting(e):null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e)}},{key:"nearestNamedExpression",value:function(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.get(e))&&void 0!==r?r:this.workbookStore.getExisting(e)}},{key:"isExpressionInScope",value:function(e,t){var n,r;return null!==(r=null===(n=this.worksheetStore(t))||void 0===n?void 0:n.has(e))&&void 0!==r&&r}},{key:"isNameValid",value:function(e){return!/^[A-Za-z]+[0-9]+$/.test(e)&&/^[A-Za-z\u00C0-\u02AF_][A-Za-z0-9\u00C0-\u02AF._]*$/.test(e)}},{key:"addNamedExpression",value:function(e,t,n){var r=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t),o=r.get(e);return o?(o.added=!0,o.displayName=e,o.options=n):(o=new Xs(e,this.nextAddress(),!0,n),r.add(o)),this.addressCache.set(o.address.row,o),o}},{key:"restoreNamedExpression",value:function(e,t){var n=void 0===t?this.workbookStore:this.worksheetStoreOrCreate(t);return e.added=!0,n.add(e),this.addressCache.set(e.address.row,e),e}},{key:"worksheetStoreOrCreate",value:function(e){var t=this.worksheetStores.get(e);return t||(t=new Qs,this.worksheetStores.set(e,t)),t}},{key:"worksheetStore",value:function(e){return this.worksheetStores.get(e)}},{key:"namedExpressionOrPlaceholder",value:function(e,t){var n;return null!==(n=this.worksheetStoreOrCreate(t).get(e))&&void 0!==n?n:this.workbookNamedExpressionOrPlaceholder(e)}},{key:"workbookNamedExpressionOrPlaceholder",value:function(e){var t=this.workbookStore.get(e);return void 0===t&&(t=new Xs(e,this.nextAddress(),!1),this.workbookStore.add(t)),t}},{key:"remove",value:function(e,t){var n,r=null==(n=void 0===t?this.workbookStore:this.worksheetStore(t))?void 0:n.get(e);if(void 0===n||void 0===r||!r.added)throw"Named expression does not exist";n.remove(e),n instanceof Qs&&0===n.mapping.size&&this.worksheetStores.delete(t),this.addressCache.delete(r.address.row)}},{key:"getAllNamedExpressionsNamesInScope",value:function(e){return this.getAllNamedExpressions().filter((function(t){return t.scope===e})).map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressionsNames",value:function(){return this.getAllNamedExpressions().map((function(e){return e.expression.displayName}))}},{key:"getAllNamedExpressions",value:function(){var e=[];return this.workbookStore.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:void 0})})),this.worksheetStores.forEach((function(t,n){t.getAllNamedExpressions().forEach((function(t){e.push({expression:t,scope:n})}))})),e}},{key:"getAllNamedExpressionsForScope",value:function(e){var t,n;return void 0===e?this.workbookStore.getAllNamedExpressions():null!==(n=null===(t=this.worksheetStores.get(e))||void 0===t?void 0:t.getAllNamedExpressions())&&void 0!==n?n:[]}},{key:"nextAddress",value:function(){return Yo(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow++)}},{key:"lookupNextAddress",value:function(t,n){if(void 0===n){var r=this.workbookStore.get(t);if(r)return r.address}return Yo(e.SHEET_FOR_WORKBOOK_EXPRESSIONS,0,this.nextNamedExpressionRow)}}]),e}();Zs.SHEET_FOR_WORKBOOK_EXPRESSIONS=-1;var eu=function e(t){switch(t.type){case le.EMPTY:case le.NUMBER:case le.STRING:case le.ERROR:case le.ERROR_WITH_RAW_INPUT:return!1;case le.CELL_REFERENCE:return!t.reference.isAbsolute();case le.CELL_RANGE:case le.COLUMN_RANGE:case le.ROW_RANGE:return!t.start.isAbsolute();case le.NAMED_EXPRESSION:return!1;case le.PERCENT_OP:case le.PLUS_UNARY_OP:case le.MINUS_UNARY_OP:return e(t.value);case le.CONCATENATE_OP:case le.EQUALS_OP:case le.NOT_EQUAL_OP:case le.LESS_THAN_OP:case le.GREATER_THAN_OP:case le.LESS_THAN_OR_EQUAL_OP:case le.GREATER_THAN_OR_EQUAL_OP:case le.MINUS_OP:case le.PLUS_OP:case le.TIMES_OP:case le.DIV_OP:case le.POWER_OP:return e(t.left)||e(t.right);case le.PARENTHESIS:return e(t.expression);case le.FUNCTION_CALL:return t.args.some((function(t){return e(t)}))}};function tu(e){if(!Array.isArray(e))throw new An("an array of arrays.");for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))throw new An("an array of arrays.")}function nu(e){for(var t=0,n=0,r=0,o=0;o<e.length;o++){for(var i=0,a=0;a<e[o].length;a++){var s=e[o][a];null!=s&&(i=a+1,++r)}t=Math.max(t,i),i>0&&(n=o+1)}var u=t*n;return{height:n,width:t,fill:0===u?0:r/u}}function ru(e){return(ru="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ou(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function iu(e,t){return(iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function au(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=uu(e);if(t){var o=uu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return su(this,n)}}function su(e,t){return!t||"object"!==ru(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function uu(e){return(uu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var cu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&iu(e,t)}(i,e);var t,n,r,o=au(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this)).sheet=e,t}return t=i,(n=[{key:"isIrreversible",value:function(){return!0}},{key:"fixNodeAddress",value:function(e){return e}},{key:"transformCellAddress",value:function(e,t){return!!e.isInvalid(t)&&Mo.REF}},{key:"transformCellRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&Mo.REF}},{key:"transformColumnRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&Mo.REF}},{key:"transformRowRange",value:function(e,t,n){return!(!e.isInvalid(n)&&!t.isInvalid(n))&&Mo.REF}}])&&ou(t.prototype,n),r&&ou(t,r),i}(_a);function lu(e){return function(e){if(Array.isArray(e))return du(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||pu(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||pu(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hu(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=pu(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function pu(e,t){if(e){if("string"==typeof e)return du(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?du(e,t):void 0}}function du(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yu(e,t,n){return t&&vu(e.prototype,t),n&&vu(e,n),e}var gu=function(){function e(t,n){mu(this,e),this.sheet=t,this.indexes=n}return yu(e,[{key:"normalizedIndexes",value:function(){return Tu(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return it.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}(),bu=function(){function e(t,n){mu(this,e),this.sheet=t,this.indexes=n}return yu(e,[{key:"normalizedIndexes",value:function(){return Ou(this.indexes)}},{key:"rowsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return it.fromNumberOfRows(e.sheet,t[0],t[1])}))}}]),e}(),Eu=function(){function e(t,n){mu(this,e),this.sheet=t,this.indexes=n}return yu(e,[{key:"normalizedIndexes",value:function(){return Ou(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return at.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}(),wu=function(){function e(t,n){mu(this,e),this.sheet=t,this.indexes=n}return yu(e,[{key:"normalizedIndexes",value:function(){return Tu(this.indexes)}},{key:"columnsSpans",value:function(){var e=this;return this.normalizedIndexes().map((function(t){return at.fromNumberOfColumns(e.sheet,t[0],t[1])}))}}]),e}(),Su=function(){function e(t,n,r,o,i,a,s,u){mu(this,e),this.dependencyGraph=t,this.columnSearch=n,this.cellContentParser=r,this.parser=o,this.stats=i,this.lazilyTransformingAstService=a,this.namedExpressions=s,this.config=u,this.changes=Aa.empty(),this.allocateNamedExpressionAddressSpace()}return yu(e,[{key:"removeRows",value:function(e){var t,n=[],r=hu(e.rowsSpans());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.doRemoveRows(o);i&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"addRows",value:function(e){var t,n=hu(e.rowsSpans());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.doAddRows(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"addColumns",value:function(e){var t,n=hu(e.columnsSpans());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.doAddColumns(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"removeColumns",value:function(e){var t,n=[],r=hu(e.columnsSpans());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.doRemoveColumns(o);i&&n.push(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"removeSheet",value:function(e){var t,n=this,r=this.sheetMapping.fetch(e);this.dependencyGraph.removeSheet(r),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var e=new Cs(r);e.performEagerTransformations(n.dependencyGraph,n.parser),t=n.lazilyTransformingAstService.addTransformation(e)})),this.sheetMapping.removeSheet(r),this.columnSearch.removeSheet(r);var o=this.namedExpressions.getAllNamedExpressionsForScope(r).map((function(e){return n.removeNamedExpression(e.normalizeExpressionName(),r)}));return{version:t,scopedNamedExpressions:o}}},{key:"clearSheet",value:function(e){this.dependencyGraph.clearSheet(e),this.columnSearch.removeSheet(e)}},{key:"addSheet",value:function(e){var t=this.sheetMapping.addSheet(e),n=[];return this.dependencyGraph.addressMapping.autoAddSheet(t,n,nu(n)),this.sheetMapping.fetchDisplayName(t)}},{key:"renameSheet",value:function(e,t){return this.sheetMapping.renameSheet(e,t)}},{key:"moveRows",value:function(e,t,n,r){var o=it.fromNumberOfRows(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddRows(o),r<t&&(t+=n);var i=Yo(e,0,t),a=Yo(e,0,r);this.moveCells(i,Number.POSITIVE_INFINITY,n,a);var s=it.fromNumberOfRows(e,t,n);return this.doRemoveRows(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveColumns",value:function(e,t,n,r){var o=at.fromNumberOfColumns(e,r,n);this.lazilyTransformingAstService.beginCombinedMode(e),this.doAddColumns(o),r<t&&(t+=n);var i=Yo(e,t,0),a=Yo(e,r,0);this.moveCells(i,n,Number.POSITIVE_INFINITY,a);var s=at.fromNumberOfColumns(e,t,n);return this.doRemoveColumns(s),this.lazilyTransformingAstService.commitCombinedMode()}},{key:"moveCells",value:function(e,t,n,r){var o=this;this.ensureItIsPossibleToMoveCells(e,t,n,r);var i=yt.spanFrom(e,t,n),a=yt.spanFrom(r,t,n);this.dependencyGraph.breakNumericMatricesInRange(i),this.dependencyGraph.breakNumericMatricesInRange(a);var s=r.col-e.col,u=r.row-e.row,c=r.sheet,l=this.getRangeClipboardCells(a),f=this.dependencyGraph.rawValuesFromRange(a);this.columnSearch.removeValues(f);var h,p=this.dependencyGraph.rawValuesFromRange(i);this.columnSearch.moveValues(p,s,u,c),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var e=new rs(i,s,u,c);e.performEagerTransformations(o.dependencyGraph,o.parser),h=o.lazilyTransformingAstService.addTransformation(e)})),this.dependencyGraph.moveCells(i,s,u,c);var d=this.updateNamedExpressionsForMovedCells(e,t,n,r);return{version:h,overwrittenCellsData:l,addedGlobalNamedExpressions:d}}},{key:"setRowOrder",value:function(e,t){var n,r=this,o=[],i=[],a=hu(t);try{var s=function(){var t=fu(n.value,2),a=t[0],s=t[1];if(a!==s){var u=yt.spanFrom({sheet:e,col:0,row:a},1/0,1);r.dependencyGraph.breakNumericMatricesInRange(u);var c=r.getRangeClipboardCells(u);i=i.concat(c),o.push(c.map((function(e){var t=fu(e,2),n=t[0],r=n.sheet,o=n.col,i=t[1];return[{sheet:r,col:o,row:s},i]})))}};for(a.s();!(n=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}return o.forEach((function(t){return r.restoreClipboardCells(e,t.values())})),i}},{key:"setColumnOrder",value:function(e,t){var n,r=this,o=[],i=[],a=hu(t);try{var s=function(){var t=fu(n.value,2),a=t[0],s=t[1];if(a!==s){var u=yt.spanFrom({sheet:e,col:a,row:0},1,1/0);r.dependencyGraph.breakNumericMatricesInRange(u);var c=r.getRangeClipboardCells(u);i=i.concat(c),o.push(c.map((function(e){var t=fu(e,2),n=t[0],r=n.sheet,o=(n.col,n.row),i=t[1];return[{sheet:r,col:s,row:o},i]})))}};for(a.s();!(n=a.n()).done;)s()}catch(e){a.e(e)}finally{a.f()}return o.forEach((function(t){return r.restoreClipboardCells(e,t.values())})),i}},{key:"addNamedExpression",value:function(e,t,n,r){this.storeNamedExpressionInCell(this.namedExpressions.lookupNextAddress(e,n),t);var o=this.namedExpressions.addNamedExpression(e,n,r);this.adjustNamedExpressionEdges(o,e,n)}},{key:"restoreNamedExpression",value:function(e,t,n){var r=e.displayName;this.restoreCell(e.address,t);var o=this.namedExpressions.restoreNamedExpression(e,n);this.adjustNamedExpressionEdges(o,r,n)}},{key:"changeNamedExpressionExpression",value:function(e,t,n,r){var o=this.namedExpressions.namedExpressionForScope(e,n);if(!o)throw new xn(e);var i=o.copy();o.options=r;var a=this.getClipboardCell(o.address);return this.storeNamedExpressionInCell(o.address,t),[i,a]}},{key:"removeNamedExpression",value:function(e,t){var n=this.namedExpressions.namedExpressionForScope(e,t);if(!n)throw new xn(e);this.namedExpressions.remove(n.displayName,t);var r=this.getClipboardCell(n.address);if(void 0!==t){var o=this.namedExpressions.workbookNamedExpressionOrPlaceholder(e);this.dependencyGraph.exchangeNode(n.address,o.address)}else this.dependencyGraph.setCellEmpty(n.address);return[n,r]}},{key:"ensureItIsPossibleToMoveCells",value:function(e,t,n,r){if(Ko(e)||!(Ru(t)&&Ru(n)||function(e,t,n){return 0===e.row&&Ru(t)&&n===Number.POSITIVE_INFINITY||0===e.col&&Ru(n)&&t===Number.POSITIVE_INFINITY}(e,t,n))||Ko(r)||!this.sheetMapping.hasSheetWithId(e.sheet)||!this.sheetMapping.hasSheetWithId(r.sheet))throw new An("a valid range of cells to move.");var o=yt.spanFrom(e,t,n),i=yt.spanFrom(r,t,n);if(i.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new Rn;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(o))throw new qn;if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(i))throw new Xn}},{key:"restoreClipboardCells",value:function(e,t){var n,r=[],o=hu(t);try{for(o.s();!(n=o.n()).done;){var i=fu(n.value,2),a=i[0],s=i[1];if(this.restoreCell(a,s),s.type===va.FORMULA){var u=this.parser.fetchCachedResult(s.hash).dependencies;r.push.apply(r,lu(this.updateNamedExpressionsForTargetAddress(e,a,u)))}}}catch(e){o.e(e)}finally{o.f()}return r}},{key:"restoreCell",value:function(e,t){switch(t.type){case va.VALUE:this.setValueToCell(t,e);break;case va.FORMULA:this.setFormulaToCellFromCache(t.hash,e);break;case va.EMPTY:this.setCellEmpty(e);break;case va.PARSING_ERROR:this.setParsingErrorToCell(t.rawInput,t.errors,e)}}},{key:"doRemoveRows",value:function(e){var t=this;if(!this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)){var n,r,o=[],i=hu(this.dependencyGraph.entriesFromRowsSpan(e));try{for(i.s();!(n=i.n()).done;){var a=fu(n.value,1)[0];o.push({address:a,cellType:this.getClipboardCell(a)})}}catch(e){i.e(e)}finally{i.f()}return this.dependencyGraph.removeRows(e),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var n=new bs(e);n.performEagerTransformations(t.dependencyGraph,t.parser),r=t.lazilyTransformingAstService.addTransformation(n)})),{version:r,removedCells:o,rowFrom:e.rowStart,rowCount:e.numberOfRows}}}},{key:"doRemoveColumns",value:function(e){var t=this;if(!this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)){var n,r,o=[],i=hu(this.dependencyGraph.entriesFromColumnsSpan(e));try{for(i.s();!(n=i.n()).done;){var a=fu(n.value,1)[0];o.push({address:a,cellType:this.getClipboardCell(a)})}}catch(e){i.e(e)}finally{i.f()}return this.dependencyGraph.removeColumns(e),this.columnSearch.removeColumns(e),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var n=new hs(e);n.performEagerTransformations(t.dependencyGraph,t.parser),r=t.lazilyTransformingAstService.addTransformation(n)})),{version:r,removedCells:o,columnFrom:e.columnStart,columnCount:e.numberOfColumns}}}},{key:"doAddRows",value:function(e){var t=this;this.rowEffectivelyNotInSheet(e.rowStart,e.sheet)||(this.dependencyGraph.addRows(e),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var n=new Ya(e);n.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(n)})))}},{key:"doAddColumns",value:function(e){var t=this;this.columnEffectivelyNotInSheet(e.columnStart,e.sheet)||(this.dependencyGraph.addColumns(e),this.columnSearch.addColumns(e),this.stats.measure(qt.TRANSFORM_ASTS,(function(){var n=new Ba(e);n.performEagerTransformations(t.dependencyGraph,t.parser),t.lazilyTransformingAstService.addTransformation(n)})))}},{key:"getClipboardCell",value:function(e){var t=this.dependencyGraph.getCell(e);if(null===t||t instanceof vo)return{type:va.EMPTY};if(t instanceof go)return Object.assign({type:va.VALUE},t.getValues());if(t instanceof Or)return{type:va.VALUE,parsedValue:t.getMatrixCellValue(e),rawValue:t.getMatrixCellRawValue(e)};if(t instanceof cr)return{type:va.FORMULA,hash:this.parser.computeHashFromAst(t.getFormula(this.lazilyTransformingAstService))};if(t instanceof Eo)return{type:va.PARSING_ERROR,rawInput:t.rawInput,errors:t.errors};throw Error("Trying to copy unsupported type")}},{key:"getSheetClipboardCells",value:function(e){for(var t=this.dependencyGraph.getSheetHeight(e),n=this.dependencyGraph.getSheetWidth(e),r=new Array(t),o=0;o<t;o++){r[o]=new Array(n);for(var i=0;i<n;i++){var a=Yo(e,i,o);r[o][i]=this.getClipboardCell(a)}}return r}},{key:"getRangeClipboardCells",value:function(e){var t,n=[],r=hu(e.addresses(this.dependencyGraph));try{for(r.s();!(t=r.n()).done;){var o=t.value;n.push([o,this.getClipboardCell(o)])}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"setCellContent",value:function(e,t){var n=this.cellContentParser.parse(t),r=this.dependencyGraph.getCell(e);if(!(r instanceof Or)||r.isFormula()||n instanceof Zi.Number||(this.dependencyGraph.breakNumericMatrix(r),r=this.dependencyGraph.getCell(e)),r instanceof Or&&!r.isFormula()&&n instanceof Zi.Number){var o=n.value,i=this.dependencyGraph.getCellValue(e);this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(r),r.setMatrixCellValue(e,xt(o)),this.columnSearch.change(xt(i),xt(o),e),this.changes.addChange(o,e)}else if(!(r instanceof Or)&&n instanceof Zi.MatrixFormula){var a=this.parser.parse(n.formula,e),s=a.ast,u=a.errors,c=a.dependencies;if(u.length>0)this.dependencyGraph.setParsingErrorToCell(e,new Eo(u,n.formulaWithBraces()));else{var l=$s(s,e);if(l instanceof go)throw Error("What if new matrix vertex is not properly constructed?");this.dependencyGraph.addNewMatrixVertex(l),this.dependencyGraph.processCellDependencies(Et(c,e),l),this.dependencyGraph.graph.markNodeAsSpecialRecentlyChanged(l)}}else{if(r instanceof Or)throw new Error("Illegal operation");if(n instanceof Zi.Formula){var f=this.parser.parse(n.formula,e),h=f.ast,p=f.errors,d=f.hasVolatileFunction,m=f.hasStructuralChangeFunction,v=f.dependencies;p.length>0?this.dependencyGraph.setParsingErrorToCell(e,new Eo(p,n.formula)):this.dependencyGraph.setFormulaToCell(e,h,Et(v,e),d,m)}else if(n instanceof Zi.Empty)this.setCellEmpty(e);else{if(n instanceof Zi.MatrixFormula)throw new Error("Cant happen");this.setValueToCell({parsedValue:n.value,rawValue:t},e)}}}},{key:"setSheetContent",value:function(e,t){this.clearSheet(e);for(var n=0;n<t.length;n++)for(var r=0;r<t[n].length;r++){var o=Yo(e,r,n);this.setCellContent(o,t[n][r])}}},{key:"setValueToCell",value:function(e,t){var n=this.dependencyGraph.getCellValue(t);this.dependencyGraph.setValueToCell(t,e),this.columnSearch.change(xt(n),xt(e.parsedValue),t),this.changes.addChange(e.parsedValue,t)}},{key:"setCellEmpty",value:function(e){var t=this.dependencyGraph.getCellValue(e);this.columnSearch.remove(xt(t),e),this.changes.addChange(Mt,e),this.dependencyGraph.setCellEmpty(e)}},{key:"setFormulaToCellFromCache",value:function(e,t){var n=this.parser.fetchCachedResult(e),r=n.ast,o=n.hasVolatileFunction,i=n.hasStructuralChangeFunction,a=n.dependencies,s=Et(a,t),u=fu(new cu(t.sheet).transformSingleAst(r,t),1)[0];this.parser.rememberNewAst(u);var c=s.filter((function(e){return e instanceof tt||(e instanceof yt?!(Ko(e.start)||Ko(e.end)):!Ko(e))}));this.dependencyGraph.setFormulaToCell(t,u,c,o,i)}},{key:"setParsingErrorToCell",value:function(e,t,n){this.dependencyGraph.setParsingErrorToCell(n,new Eo(t,e))}},{key:"rowEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getHeight(t)}},{key:"getAndClearContentChanges",value:function(){var e=this.changes;return this.changes=Aa.empty(),e}},{key:"forceApplyPostponedTransformations",value:function(){this.dependencyGraph.forceApplyPostponedTransformations()}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"columnEffectivelyNotInSheet",value:function(e,t){return e>=this.dependencyGraph.addressMapping.getWidth(t)}},{key:"adjustNamedExpressionEdges",value:function(e,t,n){if(void 0!==n){var r,o=this.dependencyGraph.fetchCellOrCreateEmpty(e.address),i=this.namedExpressions.workbookNamedExpressionOrPlaceholder(t),a=this.dependencyGraph.fetchCellOrCreateEmpty(i.address),s=hu(this.dependencyGraph.graph.adjacentNodes(a));try{for(s.s();!(r=s.n()).done;){var u=r.value;if(u instanceof cr&&u.cellAddress.sheet===n){var c,l=u.getFormula(this.lazilyTransformingAstService),f=u.getAddress(this.lazilyTransformingAstService),h=this.parser.fetchCachedResultForAst(l).dependencies,p=hu(Et(h,f));try{for(p.s();!(c=p.n()).done;){var d=c.value;d instanceof tt&&d.name.toLowerCase()===e.displayName.toLowerCase()&&(this.dependencyGraph.graph.removeEdge(a,u),this.dependencyGraph.graph.addEdge(o,u))}}catch(e){p.e(e)}finally{p.f()}}}}catch(e){s.e(e)}finally{s.f()}}}},{key:"storeNamedExpressionInCell",value:function(e,t){var n=this.cellContentParser.parse(t);if(n instanceof Zi.MatrixFormula)throw new Error("Matrix formulas are not supported");if(n instanceof Zi.Formula){var r=this.parser.parse(n.formula,Yo(-1,0,0));if(eu(r.ast))throw new Qn;var o=r.ast,i=r.hasVolatileFunction,a=r.hasStructuralChangeFunction,s=r.dependencies;this.dependencyGraph.setFormulaToCell(e,o,Et(s,e),i,a)}else n instanceof Zi.Empty?this.setCellEmpty(e):this.setValueToCell({parsedValue:n.value,rawValue:t},e)}},{key:"updateNamedExpressionsForMovedCells",value:function(e,t,n,r){if(e.sheet===r.sheet)return[];var o,i=[],a=hu(yt.spanFrom(r,t,n).addresses(this.dependencyGraph));try{for(a.s();!(o=a.n()).done;){var s=o.value,u=this.addressMapping.fetchCell(s);if(u instanceof cr&&s.sheet!==e.sheet){var c=u.getFormula(this.lazilyTransformingAstService),l=this.parser.fetchCachedResultForAst(c).dependencies;i.push.apply(i,lu(this.updateNamedExpressionsForTargetAddress(e.sheet,s,l)))}}}catch(e){a.e(e)}finally{a.f()}return i}},{key:"updateNamedExpressionsForTargetAddress",value:function(e,t,n){if(e===t.sheet)return[];var r,o=[],i=this.addressMapping.fetchCell(t),a=hu(Et(n,t));try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof tt){var u=s.name,c=this.dependencyGraph.fetchNamedExpressionVertex(u,e),l=this.namedExpressions.isExpressionInScope(u,t.sheet)?this.dependencyGraph.fetchNamedExpressionVertex(u,t.sheet):this.copyOrFetchGlobalNamedExpressionVertex(u,c,o);l!==c&&(this.dependencyGraph.graph.softRemoveEdge(c,i),this.dependencyGraph.graph.addEdge(l,i))}}}catch(e){a.e(e)}finally{a.f()}return o}},{key:"allocateNamedExpressionAddressSpace",value:function(){this.dependencyGraph.addressMapping.addSheet(-1,new No(0,0))}},{key:"copyOrFetchGlobalNamedExpressionVertex",value:function(e,t,n){var r=this.namedExpressions.namedExpressionForScope(e);if(void 0===r)if(r=this.namedExpressions.addNamedExpression(e),n.push(r.normalizeExpressionName()),t instanceof cr){var o=this.parser.fetchCachedResultForAst(t.getFormula(this.lazilyTransformingAstService)),i=o.ast,a=o.hasVolatileFunction,s=o.hasStructuralChangeFunction,u=o.dependencies;this.dependencyGraph.setFormulaToCell(r.address,i,Et(u,r.address),a,s)}else t instanceof vo?this.setCellEmpty(r.address):t instanceof go&&this.setValueToCell(t.getValues(),r.address);return this.dependencyGraph.fetchCellOrCreateEmpty(r.address)}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}}]),e}();function Tu(e){if(e.length<=1)return e;for(var t=lu(e).sort((function(e,t){return fu(e,1)[0]-fu(t,1)[0]})),n=t.reduce((function(e,t){var n=fu(t,2),r=n[0],o=n[1],i=e[e.length-1],a=i[0]+i[1];return r<=a?i[1]+=Math.max(0,o-(a-r)):e.push([r,o]),e}),[t[0]]),r=0,o=0;o<n.length;++o)n[o][0]-=r,r+=n[o][1];return n}function Ou(e){if(e.length<=1)return e;for(var t=lu(e).sort((function(e,t){return fu(e,1)[0]-fu(t,1)[0]})),n=t.reduce((function(e,t){var n=fu(t,2),r=n[0],o=n[1],i=e[e.length-1];return r===i[0]?i[1]=Math.max(i[1],o):e.push([r,o]),e}),[t[0]]),r=0,o=0;o<n.length;++o)n[o][0]+=r,r+=n[o][1];return n}function Ru(e){return Number.isInteger(e)&&e>0}var Nu,ku=n("wOJ8");function Au(e){return(Au="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xu(e,t,n){return(xu="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Lu(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function Iu(e,t){return(Iu=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _u(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Lu(e);if(t){var o=Lu(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Pu(this,n)}}function Pu(e,t){return!t||"object"!==Au(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Lu(e){return(Lu=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}!function(e){e.SheetAdded="sheetAdded",e.SheetRemoved="sheetRemoved",e.SheetRenamed="sheetRenamed",e.NamedExpressionAdded="namedExpressionAdded",e.NamedExpressionRemoved="namedExpressionRemoved",e.ValuesUpdated="valuesUpdated",e.EvaluationSuspended="evaluationSuspended",e.EvaluationResumed="evaluationResumed"}(Nu||(Nu={}));var Fu=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iu(e,t)}(i,e);var t,n,r,o=_u(i);function i(){return Cu(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"emit",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=xu(Lu(i.prototype),"emit",this)).call.apply(t,[this,e].concat(r)),this}}])&&Mu(t.prototype,n),r&&Mu(t,r),i}(ku.TinyEmitter);n("a5NK");function Du(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Uu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ju(e,t,n){return t&&Uu(e.prototype,t),n&&Uu(e,n),e}var Bu=function(){function e(t,n){Du(this,e),this.address=t,this.newValue=n}return ju(e,[{key:"col",get:function(){return this.address.col}},{key:"row",get:function(){return this.address.row}},{key:"sheet",get:function(){return this.address.sheet}},{key:"value",get:function(){return this.newValue}}]),e}(),Vu=function e(t,n){Du(this,e),this.name=t,this.newValue=n},Hu=function(){function e(t,n,r){Du(this,e),this.config=t,this.namedExpressions=n,this.sheetIndexMapping=r}return ju(e,[{key:"exportChange",value:function(e){if(e.sheet===Zs.SHEET_FOR_WORKBOOK_EXPRESSIONS){var t=this.namedExpressions.namedExpressionInAddress(e.row);if(!t)throw"Missing named expression";return new Vu(t.displayName,this.exportValue(e.value))}return new Bu(Yo(e.sheet,e.col,e.row),this.exportValue(e.value))}},{key:"exportValue",value:function(e){return e instanceof Qt?this.detailedError(new Ho(Mo.VALUE,Ne.ScalarExpected)):this.config.smartRounding&&Bt(e)?this.cellValueRounding(xt(e)):e instanceof Ho?this.detailedError(e):e===Mt?null:xt(e)}},{key:"detailedError",value:function(e){var t,n=void 0,r=e.address;return void 0!==r&&(n=r.sheet===Zs.SHEET_FOR_WORKBOOK_EXPRESSIONS?null===(t=this.namedExpressions.namedExpressionInAddress(r.row))||void 0===t?void 0:t.displayName:oe(this.sheetIndexMapping,r,-1)),new Jo(e,this.config.translationPackage.getErrorTranslation(e.type),n)}},{key:"cellValueRounding",value:function(e){if(0===e)return e;var t=Math.floor(Math.log10(Math.abs(e))),n=Math.pow(10,this.config.precisionRounding-t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}}]),e}();function Gu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return zu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zu(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function zu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var $u=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sheet=t,this.transformations=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e){this.transformations.push(e)}},{key:"performEagerTransformations",value:function(e,t){this.transformations.forEach((function(n){return n.performEagerTransformations(e,t)}))}},{key:"transformSingleAst",value:function(e,t){var n=e,r=t;return this.transformations.forEach((function(e){var t=Gu(e.transformSingleAst(n,r),2);n=t[0],r=t[1]})),[n,r]}},{key:"isIrreversible",value:function(){return!0}}])&&Wu(t.prototype,n),r&&Wu(t,r),e}();function Yu(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return Ku(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ku(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ku(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function qu(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.stats=t,this.transformations=[]}var t,n,r;return t=e,(n=[{key:"version",value:function(){return this.transformations.length}},{key:"addTransformation",value:function(e){return void 0!==this.combinedTransformer?this.combinedTransformer.add(e):this.transformations.push(e),this.version()}},{key:"beginCombinedMode",value:function(e){this.combinedTransformer=new $u(e)}},{key:"commitCombinedMode",value:function(){if(void 0===this.combinedTransformer)throw"Combined mode wasn't started";return this.transformations.push(this.combinedTransformer),this.combinedTransformer=void 0,this.version()}},{key:"applyTransformations",value:function(e,t,n){this.stats.start(qt.TRANSFORM_ASTS_POSTPONED);for(var r=n;r<this.transformations.length;r++){var o=this.transformations[r];o.isIrreversible()&&(this.undoRedo.storeDataForVersion(r,t,this.parser.computeHashFromAst(e)),this.parser.rememberNewAst(e));var i=Yu(o.transformSingleAst(e,t),2);e=i[0],t=i[1]}var a=this.parser.rememberNewAst(e);return this.stats.end(qt.TRANSFORM_ASTS_POSTPONED),[a,t,this.transformations.length]}},{key:"getTransformationsFrom",value:regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=t;case 1:if(!(r<this.transformations.length)){e.next=9;break}if(o=this.transformations[r],n&&!n(o)){e.next=6;break}return e.next=6,o;case 6:r++,e.next=1;break;case 9:case"end":return e.stop()}}),e,this)}))},{key:"destroy",value:function(){this.parser=void 0,this.transformations=[]}}])&&qu(t.prototype,n),r&&qu(t,r),e}();function Ju(e){return(Ju="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qu(e,t,n,r){var o;return o="col"===r?e.effectiveEndColumn(n):e.effectiveEndRow(n),function(e,t,n,r){for(;n<=r;){var o=Math.floor((n+r)/2),i=Zu(t,e(o));if(i>0)n=o+1;else if(i<0)r=o-1;else{if(n==o)return o;r=o}}return r}("row"===r?function(t){return xt(n.getCellValue(Yo(e.sheet,e.start.col,t)))}:function(t){return xt(n.getCellValue(Yo(e.sheet,t,e.start.row)))},t,e.start[r],o)}function Zu(e,t){return Ju(e)===Ju(t)?e===Mt?0:e<t?-1:e>t?1:0:e===Mt?-1:t===Mt?1:t instanceof Ho||"number"==typeof e&&"string"==typeof t||"number"==typeof e&&"boolean"==typeof t?-1:"string"==typeof e&&"number"==typeof t?1:"string"==typeof e&&"boolean"==typeof t?-1:1}function ec(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var tc=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t}var t,n,r;return t=e,(n=[{key:"advancedFind",value:function(e,t){for(var n=this.dependencyGraph.computeListOfValuesInRange(t),r=0;r<n.length;r++)if(e(xt(n[r])))return r+t.start.col;return-1}}])&&ec(t.prototype,n),r&&ec(t,r),e}();function nc(e){return(nc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function rc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oc(e,t){return(oc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ic(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sc(e);if(t){var o=sc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ac(this,n)}}function ac(e,t){return!t||"object"!==nc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sc(e){return(sc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var uc=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oc(e,t)}(i,e);var t,n,r,o=ic(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,e)).dependencyGraph=e,n.config=t,n}return t=i,(n=[{key:"add",value:function(e,t){}},{key:"remove",value:function(e,t){}},{key:"change",value:function(e,t,n){}},{key:"addColumns",value:function(e){}},{key:"removeColumns",value:function(e){}},{key:"removeSheet",value:function(e){}},{key:"moveValues",value:function(e,t,n,r){}},{key:"removeValues",value:function(e){}},{key:"destroy",value:function(){}},{key:"find",value:function(e,t,n){if("string"==typeof e&&(e=sa(e)),t.height()<this.config.binarySearchThreshold||!n){var r=this.dependencyGraph.computeListOfValuesInRange(t).map(xt).map((function(e){return"string"==typeof e?sa(e):e})).indexOf(e);return r<0?r:r+t.start.row}return Qu(t,e,this.dependencyGraph,"row")}}])&&rc(t.prototype,n),r&&rc(t,r),i}(tc);n("fbCW");function cc(e){return function(e){if(Array.isArray(e))return pc(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||hc(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function lc(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||hc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=hc(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function hc(e,t){if(e){if("string"==typeof e)return pc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pc(e,t):void 0}}function pc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var mc=function(){function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.config=n,this.stats=r,this.index=new Map,this.transformingService=this.dependencyGraph.lazilyTransformingAstService,this.binarySearchStrategy=new uc(t,n)}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){if(e instanceof wr){var n,r=fc(e.generateValues(t));try{for(r.s();!(n=r.n()).done;){var o=lc(n.value,2),i=o[0],a=o[1];this.addSingleCellValue(i,a)}}catch(e){r.e(e)}finally{r.f()}}else e instanceof Ho||e instanceof Qt||this.addSingleCellValue(e,t)}},{key:"remove",value:function(e,t){if(e)if(e instanceof wr){var n,r=fc(e.generateValues(t));try{for(r.s();!(n=r.n()).done;){var o=lc(n.value,2),i=o[0],a=o[1];this.removeSingleValue(i,a)}}catch(e){r.e(e)}finally{r.f()}}else this.removeSingleValue(e,t)}},{key:"change",value:function(e,t,n){e!==t&&(this.remove(e,n),this.add(t,n))}},{key:"moveValues",value:function(e,t,n,r){var o,i=fc(e);try{for(i.s();!(o=i.n()).done;){var a=lc(o.value,2),s=a[0],u=a[1],c=qo(u,r,t,n);this.remove(s,u),this.add(s,c)}}catch(e){i.e(e)}finally{i.f()}}},{key:"removeValues",value:function(e){var t,n=fc(e);try{for(n.s();!(t=n.n()).done;){var r=lc(t.value,2),o=r[0],i=r[1];this.remove(o,i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"find",value:function(e,t,n){this.ensureRecentData(t.sheet,t.start.col,e);var r=this.getColumnMap(t.sheet,t.start.col);if(!r)return-1;"string"==typeof e&&(e=sa(e));var o=r.get(e);if(!o)return this.binarySearchStrategy.find(e,t,n);var i=vc(o.index,t.start.row),a=o.index[i];return a<=t.end.row?a:this.binarySearchStrategy.find(e,t,n)}},{key:"advancedFind",value:function(e,t){return this.binarySearchStrategy.advancedFind(e,t)}},{key:"addColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice.apply(t,[e.columnStart,0].concat(cc(Array(e.numberOfColumns))))}},{key:"removeColumns",value:function(e){var t=this.index.get(e.sheet);t&&t.splice(e.columnStart,e.numberOfColumns)}},{key:"removeSheet",value:function(e){this.index.delete(e)}},{key:"getColumnMap",value:function(e,t){this.index.has(e)||this.index.set(e,[]);var n=this.index.get(e),r=n[t];return r||(r=new Map,n[t]=r),r}},{key:"getValueIndex",value:function(e,t,n){var r=this.getColumnMap(e,t),o=this.getColumnMap(e,t).get(n);return o||(o={version:this.transformingService.version(),index:[]},r.set(n,o)),o}},{key:"ensureRecentData",value:function(e,t,n){var r=this.getValueIndex(e,t,n),o=this.transformingService.version();if(r.version!==o){var i,a=fc(this.transformingService.getTransformationsFrom(r.version,(function(t){return t.sheet===e&&(t instanceof Ya||t instanceof bs)})));try{for(a.s();!(i=a.n()).done;){var s=i.value;s instanceof Ya?this.addRows(t,s.rowsSpan,n):s instanceof bs&&this.removeRows(t,s.rowsSpan,n)}}catch(e){a.e(e)}finally{a.f()}r.version=o}}},{key:"destroy",value:function(){this.index.clear()}},{key:"addSingleCellValue",value:function(e,t){var n=this;this.stats.measure(qt.BUILD_COLUMN_INDEX,(function(){n.ensureRecentData(t.sheet,t.col,e),"string"==typeof e&&(e=sa(e));var r=n.getValueIndex(t.sheet,t.col,e);n.addValue(r,t.row)}))}},{key:"removeSingleValue",value:function(e,t){var n=this;this.stats.measure(qt.BUILD_COLUMN_INDEX,(function(){n.ensureRecentData(t.sheet,t.col,e);var r=n.getColumnMap(t.sheet,t.col);"string"==typeof e&&(e=sa(e));var o=r.get(e);if(o){var i=vc(o.index,t.row);o.index.splice(i,1),0===o.index.length&&r.delete(e),0===r.size&&delete n.index.get(t.sheet)[t.col]}}))}},{key:"addRows",value:function(e,t,n){var r=this.getValueIndex(t.sheet,e,n);this.shiftRows(r,t.rowStart,t.numberOfRows)}},{key:"removeRows",value:function(e,t,n){var r=this.getValueIndex(t.sheet,e,n);this.removeRowsFromValues(r,t),this.shiftRows(r,t.rowEnd+1,-t.numberOfRows)}},{key:"addValue",value:function(e,t){var n=yc(e.index,t);e.index[n]!==t&&(n===e.index.length-1?e.index.push(t):e.index.splice(n+1,0,t))}},{key:"removeRowsFromValues",value:function(e,t){var n=vc(e.index,t.rowStart),r=yc(e.index,t.rowEnd);e.index[n]<=t.rowEnd&&e.index.splice(n,r-n+1)}},{key:"shiftRows",value:function(e,t,n){for(var r=vc(e.index,t);r<e.index.length;++r)e.index[r]+=n}}])&&dc(t.prototype,n),r&&dc(t,r),e}();function vc(e,t){for(var n=0,r=e.length-1;n<=r;){var o=Math.floor((n+r)/2);if(t>e[o])n=o+1;else{if(!(t<e[o]))return o;r=o-1}}return n}function yc(e,t){for(var n=0,r=e.length-1;n<=r;){var o=Math.floor((n+r)/2);if(t>e[o])n=o+1;else{if(!(t<e[o]))return o;r=o-1}}return r}function gc(e,t,n){return t.useColumnIndex?new mc(e,t,n):new uc(e,t)}function bc(e){return(bc="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ec(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Sc(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wc(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Sc(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Sc(e,t){if(e){if("string"==typeof e)return Tc(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Tc(e,t):void 0}}function Tc(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oc(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rc(e,t,n){return t&&Oc(e.prototype,t),n&&Oc(e,n),e}function Nc(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&kc(e,t)}function kc(e,t){return(kc=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ac(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Mc(e);if(t){var o=Mc(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Cc(this,n)}}function Cc(e,t){return!t||"object"!==bc(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Mc(e){return(Mc=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function xc(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ic=function e(){xc(this,e)},_c=function(e){Nc(n,e);var t=Ac(n);function n(e,r){var o;return xc(this,n),(o=t.call(this)).command=e,o.rowsRemovals=r,o}return Rc(n,[{key:"doUndo",value:function(e){e.undoRemoveRows(this)}},{key:"doRedo",value:function(e){e.redoRemoveRows(this)}}]),n}(Ic),Pc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i,a,s,u){var c;return xc(this,n),(c=t.call(this)).sourceLeftCorner=e,c.width=r,c.height=o,c.destinationLeftCorner=i,c.overwrittenCellsData=a,c.addedGlobalNamedExpressions=s,c.version=u,c}return Rc(n,[{key:"doUndo",value:function(e){e.undoMoveCells(this)}},{key:"doRedo",value:function(e){e.redoMoveCells(this)}}]),n}(Ic),Lc=function(e){Nc(n,e);var t=Ac(n);function n(e){var r;return xc(this,n),(r=t.call(this)).command=e,r}return Rc(n,[{key:"doUndo",value:function(e){e.undoAddRows(this)}},{key:"doRedo",value:function(e){e.redoAddRows(this)}}]),n}(Ic),Fc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o){var i;return xc(this,n),(i=t.call(this)).sheetId=e,i.rowMapping=r,i.oldContent=o,i}return Rc(n,[{key:"doUndo",value:function(e){e.undoSetRowOrder(this)}},{key:"doRedo",value:function(e){e.redoSetRowOrder(this)}}]),n}(Ic),Dc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o){var i;return xc(this,n),(i=t.call(this)).sheetId=e,i.columnMapping=r,i.oldContent=o,i}return Rc(n,[{key:"doUndo",value:function(e){e.undoSetColumnOrder(this)}},{key:"doRedo",value:function(e){e.redoSetColumnOrder(this)}}]),n}(Ic),Uc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o){var i;return xc(this,n),(i=t.call(this)).sheetId=e,i.oldSheetContent=r,i.newSheetContent=o,i}return Rc(n,[{key:"doUndo",value:function(e){e.undoSetSheetContent(this)}},{key:"doRedo",value:function(e){e.redoSetSheetContent(this)}}]),n}(Ic),jc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i,a){var s;return xc(this,n),(s=t.call(this)).sheet=e,s.startRow=r,s.numberOfRows=o,s.targetRow=i,s.version=a,s.undoStart=s.startRow<s.targetRow?s.targetRow-s.numberOfRows:s.targetRow,s.undoEnd=s.startRow>s.targetRow?s.startRow+s.numberOfRows:s.startRow,s}return Rc(n,[{key:"doUndo",value:function(e){e.undoMoveRows(this)}},{key:"doRedo",value:function(e){e.redoMoveRows(this)}}]),n}(Ic),Bc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i,a){var s;return xc(this,n),(s=t.call(this)).sheet=e,s.startColumn=r,s.numberOfColumns=o,s.targetColumn=i,s.version=a,s.undoStart=s.startColumn<s.targetColumn?s.targetColumn-s.numberOfColumns:s.targetColumn,s.undoEnd=s.startColumn>s.targetColumn?s.startColumn+s.numberOfColumns:s.startColumn,s}return Rc(n,[{key:"doUndo",value:function(e){e.undoMoveColumns(this)}},{key:"doRedo",value:function(e){e.redoMoveColumns(this)}}]),n}(Ic),Vc=function(e){Nc(n,e);var t=Ac(n);function n(e){var r;return xc(this,n),(r=t.call(this)).command=e,r}return Rc(n,[{key:"doUndo",value:function(e){e.undoAddColumns(this)}},{key:"doRedo",value:function(e){e.redoAddColumns(this)}}]),n}(Ic),Hc=function(e){Nc(n,e);var t=Ac(n);function n(e,r){var o;return xc(this,n),(o=t.call(this)).command=e,o.columnsRemovals=r,o}return Rc(n,[{key:"doUndo",value:function(e){e.undoRemoveColumns(this)}},{key:"doRedo",value:function(e){e.redoRemoveColumns(this)}}]),n}(Ic),Gc=function(e){Nc(n,e);var t=Ac(n);function n(e){var r;return xc(this,n),(r=t.call(this)).sheetName=e,r}return Rc(n,[{key:"doUndo",value:function(e){e.undoAddSheet(this)}},{key:"doRedo",value:function(e){e.redoAddSheet(this)}}]),n}(Ic),zc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i,a){var s;return xc(this,n),(s=t.call(this)).sheetName=e,s.sheetId=r,s.oldSheetContent=o,s.scopedNamedExpressions=i,s.version=a,s}return Rc(n,[{key:"doUndo",value:function(e){e.undoRemoveSheet(this)}},{key:"doRedo",value:function(e){e.redoRemoveSheet(this)}}]),n}(Ic),Wc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o){var i;return xc(this,n),(i=t.call(this)).sheetId=e,i.oldName=r,i.newName=o,i}return Rc(n,[{key:"doUndo",value:function(e){e.undoRenameSheet(this)}},{key:"doRedo",value:function(e){e.redoRenameSheet(this)}}]),n}(Ic),$c=function(e){Nc(n,e);var t=Ac(n);function n(e,r){var o;return xc(this,n),(o=t.call(this)).sheetId=e,o.oldSheetContent=r,o}return Rc(n,[{key:"doUndo",value:function(e){e.undoClearSheet(this)}},{key:"doRedo",value:function(e){e.redoClearSheet(this)}}]),n}(Ic),Yc=function(e){Nc(n,e);var t=Ac(n);function n(e){var r;return xc(this,n),(r=t.call(this)).cellContents=e,r}return Rc(n,[{key:"doUndo",value:function(e){e.undoSetCellContents(this)}},{key:"doRedo",value:function(e){e.redoSetCellContents(this)}}]),n}(Ic),Kc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i){var a;return xc(this,n),(a=t.call(this)).targetLeftCorner=e,a.oldContent=r,a.newContent=o,a.addedGlobalNamedExpressions=i,a}return Rc(n,[{key:"doUndo",value:function(e){e.undoPaste(this)}},{key:"doRedo",value:function(e){e.redoPaste(this)}}]),n}(Ic),qc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i){var a;return xc(this,n),(a=t.call(this)).name=e,a.newContent=r,a.scope=o,a.options=i,a}return Rc(n,[{key:"doUndo",value:function(e){e.undoAddNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoAddNamedExpression(this)}}]),n}(Ic),Xc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o){var i;return xc(this,n),(i=t.call(this)).namedExpression=e,i.content=r,i.scope=o,i}return Rc(n,[{key:"doUndo",value:function(e){e.undoRemoveNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoRemoveNamedExpression(this)}}]),n}(Ic),Jc=function(e){Nc(n,e);var t=Ac(n);function n(e,r,o,i,a){var s;return xc(this,n),(s=t.call(this)).namedExpression=e,s.newContent=r,s.oldContent=o,s.scope=i,s.options=a,s}return Rc(n,[{key:"doUndo",value:function(e){e.undoChangeNamedExpression(this)}},{key:"doRedo",value:function(e){e.redoChangeNamedExpression(this)}}]),n}(Ic),Qc=function(e){Nc(n,e);var t=Ac(n);function n(){var e;return xc(this,n),(e=t.apply(this,arguments)).operations=[],e}return Rc(n,[{key:"add",value:function(e){this.operations.push(e)}},{key:"reversedOperations",value:regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this.operations.length-1;case 1:if(!(t>=0)){e.next=7;break}return e.next=4,this.operations[t];case 4:t--,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"doUndo",value:function(e){e.undoBatch(this)}},{key:"doRedo",value:function(e){e.redoBatch(this)}}]),n}(Ic),Zc=function(){function e(t,n){xc(this,e),this.operations=n,this.undoStack=[],this.redoStack=[],this.oldData=new Map,this.undoLimit=t.undoLimit}return Rc(e,[{key:"saveOperation",value:function(e){void 0!==this.batchUndoEntry?this.batchUndoEntry.add(e):this.addUndoEntry(e)}},{key:"beginBatchMode",value:function(){this.batchUndoEntry=new Qc}},{key:"addUndoEntry",value:function(e){this.undoStack.push(e),this.undoStack.splice(0,Math.max(0,this.undoStack.length-this.undoLimit))}},{key:"commitBatchMode",value:function(){if(void 0===this.batchUndoEntry)throw"Batch mode wasn't started";this.addUndoEntry(this.batchUndoEntry),this.batchUndoEntry=void 0}},{key:"storeDataForVersion",value:function(e,t,n){this.oldData.has(e)||this.oldData.set(e,[]),this.oldData.get(e).push([t,n])}},{key:"clearRedoStack",value:function(){this.redoStack=[]}},{key:"clearUndoStack",value:function(){this.undoStack=[]}},{key:"isUndoStackEmpty",value:function(){return 0===this.undoStack.length}},{key:"isRedoStackEmpty",value:function(){return 0===this.redoStack.length}},{key:"undo",value:function(){var e=this.undoStack.pop();if(!e)throw"Attempted to undo without operation on stack";this.undoEntry(e),this.redoStack.push(e)}},{key:"undoEntry",value:function(e){e.doUndo(this)}},{key:"undoBatch",value:function(e){var t,n=wc(e.reversedOperations());try{for(n.s();!(t=n.n()).done;){var r=t.value;this.undoEntry(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoRemoveRows",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,n=e.rowsRemovals,r=n.length-1;r>=0;--r){var o=n[r];this.operations.addRows(new bu(t,[[o.rowFrom,o.rowCount]]));var i,a=wc(o.removedCells);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=s.address,c=s.cellType;this.operations.restoreCell(u,c)}}catch(e){a.e(e)}finally{a.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoRemoveColumns",value:function(e){this.operations.forceApplyPostponedTransformations();for(var t=e.command.sheet,n=e.columnsRemovals,r=n.length-1;r>=0;--r){var o=n[r];this.operations.addColumns(new Eu(t,[[o.columnFrom,o.columnCount]]));var i,a=wc(o.removedCells);try{for(a.s();!(i=a.n()).done;){var s=i.value,u=s.address,c=s.cellType;this.operations.restoreCell(u,c)}}catch(e){a.e(e)}finally{a.f()}this.restoreOldDataFromVersion(o.version-1)}}},{key:"undoAddRows",value:function(e){for(var t=e.command.rowsSpans(),n=t.length-1;n>=0;--n){var r=t[n];this.operations.removeRows(new gu(e.command.sheet,[[r.rowStart,r.numberOfRows]]))}}},{key:"undoAddColumns",value:function(e){for(var t=e.command.columnsSpans(),n=t.length-1;n>=0;--n){var r=t[n];this.operations.removeColumns(new wu(e.command.sheet,[[r.columnStart,r.numberOfColumns]]))}}},{key:"undoSetCellContents",value:function(e){var t,n=wc(e.cellContents);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.restoreCell(r.address,r.oldContent)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoPaste",value:function(e){this.restoreOperationOldContent(e.oldContent);var t,n=wc(e.addedGlobalNamedExpressions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.removeNamedExpression(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoMoveRows",value:function(e){var t=e.sheet;this.operations.moveRows(t,e.undoStart,e.numberOfRows,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveColumns",value:function(e){var t=e.sheet;this.operations.moveColumns(t,e.undoStart,e.numberOfColumns,e.undoEnd),this.restoreOldDataFromVersion(e.version-1)}},{key:"undoMoveCells",value:function(e){this.operations.forceApplyPostponedTransformations(),this.operations.moveCells(e.destinationLeftCorner,e.width,e.height,e.sourceLeftCorner),this.restoreOperationOldContent(e.overwrittenCellsData),this.restoreOldDataFromVersion(e.version-1);var t,n=wc(e.addedGlobalNamedExpressions);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.removeNamedExpression(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"undoAddSheet",value:function(e){var t=e.sheetName;this.operations.removeSheet(t)}},{key:"undoRemoveSheet",value:function(e){this.operations.forceApplyPostponedTransformations();var t=e.oldSheetContent,n=e.sheetId;this.operations.addSheet(e.sheetName);for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=Yo(n,i,r);this.operations.restoreCell(s,a)}var u,c=wc(e.scopedNamedExpressions);try{for(c.s();!(u=c.n()).done;){var l=Ec(u.value,2),f=l[0],h=l[1];this.operations.restoreNamedExpression(f,h,n)}}catch(e){c.e(e)}finally{c.f()}this.restoreOldDataFromVersion(e.version-1)}},{key:"undoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.oldName)}},{key:"undoClearSheet",value:function(e){for(var t=e.oldSheetContent,n=e.sheetId,r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=Yo(n,i,r);this.operations.restoreCell(s,a)}}},{key:"undoSetSheetContent",value:function(e){var t=e.oldSheetContent,n=e.sheetId;this.operations.clearSheet(n);for(var r=0;r<t.length;r++)for(var o=t[r],i=0;i<o.length;i++){var a=o[i],s=Yo(n,i,r);this.operations.restoreCell(s,a)}}},{key:"undoAddNamedExpression",value:function(e){this.operations.removeNamedExpression(e.name,e.scope)}},{key:"undoRemoveNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.content,e.scope)}},{key:"undoChangeNamedExpression",value:function(e){this.operations.restoreNamedExpression(e.namedExpression,e.oldContent,e.scope)}},{key:"undoSetRowOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"undoSetColumnOrder",value:function(e){this.restoreOperationOldContent(e.oldContent)}},{key:"restoreOperationOldContent",value:function(e){var t,n=wc(e);try{for(n.s();!(t=n.n()).done;){var r=Ec(t.value,2),o=r[0],i=r[1];this.operations.restoreCell(o,i)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redo",value:function(){var e=this.redoStack.pop();if(!e)throw"Attempted to redo without operation on stack";this.redoEntry(e),this.undoStack.push(e)}},{key:"redoEntry",value:function(e){e.doRedo(this)}},{key:"redoBatch",value:function(e){var t,n=wc(e.operations);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.redoEntry(r)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redoRemoveRows",value:function(e){this.operations.removeRows(e.command)}},{key:"redoMoveCells",value:function(e){this.operations.moveCells(e.sourceLeftCorner,e.width,e.height,e.destinationLeftCorner)}},{key:"redoRemoveColumns",value:function(e){this.operations.removeColumns(e.command)}},{key:"redoPaste",value:function(e){for(var t=e.targetLeftCorner,n=e.newContent,r=n.length,o=n[0].length,i=0;i<r;++i)for(var a=0;a<o;++a){var s=Yo(t.sheet,t.col+a,t.row+i);this.operations.restoreCell(s,n[i][a])}}},{key:"redoSetCellContents",value:function(e){var t,n=wc(e.cellContents);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.operations.setCellContent(r.address,r.newContent)}}catch(e){n.e(e)}finally{n.f()}}},{key:"redoAddRows",value:function(e){this.operations.addRows(e.command)}},{key:"redoAddColumns",value:function(e){this.operations.addColumns(e.command)}},{key:"redoRemoveSheet",value:function(e){this.operations.removeSheet(e.sheetName)}},{key:"redoAddSheet",value:function(e){this.operations.addSheet(e.sheetName)}},{key:"redoRenameSheet",value:function(e){this.operations.renameSheet(e.sheetId,e.newName)}},{key:"redoMoveRows",value:function(e){this.operations.moveRows(e.sheet,e.startRow,e.numberOfRows,e.targetRow)}},{key:"redoMoveColumns",value:function(e){this.operations.moveColumns(e.sheet,e.startColumn,e.numberOfColumns,e.targetColumn)}},{key:"redoClearSheet",value:function(e){this.operations.clearSheet(e.sheetId)}},{key:"redoSetSheetContent",value:function(e){var t=e.sheetId,n=e.newSheetContent;this.operations.setSheetContent(t,n)}},{key:"redoAddNamedExpression",value:function(e){this.operations.addNamedExpression(e.name,e.newContent,e.scope,e.options)}},{key:"redoRemoveNamedExpression",value:function(e){this.operations.removeNamedExpression(e.namedExpression.displayName,e.scope)}},{key:"redoChangeNamedExpression",value:function(e){this.operations.changeNamedExpressionExpression(e.namedExpression.displayName,e.newContent,e.scope,e.options)}},{key:"redoSetRowOrder",value:function(e){this.operations.setRowOrder(e.sheetId,e.rowMapping)}},{key:"redoSetColumnOrder",value:function(e){this.operations.setColumnOrder(e.sheetId,e.columnMapping)}},{key:"restoreOldDataFromVersion",value:function(e){var t,n=wc(this.oldData.get(e)||[]);try{for(n.s();!(t=n.n()).done;){var r=Ec(t.value,2),o=r[0],i=r[1];this.operations.setFormulaToCellFromCache(i,o)}}catch(e){n.e(e)}finally{n.f()}}}]),e}();function el(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||nl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=nl(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function nl(e,t){if(e){if("string"==typeof e)return rl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rl(e,t):void 0}}function rl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ol(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var il,al=function(){function e(t,n,r,o,i,a,s,u){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.stats=n,this.dependencyGraph=r,this.columnSearch=o,this.parser=i,this.cellContentParser=a,this.lazilyTransformingAstService=s,this.namedExpressions=u,this.operations=new Su(this.dependencyGraph,this.columnSearch,this.cellContentParser,this.parser,this.stats,this.lazilyTransformingAstService,this.namedExpressions,this.config),this.clipboardOperations=new Sa(this.dependencyGraph,this.operations,this.parser,this.lazilyTransformingAstService,this.config),this.undoRedo=new Zc(this.config,this.operations)}var t,n,r;return t=e,(n=[{key:"addRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new bu(e,n);this.ensureItIsPossibleToAddRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addRows(o),this.undoRedo.saveOperation(new Lc(o))}},{key:"removeRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new gu(e,n);this.ensureItIsPossibleToRemoveRows.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.removeRows(o);this.undoRedo.saveOperation(new _c(o,i))}},{key:"addColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new Eu(e,n);this.ensureItIsPossibleToAddColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.operations.addColumns(o),this.undoRedo.saveOperation(new Vc(o))}},{key:"removeColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=new wu(e,n);this.ensureItIsPossibleToRemoveColumns.apply(this,[e].concat(n)),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var i=this.operations.removeColumns(o);this.undoRedo.saveOperation(new Hc(o,i))}},{key:"moveCells",value:function(e,t,n,r){this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveCells(e,t,n,r),i=o.version,a=o.overwrittenCellsData,s=o.addedGlobalNamedExpressions;this.undoRedo.saveOperation(new Pc(e,t,n,r,a,s,i))}},{key:"moveRows",value:function(e,t,n,r){this.ensureItIsPossibleToMoveRows(e,t,n,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var o=this.operations.moveRows(e,t,n,r);this.undoRedo.saveOperation(new jc(e,t,n,r,o))}},{key:"moveColumns",value:function(e,t,n,r){this.ensureItIsPossibleToMoveColumns(e,t,n,r),this.undoRedo.clearRedoStack();var o=this.operations.moveColumns(e,t,n,r);this.undoRedo.saveOperation(new Bc(e,t,n,r,o))}},{key:"cut",value:function(e,t,n){this.clipboardOperations.cut(e,t,n)}},{key:"ensureItIsPossibleToCopy",value:function(e,t,n){if(!sl(t))throw new An("width to be positive integer.");if(!sl(n))throw new An("height to be positive integer.")}},{key:"copy",value:function(e,t,n){this.ensureItIsPossibleToCopy(e,t,n),this.clipboardOperations.copy(e,t,n)}},{key:"paste",value:function(e){var t=this.clipboardOperations.clipboard;if(void 0===t)throw new Pn;if(this.clipboardOperations.isCutClipboard())this.moveCells(t.sourceLeftCorner,t.width,t.height,e);else if(this.clipboardOperations.isCopyClipboard()){this.clipboardOperations.ensureItIsPossibleToCopyPaste(e);var n=yt.spanFrom(e,t.width,t.height),r=this.operations.getRangeClipboardCells(n);this.undoRedo.clearRedoStack(),this.dependencyGraph.breakNumericMatricesInRange(n);var o=this.operations.restoreClipboardCells(t.sourceLeftCorner.sheet,t.getContent(e));this.undoRedo.saveOperation(new Kc(e,r,t.content,o))}}},{key:"beginUndoRedoBatchMode",value:function(){this.undoRedo.beginBatchMode()}},{key:"commitUndoRedoBatchMode",value:function(){this.undoRedo.commitBatchMode()}},{key:"isClipboardEmpty",value:function(){return void 0===this.clipboardOperations.clipboard}},{key:"clearClipboard",value:function(){this.clipboardOperations.clear()}},{key:"addSheet",value:function(e){e&&this.ensureItIsPossibleToAddSheet(e),this.undoRedo.clearRedoStack();var t=this.operations.addSheet(e);return this.undoRedo.saveOperation(new Gc(t)),t}},{key:"removeSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),n=this.sheetMapping.fetchDisplayName(t),r=this.operations.getSheetClipboardCells(t),o=this.operations.removeSheet(e),i=o.version,a=o.scopedNamedExpressions;this.undoRedo.saveOperation(new zc(n,t,r,a,i))}},{key:"renameSheet",value:function(e,t){this.ensureItIsPossibleToRenameSheet(e,t);var n=this.operations.renameSheet(e,t);return void 0!==n&&(this.undoRedo.clearRedoStack(),this.undoRedo.saveOperation(new Wc(e,n,t))),n}},{key:"clearSheet",value:function(e){this.ensureSheetExists(e),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var t=this.sheetMapping.fetch(e),n=this.operations.getSheetClipboardCells(t);this.operations.clearSheet(t),this.undoRedo.saveOperation(new $c(t,n))}},{key:"setCellContents",value:function(e,t){if(t instanceof Array)for(var n=0;n<t.length;n++){if(!(t[n]instanceof Array))throw new An("an array of arrays or a raw cell value.");for(var r=0;r<t[n].length;r++)if(da(t[n][r]))throw new Error("Cant change matrices in batch operation")}else t=[[t]];this.ensureItIsPossibleToChangeCellContents(e,t),this.undoRedo.clearRedoStack();for(var o=[],i=0;i<t.length;i++)for(var a=0;a<t[i].length;a++){var s={sheet:e.sheet,row:e.row+i,col:e.col+a};this.clipboardOperations.abortCut();var u=this.operations.getClipboardCell(s);this.operations.setCellContent(s,t[i][a]),o.push({address:s,newContent:t[i][a],oldContent:u})}this.undoRedo.saveOperation(new Yc(o))}},{key:"setSheetContent",value:function(e,t){this.ensureSheetExists(e);var n=this.sheetMapping.fetch(e);this.ensureItIsPossibleToChangeSheetContents(n,t),tu(t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var r=this.operations.getSheetClipboardCells(n);this.operations.setSheetContent(n,t),this.undoRedo.saveOperation(new Uc(n,r,t))}},{key:"setRowOrder",value:function(e,t){this.validateSwapRowIndexes(e,t),this.testRowOrderForMatrices(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setRowOrder(e,t);this.undoRedo.saveOperation(new Fc(e,t,n))}},{key:"validateSwapRowIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);this.validateRowOrColumnMapping(e,t,"row")}},{key:"testColumnOrderForMatrices",value:function(e,t){var n,r=tl(t);try{for(r.s();!(n=r.n()).done;){var o=el(n.value,2),i=o[0];if(i!==o[1]){var a=yt.spanFrom({sheet:e,col:i,row:0},1,1/0);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(a))throw new qn}}}catch(e){r.e(e)}finally{r.f()}}},{key:"setColumnOrder",value:function(e,t){this.validateSwapColumnIndexes(e,t),this.testColumnOrderForMatrices(e,t),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut();var n=this.operations.setColumnOrder(e,t);this.undoRedo.saveOperation(new Dc(e,t,n))}},{key:"validateSwapColumnIndexes",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);this.validateRowOrColumnMapping(e,t,"column")}},{key:"testRowOrderForMatrices",value:function(e,t){var n,r=tl(t);try{for(r.s();!(n=r.n()).done;){var o=el(n.value,2),i=o[0];if(i!==o[1]){var a=yt.spanFrom({sheet:e,col:0,row:i},1/0,1);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(a))throw new qn}}}catch(e){r.e(e)}finally{r.f()}}},{key:"mappingFromOrder",value:function(e,t,n){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e);if(t.length!==r)throw new An("number of ".concat(n,"s provided to be sheet ").concat("row"===n?"height":"width","."));for(var o=[],i=0;i<r;i++)t[i]!==i&&o.push([i,t[i]]);return o}},{key:"validateRowOrColumnMapping",value:function(e,t,n){for(var r="row"===n?this.dependencyGraph.getSheetHeight(e):this.dependencyGraph.getSheetWidth(e),o=t.map((function(e){var t=el(e,2),n=t[0];return t[1],n})).sort((function(e,t){return e-t})),i=t.map((function(e){var t=el(e,2);return t[0],t[1]})).sort((function(e,t){return e-t})),a=0;a<o.length;a++){if(!ul(o[a])||o[a]>=r)throw new An("".concat(n," numbers to be nonnegative integers and less than sheet ").concat("row"===n?"height":"width","."));if(o[a]===o[a+1])throw new An("source ".concat(n," numbers to be unique."));if(o[a]!==i[a])throw new An("target ".concat(n," numbers to be permutation of source ").concat(n," numbers."))}}},{key:"undo",value:function(){if(this.undoRedo.isUndoStackEmpty())throw new In;this.clipboardOperations.abortCut(),this.undoRedo.undo()}},{key:"redo",value:function(){if(this.undoRedo.isRedoStackEmpty())throw new _n;this.clipboardOperations.abortCut(),this.undoRedo.redo()}},{key:"addNamedExpression",value:function(e,t,n,r){var o=this.scopeId(n);this.ensureNamedExpressionNameIsValid(e,o),this.operations.addNamedExpression(e,t,o,r),this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new qc(e,t,o,r))}},{key:"changeNamedExpressionExpression",value:function(e,t,n,r){var o=this.scopeId(t),i=el(this.operations.changeNamedExpressionExpression(e,n,o,r),2),a=i[0],s=i[1];this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Jc(a,n,s,o,r))}},{key:"removeNamedExpression",value:function(e,t){var n=this.scopeId(t),r=el(this.operations.removeNamedExpression(e,n),2),o=r[0],i=r[1];return this.undoRedo.clearRedoStack(),this.clipboardOperations.abortCut(),this.undoRedo.saveOperation(new Xc(o,i,n)),o}},{key:"ensureItIsPossibleToAddNamedExpression",value:function(e,t,n){var r=this.scopeId(n);this.ensureNamedExpressionNameIsValid(e,r),this.ensureNamedExpressionIsValid(t)}},{key:"ensureItIsPossibleToChangeNamedExpression",value:function(e,t,n){var r=this.scopeId(n);if(void 0===this.namedExpressions.namedExpressionForScope(e,r))throw new xn(e);this.ensureNamedExpressionIsValid(t)}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){var n=this.scopeId(t);if(void 0===this.namedExpressions.namedExpressionForScope(e,n))throw new xn(e)}},{key:"ensureItIsPossibleToAddRows",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);for(var t=this.dependencyGraph.getSheetHeight(e),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+i>this.config.maxRows)throw new Rn;for(var a=0,s=r;a<s.length;a++){var u=el(s[a],2),c=u[0],l=u[1];if(!ul(c)||!sl(l))throw new An("row number to be nonnegative and number of rows to add to be positive.");if(sl(c)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,c-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInRow(e,c))throw new Xn}}},{key:"ensureItIsPossibleToRemoveRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=el(i[o],2),s=a[0],u=a[1],c=s+u-1;if(!ul(s)||!ul(c))throw new An("starting and ending row to be nonnegative.");if(c<s)throw new An("starting row to be smaller than the ending row.");var l=it.fromRowStartAndEnd(e,s,c);if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRows(l))throw new qn}}},{key:"ensureItIsPossibleToAddColumns",value:function(e){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);for(var t=this.dependencyGraph.getSheetWidth(e),n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];var i=r.map((function(e){return e[1]})).reduce((function(e,t){return e+t}),0);if(t+i>this.config.maxColumns)throw new Rn;for(var a=0,s=r;a<s.length;a++){var u=el(s[a],2),c=u[0],l=u[1];if(!ul(c)||!sl(l))throw new An("column number to be nonnegative and number of columns to add to be positive.");if(sl(c)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,c-1)&&this.dependencyGraph.matrixMapping.isFormulaMatrixInColumn(e,c))throw new Xn}}},{key:"ensureItIsPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=el(i[o],2),s=a[0],u=a[1],c=s+u-1;if(!ul(s)||!ul(c))throw new An("starting and ending column to be nonnegative.");if(c<s)throw new An("starting column to be smaller than the ending column.");var l=at.fromColumnStartAndEnd(e,s,c);if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInColumns(l))throw new qn}}},{key:"ensureItIsPossibleToMoveRows",value:function(e,t,n,r){this.ensureItIsPossibleToAddRows(e,[r,n]);var o=Yo(e,0,t),i=Yo(e,0,r);if(!this.sheetMapping.hasSheetWithId(e)||Ko(o)||Ko(i)||!sl(n)||r<=t+n&&r>=t)throw new An("a valid range of rows to move.");var a=this.dependencyGraph.getSheetWidth(e),s=yt.spanFrom(o,a,n);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(s))throw new qn}},{key:"ensureItIsPossibleToMoveColumns",value:function(e,t,n,r){this.ensureItIsPossibleToAddColumns(e,[r,n]);var o=Yo(e,t,0),i=Yo(e,r,0);if(!this.sheetMapping.hasSheetWithId(e)||Ko(o)||Ko(i)||!sl(n)||r<=t+n&&r>=t)throw new An("a valid range of columns to move.");var a=this.dependencyGraph.getSheetHeight(e),s=yt.spanFrom(o,n,a);if(this.dependencyGraph.matrixMapping.isFormulaMatrixInRange(s))throw new qn}},{key:"ensureItIsPossibleToAddSheet",value:function(e){if(this.sheetMapping.hasSheetWithName(e))throw new On(e)}},{key:"ensureItIsPossibleToRenameSheet",value:function(e,t){if(!this.sheetMapping.hasSheetWithId(e))throw new Sn(e);var n=this.sheetMapping.get(t);if(void 0!==n&&n!==e)throw new On(t)}},{key:"ensureItIsPossibleToChangeContent",value:function(e){if(Ko(e))throw new kn(e);if(!this.sheetMapping.hasSheetWithId(e.sheet))throw new Sn(e.sheet);if(this.dependencyGraph.matrixMapping.isFormulaMatrixAtAddress(e))throw new qn}},{key:"ensureItIsPossibleToChangeCellContents",value:function(e,t){var n=nu(t),r=yt.spanFrom(e,n.width,n.height);this.ensureRangeInSizeLimits(r);var o,i=tl(r.addresses(this.dependencyGraph));try{for(i.s();!(o=i.n()).done;){var a=o.value;this.ensureItIsPossibleToChangeContent(a)}}catch(e){i.e(e)}finally{i.f()}}},{key:"ensureItIsPossibleToChangeSheetContents",value:function(e,t){var n=nu(t),r=yt.spanFrom(Yo(e,0,0),n.width,n.height);this.ensureRangeInSizeLimits(r)}},{key:"ensureRangeInSizeLimits",value:function(e){if(e.exceedsSheetSizeLimits(this.config.maxColumns,this.config.maxRows))throw new Rn}},{key:"isThereSomethingToUndo",value:function(){return!this.undoRedo.isUndoStackEmpty()}},{key:"isThereSomethingToRedo",value:function(){return!this.undoRedo.isRedoStackEmpty()}},{key:"getAndClearContentChanges",value:function(){return this.operations.getAndClearContentChanges()}},{key:"ensureSheetExists",value:function(e){if(!this.sheetMapping.hasSheetWithName(e))throw new Tn(e)}},{key:"scopeId",value:function(e){if(void 0!==e)return this.ensureSheetExists(e),this.sheetMapping.fetch(e)}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"ensureNamedExpressionNameIsValid",value:function(e,t){if(!this.namedExpressions.isNameValid(e))throw new Mn(e);if(!this.namedExpressions.isNameAvailable(e,t))throw new Cn(e)}},{key:"ensureNamedExpressionIsValid",value:function(e){var t=this.cellContentParser.parse(e);if(t instanceof Zi.MatrixFormula)throw new Jn;if(t instanceof Zi.Formula){var n=this.parser.parse(t.formula,Yo(-1,0,0));if(eu(n.ast))throw new Qn}}}])&&ol(t.prototype,n),r&&ol(t,r),e}();function sl(e){return Number.isInteger(e)&&e>0}function ul(e){return Number.isInteger(e)&&e>=0}function cl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.GREATER_THAN="GREATER_THAN",e.GREATER_THAN_OR_EQUAL="GREATER_THAN_OR_EQUAL",e.LESS_THAN="LESS_THAN",e.LESS_THAN_OR_EQUAL="LESS_THAN_OR_EQUAL",e.NOT_EQUAL="NOT_EQUAL",e.EQUAL="EQUAL"}(il||(il={}));var ll=function(e,t){return{operator:e,value:t}},fl=function(){function e(t){var n,r,o,i;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.trueString=null!==(r=null===(n=t.translationPackage.getMaybeFunctionTranslation("TRUE"))||void 0===n?void 0:n.toLowerCase())&&void 0!==r?r:"true",this.falseString=null!==(i=null===(o=t.translationPackage.getMaybeFunctionTranslation("FALSE"))||void 0===o?void 0:o.toLowerCase())&&void 0!==i?i:"false"}var t,n,r;return t=e,(n=[{key:"fromCellValue",value:function(e,t){if("string"==typeof e||"boolean"==typeof e||"number"==typeof e){var n=this.parseCriterion(e,t);if(void 0!==n)return{raw:e,lambda:dl(n,t)}}}},{key:"parseCriterion",value:function(e,t){if("number"==typeof e||"boolean"==typeof e)return ll(il.EQUAL,e);if("string"==typeof e){var n,r,o=hl.exec(e);o?(r=function(e){switch(e){case">":return il.GREATER_THAN;case">=":return il.GREATER_THAN_OR_EQUAL;case"<":return il.LESS_THAN;case"<=":return il.LESS_THAN_OR_EQUAL;case"<>":return il.NOT_EQUAL;case"=":return il.EQUAL;default:return}}(o[1]),n=o[2]):(r=il.EQUAL,n=e);var i=t.coerceToMaybeNumber(n),a=n.toLowerCase()===this.trueString||n.toLowerCase()!==this.falseString&&void 0;if(void 0===r)return;if(""===n)return ll(r,null);if(void 0!==i)return ll(r,xt(i));if(r===il.EQUAL||r===il.NOT_EQUAL)return ll(r,null!=a?a:n)}}}])&&cl(t.prototype,n),r&&cl(t,r),e}(),hl=/([<>=]+)(.*)/;var pl,dl=function(e,t){switch(e.operator){case il.GREATER_THAN:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)>0}:function(e){return!1};case il.GREATER_THAN_OR_EQUAL:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)>=0}:function(e){return!1};case il.LESS_THAN:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)<0}:function(e){return!1};case il.LESS_THAN_OR_EQUAL:return"number"==typeof e.value?function(n){return"number"==typeof n&&t.floatCmp(n,e.value)<=0}:function(e){return!1};case il.EQUAL:return"number"==typeof e.value?function(n){if("number"==typeof n)return 0===t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!1;var r=t.coerceToMaybeNumber(n);return void 0!==r&&0===t.floatCmp(r,e.value)}return!1}:"string"==typeof e.value?t.eqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"==typeof t&&t===e.value}:function(e){return e===Mt};case il.NOT_EQUAL:return"number"==typeof e.value?function(n){if("number"==typeof n)return 0!==t.floatCmp(n,e.value);if("string"==typeof n){if(""===n)return!0;var r=t.coerceToMaybeNumber(n);return void 0===r||0!==t.floatCmp(r,e.value)}return!0}:"string"==typeof e.value?t.neqMatcherFunction(e.value):"boolean"==typeof e.value?function(t){return"boolean"!=typeof t||t!==e.value}:function(e){return e!==Mt}}};function ml(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=yl(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function vl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||yl(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yl(e,t){if(e){if("string"==typeof e)return gl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gl(e,t):void 0}}function gl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}!function(e){e.STRING="STRING",e.NUMBER="NUMBER",e.BOOLEAN="BOOLEAN",e.SCALAR="SCALAR",e.NOERROR="NOERROR",e.RANGE="RANGE",e.INTEGER="INTEGER",e.COMPLEX="COMPLEX",e.ANY="ANY"}(pl||(pl={}));var El=function(){function e(t){var n=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.coerceScalarToNumberOrError=function(e){return n.interpreter.arithmeticHelper.coerceScalarToNumberOrError(e)},this.runFunction=function(e,t,r,o){return n.runFunctionTemplate(e,t,r,o)},this.runMatrixFunction=function(e,t,r,o){return n.runFunctionTemplate(e,t,r,o)},this.runFunctionTemplate=function(e,t,r,o){var i,a,s,u,c=r.parameters;u=r.expandRanges?n.listOfScalarValues(e,t):e.map((function(e){return[n.evaluateAst(e,t),!1]}));var l=[],f=void 0;if(void 0===r.repeatLastArgs&&c.length<u.length)return new Ho(Mo.NA,Ne.WrongArgNumber);if(void 0!==r.repeatLastArgs&&u.length>c.length&&(u.length-c.length)%r.repeatLastArgs!=0)return new Ho(Mo.NA,Ne.WrongArgNumber);for(var h=0,p=0;h<Math.max(u.length,c.length);h++,p++){p===c.length&&(p-=r.repeatLastArgs);var d=vl(null!==(i=u[h])&&void 0!==i?i:[void 0,void 0],2),m=d[0],v=d[1],y=null!=m?m:null===(a=c[p])||void 0===a?void 0:a.defaultValue;if(void 0===y){if(!(null===(s=c[p])||void 0===s?void 0:s.optionalArg))return new Ho(Mo.NA,Ne.WrongArgNumber);l.push(void 0)}else{var g=void 0!==m?n.coerceToType(y,c[p]):y;void 0!==g?(g instanceof Ho&&c[p].argumentType!==pl.SCALAR&&(f=null!=f?f:g),l.push(g)):v||(f=null!=f?f:new Ho(Mo.VALUE,Ne.WrongType))}}return null!=f?f:n.returnNumberWrapper(o.apply(void 0,l),r.returnNumberType)},this.runFunctionWithReferenceArgument=function(e,t,r,o,i){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){return new Ho(Mo.NA,Ne.CellRefExpected)};if(0===e.length)return n.returnNumberWrapper(o(),r.returnNumberType);if(e.length>1)return new Ho(Mo.NA,Ne.WrongArgNumber);for(var s,u=e[0];u.type===le.PARENTHESIS;)u=u.expression;if(u.type===le.CELL_REFERENCE)s=u.reference.toSimpleCellAddress(t);else if(u.type===le.CELL_RANGE||u.type===le.COLUMN_RANGE||u.type===le.ROW_RANGE)try{s=yt.fromAst(u,t).start}catch(e){return new Ho(Mo.REF,Ne.CellRefExpected)}return void 0!==s?n.returnNumberWrapper(i(s),r.returnNumberType):n.runFunction(e,t,r,a)},this.interpreter=t,this.dependencyGraph=t.dependencyGraph,this.columnSearch=t.columnSearch,this.config=t.config,this.serialization=t.serialization}var t,n,r;return t=e,(n=[{key:"evaluateAst",value:function(e,t){return this.interpreter.evaluateAst(e,t)}},{key:"listOfScalarValues",value:function(e,t){var n,r=[],o=ml(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=this.evaluateAst(i,t);if(a instanceof Qt){var s,u=ml(a.valuesFromTopLeftCorner());try{for(u.s();!(s=u.n()).done;){var c=s.value;r.push([c,!0])}}catch(e){u.e(e)}finally{u.f()}}else r.push([a,!1])}}catch(e){o.e(e)}finally{o.f()}return r}},{key:"coerceToType",value:function(e,t){var n;if(e instanceof Qt)switch(t.argumentType){case pl.RANGE:case pl.ANY:n=e;break;default:return}else switch(t.argumentType){case pl.INTEGER:case pl.NUMBER:var r=this.coerceScalarToNumberOrError(e);if(!Bt(r)){n=r;break}var o=xt(r);if(void 0!==t.maxValue&&o>t.maxValue)return new Ho(Mo.NUM,Ne.ValueLarge);if(void 0!==t.minValue&&o<t.minValue)return new Ho(Mo.NUM,Ne.ValueSmall);if(void 0!==t.lessThan&&o>=t.lessThan)return new Ho(Mo.NUM,Ne.ValueLarge);if(void 0!==t.greaterThan&&o<=t.greaterThan)return new Ho(Mo.NUM,Ne.ValueSmall);if(t.argumentType===pl.INTEGER&&!Number.isInteger(o))return new Ho(Mo.NUM,Ne.IntegerExpected);n=r;break;case pl.STRING:n=Yi(e);break;case pl.BOOLEAN:n=function(e){if(e instanceof Ho||"boolean"==typeof e)return e;if(e===Mt)return!1;if(Bt(e))return 0!==xt(e);var t=e.toUpperCase();return"TRUE"===t||"FALSE"!==t&&""!==t&&void 0}(e);break;case pl.SCALAR:case pl.NOERROR:case pl.ANY:n=e;break;case pl.RANGE:if(e instanceof Ho)return e;n=function(e){return e instanceof Qt?e:Qt.fromScalar(e)}(xt(e));break;case pl.COMPLEX:return this.interpreter.arithmeticHelper.coerceScalarToComplex(xt(e))}return t.passSubtype||void 0===n?n:xt(n)}},{key:"metadata",value:function(e){var t=this.constructor.implementedFunctions[e];if(void 0!==t)return t;throw new Error("No metadata for function ".concat(e,"."))}},{key:"returnNumberWrapper",value:function(e,t,n){return void 0!==t&&Bt(e)?this.interpreter.arithmeticHelper.ExtendedNumberFactory(xt(e),{type:t,format:n}):e}}])&&bl(t.prototype,n),r&&bl(t,r),e}();function wl(e){return(wl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Sl(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Tl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ol(e,t){return(Ol=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Rl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=kl(e);if(t){var o=kl(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Nl(this,n)}}function Nl(e,t){return!t||"object"!==wl(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function kl(e){return(kl=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Al=new Map([["agpl-v3",1],["non-commercial-and-evaluation",2],["missing",3],["invalid",4],["expired",5]]),Cl=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ol(e,t)}(i,e);var t,n,r,o=Rl(i);function i(){return Sl(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"version",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("VERSION"),(function(){var e,t=n.config,r=t.licenseKeyValidityState,o=t.licenseKey;return Al.has(o)?e=Al.get(o):Al.has(r)?e=Al.get(r):"valid"===r&&(e=o.slice(-5)),"HyperFormula v".concat(cf.version,", ").concat(e)}))}}])&&Tl(t.prototype,n),r&&Tl(t,r),i}(El);function Ml(e){return function(e){if(Array.isArray(e))return Pl(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||_l(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xl(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||_l(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Il(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_l(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function _l(e,t){if(e){if("string"==typeof e)return Pl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pl(e,t):void 0}}function Pl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ll(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Fl(e,t){var n,r=t.implementedFunctions[e],o=null===(n=t.aliases)||void 0===n?void 0:n[e];if(void 0!==o){if(void 0!==r)throw new Zn(e,t.name);r=t.implementedFunctions[o]}if(void 0===r)throw Yn.functionNotDeclaredInPlugin(e,t.name);return r}Cl.implementedFunctions={VERSION:{method:"version",parameters:[]}};var Dl=function(){function e(t){var n=this;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t,this.functions=new Map,this.volatileFunctions=new Set,this.structuralChangeFunctions=new Set,this.functionsWhichDoesNotNeedArgumentsToBeComputed=new Set,this.doesFunctionNeedArgumentToBeComputed=function(e){return n.functionsWhichDoesNotNeedArgumentsToBeComputed.has(e)},this.isFunctionVolatile=function(e){return n.volatileFunctions.has(e)},this.isFunctionDependentOnSheetStructureChange=function(e){return n.structuralChangeFunctions.has(e)},t.functionPlugins.length>0){this.instancePlugins=new Map;var r,o=Il(t.functionPlugins);try{for(o.s();!(r=o.n()).done;){var i=r.value;e.loadPluginFunctions(i,this.instancePlugins)}}catch(e){o.e(e)}finally{o.f()}}else this.instancePlugins=new Map(e.plugins);var a,s=Il(e.protectedFunctions());try{for(s.s();!(a=s.n()).done;){var u=xl(a.value,2),c=u[0],l=u[1];e.loadFunctionUnprotected(l,c,this.instancePlugins)}}catch(e){s.e(e)}finally{s.f()}var f,h=Il(this.instancePlugins.entries());try{for(h.s();!(f=h.n()).done;){var p=xl(f.value,2),d=p[0],m=p[1];this.categorizeFunction(d,Fl(d,m))}}catch(e){h.e(e)}finally{h.f()}}var t,n,r;return t=e,n=[{key:"initializePlugins",value:function(e){var t,n=this,r=[],o=Il(this.instancePlugins.entries());try{var i=function(){var o=xl(t.value,2),i=o[0],a=o[1],s=r.find((function(e){return e instanceof a}));void 0===s&&(s=new a(e),r.push(s));var u=Fl(i,a).method;n.functions.set(i,[u,s])};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}}},{key:"getFunctionPlugin",value:function(t){if(!e.functionIsProtected(t))return this.instancePlugins.get(t)}},{key:"getFunction",value:function(e){return this.functions.get(e)}},{key:"getPlugins",value:function(){var t,n=new Set,r=Il(this.instancePlugins);try{for(r.s();!(t=r.n()).done;){var o=xl(t.value,2),i=o[0],a=o[1];e.functionIsProtected(i)||n.add(a)}}catch(e){r.e(e)}finally{r.f()}return Array.from(n)}},{key:"getRegisteredFunctionIds",value:function(){return Array.from(this.functions.keys())}},{key:"categorizeFunction",value:function(e,t){t.isVolatile&&this.volatileFunctions.add(e),t.doesNotNeedArgumentsToBeComputed&&this.functionsWhichDoesNotNeedArgumentsToBeComputed.add(e),t.isDependentOnSheetStructureChange&&this.structuralChangeFunctions.add(e)}}],r=[{key:"registerFunctionPlugin",value:function(e,t){this.loadPluginFunctions(e,this.plugins),void 0!==t&&this.loadTranslations(t)}},{key:"registerFunction",value:function(e,t,n){this.loadPluginFunction(t,e,this.plugins),void 0!==n&&this.loadTranslations(n)}},{key:"unregisterFunction",value:function(e){if(this.functionIsProtected(e))throw Kn.cannotUnregisterFunctionWithId(e);this.plugins.delete(e)}},{key:"unregisterFunctionPlugin",value:function(e){var t,n=Il(this.protectedPlugins());try{for(n.s();!(t=n.n()).done;)if(t.value===e)throw Kn.cannotUnregisterProtectedPlugin()}catch(e){n.e(e)}finally{n.f()}var r,o=Il(this.plugins.entries());try{for(o.s();!(r=o.n()).done;){var i=xl(r.value,2),a=i[0];i[1]===e&&this.plugins.delete(a)}}catch(e){o.e(e)}finally{o.f()}}},{key:"unregisterAll",value:function(){this.plugins.clear()}},{key:"getRegisteredFunctionIds",value:function(){return[].concat(Ml(Array.from(this.plugins.keys())),Ml(Array.from(this._protectedPlugins.keys())))}},{key:"getPlugins",value:function(){return Array.from(new Set(this.plugins.values()).values())}},{key:"getFunctionPlugin",value:function(e){return this.functionIsProtected(e)?void 0:this.plugins.get(e)}},{key:"loadTranslations",value:function(e){var t=new Set(cf.getRegisteredLanguagesCodes());Object.keys(e).forEach((function(n){t.has(n)&&cf.getLanguage(n).extendFunctions(e[n])}))}},{key:"loadPluginFunctions",value:function(e,t){var n=this;Object.keys(e.implementedFunctions).forEach((function(r){n.loadPluginFunction(e,r,t)})),void 0!==e.aliases&&Object.keys(e.aliases).forEach((function(r){n.loadPluginFunction(e,r,t)}))}},{key:"loadPluginFunction",value:function(e,t,n){if(this.functionIsProtected(t))throw Kn.cannotRegisterFunctionWithId(t);this.loadFunctionUnprotected(e,t,n)}},{key:"loadFunctionUnprotected",value:function(e,t,n){var r=Fl(t,e).method;if(!Object.prototype.hasOwnProperty.call(e.prototype,r))throw Yn.functionMethodNotFound(r,e.name);n.set(t,e)}},{key:"functionIsProtected",value:function(e){return this._protectedPlugins.has(e)}},{key:"protectedFunctions",value:regeneratorRuntime.mark((function e(){var t,n,r,o,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Il(this._protectedPlugins),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(r=xl(n.value,2),o=r[0],void 0===(i=r[1])){e.next=8;break}return e.next=8,[o,i];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"protectedPlugins",value:regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Il(this._protectedPlugins),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(r=xl(n.value,2),void 0===(o=r[1])){e.next=8;break}return e.next=8,o;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))}],n&&Ll(t.prototype,n),r&&Ll(t,r),e}();function Ul(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return jl(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jl(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function jl(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Bl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}Dl.plugins=new Map,Dl._protectedPlugins=new Map([["VERSION",Cl],["OFFSET",void 0]]);var Vl=function(){function e(t,n,r,o,i,a,s,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=n,this.config=r,this.stats=o,this.dateHelper=i,this.numberLiteralsHelper=a,this.functionRegistry=s,this.namedExpressions=u,this.serialization=c,this.functionRegistry.initializePlugins(this),this.arithmeticHelper=new Gi(r,i,a),this.criterionBuilder=new fl(r)}var t,n,r;return t=e,(n=[{key:"evaluateAst",value:function(e,t){var n=this.evaluateAstWithoutPostprocessing(e,t);if(Bt(n)){if(Xi(xt(n)))return new Ho(Mo.NUM,Ne.NaN);n=_t(n,Ji(xt(n)))}return function(e,t){return e instanceof Ho?e.attachAddress(t):e}(n,t)}},{key:"evaluateAstWithoutPostprocessing",value:function(e,t){var n,r,o,i,a,s,u,c,l,f,h,p;switch(e.type){case le.EMPTY:return Mt;case le.CELL_REFERENCE:var d=e.reference.toSimpleCellAddress(t);return Ko(d)?new Ho(Mo.REF,Ne.BadRef):this.dependencyGraph.getCellValue(d);case le.NUMBER:case le.STRING:return e.value;case le.CONCATENATE_OP:var m=this.evaluateAst(e.left,t),v=this.evaluateAst(e.right,t);return null!==(n=Hl(m,v))&&void 0!==n?n:zl(this.arithmeticHelper.concat,Yi(m),Yi(v));case le.EQUALS_OP:var y=this.evaluateAst(e.left,t),g=this.evaluateAst(e.right,t);return null!==(r=Hl(y,g))&&void 0!==r?r:this.arithmeticHelper.eq(y,g);case le.NOT_EQUAL_OP:var b=this.evaluateAst(e.left,t),E=this.evaluateAst(e.right,t);return null!==(o=Hl(b,E))&&void 0!==o?o:this.arithmeticHelper.neq(b,E);case le.GREATER_THAN_OP:var w=this.evaluateAst(e.left,t),S=this.evaluateAst(e.right,t);return null!==(i=Hl(w,S))&&void 0!==i?i:this.arithmeticHelper.gt(w,S);case le.LESS_THAN_OP:var T=this.evaluateAst(e.left,t),O=this.evaluateAst(e.right,t);return null!==(a=Hl(T,O))&&void 0!==a?a:this.arithmeticHelper.lt(T,O);case le.GREATER_THAN_OR_EQUAL_OP:var R=this.evaluateAst(e.left,t),N=this.evaluateAst(e.right,t);return null!==(s=Hl(R,N))&&void 0!==s?s:this.arithmeticHelper.geq(R,N);case le.LESS_THAN_OR_EQUAL_OP:var k=this.evaluateAst(e.left,t),A=this.evaluateAst(e.right,t);return null!==(u=Hl(k,A))&&void 0!==u?u:this.arithmeticHelper.leq(k,A);case le.PLUS_OP:var C=this.evaluateAst(e.left,t),M=this.evaluateAst(e.right,t);return null!==(c=Hl(C,M))&&void 0!==c?c:zl(this.arithmeticHelper.addWithEpsilon,this.arithmeticHelper.coerceScalarToNumberOrError(C),this.arithmeticHelper.coerceScalarToNumberOrError(M));case le.MINUS_OP:var x=this.evaluateAst(e.left,t),I=this.evaluateAst(e.right,t);return null!==(l=Hl(x,I))&&void 0!==l?l:zl(this.arithmeticHelper.subtract,this.arithmeticHelper.coerceScalarToNumberOrError(x),this.arithmeticHelper.coerceScalarToNumberOrError(I));case le.TIMES_OP:var _=this.evaluateAst(e.left,t),P=this.evaluateAst(e.right,t);return null!==(f=Hl(_,P))&&void 0!==f?f:zl(this.arithmeticHelper.multiply,this.arithmeticHelper.coerceScalarToNumberOrError(_),this.arithmeticHelper.coerceScalarToNumberOrError(P));case le.POWER_OP:var L=this.evaluateAst(e.left,t),F=this.evaluateAst(e.right,t);return null!==(h=Hl(L,F))&&void 0!==h?h:zl(this.arithmeticHelper.pow,this.arithmeticHelper.coerceScalarToNumberOrError(L),this.arithmeticHelper.coerceScalarToNumberOrError(F));case le.DIV_OP:var D=this.evaluateAst(e.left,t),U=this.evaluateAst(e.right,t);return null!==(p=Hl(D,U))&&void 0!==p?p:zl(this.arithmeticHelper.divide,this.arithmeticHelper.coerceScalarToNumberOrError(D),this.arithmeticHelper.coerceScalarToNumberOrError(U));case le.PLUS_UNARY_OP:var j=this.evaluateAst(e.value,t);return j instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):Bt(j)?this.arithmeticHelper.unaryPlus(j):j;case le.MINUS_UNARY_OP:var B=this.evaluateAst(e.value,t);return B instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):Gl(this.arithmeticHelper.unaryMinus,this.arithmeticHelper.coerceScalarToNumberOrError(B));case le.PERCENT_OP:var V=this.evaluateAst(e.value,t);return V instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):Gl(this.arithmeticHelper.unaryPercent,this.arithmeticHelper.coerceScalarToNumberOrError(V));case le.FUNCTION_CALL:if("valid"!==this.config.licenseKeyValidityState&&!Dl.functionIsProtected(e.procedureName))return new Ho(Mo.LIC,Ne.LicenseKey(this.config.licenseKeyValidityState));var H=this.functionRegistry.getFunction(e.procedureName);if(H&&this.config.translationPackage.isFunctionTranslated(e.procedureName)){var G=Ul(H,2),z=G[0];return G[1][z](e,t)}return new Ho(Mo.NAME,Ne.FunctionName(e.procedureName));case le.NAMED_EXPRESSION:var W=this.namedExpressions.nearestNamedExpression(e.expressionName,t.sheet);return W?this.dependencyGraph.getCellValue(W.address):new Ho(Mo.NAME,Ne.NamedExpressionName(e.expressionName));case le.CELL_RANGE:if(!this.rangeSpansOneSheet(e))return new Ho(Mo.REF,Ne.RangeManySheets);var $=yt.fromCellRange(e,t),Y=this.dependencyGraph.getMatrix($);if(Y){var K=Y.matrix;if(K instanceof Er)throw new Error("Matrix should be already computed");if(K instanceof Ho)return K;if(K instanceof wr)return Qt.onlyNumbersDataWithRange(K.raw(),K.size,$);throw new Error("Unknown matrix")}return Qt.onlyRange($,this.dependencyGraph);case le.COLUMN_RANGE:if(!this.rangeSpansOneSheet(e))return new Ho(Mo.REF,Ne.RangeManySheets);var q=gt.fromColumnRange(e,t);return Qt.onlyRange(q,this.dependencyGraph);case le.ROW_RANGE:if(!this.rangeSpansOneSheet(e))return new Ho(Mo.REF,Ne.RangeManySheets);var X=bt.fromRowRange(e,t);return Qt.onlyRange(X,this.dependencyGraph);case le.PARENTHESIS:return this.evaluateAst(e.expression,t);case le.ERROR_WITH_RAW_INPUT:case le.ERROR:return e.error}}},{key:"getGpuInstance",value:function(){var e=this.config.gpuMode,t=this.config.gpujs;if(void 0===t)throw Error("Cannot instantiate GPU.js. Constructor not provided.");return this.gpu||(this.gpu=new t({mode:e})),this.gpu}},{key:"destroy",value:function(){this.gpu&&this.gpu.destroy()}},{key:"rangeSpansOneSheet",value:function(e){return e.start.sheet===e.end.sheet}}])&&Bl(t.prototype,n),r&&Bl(t,r),e}();function Hl(e,t){return e instanceof Ho?e:e instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):t instanceof Ho?t:t instanceof Qt?new Ho(Mo.VALUE,Ne.ScalarExpected):void 0}function Gl(e,t){return t instanceof Ho?t:e(t)}function zl(e,t,n){return t instanceof Ho?t:n instanceof Ho?n:e(t,n)}function Wl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $l(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function $l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Yl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Kl=function(){function e(t,n,r,o,i,a,s,u,c){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.columnSearch=n,this.config=r,this.stats=o,this.dateHelper=i,this.numberLiteralsHelper=a,this.functionRegistry=s,this.namedExpressions=u,this.serialization=c,this.interpreter=new Vl(this.dependencyGraph,this.columnSearch,this.config,this.stats,this.dateHelper,this.numberLiteralsHelper,this.functionRegistry,this.namedExpressions,this.serialization)}var t,n,r;return t=e,(n=[{key:"run",value:function(){var e=this;this.stats.start(qt.TOP_SORT);var t=this.dependencyGraph.topSortWithScc(),n=t.sorted,r=t.cycled;this.stats.end(qt.TOP_SORT),this.stats.measure(qt.EVALUATION,(function(){e.recomputeFormulas(r,n)}))}},{key:"partialRun",value:function(e){var t=this,n=new Aa;return this.stats.measure(qt.EVALUATION,(function(){t.dependencyGraph.graph.getTopSortedWithSccSubgraphFrom(e,(function(e){if(e instanceof cr){var r=e.getAddress(t.dependencyGraph.lazilyTransformingAstService),o=e.getFormula(t.dependencyGraph.lazilyTransformingAstService),i=e.isComputed()?e.getCellValue():null,a=t.evaluateAstToCellValue(o,r);return e.setCellValue(a),a!==i&&(n.addChange(a,r),t.columnSearch.change(xt(i),xt(a),r),!0)}if(e instanceof Or&&e.isFormula()){var s=e.getAddress(),u=e.getFormula(),c=e.isComputed()?e.getCellValue():null,l=t.evaluateAstToRangeValue(u,s);if(l instanceof Qt){var f=new wr(l.rawNumbers());e.setCellValue(f),n.addMatrixChange(f,s),t.columnSearch.change(c,f,s)}else e.setErrorValue(l),n.addChange(l,s),t.columnSearch.change(c,l,s);return!0}return!(e instanceof kr&&(e.clearCache(),0))}),(function(e){if(e instanceof kr)e.clearCache();else if(e instanceof cr){var r=e.getAddress(t.dependencyGraph.lazilyTransformingAstService);t.columnSearch.remove(xt(e.valueOrNull()),r);var o=new Ho(Mo.CYCLE,void 0,e.address);e.setCellValue(o),n.addChange(o,e.address)}}))})),n}},{key:"destroy",value:function(){this.interpreter.destroy()}},{key:"runAndForget",value:function(e,t,n){var r,o=this,i=[],a=Wl(Et(n,t));try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof yt){var u=s;if(void 0===this.dependencyGraph.getRange(u.start,u.end)){var c=new kr(u);this.dependencyGraph.rangeMapping.setRange(c),i.push(c)}}}}catch(e){a.e(e)}finally{a.f()}var l=this.evaluateAstToCellValue(e,t);return i.forEach((function(e){o.dependencyGraph.rangeMapping.removeRange(e)})),l}},{key:"recomputeFormulas",value:function(e,t){var n=this;e.forEach((function(e){e instanceof cr&&e.setCellValue(new Ho(Mo.CYCLE,void 0,e.address))})),t.forEach((function(e){if(e instanceof cr){var t=e.getAddress(n.dependencyGraph.lazilyTransformingAstService),r=e.getFormula(n.dependencyGraph.lazilyTransformingAstService),o=n.evaluateAstToCellValue(r,t);e.setCellValue(o),n.columnSearch.add(xt(o),t)}else if(e instanceof Or&&e.isFormula()){var i=e.getAddress(),a=e.getFormula(),s=n.evaluateAstToRangeValue(a,i);if(s instanceof Qt){var u=new wr(s.rawNumbers());e.setCellValue(u),n.columnSearch.add(u,i)}else e.setErrorValue(s),n.columnSearch.add(s,i)}else e instanceof kr&&e.clearCache()}))}},{key:"evaluateAstToCellValue",value:function(e,t){var n=this.interpreter.evaluateAst(e,t);return n instanceof Qt?n:n===Mt&&this.config.evaluateNullToZero?0:n}},{key:"evaluateAstToRangeValue",value:function(e,t){var n=this.interpreter.evaluateAst(e,t);return n instanceof Ho||n instanceof Qt&&n.hasOnlyNumbers()?n:new Ho(Mo.VALUE,Ne.CellRangeExpected)}}])&&Yl(t.prototype,n),r&&Yl(t,r),e}();function ql(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Xl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.config=t;var n="."===this.config.thousandSeparator?"\\".concat(this.config.thousandSeparator):this.config.thousandSeparator,r="."===this.config.decimalSeparator?"\\".concat(this.config.decimalSeparator):this.config.decimalSeparator;this.numberPattern=new RegExp("^([+-]?((".concat(r,"\\d+)|(\\d+(").concat(n,"\\d{3,})*(").concat(r,"\\d*)?)))(e[+-]?\\d+)?$")),this.allThousandSeparatorsRegex=new RegExp("".concat(n),"g")}var t,n,r;return t=e,(n=[{key:"numericStringToMaybeNumber",value:function(e){if(this.numberPattern.test(e)){var t=this.numericStringToNumber(e);if(isNaN(t))return;return t}}},{key:"isNumber",value:function(e){return!!this.numberPattern.test(e)&&!isNaN(this.numericStringToNumber(e))}},{key:"numericStringToNumber",value:function(e){var t=e.replace(this.allThousandSeparatorsRegex,"").replace(this.config.decimalSeparator,".");return Number(t)}}])&&ql(t.prototype,n),r&&ql(t,r),e}();function Jl(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ql(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ql(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Ql(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zl(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ef=function(){function e(t,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.dependencyGraph=t,this.unparser=n,this.config=r,this.exporter=o}var t,n,r;return t=e,(n=[{key:"getCellFormula",value:function(e){var t=this.dependencyGraph.getCell(e);if(t instanceof cr){var n=t.getFormula(this.dependencyGraph.lazilyTransformingAstService);return this.unparser.unparse(n,e)}if(t instanceof Or){var r=t.getFormula();if(r)return"{"+this.unparser.unparse(r,t.getAddress())+"}"}else if(t instanceof Eo)return t.getFormula()}},{key:"getCellSerialized",value:function(e){var t=this.getCellFormula(e);return void 0!==t?t:this.getRawValue(e)}},{key:"getCellValue",value:function(e){return this.exporter.exportValue(this.dependencyGraph.getScalarValue(e))}},{key:"getRawValue",value:function(e){return this.dependencyGraph.getRawValue(e)}},{key:"getSheetValues",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellValue(e)}))}},{key:"getSheetFormulas",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellFormula(e)}))}},{key:"genericSheetGetter",value:function(e,t){for(var n=this.dependencyGraph.getSheetHeight(e),r=this.dependencyGraph.getSheetWidth(e),o=new Array(n),i=0;i<n;i++){o[i]=new Array(r);for(var a=0;a<r;a++){var s=Yo(e,a,i);o[i][a]=t(s)}for(var u=r-1;u>=0&&(null===o[i][u]||void 0===o[i][u]);u--)o[i].pop()}for(var c=n-1;c>=0&&0===o[c].length;c--)o.pop();return o}},{key:"genericAllSheetsGetter",value:function(e){var t,n={},r=Jl(this.dependencyGraph.sheetMapping.displayNames());try{for(r.s();!(t=r.n()).done;){var o=t.value,i=this.dependencyGraph.sheetMapping.fetch(o);n[o]=e(i)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"getSheetSerialized",value:function(e){var t=this;return this.genericSheetGetter(e,(function(e){return t.getCellSerialized(e)}))}},{key:"getAllSheetsValues",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetValues(t)}))}},{key:"getAllSheetsFormulas",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetFormulas(t)}))}},{key:"getAllSheetsSerialized",value:function(){var e=this;return this.genericAllSheetsGetter((function(t){return e.getSheetSerialized(t)}))}},{key:"getAllNamedExpressionsSerialized",value:function(){var e=this;return this.dependencyGraph.namedExpressions.getAllNamedExpressions().map((function(t){var n=void 0!==t.scope?e.dependencyGraph.sheetMapping.fetchDisplayName(t.scope):void 0;return{name:t.expression.displayName,expression:e.getCellSerialized(t.expression.address),scope:n,options:t.expression.options}}))}},{key:"withNewConfig",value:function(t,n){var r=new Ve(t,K(t),this.dependencyGraph.sheetMapping.fetchDisplayName,n);return new e(this.dependencyGraph,r,t,this.exporter)}}])&&Zl(t.prototype,n),r&&Zl(t,r),e}();function tf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var nf=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,n,r;return t=e,r=[{key:"buildEngine",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.useStats?new en:new cn;n.start(qt.BUILD_ENGINE_TOTAL);var r=new Zs,o=new Dl(e),i=new Xu(n),a=po.buildEmpty(i,e,o,r,n),s=gc(a,e,n),u=a.sheetMapping,c=a.addressMapping;for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){var f=t[l];tu(f);var h=nu(f);if(h.height>e.maxRows||h.width>e.maxColumns)throw new Rn;var p=u.addSheet(l);c.autoAddSheet(p,f,h)}var d=new $e(e,o,u.get),m=new Ve(e,K(e),u.fetchDisplayName,r),v=new li(e),y=new Xl(e),g=new ya(e,v,y),b=new al(e,n,a,s,d,g,i,r);n.measure(qt.GRAPH_BUILD,(function(){new Gs(a,s,d,g,e,n).buildGraph(t)})),i.undoRedo=b.undoRedo,i.parser=d;var E=new Hu(e,r,u.fetchDisplayName),w=new ef(a,m,e,E),S=new Kl(a,s,e,n,v,y,o,r,w);return S.run(),n.end(qt.BUILD_ENGINE_TOTAL),{config:e,stats:n,dependencyGraph:a,columnSearch:s,parser:d,unparser:m,cellContentParser:g,evaluator:S,lazilyTransformingAstService:i,crudOperations:b,exporter:E,namedExpressions:r,serialization:w,functionRegistry:o}}},{key:"buildFromSheets",value:function(e,t){var n=new If(t);return this.buildEngine(n,e)}},{key:"buildFromSheet",value:function(e,t){var n,r,o,i=new If(t),a=i.translationPackage.getUITranslation(Jr.NEW_SHEET_PREFIX)+"1";return this.buildEngine(i,(o=e,(r=a)in(n={})?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n))}},{key:"buildEmpty",value:function(e){return this.buildEngine(new If(e))}},{key:"rebuildWithConfig",value:function(e,t,n){return this.buildEngine(e,t,n)}}],(n=null)&&tf(t.prototype,n),r&&tf(t,r),e}();function rf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||af(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function of(e){return function(e){if(Array.isArray(e))return sf(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||af(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function af(e,t){if(e){if("string"==typeof e)return sf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?sf(e,t):void 0}}function sf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function uf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var cf=function(){function e(t,n,r,o,i,a,s,u,c,l,f,h,p,d){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._config=t,this._stats=n,this._dependencyGraph=r,this._columnSearch=o,this._parser=i,this._unparser=a,this._cellContentParser=s,this._evaluator=u,this._lazilyTransformingAstService=c,this._crudOperations=l,this._exporter=f,this._namedExpressions=h,this._serialization=p,this._functionRegistry=d,this._emitter=new Fu,this._evaluationSuspended=!1}var t,n,r;return t=e,r=[{key:"buildFromEngineState",value:function(t){return new e(t.config,t.stats,t.dependencyGraph,t.columnSearch,t.parser,t.unparser,t.cellContentParser,t.evaluator,t.lazilyTransformingAstService,t.crudOperations,t.exporter,t.namedExpressions,t.serialization,t.functionRegistry)}},{key:"buildFromArray",value:function(e,t){return this.buildFromEngineState(nf.buildFromSheet(e,t))}},{key:"buildFromSheets",value:function(e,t){return this.buildFromEngineState(nf.buildFromSheets(e,t))}},{key:"buildEmpty",value:function(e){return this.buildFromEngineState(nf.buildEmpty(e))}},{key:"getLanguage",value:function(e){var t=this.registeredLanguages.get(e);if(void 0===t)throw new Wn;return t}},{key:"registerLanguage",value:function(e,t){if(this.registeredLanguages.has(e))throw new $n;var n;this.registeredLanguages.set(e,(n=t,new Qr(Object.assign({},n.functions),Object.assign({},n.errors),Object.assign({},n.ui))))}},{key:"unregisterLanguage",value:function(e){if(!this.registeredLanguages.has(e))throw new Wn;this.registeredLanguages.delete(e)}},{key:"getRegisteredLanguagesCodes",value:function(){return Array.from(this.registeredLanguages.keys())}},{key:"registerFunctionPlugin",value:function(e,t){Dl.registerFunctionPlugin(e,t)}},{key:"unregisterFunctionPlugin",value:function(e){Dl.unregisterFunctionPlugin(e)}},{key:"registerFunction",value:function(e,t,n){Dl.registerFunction(e,t,n)}},{key:"unregisterFunction",value:function(e){Dl.unregisterFunction(e)}},{key:"unregisterAllFunctions",value:function(){Dl.unregisterAll()}},{key:"getRegisteredFunctionNames",value:function(e){var t=Dl.getRegisteredFunctionIds();return this.getLanguage(e).getFunctionTranslations(t)}},{key:"getFunctionPlugin",value:function(e){return Dl.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return Dl.getPlugins()}}],(n=[{key:"graph",get:function(){return this.dependencyGraph.graph}},{key:"rangeMapping",get:function(){return this.dependencyGraph.rangeMapping}},{key:"matrixMapping",get:function(){return this.dependencyGraph.matrixMapping}},{key:"sheetMapping",get:function(){return this.dependencyGraph.sheetMapping}},{key:"addressMapping",get:function(){return this.dependencyGraph.addressMapping}},{key:"dependencyGraph",get:function(){return this._dependencyGraph}},{key:"evaluator",get:function(){return this._evaluator}},{key:"columnSearch",get:function(){return this._columnSearch}},{key:"lazilyTransformingAstService",get:function(){return this._lazilyTransformingAstService}},{key:"licenseKeyValidityState",get:function(){return this._config.licenseKeyValidityState}},{key:"getCellValue",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellValue(e)}},{key:"ensureEvaluationIsNotSuspended",value:function(){if(this._evaluationSuspended)throw new Hn}},{key:"getCellFormula",value:function(e){return this._serialization.getCellFormula(e)}},{key:"getCellSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getCellSerialized(e)}},{key:"getSheetValues",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetValues(e)}},{key:"getSheetFormulas",value:function(e){return this._serialization.getSheetFormulas(e)}},{key:"getSheetSerialized",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._serialization.getSheetSerialized(e)}},{key:"getAllSheetsDimensions",value:function(){var e=this;return this._serialization.genericAllSheetsGetter((function(t){return e.getSheetDimensions(t)}))}},{key:"getSheetDimensions",value:function(e){return{width:this.dependencyGraph.getSheetWidth(e),height:this.dependencyGraph.getSheetHeight(e)}}},{key:"getAllSheetsValues",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsValues()}},{key:"getAllSheetsFormulas",value:function(){return this._serialization.getAllSheetsFormulas()}},{key:"getAllSheetsSerialized",value:function(){return this.ensureEvaluationIsNotSuspended(),this._serialization.getAllSheetsSerialized()}},{key:"updateConfig",value:function(e){var t=this,n=this._config.mergeConfig(e),r=this._config.mergeConfig({language:e.language}),o=this._serialization.withNewConfig(r,this._namedExpressions).getAllSheetsSerialized(),i=this._serialization.getAllNamedExpressionsSerialized(),a=nf.rebuildWithConfig(n,o,this._stats);this._config=a.config,this._stats=a.stats,this._dependencyGraph=a.dependencyGraph,this._columnSearch=a.columnSearch,this._parser=a.parser,this._unparser=a.unparser,this._cellContentParser=a.cellContentParser,this._evaluator=a.evaluator,this._lazilyTransformingAstService=a.lazilyTransformingAstService,this._crudOperations=a.crudOperations,this._exporter=a.exporter,this._namedExpressions=a.namedExpressions,this._serialization=a.serialization,this._functionRegistry=a.functionRegistry,i.forEach((function(e){t.addNamedExpression(e.name,e.expression,e.scope,e.options)}))}},{key:"getConfig",value:function(){return this._config.getConfig()}},{key:"rebuildAndRecalculate",value:function(){this.updateConfig({})}},{key:"getStats",value:function(){return this._stats.snapshot()}},{key:"undo",value:function(){return this._crudOperations.undo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"redo",value:function(){return this._crudOperations.redo(),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isThereSomethingToUndo",value:function(){return this._crudOperations.isThereSomethingToUndo()}},{key:"isThereSomethingToRedo",value:function(){return this._crudOperations.isThereSomethingToRedo()}},{key:"isItPossibleToSetCellContents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;try{this._crudOperations.ensureRangeInSizeLimits(yt.spanFrom(e,t,n));for(var r=0;r<t;r++)for(var o=0;o<n;o++)this._crudOperations.ensureItIsPossibleToChangeContent({col:e.col+r,row:e.row+o,sheet:e.sheet})}catch(e){return!1}return!0}},{key:"setCellContents",value:function(e,t){return this._crudOperations.setCellContents(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"swapRowIndexes",value:function(e,t){return this._crudOperations.setRowOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapRowIndexes",value:function(e,t){try{return this._crudOperations.validateSwapRowIndexes(e,t),this._crudOperations.testRowOrderForMatrices(e,t),!0}catch(e){return!1}}},{key:"setRowOrder",value:function(e,t){var n=this._crudOperations.mappingFromOrder(e,t,"row");return this.swapRowIndexes(e,n)}},{key:"isItPossibleToSetRowOrder",value:function(e,t){try{var n=this._crudOperations.mappingFromOrder(e,t,"row");return this._crudOperations.validateSwapRowIndexes(e,n),this._crudOperations.testRowOrderForMatrices(e,n),!0}catch(e){return!1}}},{key:"swapColumnIndexes",value:function(e,t){return this._crudOperations.setColumnOrder(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToSwapColumnIndexes",value:function(e,t){try{return this._crudOperations.validateSwapColumnIndexes(e,t),this._crudOperations.testColumnOrderForMatrices(e,t),!0}catch(e){return!1}}},{key:"setColumnOrder",value:function(e,t){var n=this._crudOperations.mappingFromOrder(e,t,"column");return this.swapColumnIndexes(e,n)}},{key:"isItPossibleToSetColumnOrder",value:function(e,t){try{var n=this._crudOperations.mappingFromOrder(e,t,"column");return this._crudOperations.validateSwapColumnIndexes(e,n),this._crudOperations.testColumnOrderForMatrices(e,n),!0}catch(e){return!1}}},{key:"isItPossibleToAddRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Ou(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToAddRows.apply(i,[e].concat(of(o))),!0}catch(e){return!1}}},{key:"addRows",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).addRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveRows",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Tu(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToRemoveRows.apply(i,[e].concat(of(o))),!0}catch(e){return!1}}},{key:"removeRows",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).removeRows.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToAddColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Ou(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToAddColumns.apply(i,[e].concat(of(o))),!0}catch(e){return!1}}},{key:"addColumns",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).addColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveColumns",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=Tu(n);try{var i;return(i=this._crudOperations).ensureItIsPossibleToRemoveColumns.apply(i,[e].concat(of(o))),!0}catch(e){return!1}}},{key:"removeColumns",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return(t=this._crudOperations).removeColumns.apply(t,[e].concat(r)),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveCells",value:function(e,t,n,r){try{return this._crudOperations.operations.ensureItIsPossibleToMoveCells(e,t,n,r),!0}catch(e){return!1}}},{key:"moveCells",value:function(e,t,n,r){return this._crudOperations.moveCells(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveRows",value:function(e,t,n,r){try{return this._crudOperations.ensureItIsPossibleToMoveRows(e,t,n,r),!0}catch(e){return!1}}},{key:"moveRows",value:function(e,t,n,r){return this._crudOperations.moveRows(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToMoveColumns",value:function(e,t,n,r){try{return this._crudOperations.ensureItIsPossibleToMoveColumns(e,t,n,r),!0}catch(e){return!1}}},{key:"moveColumns",value:function(e,t,n,r){return this._crudOperations.moveColumns(e,t,n,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"copy",value:function(e,t,n){return this._crudOperations.copy(e,t,n),this.getRangeValues(e,t,n)}},{key:"cut",value:function(e,t,n){return this._crudOperations.cut(e,t,n),this.getRangeValues(e,t,n)}},{key:"paste",value:function(e){return this.ensureEvaluationIsNotSuspended(),this._crudOperations.paste(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isClipboardEmpty",value:function(){return this._crudOperations.isClipboardEmpty()}},{key:"clearClipboard",value:function(){this._crudOperations.clearClipboard()}},{key:"clearRedoStack",value:function(){this._crudOperations.undoRedo.clearRedoStack()}},{key:"clearUndoStack",value:function(){this._crudOperations.undoRedo.clearUndoStack()}},{key:"getRangeValues",value:function(e,t,n){var r=this;return yt.spanFrom(e,t,n).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return r.getCellValue(e)}))}))}},{key:"getRangeFormulas",value:function(e,t,n){var r=this;return yt.spanFrom(e,t,n).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return r.getCellFormula(e)}))}))}},{key:"getRangeSerialized",value:function(e,t,n){var r=this;return yt.spanFrom(e,t,n).arrayOfAddressesInRange().map((function(e){return e.map((function(e){return r.getCellSerialized(e)}))}))}},{key:"isItPossibleToAddSheet",value:function(e){try{return this._crudOperations.ensureItIsPossibleToAddSheet(e),!0}catch(e){return!1}}},{key:"addSheet",value:function(e){var t=this._crudOperations.addSheet(e);return this._emitter.emit(Nu.SheetAdded,t),t}},{key:"isItPossibleToRemoveSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"removeSheet",value:function(e){var t=this.sheetMapping.getDisplayNameByName(e);this._crudOperations.removeSheet(e);var n=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Nu.SheetRemoved,t,n),n}},{key:"isItPossibleToClearSheet",value:function(e){try{return this._crudOperations.ensureSheetExists(e),!0}catch(e){return!1}}},{key:"clearSheet",value:function(e){return this._crudOperations.ensureSheetExists(e),this._crudOperations.clearSheet(e),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToReplaceSheetContent",value:function(e,t){try{this._crudOperations.ensureSheetExists(e);var n=this.sheetMapping.fetch(e);return this._crudOperations.ensureItIsPossibleToChangeSheetContents(n,t),!0}catch(e){return!1}}},{key:"setSheetContent",value:function(e,t){return this._crudOperations.setSheetContent(e,t),this.recomputeIfDependencyGraphNeedsIt()}},{key:"simpleCellAddressFromString",value:function(e,t){return function(e,t,n){var r=J.exec(t),o=ie(r[6]),i=ue(r,e);if(void 0!==i){null===i&&(i=n);var a=Number(r[8])-1;return Yo(i,o,a)}}(this.sheetMapping.get,e,t)}},{key:"simpleCellAddressToString",value:function(e,t){return oe(this.sheetMapping.fetchDisplayName,e,t)}},{key:"getCellDependents",value:function(e){var t;if(e instanceof yt){if(void 0===(t=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(t=this._dependencyGraph.addressMapping.getCell(e)))return[];return this._dependencyGraph.getAdjacentNodesAddresses(t)}},{key:"getCellPrecedents",value:function(e){var t,n;if(e instanceof yt){if(void 0===(n=this._dependencyGraph.rangeMapping.getRange(e.start,e.end)))return[]}else if(null===(n=this._dependencyGraph.addressMapping.getCell(e)))return[];return null!==(t=this._dependencyGraph.dependencyQueryAddresses(n))&&void 0!==t?t:[]}},{key:"getSheetName",value:function(e){return this.sheetMapping.getDisplayName(e)}},{key:"getSheetNames",value:function(){return this.sheetMapping.sheetNames()}},{key:"getSheetId",value:function(e){return this.sheetMapping.get(e)}},{key:"doesSheetExist",value:function(e){return this.sheetMapping.hasSheetWithName(e)}},{key:"getCellType",value:function(e){return function(e){return e instanceof cr||e instanceof Eo?xo.FORMULA:e instanceof go||e instanceof Or&&e.isNumeric()?xo.VALUE:e instanceof Or&&e.isFormula()?xo.MATRIX:xo.EMPTY}(this.dependencyGraph.getCell(e))}},{key:"doesCellHaveSimpleValue",value:function(e){return this.getCellType(e)===xo.VALUE}},{key:"doesCellHaveFormula",value:function(e){return this.getCellType(e)===xo.FORMULA}},{key:"isCellEmpty",value:function(e){return this.getCellType(e)===xo.EMPTY}},{key:"isCellPartOfMatrix",value:function(e){return this.getCellType(e)===xo.MATRIX}},{key:"getCellValueType",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return jo(t)}},{key:"getCellValueDetailedType",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return Bo(t)}},{key:"getCellValueFormat",value:function(e){this.ensureEvaluationIsNotSuspended();var t=this.dependencyGraph.getCellValue(e);return Vo(t)}},{key:"countSheets",value:function(){return this.sheetMapping.numberOfSheets()}},{key:"isItPossibleToRenameSheet",value:function(e,t){try{return this._crudOperations.ensureItIsPossibleToRenameSheet(e,t),!0}catch(e){return!1}}},{key:"renameSheet",value:function(e,t){var n=this._crudOperations.renameSheet(e,t);void 0!==n&&this._emitter.emit(Nu.SheetRenamed,n,t)}},{key:"batch",value:function(e){this.suspendEvaluation(),this._crudOperations.beginUndoRedoBatchMode();try{e()}catch(e){throw this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation(),e}return this._crudOperations.commitUndoRedoBatchMode(),this.resumeEvaluation()}},{key:"suspendEvaluation",value:function(){this._evaluationSuspended=!0,this._emitter.emit(Nu.EvaluationSuspended)}},{key:"resumeEvaluation",value:function(){this._evaluationSuspended=!1;var e=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Nu.EvaluationResumed,e),e}},{key:"isEvaluationSuspended",value:function(){return this._evaluationSuspended}},{key:"isItPossibleToAddNamedExpression",value:function(e,t,n){try{return this._crudOperations.ensureItIsPossibleToAddNamedExpression(e,t,n),!0}catch(e){return!1}}},{key:"addNamedExpression",value:function(e,t,n,r){this._crudOperations.addNamedExpression(e,t,n,r);var o=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Nu.NamedExpressionAdded,e,o),o}},{key:"getNamedExpressionValue",value:function(e,t){this.ensureEvaluationIsNotSuspended();var n=this._crudOperations.scopeId(t),r=this._namedExpressions.namedExpressionForScope(e,n);return r?this._serialization.getCellValue(r.address):void 0}},{key:"getNamedExpressionFormula",value:function(e,t){var n=this._crudOperations.scopeId(t),r=this._namedExpressions.namedExpressionForScope(e,n);return void 0===r?void 0:this._serialization.getCellFormula(r.address)}},{key:"getNamedExpression",value:function(e,t){var n=this._crudOperations.scopeId(t),r=this._namedExpressions.namedExpressionForScope(e,n);if(void 0!==r)return{name:e,scope:t,expression:this._serialization.getCellFormula(r.address),options:r.options}}},{key:"isItPossibleToChangeNamedExpression",value:function(e,t,n){try{return this._crudOperations.ensureItIsPossibleToChangeNamedExpression(e,t,n),!0}catch(e){return!1}}},{key:"changeNamedExpression",value:function(e,t,n,r){return this._crudOperations.changeNamedExpressionExpression(e,n,t,r),this.recomputeIfDependencyGraphNeedsIt()}},{key:"isItPossibleToRemoveNamedExpression",value:function(e,t){try{return this._crudOperations.isItPossibleToRemoveNamedExpression(e,t),!0}catch(e){return!1}}},{key:"removeNamedExpression",value:function(e,t){var n=this._crudOperations.removeNamedExpression(e,t);if(n){var r=this.recomputeIfDependencyGraphNeedsIt();return this._emitter.emit(Nu.NamedExpressionRemoved,n.displayName,r),r}return[]}},{key:"listNamedExpressions",value:function(e){var t=this._crudOperations.scopeId(e);return this._namedExpressions.getAllNamedExpressionsNamesInScope(t)}},{key:"normalizeFormula",value:function(e){var t=rf(this.extractTemporaryFormula(e),2),n=t[0],r=t[1];if(void 0===n)throw new Nn;return this._unparser.unparse(n,r)}},{key:"calculateFormula",value:function(e,t){this._crudOperations.ensureSheetExists(t);var n=this.sheetMapping.fetch(t),r=rf(this.extractTemporaryFormula(e,n),3),o=r[0],i=r[1],a=r[2];if(void 0===o)throw new Nn;var s=this.evaluator.runAndForget(o,i,a);return this._exporter.exportValue(s)}},{key:"validateFormula",value:function(e){var t=rf(this.extractTemporaryFormula(e),1)[0];return void 0!==t&&!(t.type===le.ERROR&&!t.error)}},{key:"getRegisteredFunctionNames",value:function(){return e.getLanguage(this._config.language).getFunctionTranslations(this._functionRegistry.getRegisteredFunctionIds())}},{key:"getFunctionPlugin",value:function(e){return this._functionRegistry.getFunctionPlugin(e)}},{key:"getAllFunctionPlugins",value:function(){return this._functionRegistry.getPlugins()}},{key:"numberToDateTime",value:function(e){return this._evaluator.dateHelper.numberToSimpleDateTime(e)}},{key:"numberToDate",value:function(e){return this._evaluator.dateHelper.numberToSimpleDate(e)}},{key:"numberToTime",value:function(e){return pi(e)}},{key:"extractTemporaryFormula",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=this._cellContentParser.parse(e),r={sheet:t,col:0,row:0};if(!(n instanceof Zi.Formula))return[void 0,r,[]];var o=this._parser.parse(n.formula,r),i=o.ast,a=o.errors,s=o.dependencies;return a.length>0?[void 0,r,[]]:[i,r,s]}},{key:"on",value:function(e,t){this._emitter.on(e,t)}},{key:"once",value:function(e,t){this._emitter.once(e,t)}},{key:"off",value:function(e,t){this._emitter.off(e,t)}},{key:"destroy",value:function(){this.dependencyGraph.destroy(),this.columnSearch.destroy(),this.evaluator.destroy(),this._parser.destroy(),this._lazilyTransformingAstService.destroy(),this._stats.destroy(),this._crudOperations.clearClipboard()}},{key:"recomputeIfDependencyGraphNeedsIt",value:function(){if(this._evaluationSuspended)return[];var e=this._crudOperations.getAndClearContentChanges(),t=Array.from(this.dependencyGraph.verticesToRecompute());this.dependencyGraph.clearRecentlyChangedVertices(),t.length>0&&e.addAll(this.evaluator.partialRun(t));var n=e.exportChanges(this._exporter);return e.isEmpty()||this._emitter.emit(Nu.ValuesUpdated,n),n}}])&&uf(t.prototype,n),r&&uf(t,r),e}();cf.version="0.6.0",cf.buildDate="27/04/2021 11:27:25",cf.releaseDate="27/04/2021",cf.languages={},cf.registeredLanguages=new Map;n("9bJ7"),n("TZCg");function lf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return ff(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ff(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ff(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hf="length",pf=function(e){return parseInt(e,16)},df=function(e){return parseInt(e,10)},mf=function(e){return(e+"").replace(/\-/g,"")},vf=function(e,t,n){return e.substr(t,n)},yf=function(e){return e.codePointAt(0)-65};function gf(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return bf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bf(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function bf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ef={invalid:function(){return"The license key for HyperFormula is invalid."},expired:function(e){var t=e.keyValidityDate;return"The license key for HyperFormula expired"+" on ".concat(t,", and is not valid for the installed version.")},missing:function(){return"The license key for HyperFormula is missing."}},wf=!1;function Sf(e){var t,n={template:"missing",vars:{}};if("non-commercial-and-evaluation"===e||"agpl-v3"===e||"internal-use-in-handsontable"===e)n.template="valid";else if("string"==typeof e&&function(e){if((e=(e+"").replace(/\-/g,""))[hf]!==yf("Z"))return!1;var t=0;return[[0,yf("G")+1],[yf("H"),yf("H")-1],[yf("G")+yf("H"),yf("G")]].reduce((function(n,r,o){var i=lf(r,2),a=i[0],s=i[1];return n|=(df("".concat(df(pf(vf.apply(void 0,[e].concat([t+a-(0===o?0:2),s+(o?2:0)])))+(pf(vf.apply(void 0,[e].concat([t+a+s,2])))+[]).padStart(2,"0"))))%97||2)>>1,t+=2,n}),yf("A"))===[]+1>>1}(e)){var r=gf("27/04/2021".split("/"),3),o=r[0],i=r[1],a=r[2],s=Math.floor(new Date("".concat(i,"/").concat(o,"/").concat(a)).getTime()/864e5),u=25===mf(t=e)[hf]?pf(vf(mf(t),pf("12"),yf("F")))/(pf(vf(mf(t),yf("C"),yf("Y")>>4))||1+(~~![][hf]<<3)):0;n.vars.keyValidityDate=function(e){var t=["January","February","March","April","May","June","July","August","September","October","November","December"][e.getMonth()],n=e.getDate(),r=e.getFullYear();return"".concat(t," ").concat(n,", ").concat(r)}(new Date(864e5*(u+1))),n.template=s>u?"expired":"valid"}else""!==e&&(n.template="invalid");return wf||"valid"===n.template||(console.warn(Ef[n.template](n.vars)),wf=!0),n.template}function Tf(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Of(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Of(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Of(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Rf(e){return(Rf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Nf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Af,Cf=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},Mf=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},xf=["gpu","cpu","dev"],If=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.accentSensitive,r=t.caseSensitive,o=t.caseFirst,i=t.chooseAddressMappingPolicy,a=t.dateFormats,s=t.timeFormats,u=t.functionArgSeparator,c=t.decimalSeparator,l=t.thousandSeparator,f=t.language,h=t.licenseKey,p=t.functionPlugins,d=t.gpujs,m=t.gpuMode,v=t.ignorePunctuation,y=t.leapYear1900,g=t.localeLang,b=t.smartRounding,E=t.matrixDetection,w=t.matrixDetectionThreshold,S=t.evaluateNullToZero,T=t.nullYear,O=t.parseDateTime,R=t.stringifyDateTime,N=t.stringifyDuration,k=t.precisionEpsilon,A=t.precisionRounding,C=t.useColumnIndex,M=t.binarySearchThreshold,x=t.nullDate,I=t.useStats,_=t.undoLimit,P=t.useRegularExpressions,L=t.useWildcards,F=t.matchWholeCell,D=t.maxRows,U=t.maxColumns,j=t.currencySymbol;Nf(this,e),Af.set(this,void 0),this.accentSensitive=this.valueFromParam(n,"boolean","accentSensitive"),this.caseSensitive=this.valueFromParam(r,"boolean","caseSensitive"),this.caseFirst=this.valueFromParam(o,["upper","lower","false"],"caseFirst"),this.ignorePunctuation=this.valueFromParam(v,"boolean","ignorePunctuation"),this.chooseAddressMappingPolicy=null!=i?i:e.defaultConfig.chooseAddressMappingPolicy,this.dateFormats=this.valueFromParamCheck(a,Array.isArray,"array","dateFormats"),this.timeFormats=this.valueFromParamCheck(s,Array.isArray,"array","timeFormats"),this.functionArgSeparator=this.valueFromParam(u,"string","functionArgSeparator"),this.decimalSeparator=this.valueFromParam(c,[".",","],"decimalSeparator"),this.language=this.valueFromParam(f,"string","language"),this.licenseKey=this.valueFromParam(h,"string","licenseKey"),Cf(this,Af,Sf(this.licenseKey)),this.thousandSeparator=this.valueFromParam(l,["",","," ","."],"thousandSeparator"),this.localeLang=this.valueFromParam(g,"string","localeLang"),this.functionPlugins=null!=p?p:e.defaultConfig.functionPlugins,this.gpujs=null!=d?d:e.defaultConfig.gpujs,this.gpuMode=this.valueFromParam(m,xf,"gpuMode"),this.smartRounding=this.valueFromParam(b,"boolean","smartRounding"),this.matrixDetection=this.valueFromParam(E,"boolean","matrixDetection"),this.matrixDetectionThreshold=this.valueFromParam(w,"number","matrixDetectionThreshold"),this.validateNumberToBeAtLeast(this.matrixDetectionThreshold,"matrixDetectionThreshold",1),this.evaluateNullToZero=this.valueFromParam(S,"boolean","evaluateNullToZero"),this.nullYear=this.valueFromParam(T,"number","nullYear"),this.validateNumberToBeAtLeast(this.nullYear,"nullYear",0),this.validateNumberToBeAtMost(this.nullYear,"nullYear",100),this.precisionRounding=this.valueFromParam(A,"number","precisionRounding"),this.validateNumberToBeAtLeast(this.precisionRounding,"precisionRounding",0),this.precisionEpsilon=this.valueFromParam(k,"number","precisionEpsilon"),this.validateNumberToBeAtLeast(this.precisionEpsilon,"precisionEpsilon",0),this.useColumnIndex=this.valueFromParam(C,"boolean","useColumnIndex"),this.useStats=this.valueFromParam(I,"boolean","useStats"),this.binarySearchThreshold=this.valueFromParam(M,"number","binarySearchThreshold"),this.validateNumberToBeAtLeast(this.binarySearchThreshold,"binarySearchThreshold",1),this.parseDateTime=this.valueFromParam(O,"function","parseDateTime"),this.stringifyDateTime=this.valueFromParam(R,"function","stringifyDateTime"),this.stringifyDuration=this.valueFromParam(N,"function","stringifyDuration"),this.translationPackage=cf.getLanguage(this.language),this.errorMapping=this.translationPackage.buildErrorMapping(),this.nullDate=this.valueFromParamCheck(x,si,"IDate","nullDate"),this.leapYear1900=this.valueFromParam(y,"boolean","leapYear1900"),this.undoLimit=this.valueFromParam(_,"number","undoLimit"),this.useRegularExpressions=this.valueFromParam(P,"boolean","useRegularExpressions"),this.useWildcards=this.valueFromParam(L,"boolean","useWildcards"),this.matchWholeCell=this.valueFromParam(F,"boolean","matchWholeCell"),this.validateNumberToBeAtLeast(this.undoLimit,"undoLimit",0),this.maxRows=this.valueFromParam(D,"number","maxRows"),this.validateNumberToBeAtLeast(this.maxRows,"maxRows",1),this.maxColumns=this.valueFromParam(U,"number","maxColumns"),this.currencySymbol=this.valueFromParamCheck(j,Array.isArray,"array","currencySymbol"),this.currencySymbol.forEach((function(e){if("string"!=typeof e)throw new Dn("string[]","currencySymbol");if(""===e)throw new Un("currencySymbol")})),this.validateNumberToBeAtLeast(this.maxColumns,"maxColumns",1),this.checkIfParametersNotInConflict({value:this.decimalSeparator,name:"decimalSeparator"},{value:this.functionArgSeparator,name:"functionArgSeparator"},{value:this.thousandSeparator,name:"thousandSeparator"})}var t,n,r;return t=e,(n=[{key:"licenseKeyValidityState",get:function(){return Mf(this,Af)}},{key:"getConfig",value:function(){return this}},{key:"mergeConfig",value:function(t){return new e(Object.assign({},this.getConfig(),t))}},{key:"warnDeprecatedIfUsed",value:function(e,t,n,r){void 0!==e&&console.warn("".concat(t," option is deprecated since ").concat(n,", please use ").concat(r))}},{key:"valueFromParam",value:function(t,n,r){if(void 0===t)return e.defaultConfig[r];if("string"==typeof n){if(Rf(t)===n)return t;throw new Dn(n,r)}if(n.includes(t))return t;throw new Vn(n.map((function(e){return"'"+e+"'"})).join(" "),r)}},{key:"valueFromParamCheck",value:function(t,n,r,o){if(n(t))return t;if(void 0===t)return e.defaultConfig[o];throw new Dn(r,o)}},{key:"checkIfParametersNotInConflict",value:function(){for(var e=new Map,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){var n=e.get(t.value)||[];n.push(t.name),e.set(t.value,n)}));var o,i=[],a=Tf(e.values());try{for(a.s();!(o=a.n()).done;){var s=o.value;s.length>1&&i.push(s)}}catch(e){a.e(e)}finally{a.f()}if(i.length>0){i.forEach((function(e){return e.sort()}));var u=i.map((function(e){return"[".concat(e,"]")})).join("; ");throw new Error("Config initialization failed. Parameters in conflict: ".concat(u))}}},{key:"validateNumberToBeAtLeast",value:function(e,t,n){if(e<n)throw new jn(t,n)}},{key:"validateNumberToBeAtMost",value:function(e,t,n){if(e>n)throw new Bn(t,n)}}])&&kf(t.prototype,n),r&&kf(t,r),e}();Af=new WeakMap,If.defaultConfig={accentSensitive:!1,caseSensitive:!1,caseFirst:"lower",ignorePunctuation:!1,chooseAddressMappingPolicy:new wi,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],functionArgSeparator:",",decimalSeparator:".",thousandSeparator:"",language:"enGB",licenseKey:"",functionPlugins:[],gpujs:void 0,gpuMode:"gpu",leapYear1900:!1,smartRounding:!0,localeLang:"en",matrixDetection:!0,matrixDetectionThreshold:100,evaluateNullToZero:!1,nullYear:30,parseDateTime:function(e,t,n){var r=(e=e.replace(/\s\s+/g," ").trim().toLowerCase()).substring(e.length-2);"am"===r||"pm"===r?e=e.substring(0,e.length-2).trim():"a"===(r=e.substring(e.length-1))||"p"===r?e=e.substring(0,e.length-1).trim():r=void 0;var o=e.split(/[ /.-]/g);o.length>=2&&o[o.length-2].includes(":")&&(o[o.length-2]=o[o.length-2]+"."+o[o.length-1],o.pop());var i=o[o.length-1].split(":");if(void 0!==r&&i.push(r),1===o.length)return Zo(i,n);if(1===i.length)return ei(o,t);var a=ei(o.slice(0,o.length-1),t),s=Zo(i,n);return void 0===a||void 0===s?void 0:Object.assign(Object.assign({},a),s)},stringifyDateTime:function(e,t){var n=Ni(t);if(void 0!==n){for(var r=n.tokens,o="",i=!1,a=r.some((function(e){return e.type===bi.FORMAT&&("a/p"===e.value||"A/P"===e.value||"am/pm"===e.value||"AM/PM"===e.value)})),s=0;s<r.length;s++){var u=r[s];if(u.type!==bi.FREE_TEXT)if(Qo.test(u.value)){var c=u.value.length-3;o+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,c))/Math.pow(10,c)}else switch(u.value.toLowerCase()){case"h":case"hh":i=!0,o+=_i(a?(e.hours+11)%12+1:e.hours,u.value.length);break;case"d":case"dd":o+=_i(e.day,u.value.length);break;case"s":case"ss":o+=_i(Math.round(e.seconds),u.value.length);break;case"m":case"mm":s+1<r.length&&r[s+1].value.startsWith(":")&&(i=!0),o+=_i(i?e.minutes:e.month,u.value.length),i=!0;break;case"yy":o+=_i(e.year%100,u.value.length);break;case"yyyy":o+=e.year;break;case"am/pm":case"a/p":var l=Ci(u.value.split("/"),2),f=l[0],h=l[1];o+=e.hours<12?f:h;break;default:return}else o+=u.value}return o}},stringifyDuration:function(e,t){var n=Ni(t);if(void 0!==n){var r,o="",i=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Mi(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(n.tokens);try{for(i.s();!(r=i.n()).done;){var a=r.value;if(a.type!==bi.FREE_TEXT)if(Qo.test(a.value)){var s=a.value.length-3;o+=(e.seconds<10?"0":"")+Math.round(e.seconds*Math.pow(10,s))/Math.pow(10,s)}else switch(a.value.toLowerCase()){case"h":case"hh":o+=_i(e.hours,a.value.length),e.hours=0;break;case"[hh]":o+=_i(e.hours,a.value.length-2),e.hours=0;break;case"m":case"mm":o+=_i(e.minutes,a.value.length),e.minutes=0;break;case"[mm]":o+=_i(e.minutes+60*e.hours,a.value.length-2),e.minutes=0,e.hours=0;break;case"s":case"ss":o+=_i(e.seconds,a.value.length);break;default:return}else o+=a.value}}catch(e){i.e(e)}finally{i.f()}return o}},precisionEpsilon:1e-13,precisionRounding:14,useColumnIndex:!1,useStats:!1,binarySearchThreshold:20,nullDate:{year:1899,month:12,day:30},undoLimit:20,useRegularExpressions:!1,useWildcards:!0,matchWholeCell:!0,maxRows:4e4,maxColumns:18278,currencySymbol:["$"]};var _f={errors:{CYCLE:"#CYCLE!",DIV_BY_ZERO:"#DIV/0!",ERROR:"#ERROR!",NA:"#N/A",NAME:"#NAME?",NUM:"#NUM!",REF:"#REF!",VALUE:"#VALUE!"},functions:{ABS:"ABS",ACOS:"ACOS",ACOSH:"ACOSH",ACOT:"ACOT",ACOTH:"ACOTH",AND:"AND",ARABIC:"ARABIC",ASIN:"ASIN",ASINH:"ASINH",ATAN2:"ATAN2",ATAN:"ATAN",ATANH:"ATANH",AVERAGE:"AVERAGE",AVERAGEA:"AVERAGEA",AVERAGEIF:"AVERAGEIF",BASE:"BASE",BIN2DEC:"BIN2DEC",BIN2HEX:"BIN2HEX",BIN2OCT:"BIN2OCT",BITAND:"BITAND",BITLSHIFT:"BITLSHIFT",BITOR:"BITOR",BITRSHIFT:"BITRSHIFT",BITXOR:"BITXOR",CEILING:"CEILING",CHAR:"CHAR",CHOOSE:"CHOOSE",CLEAN:"CLEAN",CODE:"CODE",COLUMN:"COLUMN",COLUMNS:"COLUMNS",CONCATENATE:"CONCATENATE",CORREL:"CORREL",COS:"COS",COSH:"COSH",COT:"COT",COTH:"COTH",COUNT:"COUNT",COUNTA:"COUNTA",COUNTBLANK:"COUNTBLANK",COUNTIF:"COUNTIF",COUNTIFS:"COUNTIFS",COUNTUNIQUE:"COUNTUNIQUE",CSC:"CSC",CSCH:"CSCH",CUMIPMT:"CUMIPMT",CUMPRINC:"CUMPRINC",DATE:"DATE",DATEDIF:"DATEDIF",DATEVALUE:"DATEVALUE",DAY:"DAY",DAYS360:"DAYS360",DAYS:"DAYS",DB:"DB",DDB:"DDB",DEC2BIN:"DEC2BIN",DEC2HEX:"DEC2HEX",DEC2OCT:"DEC2OCT",DECIMAL:"DECIMAL",DEGREES:"DEGREES",DELTA:"DELTA",DOLLARDE:"DOLLARDE",DOLLARFR:"DOLLARFR",EDATE:"EDATE",EFFECT:"EFFECT",EOMONTH:"EOMONTH",ERF:"ERF",ERFC:"ERFC",EVEN:"EVEN",EXACT:"EXACT",EXP:"EXP",FALSE:"FALSE",FIND:"FIND",FORMULATEXT:"FORMULATEXT",FV:"FV",FVSCHEDULE:"FVSCHEDULE",HEX2BIN:"HEX2BIN",HEX2DEC:"HEX2DEC",HEX2OCT:"HEX2OCT",HLOOKUP:"HLOOKUP",HOUR:"HOUR",IF:"IF",IFERROR:"IFERROR",IFNA:"IFNA",INDEX:"INDEX",INT:"INT",INTERVAL:"INTERVAL",IPMT:"IPMT",ISBINARY:"ISBINARY",ISBLANK:"ISBLANK",ISERR:"ISERR",ISERROR:"ISERROR",ISEVEN:"ISEVEN",ISFORMULA:"ISFORMULA",ISLOGICAL:"ISLOGICAL",ISNA:"ISNA",ISNONTEXT:"ISNONTEXT",ISNUMBER:"ISNUMBER",ISODD:"ISODD",ISOWEEKNUM:"ISOWEEKNUM",ISPMT:"ISPMT",ISREF:"ISREF",ISTEXT:"ISTEXT",LEFT:"LEFT",LEN:"LEN",LN:"LN",LOG10:"LOG10",LOG:"LOG",LOWER:"LOWER",MATCH:"MATCH",MAX:"MAX",MAXA:"MAXA",MAXPOOL:"MAXPOOL",MEDIAN:"MEDIAN",MEDIANPOOL:"MEDIANPOOL",MID:"MID",MIN:"MIN",MINA:"MINA",MINUTE:"MINUTE",MIRR:"MIRR",MMULT:"MMULT",MOD:"MOD",MONTH:"MONTH",NA:"NA",NETWORKDAYS:"NETWORKDAYS","NETWORKDAYS.INTL":"NETWORKDAYS.INTL",NOMINAL:"NOMINAL",NOT:"NOT",NOW:"NOW",NPER:"NPER",NPV:"NPV",OCT2BIN:"OCT2BIN",OCT2DEC:"OCT2DEC",OCT2HEX:"OCT2HEX",ODD:"ODD",OFFSET:"OFFSET",OR:"OR",PI:"PI",PMT:"PMT",PDURATION:"PDURATION",PRODUCT:"PRODUCT",POWER:"POWER",PPMT:"PPMT",PROPER:"PROPER",PV:"PV",RADIANS:"RADIANS",RAND:"RAND",RATE:"RATE",REPLACE:"REPLACE",REPT:"REPT",RIGHT:"RIGHT",ROMAN:"ROMAN",ROUND:"ROUND",ROUNDDOWN:"ROUNDDOWN",ROUNDUP:"ROUNDUP",ROW:"ROW",ROWS:"ROWS",RRI:"RRI",SEARCH:"SEARCH",SEC:"SEC",SECH:"SECH",SECOND:"SECOND",SHEET:"SHEET",SHEETS:"SHEETS",SIN:"SIN",SINH:"SINH",SLN:"SLN",SPLIT:"SPLIT",SQRT:"SQRT",STDEVA:"STDEVA","STDEV.P":"STDEV.P",STDEVPA:"STDEVPA","STDEV.S":"STDEV.S",SUBSTITUTE:"SUBSTITUTE",SUBTOTAL:"SUBTOTAL",SUM:"SUM",SUMIF:"SUMIF",SUMIFS:"SUMIFS",SUMPRODUCT:"SUMPRODUCT",SUMSQ:"SUMSQ",SWITCH:"SWITCH",SYD:"SYD",T:"T",TAN:"TAN",TANH:"TANH",TBILLEQ:"TBILLEQ",TBILLPRICE:"TBILLPRICE",TBILLYIELD:"TBILLYIELD",TEXT:"TEXT",TIME:"TIME",TIMEVALUE:"TIMEVALUE",TODAY:"TODAY",TRANSPOSE:"TRANSPOSE",TRIM:"TRIM",TRUE:"TRUE",TRUNC:"TRUNC",UNICHAR:"UNICHAR",UNICODE:"UNICODE",UPPER:"UPPER",VARA:"VARA","VAR.P":"VAR.P",VARPA:"VARPA","VAR.S":"VAR.S",VLOOKUP:"VLOOKUP",WEEKDAY:"WEEKDAY",WEEKNUM:"WEEKNUM",WORKDAY:"WORKDAY","WORKDAY.INTL":"WORKDAY.INTL",XNPV:"XNPV",XOR:"XOR",YEAR:"YEAR",YEARFRAC:"YEARFRAC","HF.ADD":"HF.ADD","HF.CONCAT":"HF.CONCAT","HF.DIVIDE":"HF.DIVIDE","HF.EQ":"HF.EQ","HF.GT":"HF.GT","HF.GTE":"HF.GTE","HF.LT":"HF.LT","HF.LTE":"HF.LTE","HF.MINUS":"HF.MINUS","HF.MULTIPLY":"HF.MULTIPLY","HF.NE":"HF.NE","HF.POW":"HF.POW","HF.UMINUS":"HF.UMINUS","HF.UNARY_PERCENT":"HF.UNARY_PERCENT","HF.UPLUS":"HF.UPLUS",VARP:"VARP",VAR:"VAR",STDEVP:"STDEVP",STDEV:"STDEV","EXPON.DIST":"EXPON.DIST",FISHER:"FISHER",FISHERINV:"FISHERINV",GAMMA:"GAMMA","GAMMA.DIST":"GAMMA.DIST",GAMMALN:"GAMMALN","GAMMALN.PRECISE":"GAMMALN.PRECISE","GAMMA.INV":"GAMMA.INV",GAUSS:"GAUSS",FACT:"FACT",FACTDOUBLE:"FACTDOUBLE",COMBIN:"COMBIN",COMBINA:"COMBINA",GCD:"GCD",LCM:"LCM",MROUND:"MROUND",MULTINOMIAL:"MULTINOMIAL",QUOTIENT:"QUOTIENT",RANDBETWEEN:"RANDBETWEEN",SERIESSUM:"SERIESSUM",SIGN:"SIGN",SQRTPI:"SQRTPI",SUMX2MY2:"SUMX2MY2",SUMX2PY2:"SUMX2PY2",SUMXMY2:"SUMXMY2",EXPONDIST:"EXPONDIST",GAMMADIST:"GAMMADIST",GAMMAINV:"GAMMAINV","BETA.DIST":"BETA.DIST",BETADIST:"BETADIST","BETA.INV":"BETA.INV",BETAINV:"BETAINV","BINOM.DIST":"BINOM.DIST",BINOMDIST:"BINOMDIST","BINOM.INV":"BINOM.INV",BESSELI:"BESSELI",BESSELJ:"BESSELJ",BESSELK:"BESSELK",BESSELY:"BESSELY","CHISQ.DIST":"CHISQ.DIST","CHISQ.DIST.RT":"CHISQ.DIST.RT","CHISQ.INV":"CHISQ.INV","CHISQ.INV.RT":"CHISQ.INV.RT",CHIDIST:"CHIDIST",CHIINV:"CHIINV","F.DIST":"F.DIST","F.DIST.RT":"F.DIST.RT","F.INV":"F.INV","F.INV.RT":"F.INV.RT",FDIST:"FDIST",FINV:"FINV",WEIBULL:"WEIBULL","WEIBULL.DIST":"WEIBULL.DIST",POISSON:"POISSON","POISSON.DIST":"POISSON.DIST","HYPGEOM.DIST":"HYPGEOM.DIST",HYPGEOMDIST:"HYPGEOMDIST","T.DIST":"T.DIST","T.DIST.2T":"T.DIST.2T","T.DIST.RT":"T.DIST.RT","T.INV":"T.INV","T.INV.2T":"T.INV.2T",TDIST:"TDIST",TINV:"TINV",LOGINV:"LOGINV","LOGNORM.DIST":"LOGNORM.DIST","LOGNORM.INV":"LOGNORM.INV",LOGNORMDIST:"LOGNORMDIST","NORM.DIST":"NORM.DIST","NORM.INV":"NORM.INV","NORM.S.DIST":"NORM.S.DIST","NORM.S.INV":"NORM.S.INV",NORMDIST:"NORMDIST",NORMINV:"NORMINV",NORMSDIST:"NORMSDIST",NORMSINV:"NORMSINV",PHI:"PHI","NEGBINOM.DIST":"NEGBINOM.DIST",NEGBINOMDIST:"NEGBINOMDIST",COMPLEX:"COMPLEX",IMABS:"IMABS",IMAGINARY:"IMAGINARY",IMARGUMENT:"IMARGUMENT",IMCONJUGATE:"IMCONJUGATE",IMCOS:"IMCOS",IMCOSH:"IMCOSH",IMCOT:"IMCOT",IMCSC:"IMCSC",IMCSCH:"IMCSCH",IMDIV:"IMDIV",IMEXP:"IMEXP",IMLN:"IMLN",IMLOG10:"IMLOG10",IMLOG2:"IMLOG2",IMPOWER:"IMPOWER",IMPRODUCT:"IMPRODUCT",IMREAL:"IMREAL",IMSEC:"IMSEC",IMSECH:"IMSECH",IMSIN:"IMSIN",IMSINH:"IMSINH",IMSQRT:"IMSQRT",IMSUB:"IMSUB",IMSUM:"IMSUM",IMTAN:"IMTAN",LARGE:"LARGE",SMALL:"SMALL",AVEDEV:"AVEDEV",CONFIDENCE:"CONFIDENCE","CONFIDENCE.NORM":"CONFIDENCE.NORM","CONFIDENCE.T":"CONFIDENCE.T",DEVSQ:"DEVSQ",GEOMEAN:"GEOMEAN",HARMEAN:"HARMEAN",CRITBINOM:"CRITBINOM","COVARIANCE.P":"COVARIANCE.P","COVARIANCE.S":"COVARIANCE.S",COVAR:"COVAR",PEARSON:"PEARSON",RSQ:"RSQ",STANDARDIZE:"STANDARDIZE","Z.TEST":"Z.TEST",ZTEST:"ZTEST","F.TEST":"F.TEST",FTEST:"FTEST",STEYX:"STEYX",SLOPE:"SLOPE","CHISQ.TEST":"CHISQ.TEST",CHITEST:"CHITEST","T.TEST":"T.TEST",TTEST:"TTEST",SKEW:"SKEW","SKEW.P":"SKEW.P",WEIBULLDIST:"WEIBULLDIST",VARS:"VARS",TINV2T:"TINV2T",TDISTRT:"TDISTRT",TDIST2T:"TDIST2T",STDEVS:"STDEVS",FINVRT:"FINVRT",FDISTRT:"FDISTRT",CHIDISTRT:"CHIDISTRT",CHIINVRT:"CHIINVRT",COVARIANCEP:"COVARIANCEP",COVARIANCES:"COVARIANCES",LOGNORMINV:"LOGNORMINV",POISSONDIST:"POISSONDIST",SKEWP:"SKEWP","CEILING.MATH":"CEILING.MATH",FLOOR:"FLOOR","FLOOR.MATH":"FLOOR.MATH","CEILING.PRECISE":"CEILING.PRECISE","FLOOR.PRECISE":"FLOOR.PRECISE","ISO.CEILING":"ISO.CEILING"},langCode:"enGB",ui:{NEW_SHEET_PREFIX:"Sheet"}};function Pf(e){return(Pf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ff(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Df(e,t){return(Df=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Uf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Bf(e);if(t){var o=Bf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return jf(this,n)}}function jf(e,t){return!t||"object"!==Pf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Bf(e){return(Bf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Vf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Df(e,t)}(i,e);var t,n,r,o=Uf(i);function i(){return Lf(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"abs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ABS"),Math.abs)}}])&&Ff(t.prototype,n),r&&Ff(t,r),i}(El);function Hf(e){return(Hf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Gf(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zf(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Wf(e,t){return(Wf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function $f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Kf(e);if(t){var o=Kf(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Yf(this,n)}}function Yf(e,t){return!t||"object"!==Hf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Kf(e){return(Kf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Vf.implementedFunctions={ABS:{method:"abs",parameters:[{argumentType:pl.NUMBER}]}};var qf=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Wf(e,t)}(i,e);var t,n,r,o=$f(i);function i(){return Gf(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"bitlshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITLSHIFT"),Xf)}},{key:"bitrshift",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITRSHIFT"),Jf)}}])&&zf(t.prototype,n),r&&zf(t,r),i}(El);function Xf(e,t){return t<0?Jf(e,-t):Qf(e*Math.pow(2,t))}function Jf(e,t){return t<0?Xf(e,-t):Qf(Math.floor(e/Math.pow(2,t)))}function Qf(e){return e>0xffffffffffff?new Ho(Mo.NUM,Ne.BitshiftLong):e}function Zf(e){return(Zf="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function th(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function nh(e,t){return(nh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function rh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ih(e);if(t){var o=ih(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return oh(this,n)}}function oh(e,t){return!t||"object"!==Zf(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ih(e){return(ih=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}qf.implementedFunctions={BITLSHIFT:{method:"bitlshift",parameters:[{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:-53,maxValue:53}]},BITRSHIFT:{method:"bitrshift",parameters:[{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:-53,maxValue:53}]}};var ah=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&nh(e,t)}(i,e);var t,n,r,o=rh(i);function i(){return eh(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"bitand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITAND"),(function(e,t){return e&t}))}},{key:"bitor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITOR"),(function(e,t){return e|t}))}},{key:"bitxor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BITXOR"),(function(e,t){return e^t}))}}])&&th(t.prototype,n),r&&th(t,r),i}(El);function sh(e){return(sh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function uh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ch(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function lh(e,t){return(lh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function fh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ph(e);if(t){var o=ph(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return hh(this,n)}}function hh(e,t){return!t||"object"!==sh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ph(e){return(ph=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ah.implementedFunctions={BITAND:{method:"bitand",parameters:[{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:0}]},BITOR:{method:"bitor",parameters:[{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:0}]},BITXOR:{method:"bitxor",parameters:[{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:0}]}};var dh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&lh(e,t)}(i,e);var t,n,r,o=fh(i);function i(){return uh(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"literalTrue",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRUE"),(function(){return!0}))}},{key:"literalFalse",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FALSE"),(function(){return!1}))}},{key:"conditionalIf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IF"),(function(e,t,n){return e?t:n}))}},{key:"and",value:function(e,t){return this.runFunction(e.args,t,this.metadata("AND"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!e}))}))}},{key:"or",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OR"),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some((function(e){return e}))}))}},{key:"not",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOT"),(function(e){return!e}))}},{key:"xor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XOR"),(function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t&&e++})),e%2==1}))}},{key:"switch",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SWITCH"),(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];for(var i=r.length,a=0;a+1<i;a+=2)if(!(r[a]instanceof Ho)&&n.interpreter.arithmeticHelper.eq(e,r[a]))return r[a+1];return a<i?r[a]:new Ho(Mo.NA,Ne.NoDefault)}))}},{key:"iferror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFERROR"),(function(e,t){return e instanceof Ho?t:e}))}},{key:"ifna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IFNA"),(function(e,t){return e instanceof Ho&&e.type===Mo.NA?t:e}))}},{key:"choose",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHOOSE"),(function(e){return e>(arguments.length<=1?0:arguments.length-1)?new Ho(Mo.NUM,Ne.Selector):e-1+1<1||arguments.length<=e-1+1?void 0:arguments[e-1+1]}))}}])&&ch(t.prototype,n),r&&ch(t,r),i}(El);dh.implementedFunctions={TRUE:{method:"literalTrue",parameters:[]},FALSE:{method:"literalFalse",parameters:[]},IF:{method:"conditionalIf",parameters:[{argumentType:pl.BOOLEAN},{argumentType:pl.SCALAR,passSubtype:!0},{argumentType:pl.SCALAR,defaultValue:!1,passSubtype:!0}]},AND:{method:"and",parameters:[{argumentType:pl.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},OR:{method:"or",parameters:[{argumentType:pl.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},XOR:{method:"xor",parameters:[{argumentType:pl.BOOLEAN}],repeatLastArgs:1,expandRanges:!0},NOT:{method:"not",parameters:[{argumentType:pl.BOOLEAN}]},SWITCH:{method:"switch",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.SCALAR,passSubtype:!0},{argumentType:pl.SCALAR,passSubtype:!0}],repeatLastArgs:1},IFERROR:{method:"iferror",parameters:[{argumentType:pl.SCALAR,passSubtype:!0},{argumentType:pl.SCALAR,passSubtype:!0}]},IFNA:{method:"ifna",parameters:[{argumentType:pl.SCALAR,passSubtype:!0},{argumentType:pl.SCALAR,passSubtype:!0}]},CHOOSE:{method:"choose",parameters:[{argumentType:pl.INTEGER,minValue:1},{argumentType:pl.SCALAR,passSubtype:!0}],repeatLastArgs:1}};n("tl/u"),n("9tb/");function mh(e){return(mh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function gh(e,t){return(gh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function bh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=wh(e);if(t){var o=wh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Eh(this,n)}}function Eh(e,t){return!t||"object"!==mh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function wh(e){return(wh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&gh(e,t)}(i,e);var t,n,r,o=bh(i);function i(){return vh(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"char",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=256?new Ho(Mo.VALUE,Ne.CharacterCodeBounds):String.fromCharCode(Math.trunc(e))}))}},{key:"unichar",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHAR"),(function(e){return e<1||e>=1114112?new Ho(Mo.VALUE,Ne.CharacterCodeBounds):String.fromCodePoint(Math.trunc(e))}))}}])&&yh(t.prototype,n),r&&yh(t,r),i}(El);function Th(e){return(Th="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Rh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Nh(e,t){return(Nh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function kh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ch(e);if(t){var o=Ch(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Ah(this,n)}}function Ah(e,t){return!t||"object"!==Th(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ch(e){return(Ch=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Sh.implementedFunctions={CHAR:{method:"char",parameters:[{argumentType:pl.NUMBER}]},UNICHAR:{method:"unichar",parameters:[{argumentType:pl.NUMBER}]}};var Mh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Nh(e,t)}(i,e);var t,n,r,o=kh(i);function i(){return Oh(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"code",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CODE"),(function(e){return 0===e.length?new Ho(Mo.VALUE,Ne.EmptyString):e.charCodeAt(0)}))}},{key:"unicode",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UNICODE"),(function(e){var t;return null!==(t=e.codePointAt(0))&&void 0!==t?t:new Ho(Mo.VALUE,Ne.EmptyString)}))}}])&&Rh(t.prototype,n),r&&Rh(t,r),i}(El);function xh(e){return(xh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ih(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _h(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ph(e,t){return(Ph=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Lh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Dh(e);if(t){var o=Dh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Fh(this,n)}}function Fh(e,t){return!t||"object"!==xh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Dh(e){return(Dh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Mh.implementedFunctions={CODE:{method:"code",parameters:[{argumentType:pl.STRING}]},UNICODE:{method:"unicode",parameters:[{argumentType:pl.STRING}]}};var Uh=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ph(e,t)}(i,e);var t,n,r,o=Lh(i);function i(){return Ih(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"countblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTBLANK"),(function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){t===Mt&&e++})),e}))}}])&&_h(t.prototype,n),r&&_h(t,r),i}(El);function jh(e){return(jh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Vh(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Hh(e,t){return(Hh=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Gh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Wh(e);if(t){var o=Wh(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return zh(this,n)}}function zh(e,t){return!t||"object"!==jh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Wh(e){return(Wh=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Uh.implementedFunctions={COUNTBLANK:{method:"countblank",parameters:[{argumentType:pl.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var $h=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Hh(e,t)}(i,e);var t,n,r,o=Gh(i);function i(){return Bh(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"countunique",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COUNTUNIQUE"),(function(){for(var e=new Set,t=new Set,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var i=0,a=r;i<a.length;i++){var s=a[i];s instanceof Ho?t.add(s.type):""!==s&&e.add(s)}return e.size+t.size}))}}])&&Vh(t.prototype,n),r&&Vh(t,r),i}(El);function Yh(e){return(Yh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Kh(e){return function(e){if(Array.isArray(e))return Qh(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Jh(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function qh(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Jh(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Xh(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Jh(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jh(e,t){if(e){if("string"==typeof e)return Qh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Qh(e,t):void 0}}function Qh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Zh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tp(e,t){return(tp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function np(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=op(e);if(t){var o=op(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return rp(this,n)}}function rp(e,t){return!t||"object"!==Yh(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function op(e){return(op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}$h.implementedFunctions={COUNTUNIQUE:{method:"countunique",parameters:[{argumentType:pl.SCALAR}],repeatLastArgs:1,expandRanges:!0}};var ip=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&tp(e,t)}(i,e);var t,n,r,o=np(i);function i(){var e;return Zh(this,i),(e=o.apply(this,arguments)).isoweeknumCore=function(t){var n=Math.floor(e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),r=e.interpreter.dateHelper.numberToSimpleDate(t),o=e.interpreter.dateHelper.dateToNumber({year:r.year,month:1,day:1}),i=e.interpreter.dateHelper.relativeNumberToAbsoluteNumber(o),a=i+((4-i)%7+7)%7,s=Math.floor((n-1)/7)-Math.floor((a-1)/7)+1;return 0===s?e.isoweeknumCore(t-7)+1:s},e.days360Core=function(t,n,r){var o,i,a=e.interpreter.dateHelper.numberToSimpleDate(t),s=e.interpreter.dateHelper.numberToSimpleDate(n);if(r)o=mi(a),i=mi(s);else{var u=Xh(e.interpreter.dateHelper.toBasisUS(a,s),2);o=u[0],i=u[1]}return 360*(i.year-o.year)+30*(i.month-o.month)+i.day-o.day},e}return t=i,(n=[{key:"date",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATE"),(function(e,t,r){var o=Math.trunc(r),i=Math.trunc(t),a=Math.trunc(e);a<n.interpreter.dateHelper.getEpochYearZero()&&(a+=n.interpreter.dateHelper.getEpochYearZero());var s=Math.floor((i-1)/12),u={year:a+=s,month:i-=12*s,day:1};if(n.interpreter.dateHelper.isValidDate(u)){var c=n.interpreter.dateHelper.dateToNumber(u)+(o-1);return void 0===(c=n.interpreter.dateHelper.getWithinBounds(c))?new Ho(Mo.NUM,Ne.DateBounds):c}return new Ho(Mo.VALUE,Ne.InvalidDate)}))}},{key:"time",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TIME"),(function(e,t,n){var r=di({hours:Math.trunc(e),minutes:Math.trunc(t),seconds:Math.trunc(n)});return r<0?new Ho(Mo.NUM,Ne.NegativeTime):r%1}))}},{key:"eomonth",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("EOMONTH"),(function(e,t){var r=n.interpreter.dateHelper.numberToSimpleDate(e),o=n.interpreter.dateHelper.dateToNumber(n.interpreter.dateHelper.endOfMonth(fi(r,t)));return void 0===(o=n.interpreter.dateHelper.getWithinBounds(o))?new Ho(Mo.NUM,Ne.DateBounds):o}))}},{key:"day",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DAY"),(function(e){return n.interpreter.dateHelper.numberToSimpleDate(e).day}))}},{key:"days",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS"),(function(e,t){return Math.trunc(e)-Math.trunc(t)}))}},{key:"month",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MONTH"),(function(e){return n.interpreter.dateHelper.numberToSimpleDate(e).month}))}},{key:"year",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("YEAR"),(function(e){return n.interpreter.dateHelper.numberToSimpleDate(e).year}))}},{key:"hour",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HOUR"),(function(e){return pi(hi(e)%1).hours}))}},{key:"minute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MINUTE"),(function(e){return pi(hi(e)%1).minutes}))}},{key:"second",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECOND"),(function(e){return pi(hi(e)%1).seconds}))}},{key:"text",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TEXT"),(function(e,t){return Ii(e,t,n.config,n.interpreter.dateHelper)}))}},{key:"weekday",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WEEKDAY"),(function(e,t){var r=Math.floor(n.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e));if(3===t)return(r-1)%7;var o=up.get(t);return void 0===o?new Ho(Mo.NUM,Ne.BadMode):(r-o)%7+1}))}},{key:"weeknum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WEEKNUM"),(function(e,t){var r=Math.floor(n.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),o=n.interpreter.dateHelper.numberToSimpleDate(e),i=n.interpreter.dateHelper.dateToNumber({year:o.year,month:1,day:1}),a=n.interpreter.dateHelper.relativeNumberToAbsoluteNumber(i);if(21===t)return n.isoweeknumCore(e);var s=up.get(t);return void 0===s?new Ho(Mo.NUM,Ne.BadMode):Math.floor((r-s)/7)-Math.floor((a-s)/7)+1}))}},{key:"isoweeknum",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISOWEEKNUM"),this.isoweeknumCore)}},{key:"datevalue",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATEVALUE"),(function(e){var t=n.interpreter.dateHelper.parseDateTimeFromConfigFormats(e).dateTime;return void 0===t?new Ho(Mo.VALUE,Ne.IncorrectDateTime):si(t)?(ui(t)?Math.trunc(di(t)):0)+n.interpreter.dateHelper.dateToNumber(t):0}))}},{key:"timevalue",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TIMEVALUE"),(function(e){var t=n.interpreter.dateHelper.dateStringToDateNumber(e);return void 0===t?new Ho(Mo.VALUE,Ne.IncorrectDateTime):xt(t)%1}))}},{key:"now",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NOW"),(function(){var e=new Date;return di({hours:e.getHours(),minutes:e.getMinutes(),seconds:e.getSeconds()})+n.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"today",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TODAY"),(function(){var e=new Date;return n.interpreter.dateHelper.dateToNumber({year:e.getFullYear(),month:e.getMonth()+1,day:e.getDay()})}))}},{key:"edate",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("EDATE"),(function(e,t){var r=function(e){return{year:e.year,month:e.month,day:Math.min(e.day,ii[e.month-1])}}(fi(n.interpreter.dateHelper.numberToSimpleDate(e),t)),o=n.interpreter.dateHelper.dateToNumber(r);return void 0===(o=n.interpreter.dateHelper.getWithinBounds(o))?new Ho(Mo.NUM,Ne.DateBounds):o}))}},{key:"datedif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DATEDIF"),(function(e,t,r){if(e>t)return new Ho(Mo.NUM,Ne.StartEndDate);if("D"===r)return Math.floor(t)-Math.floor(e);var o=n.interpreter.dateHelper.numberToSimpleDate(e),i=n.interpreter.dateHelper.numberToSimpleDate(t);switch(r){case"M":return 12*(i.year-o.year)+(i.month-o.month)-(i.day<o.day?1:0);case"YM":return(i.month-o.month+12-(i.day<o.day?1:0))%12;case"Y":return i.month>o.month||i.month===o.month&&i.day>=o.day?i.year-o.year:i.year-o.year-1;case"MD":if(i.day>=o.day)return i.day-o.day;var a=1===i.month?12:i.month-1,s=1===i.month?i.year-1:i.year;return n.interpreter.dateHelper.daysInMonth(s,a)+i.day-o.day;case"YD":return i.month>o.month||i.month===o.month&&i.day>=o.day?Math.floor(t)-n.interpreter.dateHelper.dateToNumber({year:i.year,month:o.month,day:o.day}):Math.floor(t)-Math.floor(e)-365*(i.year-o.year-1)-n.interpreter.dateHelper.leapYearsCount(i.year-1)+n.interpreter.dateHelper.leapYearsCount(o.year);default:return new Ho(Mo.NUM,Ne.BadMode)}}))}},{key:"days360",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DAYS360"),this.days360Core)}},{key:"yearfrac",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("YEARFRAC"),(function(e,t,r){if((e=Math.trunc(e))>(t=Math.trunc(t))){var o=[t,e];e=o[0],t=o[1]}switch(r){case 0:return n.days360Core(e,t,!1)/360;case 1:return(t-e)/n.interpreter.dateHelper.yearLengthForBasis(n.interpreter.dateHelper.numberToSimpleDate(e),n.interpreter.dateHelper.numberToSimpleDate(t));case 2:return(t-e)/360;case 3:return(t-e)/365;case 4:return n.days360Core(e,t,!0)/360}throw new Error("Should not be reachable.")}))}},{key:"interval",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INTERVAL"),(function(e){var t=(e=Math.trunc(e))%60,n=(e=Math.trunc(e/60))%60,r=(e=Math.trunc(e/60))%24,o=(e=Math.trunc(e/24))%30,i=(e=Math.trunc(e/30))%12,a=Math.trunc(e/12);return"P"+(a>0?a+"Y":"")+(i>0?i+"M":"")+(o>0?o+"D":"")+"T"+(r>0?r+"H":"")+(n>0?n+"M":"")+(t>0?t+"S":"")}))}},{key:"networkdays",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS"),(function(e,t,r){return n.networkdayscore(e,t,1,r)}))}},{key:"networkdaysintl",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NETWORKDAYS.INTL"),(function(e,t,r,o){return n.networkdayscore(e,t,r,o)}))}},{key:"workday",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WORKDAY"),(function(e,t,r){return n.workdaycore(e,t,1,r)}))}},{key:"workdayintl",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("WORKDAY.INTL"),(function(e,t,r,o){return n.workdaycore(e,t,r,o)}))}},{key:"networkdayscore",value:function(e,t,n,r){var o=1;if((e=Math.trunc(e))>(t=Math.trunc(t))){var i=[t,e];e=i[0],t=i[1],o=-1}var a=sp(n);if(a instanceof Ho)return a;var s=this.simpleRangeToFilteredHolidays(r,a);return s instanceof Ho?s:o*this.countWorkdays(e,t,a,s)}},{key:"workdaycore",value:function(e,t,n,r){e=Math.trunc(e),t=Math.trunc(t);var o=sp(n);if(o instanceof Ho)return o;var i=this.simpleRangeToFilteredHolidays(r,o);if(i instanceof Ho)return i;if(t>0){for(var a=1;this.countWorkdays(e+1,e+a,o,i)<t;)a*=2;for(var s=1;s+1<a;){var u=Math.trunc((s+a)/2);this.countWorkdays(e+1,e+u,o,i)<t?s=u:a=u}return e+a}if(t<0){t*=-1;for(var c=1;this.countWorkdays(e-c,e-1,o,i)<t;)c*=2;for(var l=1;l+1<c;){var f=Math.trunc((l+c)/2);this.countWorkdays(e-f,e-1,o,i)<t?l=f:c=f}return e-c}return e}},{key:"countWorkdays",value:function(e,t,n,r){for(var o=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(t)),i=Math.floor(this.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)),a=0,s=0;s<7;s++)"0"===n.charAt(s)&&(a+=Math.floor((o+6-s)/7),a-=Math.floor((i-1+6-s)/7));return a-=ap(t+1,r)-ap(e,r)}},{key:"simpleRangeToFilteredHolidays",value:function(e,t){var n,r,o=this,i=null!==(n=null==e?void 0:e.valuesFromTopLeftCorner())&&void 0!==n?n:[],a=qh(i);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s instanceof Ho)return s}}catch(e){a.e(e)}finally{a.f()}var u,c=[],l=qh(i);try{for(l.s();!(u=l.n()).done;){var f=u.value;if(f!==Mt){if(!Bt(f))return new Ho(Mo.VALUE,Ne.WrongType);c.push(Math.trunc(xt(f)))}}}catch(e){l.e(e)}finally{l.f()}return Kh(new Set(c)).sort((function(e,t){return e-t})).filter((function(e){var n=(o.interpreter.dateHelper.relativeNumberToAbsoluteNumber(e)-1)%7;return"0"===t.charAt(n)}))}}])&&ep(t.prototype,n),r&&ep(t,r),i}(El);function ap(e,t){if(0===t.length)return 0;if(e<=t[0])return 0;if(t[t.length-1]<e)return t.length;for(var n=0,r=t.length-1;n+1<r;){var o=Math.floor((r+n)/2);t[o]>=e?r=o:n=o}return r}function sp(e){var t;return"number"!=typeof e&&"string"!=typeof e?new Ho(Mo.VALUE,Ne.WrongType):"string"==typeof e?7===e.length&&/^(0|1)*$/.test(e)&&"1111111"!==e?e:new Ho(Mo.NUM,Ne.WeekendString):null!==(t=cp.get(e))&&void 0!==t?t:new Ho(Mo.NUM,Ne.BadMode)}ip.implementedFunctions={DATE:{method:"date",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_DATE},TIME:{method:"time",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_TIME},MONTH:{method:"month",parameters:[{argumentType:pl.NUMBER,minValue:0}]},YEAR:{method:"year",parameters:[{argumentType:pl.NUMBER,minValue:0}]},HOUR:{method:"hour",parameters:[{argumentType:pl.NUMBER,minValue:0}]},MINUTE:{method:"minute",parameters:[{argumentType:pl.NUMBER,minValue:0}]},SECOND:{method:"second",parameters:[{argumentType:pl.NUMBER,minValue:0}]},TEXT:{method:"text",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.STRING}]},EOMONTH:{method:"eomonth",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_DATE},DAY:{method:"day",parameters:[{argumentType:pl.NUMBER,minValue:0}]},DAYS:{method:"days",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0}]},WEEKDAY:{method:"weekday",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,defaultValue:1}]},WEEKNUM:{method:"weeknum",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,defaultValue:1}]},ISOWEEKNUM:{method:"isoweeknum",parameters:[{argumentType:pl.NUMBER,minValue:0}]},DATEVALUE:{method:"datevalue",parameters:[{argumentType:pl.STRING}],returnNumberType:Pt.NUMBER_DATE},TIMEVALUE:{method:"timevalue",parameters:[{argumentType:pl.STRING}],returnNumberType:Pt.NUMBER_TIME},NOW:{method:"now",parameters:[],isVolatile:!0,returnNumberType:Pt.NUMBER_DATETIME},TODAY:{method:"today",parameters:[],isVolatile:!0,returnNumberType:Pt.NUMBER_DATE},EDATE:{method:"edate",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_DATE},DAYS360:{method:"days360",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.BOOLEAN,defaultValue:!1}]},DATEDIF:{method:"datedif",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.STRING}]},YEARFRAC:{method:"yearfrac",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.INTEGER,defaultValue:0,minValue:0,maxValue:4}]},INTERVAL:{method:"interval",parameters:[{argumentType:pl.NUMBER,minValue:0}]},NETWORKDAYS:{method:"networkdays",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.RANGE,optionalArg:!0}]},"NETWORKDAYS.INTL":{method:"networkdaysintl",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NOERROR,defaultValue:1},{argumentType:pl.RANGE,optionalArg:!0}]},WORKDAY:{method:"workday",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER},{argumentType:pl.RANGE,optionalArg:!0}]},"WORKDAY.INTL":{method:"workdayintl",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER},{argumentType:pl.NOERROR,defaultValue:1},{argumentType:pl.RANGE,optionalArg:!0}]}};var up=new Map([[1,0],[2,1],[11,1],[12,2],[13,3],[14,4],[15,5],[16,6],[17,0]]),cp=new Map([[1,"0000011"],[2,"1000001"],[3,"1100000"],[4,"0110000"],[5,"0011000"],[6,"0001100"],[7,"0000110"],[11,"0000001"],[12,"1000000"],[13,"0100000"],[14,"0010000"],[15,"0001000"],[16,"0000100"],[17,"0000010"]]);function lp(e){return(lp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function fp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function hp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function pp(e,t){return(pp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function dp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=vp(e);if(t){var o=vp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return mp(this,n)}}function mp(e,t){return!t||"object"!==lp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function vp(e){return(vp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var yp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&pp(e,t)}(i,e);var t,n,r,o=dp(i);function i(){return fp(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"degrees",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEGREES"),(function(e){return e*(180/Math.PI)}))}}])&&hp(t.prototype,n),r&&hp(t,r),i}(El);function gp(e){return(gp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function bp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ep(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function wp(e,t){return(wp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Sp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Op(e);if(t){var o=Op(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Tp(this,n)}}function Tp(e,t){return!t||"object"!==gp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Op(e){return(Op=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}yp.implementedFunctions={DEGREES:{method:"degrees",parameters:[{argumentType:pl.NUMBER}]}};var Rp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&wp(e,t)}(i,e);var t,n,r,o=Sp(i);function i(){return bp(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"delta",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DELTA"),(function(e,t){return e===t?1:0}))}}])&&Ep(t.prototype,n),r&&Ep(t,r),i}(El);function Np(e){return(Np="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function kp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ap(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Cp(e,t){return(Cp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Mp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ip(e);if(t){var o=Ip(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return xp(this,n)}}function xp(e,t){return!t||"object"!==Np(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ip(e){return(Ip=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Rp.implementedFunctions={DELTA:{method:"delta",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0}]}};var _p=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Cp(e,t)}(i,e);var t,n,r,o=Mp(i);function i(){return kp(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"exp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXP"),Math.exp)}}])&&Ap(t.prototype,n),r&&Ap(t,r),i}(El);function Pp(e){return(Pp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Lp(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Fp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Dp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Up(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jp(e,t){return(jp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hp(e);if(t){var o=Hp(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vp(this,n)}}function Vp(e,t){return!t||"object"!==Pp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hp(e){return(Hp=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}_p.implementedFunctions={EXP:{method:"exp",parameters:[{argumentType:pl.NUMBER}]}};var Gp=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jp(e,t)}(i,e);var t,n,r,o=Bp(i);function i(){return Dp(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"pmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PMT"),zp)}},{key:"ipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IPMT"),Wp)}},{key:"ppmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PPMT"),Yp)}},{key:"fv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FV"),$p)}},{key:"cumipmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMIPMT"),(function(e,t,n,r,o,i){if(r>o)return new Ho(Mo.NUM,Ne.EndStartPeriod);for(var a=0,s=r;s<=o;s++)a+=Wp(e,s,t,n,0,i);return a}))}},{key:"cumprinc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CUMPRINC"),(function(e,t,n,r,o,i){if(r>o)return new Ho(Mo.NUM,Ne.EndStartPeriod);for(var a=0,s=r;s<=o;s++)a+=Yp(e,s,t,n,0,i);return a}))}},{key:"db",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DB"),(function(e,t,n,r,o){if(12===o&&r>n||r>n+1)return new Ho(Mo.NUM,Ne.PeriodLong);if(t>=e)return 0;var i=Math.round(1e3*(1-Math.pow(t/e,1/n)))/1e3,a=e*i*o/12;if(1===r)return a;for(var s=a,u=0;u<r-2;u++)s+=(e-s)*i;return r===n+1?(e-s)*i*(12-o)/12:(e-s)*i}))}},{key:"ddb",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DDB"),(function(e,t,n,r,o){if(r>n)return new Ho(Mo.NUM);var i,a=o/n;a>=1?(a=1,i=1===r?e:0):i=e*Math.pow(1-a,r-1);var s=e*Math.pow(1-a,r);return Math.max(i-Math.max(t,s),0)}))}},{key:"dollarde",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARDE"),(function(e,t){if(t<1)return new Ho(Mo.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+10*(e-Math.trunc(e))/t}))}},{key:"dollarfr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DOLLARFR"),(function(e,t){if(t<1)return new Ho(Mo.DIV_BY_ZERO);for(t=Math.trunc(t);t>10;)t/=10;return Math.trunc(e)+(e-Math.trunc(e))*t/10}))}},{key:"effect",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EFFECT"),(function(e,t){return t=Math.trunc(t),Math.pow(1+e/t,t)-1}))}},{key:"ispmt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISPMT"),(function(e,t,n,r){return 0===n?new Ho(Mo.DIV_BY_ZERO):r*e*(t/n-1)}))}},{key:"nominal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NOMINAL"),(function(e,t){return t=Math.trunc(t),(Math.pow(e+1,1/t)-1)*t}))}},{key:"nper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NPER"),(function(e,t,n,r,o){return 0===e?0===t?new Ho(Mo.DIV_BY_ZERO):(-n-r)/t:(o&&(t*=1+e),Math.log((t-r*e)/(n*e+t))/Math.log(1+e))}))}},{key:"rate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RATE"),(function(e,t,n,r,o,i){if(i<=-1)return new Ho(Mo.VALUE);var a=i;o=o?1:0;for(var s=0;s<20;s++){if(a<=-1)return new Ho(Mo.NUM);var u=void 0;if(Math.abs(a)<1e-10)u=n*(1+e*a)+t*(1+a*o)*e+r;else{var c=Math.pow(1+a,e);u=n*c+t*(1/a+o)*(c-1)+r}if(Math.abs(u)<1e-10)return a;var l=void 0;if(Math.abs(a)<1e-10)l=n*e+t*o*e;else{var f=Math.pow(1+a,e),h=e*Math.pow(1+a,e-1);l=n*h+t*(1/a+o)*h+t*(-1/(a*a))*(f-1)}a-=u/l}return new Ho(Mo.NUM)}))}},{key:"pv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PV"),(function(e,t,n,r,o){return o=o?1:0,-1===e?new Ho(0===t?Mo.NUM:Mo.DIV_BY_ZERO):0===e?-n*t-r:((1-Math.pow(1+e,t))*n*(1+e*o)/e-r)/Math.pow(1+e,t)}))}},{key:"rri",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RRI"),(function(e,t,n){return 0===t||n<0&&t>0||n>0&&t<0?new Ho(Mo.NUM):Math.pow(n/t,1/e)-1}))}},{key:"sln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLN"),(function(e,t,n){return 0===n?new Ho(Mo.DIV_BY_ZERO):(e-t)/n}))}},{key:"syd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SYD"),(function(e,t,n,r){return r>n?new Ho(Mo.NUM):(e-t)*(n-r+1)*2/(n*(n+1))}))}},{key:"tbilleq",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLEQ"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new Ho(Mo.NUM);var o=n.interpreter.dateHelper.numberToSimpleDate(e),i=n.interpreter.dateHelper.numberToSimpleDate(t);if(i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day))return new Ho(Mo.NUM);var a=360-r*(t-e);return 0===a?0:a<0?new Ho(Mo.NUM):365*r/a}))}},{key:"tbillprice",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLPRICE"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new Ho(Mo.NUM);var o=n.interpreter.dateHelper.numberToSimpleDate(e),i=n.interpreter.dateHelper.numberToSimpleDate(t);if(i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day))return new Ho(Mo.NUM);var a=360-r*(t-e);return 0===a?0:a<0?new Ho(Mo.NUM):100*(1-r*(t-e)/360)}))}},{key:"tbillyield",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("TBILLYIELD"),(function(e,t,r){if((e=Math.round(e))>=(t=Math.round(t)))return new Ho(Mo.NUM);var o=n.interpreter.dateHelper.numberToSimpleDate(e),i=n.interpreter.dateHelper.numberToSimpleDate(t);return i.year>o.year+1||i.year===o.year+1&&(i.month>o.month||i.month===o.month&&i.day>o.day)?new Ho(Mo.NUM):360*(100-r)/(r*(t-e))}))}},{key:"fvschedule",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FVSCHEDULE"),(function(e,t){var n,r=t.valuesFromTopLeftCorner(),o=Lp(r);try{for(o.s();!(n=o.n()).done;){var i=n.value;if(i instanceof Ho)return i}}catch(e){o.e(e)}finally{o.f()}var a,s=Lp(r);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(Bt(u))e*=1+xt(u);else if(u!==Mt)return new Ho(Mo.VALUE,Ne.NumberExpected)}}catch(e){s.e(e)}finally{s.f()}return e}))}},{key:"npv",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("NPV"),(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];var i=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(r);return i instanceof Ho?i:Kp(e,i)}))}},{key:"mirr",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MIRR"),(function(e,t,r){var o=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(o instanceof Ho)return o;var i,a=!1,s=!1,u=[],c=[],l=Lp(o);try{for(l.s();!(i=l.n()).done;){var f=i.value;f>0?(a=!0,u.push(f),c.push(0)):f<0?(s=!0,c.push(f),u.push(0)):(c.push(0),u.push(0))}}catch(e){l.e(e)}finally{l.f()}if(!a||!s)return new Ho(Mo.DIV_BY_ZERO);var h=o.length,p=Kp(r,u);if(p instanceof Ho)return p;var d=Kp(t,c);return d instanceof Ho?d:Math.pow(-p*Math.pow(1+r,h)/d/(1+t),1/(h-1))-1}))}},{key:"pduration",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PDURATION"),(function(e,t,n){return(Math.log(n)-Math.log(t))/Math.log(1+e)}))}},{key:"xnpv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("XNPV"),(function(e,t,n){var r,o=t.valuesFromTopLeftCorner(),i=Lp(o);try{for(i.s();!(r=i.n()).done;)if("number"!=typeof r.value)return new Ho(Mo.VALUE,Ne.NumberExpected)}catch(e){i.e(e)}finally{i.f()}var a,s=o,u=n.valuesFromTopLeftCorner(),c=Lp(u);try{for(c.s();!(a=c.n()).done;)if("number"!=typeof a.value)return new Ho(Mo.VALUE,Ne.NumberExpected)}catch(e){c.e(e)}finally{c.f()}var l=u;if(l.length!==s.length)return new Ho(Mo.NUM,Ne.EqualLength);var f=l.length,h=0;if(l[0]<0)return new Ho(Mo.NUM,Ne.ValueSmall);for(var p=0;p<f;p++){if(l[p]=Math.floor(l[p]),l[p]<l[0])return new Ho(Mo.NUM,Ne.ValueSmall);h+=s[p]/Math.pow(1+e,(l[p]-l[0])/365)}return h}))}}])&&Up(t.prototype,n),r&&Up(t,r),i}(El);function zp(e,t,n,r,o){if(0===e)return(-n-r)/t;var i=Math.pow(1+e,t);return(r*e+n*e*i)*(o?1/(1+e):1)/(1-i)}function Wp(e,t,n,r,o,i){var a=zp(e,n,r,o,i);return 1===t?e*(i?0:-r):e*(i?$p(e,t-2,a,r,i)-a:$p(e,t-1,a,r,i))}function $p(e,t,n,r,o){if(0===e)return-r-n*t;var i=Math.pow(1+e,t);return n*(o?1+e:1)*(1-i)/e-r*i}function Yp(e,t,n,r,o,i){return zp(e,n,r,o,i)-Wp(e,t,n,r,o,i)}function Kp(e,t){for(var n=0,r=t.length-1;r>=0;r--){if(n+=t[r],-1===e){if(0===n)continue;return new Ho(Mo.DIV_BY_ZERO)}n/=1+e}return n}function qp(e){return(qp="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Xp(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Jp(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Qp(e,t){return(Qp=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=td(e);if(t){var o=td(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ed(this,n)}}function ed(e,t){return!t||"object"!==qp(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function td(e){return(td=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Gp.implementedFunctions={PMT:{method:"pmt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}],returnNumberType:Pt.NUMBER_CURRENCY},IPMT:{method:"ipmt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}],returnNumberType:Pt.NUMBER_CURRENCY},PPMT:{method:"ppmt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}],returnNumberType:Pt.NUMBER_CURRENCY},FV:{method:"fv",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}],returnNumberType:Pt.NUMBER_CURRENCY},CUMIPMT:{method:"cumipmt",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.INTEGER,minValue:1},{argumentType:pl.INTEGER,minValue:1},{argumentType:pl.INTEGER,minValue:0,maxValue:1}],returnNumberType:Pt.NUMBER_CURRENCY},CUMPRINC:{method:"cumprinc",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.INTEGER,minValue:1},{argumentType:pl.INTEGER,minValue:1},{argumentType:pl.INTEGER,minValue:0,maxValue:1}],returnNumberType:Pt.NUMBER_CURRENCY},DB:{method:"db",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.INTEGER,minValue:1,maxValue:12,defaultValue:12}],returnNumberType:Pt.NUMBER_CURRENCY},DDB:{method:"ddb",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.INTEGER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0,defaultValue:2}],returnNumberType:Pt.NUMBER_CURRENCY},DOLLARDE:{method:"dollarde",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},DOLLARFR:{method:"dollarfr",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},EFFECT:{method:"effect",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1}],returnNumberType:Pt.NUMBER_PERCENT},ISPMT:{method:"ispmt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},NOMINAL:{method:"nominal",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1}],returnNumberType:Pt.NUMBER_PERCENT},NPER:{method:"nper",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}]},PV:{method:"pv",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0}],returnNumberType:Pt.NUMBER_CURRENCY},RATE:{method:"rate",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:.1}],returnNumberType:Pt.NUMBER_PERCENT},RRI:{method:"rri",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_PERCENT},SLN:{method:"sln",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_CURRENCY},SYD:{method:"syd",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0}],returnNumberType:Pt.NUMBER_CURRENCY},TBILLEQ:{method:"tbilleq",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0}],returnNumberType:Pt.NUMBER_PERCENT},TBILLPRICE:{method:"tbillprice",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0}],returnNumberType:Pt.NUMBER_CURRENCY},TBILLYIELD:{method:"tbillyield",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0}],returnNumberType:Pt.NUMBER_PERCENT},FVSCHEDULE:{method:"fvschedule",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.RANGE}],returnNumberType:Pt.NUMBER_CURRENCY},NPV:{method:"npv",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.ANY}],repeatLastArgs:1,returnNumberType:Pt.NUMBER_CURRENCY},MIRR:{method:"mirr",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],returnNumberType:Pt.NUMBER_PERCENT},PDURATION:{method:"pduration",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0}]},XNPV:{method:"xnpv",parameters:[{argumentType:pl.NUMBER,greaterThan:-1},{argumentType:pl.RANGE},{argumentType:pl.RANGE}]}};var nd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Qp(e,t)}(i,e);var t,n,r,o=Zp(i);function i(){return Xp(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"formulatext",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("FORMULATEXT"),(function(){return new Ho(Mo.NA,Ne.WrongArgNumber)}),(function(e){var t;return null!==(t=n.serialization.getCellFormula(e))&&void 0!==t?t:new Ho(Mo.NA,Ne.Formula)}))}}])&&Jp(t.prototype,n),r&&Jp(t,r),i}(El);function rd(e){return(rd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function od(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function id(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ad(e,t){return(ad=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function sd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=cd(e);if(t){var o=cd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ud(this,n)}}function ud(e,t){return!t||"object"!==rd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function cd(e){return(cd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}nd.implementedFunctions={FORMULATEXT:{method:"formulatext",parameters:[{argumentType:pl.NOERROR}],doesNotNeedArgumentsToBeComputed:!0,isDependentOnSheetStructureChange:!0}};var ld=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ad(e,t)}(i,e);var t,n,r,o=sd(i);function i(){return od(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"isbinary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBINARY"),(function(e){return/^[01]{1,10}$/.test(e)}))}},{key:"iserr",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERR"),(function(e){return e instanceof Ho&&e.type!==Mo.NA}))}},{key:"iserror",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISERROR"),(function(e){return e instanceof Ho}))}},{key:"isformula",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ISFORMULA"),(function(){return new Ho(Mo.NA,Ne.WrongArgNumber)}),(function(e){var t=n.dependencyGraph.addressMapping.getCell(e);return t instanceof cr||t instanceof Or&&t.isFormula()}))}},{key:"isblank",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISBLANK"),(function(e){return e===Mt}))}},{key:"isna",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNA"),(function(e){return e instanceof Ho&&e.type==Mo.NA}))}},{key:"isnumber",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNUMBER"),Bt)}},{key:"islogical",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISLOGICAL"),(function(e){return"boolean"==typeof e}))}},{key:"isref",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISREF"),(function(e){return e instanceof Ho&&(e.type==Mo.REF||e.type==Mo.CYCLE)}))}},{key:"istext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISTEXT"),(function(e){return"string"==typeof e}))}},{key:"isnontext",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISNONTEXT"),(function(e){return!("string"==typeof e)}))}},{key:"column",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("COLUMN"),(function(){return t.col+1}),(function(e){return e.col+1}))}},{key:"columns",value:function(e,t){if(1!==e.args.length)return new Ho(Mo.NA,Ne.WrongArgNumber);if(e.args.some((function(e){return e.type===le.EMPTY})))return new Ho(Mo.NUM,Ne.EmptyArg);var n=e.args[0];return n.type===le.CELL_RANGE?n.end.col-n.start.col+1:new Ho(Mo.VALUE,Ne.CellRangeExpected)}},{key:"row",value:function(e,t){return this.runFunctionWithReferenceArgument(e.args,t,this.metadata("ROW"),(function(){return t.row+1}),(function(e){return e.row+1}))}},{key:"rows",value:function(e,t){if(1!==e.args.length)return new Ho(Mo.NA,Ne.WrongArgNumber);if(e.args.some((function(e){return e.type===le.EMPTY})))return new Ho(Mo.NUM,Ne.EmptyArg);var n=e.args[0];return n.type===le.CELL_RANGE?n.end.row-n.start.row+1:new Ho(Mo.VALUE,Ne.CellRangeExpected)}},{key:"index",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("INDEX"),(function(e,t,r){var o;if(r<1||t<1)return new Ho(Mo.VALUE,Ne.LessThanOne);if(r>e.width()||t>e.height())return new Ho(Mo.NUM,Ne.ValueLarge);var i=e.range();if(void 0===i)return null!==(o=e.topLeftCornerValue())&&void 0!==o?o:new Ho(Mo.VALUE,Ne.CellRangeExpected);var a=i.getAddress(r-1,t-1);return n.dependencyGraph.getScalarValue(a)}))}},{key:"na",value:function(e,t){return new Ho(Mo.NA)}},{key:"sheet",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:pl.STRING}]},(function(){return t.sheet+1}),(function(e){return e.sheet+1}),(function(e){var t=n.dependencyGraph.sheetMapping.get(e);return void 0!==t?t+1:new Ho(Mo.NA,Ne.SheetRef)}))}},{key:"sheets",value:function(e,t){var n=this;return this.runFunctionWithReferenceArgument(e.args,t,{parameters:[{argumentType:pl.STRING}]},(function(){return n.dependencyGraph.sheetMapping.numberOfSheets()}),(function(){return 1}),(function(){return new Ho(Mo.VALUE,Ne.CellRefExpected)}))}}])&&id(t.prototype,n),r&&id(t,r),i}(El);function fd(e){return(fd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function hd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function pd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dd(e,t){return(dd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function md(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=yd(e);if(t){var o=yd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return vd(this,n)}}function vd(e,t){return!t||"object"!==fd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function yd(e){return(yd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}ld.implementedFunctions={COLUMN:{method:"column",parameters:[{argumentType:pl.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},COLUMNS:{method:"columns",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ISBINARY:{method:"isbinary",parameters:[{argumentType:pl.STRING}]},ISERR:{method:"iserr",parameters:[{argumentType:pl.SCALAR}]},ISFORMULA:{method:"isformula",parameters:[{argumentType:pl.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},ISNA:{method:"isna",parameters:[{argumentType:pl.SCALAR}]},ISREF:{method:"isref",parameters:[{argumentType:pl.SCALAR}]},ISERROR:{method:"iserror",parameters:[{argumentType:pl.SCALAR}]},ISBLANK:{method:"isblank",parameters:[{argumentType:pl.SCALAR}]},ISNUMBER:{method:"isnumber",parameters:[{argumentType:pl.SCALAR}]},ISLOGICAL:{method:"islogical",parameters:[{argumentType:pl.SCALAR}]},ISTEXT:{method:"istext",parameters:[{argumentType:pl.SCALAR}]},ISNONTEXT:{method:"isnontext",parameters:[{argumentType:pl.SCALAR}]},INDEX:{method:"index",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:1}]},NA:{method:"na"},ROW:{method:"row",parameters:[{argumentType:pl.NOERROR,optional:!0}],isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},ROWS:{method:"rows",isDependentOnSheetStructureChange:!0,doesNotNeedArgumentsToBeComputed:!0},SHEET:{method:"sheet",parameters:[{argumentType:pl.NOERROR}],doesNotNeedArgumentsToBeComputed:!0},SHEETS:{method:"sheets",parameters:[{argumentType:pl.NOERROR}],doesNotNeedArgumentsToBeComputed:!0}};var gd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dd(e,t)}(i,e);var t,n,r,o=md(i);function i(){return hd(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"iseven",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISEVEN"),(function(e){return e%2==0}))}}])&&pd(t.prototype,n),r&&pd(t,r),i}(El);function bd(e){return(bd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ed(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sd(e,t){return(Sd=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Td(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Rd(e);if(t){var o=Rd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Od(this,n)}}function Od(e,t){return!t||"object"!==bd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Rd(e){return(Rd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}gd.implementedFunctions={ISEVEN:{method:"iseven",parameters:[{argumentType:pl.NUMBER}]}};var Nd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Sd(e,t)}(i,e);var t,n,r,o=Td(i);function i(){return Ed(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"isodd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ISODD"),(function(e){return e%2==1}))}}])&&wd(t.prototype,n),r&&wd(t,r),i}(El);function kd(e){return(kd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ad(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Cd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Md(e,t){return(Md=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=_d(e);if(t){var o=_d(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Id(this,n)}}function Id(e,t){return!t||"object"!==kd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _d(e){return(_d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Nd.implementedFunctions={ISODD:{method:"isodd",parameters:[{argumentType:pl.NUMBER}]}};var Pd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Md(e,t)}(i,e);var t,n,r,o=xd(i);function i(){return Ad(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"log10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG10"),Math.log10)}},{key:"log",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOG"),(function(e,t){return Math.log(e)/Math.log(t)}))}},{key:"ln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LN"),Math.log)}}])&&Cd(t.prototype,n),r&&Cd(t,r),i}(El);function Ld(e){return(Ld="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ud(e,t){return(Ud=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function jd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Vd(e);if(t){var o=Vd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Bd(this,n)}}function Bd(e,t){return!t||"object"!==Ld(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Vd(e){return(Vd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Pd.implementedFunctions={LOG10:{method:"log10",parameters:[{argumentType:pl.NUMBER}]},LOG:{method:"log",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,defaultValue:10,greaterThan:0}]},LN:{method:"ln",parameters:[{argumentType:pl.NUMBER}]}};var Hd=parseFloat(Math.PI.toFixed(14)),Gd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ud(e,t)}(i,e);var t,n,r,o=jd(i);function i(){return Fd(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"pi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PI"),(function(){return Hd}))}},{key:"sqrtpi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRTPI"),(function(e){return Math.sqrt(Hd*e)}))}}])&&Dd(t.prototype,n),r&&Dd(t,r),i}(El);function zd(e){return(zd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function $d(e,t){return($d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qd(e);if(t){var o=qd(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kd(this,n)}}function Kd(e,t){return!t||"object"!==zd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qd(e){return(qd=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Gd.implementedFunctions={PI:{method:"pi",parameters:[]},SQRTPI:{method:"sqrtpi",parameters:[{argumentType:pl.NUMBER,minValue:0}]}};var Xd=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$d(e,t)}(i,e);var t,n,r,o=Yd(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).createCpuKernel=function(e,t){return function(){for(var n=[],r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];for(var a=0;a<t.height;++a){n.push([]);for(var s=0;s<t.width;++s)n[a][s]=e.apply({thread:{x:s,y:a}},o)}return n}},t.createGpuJsKernel=function(e,n){return t.interpreter.getGpuInstance().createKernel(e).setPrecision("unsigned").setOutput([n.width,n.height])},void 0===t.config.gpujs?t.createKernel=t.createCpuKernel:t.createKernel=t.createGpuJsKernel,t}return t=i,(n=[{key:"mmult",value:function(e,t){var n=this;return this.runMatrixFunction(e.args,t,this.metadata("MMULT"),(function(e,t){if(!e.hasOnlyNumbers()||!t.hasOnlyNumbers())return new Ho(Mo.VALUE,Ne.NumberRange);var r=gr(e.size,t.size),o=n.createKernel((function(e,t,n){for(var r=0,o=0;o<n;++o)r+=e[this.thread.y][o]*t[o][this.thread.x];return r}),r)(e.rawNumbers(),t.rawNumbers(),e.width());return Qt.onlyNumbersDataWithoutRange(o,r)}))}},{key:"maxpool",value:function(e,t){var n=this;return this.runMatrixFunction(e.args,t,this.metadata("MAXPOOL"),(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new Ho(Mo.VALUE,Ne.NumberRange);var o=br(e.size,t,r),i=n.createKernel((function(e,t,n){for(var r=this.thread.x*n,o=this.thread.y*n,i=e[o][r],a=0;a<t;a++)for(var s=0;s<t;s++)i=Math.max(i,e[o+a][r+s]);return i}),o)(e.rawNumbers(),t,r);return Qt.onlyNumbersDataWithoutRange(i,o)}))}},{key:"medianpool",value:function(e,t){var n=this;return this.runMatrixFunction(e.args,t,this.metadata("MEDIANPOOL"),(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t;if(!e.hasOnlyNumbers())return new Ho(Mo.VALUE,Ne.NumberRange);var o=br(e.size,t,r),i=n.createKernel((function(e,t,n){for(var r=this.thread.x*n,o=this.thread.y*n,i=e[o][r],a=0;a<t;a++)for(var s=0;s<t;s++)i=Math.max(i,e[o+a][r+s]);for(var u=e[o][r],c=0;c<t;c++)for(var l=0;l<t;l++)u=Math.min(u,e[o+c][r+l]);for(var f=t*t,h=u,p=i,d=42,m=0;m<32;m++){for(var v=(h+p)/2,y=0,g=0;g<t;g++)for(var b=0;b<t;b++)e[o+g][r+b]>v&&y++;if(t%2==0){if(y===f/2){d=v;break}y>f/2?h=v:p=v}else{if(y===(f-1)/2){d=v;break}y>(f-1)/2?h=v:p=v}}return d}),o)(e.rawNumbers(),t,r);return Qt.onlyNumbersDataWithoutRange(i,o)}))}},{key:"transpose",value:function(e,t){return this.runMatrixFunction(e.args,t,this.metadata("TRANSPOSE"),(function(e){if(!e.hasOnlyNumbers())return new Ho(Mo.VALUE,Ne.NumberRange);for(var t=e.rawNumbers(),n=e.size,r=[],o=0;o<n.width;++o){r[o]=[];for(var i=0;i<n.height;++i)r[o][i]=t[i][o]}return Qt.onlyNumbersDataWithoutRange(r,yr(n))}))}}])&&Wd(t.prototype,n),r&&Wd(t,r),i}(El);function Jd(e){return(Jd="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qd(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zd(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function em(e,t){return(em=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function tm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=rm(e);if(t){var o=rm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return nm(this,n)}}function nm(e,t){return!t||"object"!==Jd(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function rm(e){return(rm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Xd.implementedFunctions={MMULT:{method:"mmult",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},TRANSPOSE:{method:"transpose",parameters:[{argumentType:pl.RANGE}]},MAXPOOL:{method:"maxpool",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0}]},MEDIANPOOL:{method:"medianpool",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0}]}};var om=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&em(e,t)}(i,e);var t,n,r,o=tm(i);function i(){return Qd(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"median",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MEDIAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);return o instanceof Ho?o:0===o.length?new Ho(Mo.NUM,Ne.OneValue):(o.sort((function(e,t){return e-t})),o.length%2==0?(o[o.length/2-1]+o[o.length/2])/2:o[Math.floor(o.length/2)])}))}},{key:"large",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("LARGE"),(function(e,t){var r=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof Ho?r:(r.sort((function(e,t){return e-t})),(t=Math.trunc(t))>r.length?new Ho(Mo.NUM,Ne.ValueLarge):r[r.length-t])}))}},{key:"small",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SMALL"),(function(e,t){var r=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());return r instanceof Ho?r:(r.sort((function(e,t){return e-t})),(t=Math.trunc(t))>r.length?new Ho(Mo.NUM,Ne.ValueLarge):r[t-1])}))}}])&&Zd(t.prototype,n),r&&Zd(t,r),i}(El);function im(e){return(im="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function am(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function sm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function um(e,t){return(um=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function cm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=fm(e);if(t){var o=fm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return lm(this,n)}}function lm(e,t){return!t||"object"!==im(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function fm(e){return(fm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}om.implementedFunctions={MEDIAN:{method:"median",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},LARGE:{method:"large",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER,minValue:1}]},SMALL:{method:"small",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER,minValue:1}]}};var hm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&um(e,t)}(i,e);var t,n,r,o=cm(i);function i(){return am(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"mod",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MOD"),(function(e,t){return 0===t?new Ho(Mo.DIV_BY_ZERO):e%t}))}}])&&sm(t.prototype,n),r&&sm(t,r),i}(El);function pm(e){return(pm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dm(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return mm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mm(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function mm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vm(e,t){return(vm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ym(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=bm(e);if(t){var o=bm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return gm(this,n)}}function gm(e,t){return!t||"object"!==pm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function bm(e){return(bm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Em(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function wm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Sm(e,t,n){return t&&wm(e.prototype,t),n&&wm(e,n),e}function Tm(e){return Bt(e)&&!Number.isFinite(xt(e))?0:e}hm.implementedFunctions={MOD:{method:"mod",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]}};var Om=function(){function e(t,n,r){Em(this,e),this.sumsq=t,this.sum=n,this.count=r}return Sm(e,[{key:"compose",value:function(t){return new e(this.sumsq+t.sumsq,this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}},{key:"varSValue",value:function(){return this.count>1?(this.sumsq-this.sum*this.sum/this.count)/(this.count-1):void 0}},{key:"varPValue",value:function(){return this.count>0?(this.sumsq-this.sum*this.sum/this.count)/this.count:void 0}}],[{key:"single",value:function(t){return new e(t*t,t,1)}}]),e}();Om.empty=new Om(0,0,0);var Rm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&vm(e,t)}(n,e);var t=ym(n);function n(){var e;return Em(this,n),(e=t.apply(this,arguments)).addWithEpsilonRaw=function(t,n){return e.interpreter.arithmeticHelper.addWithEpsilonRaw(t,n)},e}return Sm(n,[{key:"sum",value:function(e,t){return this.doSum(e.args,t)}},{key:"sumsq",value:function(e,t){return this.reduce(e.args,t,0,"SUMSQ",this.addWithEpsilonRaw,(function(e){return Math.pow(xt(e),2)}),Nm)}},{key:"max",value:function(e,t){return this.doMax(e.args,t)}},{key:"maxa",value:function(e,t){return Tm(this.reduce(e.args,t,Number.NEGATIVE_INFINITY,"MAXA",(function(e,t){return Math.max(e,t)}),xt,km))}},{key:"min",value:function(e,t){return this.doMin(e.args,t)}},{key:"mina",value:function(e,t){return Tm(this.reduce(e.args,t,Number.POSITIVE_INFINITY,"MINA",(function(e,t){return Math.min(e,t)}),xt,km))}},{key:"count",value:function(e,t){return this.doCount(e.args,t)}},{key:"counta",value:function(e,t){return this.doCounta(e.args,t)}},{key:"average",value:function(e,t){return this.doAverage(e.args,t)}},{key:"averagea",value:function(e,t){var n,r=this.reduce(e.args,t,Om.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return Om.single(xt(e))}),km);return r instanceof Ho?r:null!==(n=r.averageValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"vars",value:function(e,t){return this.doVarS(e.args,t)}},{key:"varp",value:function(e,t){return this.doVarP(e.args,t)}},{key:"vara",value:function(e,t){var n,r=this.reduceAggregateA(e.args,t);return r instanceof Ho?r:null!==(n=r.varSValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"varpa",value:function(e,t){var n,r=this.reduceAggregateA(e.args,t);return r instanceof Ho?r:null!==(n=r.varPValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"stdevs",value:function(e,t){return this.doStdevS(e.args,t)}},{key:"stdevp",value:function(e,t){return this.doStdevP(e.args,t)}},{key:"stdeva",value:function(e,t){var n=this.reduceAggregateA(e.args,t);if(n instanceof Ho)return n;var r=n.varSValue();return void 0===r?new Ho(Mo.DIV_BY_ZERO):Math.sqrt(r)}},{key:"stdevpa",value:function(e,t){var n=this.reduceAggregateA(e.args,t);if(n instanceof Ho)return n;var r=n.varPValue();return void 0===r?new Ho(Mo.DIV_BY_ZERO):Math.sqrt(r)}},{key:"product",value:function(e,t){return this.doProduct(e.args,t)}},{key:"subtotal",value:function(e,t){if(e.args.length<1)return new Ho(Mo.NA,Ne.WrongArgNumber);var n=this.coerceToType(this.evaluateAst(e.args[0],t),{argumentType:pl.NUMBER}),r=e.args.slice(1);switch(n){case 1:case 101:return this.doAverage(r,t);case 2:case 102:return this.doCount(r,t);case 3:case 103:return this.doCounta(r,t);case 4:case 104:return this.doMax(r,t);case 5:case 105:return this.doMin(r,t);case 6:case 106:return this.doProduct(r,t);case 7:case 107:return this.doStdevS(r,t);case 8:case 108:return this.doStdevP(r,t);case 9:case 109:return this.doSum(r,t);case 10:case 110:return this.doVarS(r,t);case 11:case 111:return this.doVarP(r,t);default:return new Ho(Mo.VALUE,Ne.BadMode)}}},{key:"reduceAggregate",value:function(e,t){return this.reduce(e,t,Om.empty,"_AGGREGATE",(function(e,t){return e.compose(t)}),(function(e){return Om.single(xt(e))}),Nm)}},{key:"reduceAggregateA",value:function(e,t){return this.reduce(e,t,Om.empty,"_AGGREGATE_A",(function(e,t){return e.compose(t)}),(function(e){return Om.single(xt(e))}),km)}},{key:"doAverage",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof Ho?r:null!==(n=r.averageValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"doVarS",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof Ho?r:null!==(n=r.varSValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"doVarP",value:function(e,t){var n,r=this.reduceAggregate(e,t);return r instanceof Ho?r:null!==(n=r.varPValue())&&void 0!==n?n:new Ho(Mo.DIV_BY_ZERO)}},{key:"doStdevS",value:function(e,t){var n=this.reduceAggregate(e,t);if(n instanceof Ho)return n;var r=n.varSValue();return void 0===r?new Ho(Mo.DIV_BY_ZERO):Math.sqrt(r)}},{key:"doStdevP",value:function(e,t){var n=this.reduceAggregate(e,t);if(n instanceof Ho)return n;var r=n.varPValue();return void 0===r?new Ho(Mo.DIV_BY_ZERO):Math.sqrt(r)}},{key:"doCount",value:function(e,t){return this.reduce(e,t,0,"COUNT",(function(e,t){return e+t}),xt,(function(e){return Bt(e)?1:0}))}},{key:"doCounta",value:function(e,t){return this.reduce(e,t,0,"COUNTA",(function(e,t){return e+t}),xt,(function(e){return e===Mt?0:1}))}},{key:"doMax",value:function(e,t){return Tm(this.reduce(e,t,Number.NEGATIVE_INFINITY,"MAX",(function(e,t){return Math.max(e,t)}),xt,Nm))}},{key:"doMin",value:function(e,t){return Tm(this.reduce(e,t,Number.POSITIVE_INFINITY,"MAX",(function(e,t){return Math.min(e,t)}),xt,Nm))}},{key:"doSum",value:function(e,t){return this.reduce(e,t,0,"SUM",this.addWithEpsilonRaw,xt,Nm)}},{key:"doProduct",value:function(e,t){return this.reduce(e,t,1,"PRODUCT",(function(e,t){return e*t}),xt,Nm)}},{key:"reduce",value:function(e,t,n,r,o,i,a){var s=this;return e.length<1?new Ho(Mo.NA,Ne.WrongArgNumber):e.reduce((function(e,n){if(e instanceof Ho)return e;if(n.type===le.CELL_RANGE||n.type===le.COLUMN_RANGE||n.type===le.ROW_RANGE)return s.evaluateRange(n,t,e,r,o,i,a);var u;if((u=s.evaluateAst(n,t))instanceof Qt)return Array.from(u.valuesFromTopLeftCorner()).map(a).filter((function(e){return void 0!==e})).map((function(e){return e instanceof Ho?e:i(e)})).reduce((function(e,t){return e instanceof Ho?e:t instanceof Ho?t:o(e,t)}),e);if(n.type===le.CELL_REFERENCE){if(void 0===(u=a(u)))return e}else if(u=s.coerceScalarToNumberOrError(u),void 0===(u=a(u)))return e;return u instanceof Ho?u:o(e,i(u))}),n)}},{key:"evaluateRange",value:function(e,t,n,r,o,i,a){var s;try{s=yt.fromAst(e,t)}catch(e){if(e.message===vt)return new Ho(Mo.REF,Ne.RangeManySheets);throw e}var u=s.start,c=s.end,l=this.dependencyGraph.getRange(u,c);h.a.ok(l,"Range does not exists in graph");var f=l.getFunctionValue(r);f||(f=this.getRangeValues(r,s,i,a).reduce((function(e,t){return e instanceof Ho?e:t instanceof Ho?t:o(e,t)}),n),l.setFunctionValue(r,f));return f}},{key:"getRangeValues",value:function(e,t,n,r){var o,i=[],a=this.dependencyGraph.rangeMapping.findSmallerRange(t),s=a.smallerRangeVertex,u=a.restRange,c=this.dependencyGraph.getRange(t.start,t.end);if(s&&this.dependencyGraph.existsEdge(s,c)){var l=s.getFunctionValue(e);if(l)i.push(l);else{var f,h=dm(s.range.addresses(this.dependencyGraph));try{for(h.s();!(f=h.n()).done;){var p=f.value,d=r(this.dependencyGraph.getScalarValue(p));d instanceof Ho?i.push(d):void 0!==d&&i.push(n(d))}}catch(e){h.e(e)}finally{h.f()}}o=u}else o=t;var m,v=dm(o.addresses(this.dependencyGraph));try{for(v.s();!(m=v.n()).done;){var y=m.value,g=r(this.dependencyGraph.getScalarValue(y));g instanceof Ho?i.push(g):void 0!==g&&i.push(n(g))}}catch(e){v.e(e)}finally{v.f()}return i}}]),n}(El);function Nm(e){return Bt(e)||e instanceof Ho?e:void 0}function km(e){return"boolean"==typeof e?Wi(e):Bt(e)||e instanceof Ho?e:"string"==typeof e?0:void 0}function Am(e){return(Am="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Cm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Mm(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xm(e,t){return(xm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Im(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pm(e);if(t){var o=Pm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return _m(this,n)}}function _m(e,t){return!t||"object"!==Am(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pm(e){return(Pm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Rm.implementedFunctions={SUM:{method:"sum"},SUMSQ:{method:"sumsq"},MAX:{method:"max"},MIN:{method:"min"},MAXA:{method:"maxa"},MINA:{method:"mina"},COUNT:{method:"count"},COUNTA:{method:"counta"},AVERAGE:{method:"average"},AVERAGEA:{method:"averagea"},PRODUCT:{method:"product"},"VAR.S":{method:"vars"},"VAR.P":{method:"varp"},VARA:{method:"vara"},VARPA:{method:"varpa"},"STDEV.S":{method:"stdevs"},"STDEV.P":{method:"stdevp"},STDEVA:{method:"stdeva"},STDEVPA:{method:"stdevpa"},SUBTOTAL:{method:"subtotal"}},Rm.aliases={VAR:"VAR.S",VARP:"VAR.P",STDEV:"STDEV.S",STDEVP:"STDEV.P",VARS:"VAR.S",STDEVS:"STDEV.S"};var Lm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&xm(e,t)}(i,e);var t,n,r,o=Im(i);function i(){return Cm(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"power",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POWER"),Math.pow)}}])&&Mm(t.prototype,n),r&&Mm(t,r),i}(El);function Fm(e){return(Fm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Dm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Um(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function jm(e,t){return(jm=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Bm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Hm(e);if(t){var o=Hm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Vm(this,n)}}function Vm(e,t){return!t||"object"!==Fm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Hm(e){return(Hm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Lm.implementedFunctions={POWER:{method:"power",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]}};var Gm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&jm(e,t)}(i,e);var t,n,r,o=Bm(i);function i(){return Dm(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"radians",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RADIANS"),(function(e){return e*(Math.PI/180)}))}}])&&Um(t.prototype,n),r&&Um(t,r),i}(El);function zm(e){return(zm="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Wm(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function $m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ym(e,t){return(Ym=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Km(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Xm(e);if(t){var o=Xm(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return qm(this,n)}}function qm(e,t){return!t||"object"!==zm(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Xm(e){return(Xm=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Gm.implementedFunctions={RADIANS:{method:"radians",parameters:[{argumentType:pl.NUMBER}]}};var Jm=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ym(e,t)}(i,e);var t,n,r,o=Km(i);function i(){return Wm(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"dec2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2BIN"),(function(e,t){return Zm(e,2,t)}))}},{key:"dec2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2OCT"),(function(e,t){return Zm(e,8,t)}))}},{key:"dec2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DEC2HEX"),(function(e,t){return Zm(e,16,t)}))}},{key:"bin2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2DEC"),(function(e){var t=Qm(e,2,10);return void 0===t?new Ho(Mo.NUM,Ne.NotBinary):rv(t,2)}))}},{key:"bin2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2OCT"),(function(e,t){var n=Qm(e,2,10);return void 0===n?new Ho(Mo.NUM,Ne.NotBinary):Zm(rv(n,2),8,t)}))}},{key:"bin2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BIN2HEX"),(function(e,t){var n=Qm(e,2,10);return void 0===n?new Ho(Mo.NUM,Ne.NotBinary):Zm(rv(n,2),16,t)}))}},{key:"oct2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2DEC"),(function(e){var t=Qm(e,8,10);return void 0===t?new Ho(Mo.NUM,Ne.NotOctal):rv(t,8)}))}},{key:"oct2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2BIN"),(function(e,t){var n=Qm(e,8,10);return void 0===n?new Ho(Mo.NUM,Ne.NotOctal):Zm(rv(n,8),2,t)}))}},{key:"oct2hex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("OCT2HEX"),(function(e,t){var n=Qm(e,8,10);return void 0===n?new Ho(Mo.NUM,Ne.NotOctal):Zm(rv(n,8),16,t)}))}},{key:"hex2dec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2DEC"),(function(e){var t=Qm(e,16,10);return void 0===t?new Ho(Mo.NUM,Ne.NotHex):rv(t,16)}))}},{key:"hex2bin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2BIN"),(function(e,t){var n=Qm(e,16,10);return void 0===n?new Ho(Mo.NUM,Ne.NotHex):Zm(rv(n,16),2,t)}))}},{key:"hex2oct",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HEX2OCT"),(function(e,t){var n=Qm(e,16,10);return void 0===n?new Ho(Mo.NUM,Ne.NotHex):Zm(rv(n,16),8,t)}))}},{key:"base",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BASE"),tv)}},{key:"decimal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("DECIMAL"),(function(e,t){var n=Qm(e,t,255);return void 0===n?new Ho(Mo.NUM,Ne.NotHex):parseInt(n,t)}))}}])&&$m(t.prototype,n),r&&$m(t,r),i}(El);function Qm(e,t,n){var r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".substr(0,t),o=new RegExp("^[".concat(r,"]+$"));if(!(e.length>n)&&o.test(e))return e}function Zm(e,t,n){if(e>function(e){return-ev(e)-1}(t))return new Ho(Mo.NUM,Ne.ValueBaseLarge);if(e<ev(t))return new Ho(Mo.NUM,Ne.ValueBaseSmall);var r=nv(e,t);return void 0===n||e<0?r:r.length>n?new Ho(Mo.NUM,Ne.ValueBaseLong):_i(r,n)}function ev(e){return-Math.pow(e,10)/2}function tv(e,t,n){var r=nv(e,t);return void 0!==n&&n>r.length?_i(r,n):r}function nv(e,t){return(e+(e<0?Math.pow(t,10):0)).toString(t).toUpperCase()}function rv(e,t){var n=parseInt(e,t),r=Math.pow(t,10);return n>=r/2?n-r:n}function ov(e){return(ov="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function iv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function av(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function sv(e,t){return(sv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function uv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=lv(e);if(t){var o=lv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return cv(this,n)}}function cv(e,t){return!t||"object"!==ov(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function lv(e){return(lv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Jm.implementedFunctions={DEC2BIN:{method:"dec2bin",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2OCT:{method:"dec2oct",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},DEC2HEX:{method:"dec2hex",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0,minValue:1,maxValue:10}]},BIN2DEC:{method:"bin2dec",parameters:[{argumentType:pl.STRING}]},BIN2OCT:{method:"bin2oct",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},BIN2HEX:{method:"bin2hex",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2DEC:{method:"oct2dec",parameters:[{argumentType:pl.STRING}]},OCT2BIN:{method:"oct2bin",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},OCT2HEX:{method:"oct2hex",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2DEC:{method:"hex2dec",parameters:[{argumentType:pl.STRING}]},HEX2BIN:{method:"hex2bin",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},HEX2OCT:{method:"hex2oct",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:10}]},DECIMAL:{method:"decimal",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,minValue:2,maxValue:36}]},BASE:{method:"base",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:2,maxValue:36},{argumentType:pl.NUMBER,optionalArg:!0,minValue:0,maxValue:255}]}};var fv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&sv(e,t)}(i,e);var t,n,r,o=uv(i);function i(){return iv(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"rand",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RAND"),Math.random)}},{key:"randbetween",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RANDBETWEEN"),(function(e,t){return t<e?new Ho(Mo.NUM,Ne.WrongOrder):((e=Math.ceil(e))===(t=Math.floor(t)+1)&&(t+=1),e+Math.floor(Math.random()*(t-e)))}))}}])&&av(t.prototype,n),r&&av(t,r),i}(El);function hv(e){return(hv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function pv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function mv(e,t){return(mv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function vv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=gv(e);if(t){var o=gv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return yv(this,n)}}function yv(e,t){return!t||"object"!==hv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function gv(e){return(gv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function bv(e){var t=Math.ceil(e);return t%2==1?t:t+1}function Ev(e){var t=Math.ceil(e);return t%2==0?t:t+1}fv.implementedFunctions={RAND:{method:"rand",parameters:[],isVolatile:!0},RANDBETWEEN:{method:"randbetween",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}],isVolatile:!0}};var wv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mv(e,t)}(i,e);var t,n,r,o=vv(i);function i(){return pv(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"roundup",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.ceil(-e*n)/n:Math.ceil(e*n)/n}))}},{key:"rounddown",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUNDDOWN"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.floor(-e*n)/n:Math.floor(e*n)/n}))}},{key:"round",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ROUND"),(function(e,t){var n=Math.pow(10,t);return e<0?-Math.round(-e*n)/n:Math.round(e*n)/n}))}},{key:"trunc",value:function(e,t){return this.rounddown(e,t)}},{key:"intFunc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("INT"),(function(e){return e<0?-Math.floor(-e):Math.floor(e)}))}},{key:"even",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EVEN"),(function(e){return e<0?-Ev(-e):Ev(e)}))}},{key:"odd",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ODD"),(function(e){return e<0?-bv(-e):bv(e)}))}},{key:"ceilingmath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.MATH"),(function(e,t,n){return 0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t=-t),Math.ceil(e/t)*t)}))}},{key:"ceiling",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING"),(function(e,t){return 0===e?0:0===t?new Ho(Mo.DIV_BY_ZERO):e>0&&t<0?new Ho(Mo.NUM,Ne.DistinctSigns):Math.ceil(e/t)*t}))}},{key:"ceilingprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CEILING.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.ceil(e/t)*t)}))}},{key:"floormath",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.MATH"),(function(e,t,n){return 0===t||0===e?0:(t=Math.abs(t),1===n&&e<0&&(t*=-1),Math.floor(e/t)*t)}))}},{key:"floor",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR"),(function(e,t){return 0===e?0:0===t?new Ho(Mo.DIV_BY_ZERO):e>0&&t<0?new Ho(Mo.NUM,Ne.DistinctSigns):Math.floor(e/t)*t}))}},{key:"floorprecise",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FLOOR.PRECISE"),(function(e,t){return 0===t||0===e?0:(t=Math.abs(t),Math.floor(e/t)*t)}))}}])&&dv(t.prototype,n),r&&dv(t,r),i}(El);function Sv(e){return(Sv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Tv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ov(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Rv(e,t){return(Rv=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Nv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Av(e);if(t){var o=Av(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kv(this,n)}}function kv(e,t){return!t||"object"!==Sv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Av(e){return(Av=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}wv.implementedFunctions={ROUNDUP:{method:"roundup",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0}]},ROUNDDOWN:{method:"rounddown",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0}]},ROUND:{method:"round",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0}]},TRUNC:{method:"trunc",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:0}]},INT:{method:"intFunc",parameters:[{argumentType:pl.NUMBER}]},EVEN:{method:"even",parameters:[{argumentType:pl.NUMBER}]},ODD:{method:"odd",parameters:[{argumentType:pl.NUMBER}]},"CEILING.MATH":{method:"ceilingmath",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:1},{argumentType:pl.NUMBER,defaultValue:0}]},CEILING:{method:"ceiling",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},"CEILING.PRECISE":{method:"ceilingprecise",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:1}]},"FLOOR.MATH":{method:"floormath",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:1},{argumentType:pl.NUMBER,defaultValue:0}]},FLOOR:{method:"floor",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},"FLOOR.PRECISE":{method:"floorprecise",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,defaultValue:1}]}},wv.aliases={"ISO.CEILING":"CEILING.PRECISE"};var Cv=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Rv(e,t)}(i,e);var t,n,r,o=Nv(i);function i(){return Tv(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"sqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SQRT"),Math.sqrt)}}])&&Ov(t.prototype,n),r&&Ov(t,r),i}(El);Cv.implementedFunctions={SQRT:{method:"sqrt",parameters:[{argumentType:pl.NUMBER}]}};var Mv=regeneratorRuntime.mark(xv);function xv(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),Mv)}var Iv=regeneratorRuntime.mark(Hv),_v=regeneratorRuntime.mark(Gv);function Pv(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||Fv(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lv(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=Fv(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Fv(e,t){if(e){if("string"==typeof e)return Dv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Dv(e,t):void 0}}function Dv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Uv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Bv=function(){function e(t,n,r,o,i){Uv(this,e),this.interpreter=t,this.cacheKey=n,this.reduceInitialValue=r,this.composeFunction=o,this.mapFunction=i,this.dependencyGraph=this.interpreter.dependencyGraph}var t,n,r;return t=e,(n=[{key:"compute",value:function(e,t){var n,r=this,o=Lv(t);try{for(o.s();!(n=o.n()).done;)if(!n.value.conditionRange.sameDimensionsAs(e))return new Ho(Mo.VALUE,Ne.EqualLength)}catch(e){o.e(e)}finally{o.f()}var i=this.tryToGetRangeVertexForRangeValue(e),a=t.map((function(e){return r.tryToGetRangeVertexForRangeValue(e.conditionRange)}));if(i&&a.every((function(e){return void 0!==e}))){var s=t.map((function(e){return e.criterionPackage.raw})).join(","),u=this.findAlreadyComputedValueInCache(i,this.cacheKey(t),s);if(u)return this.interpreter.stats.incrementCriterionFunctionFullCacheUsed(),u;var c=this.buildNewCriterionCache(this.cacheKey(t),t.map((function(e){return e.conditionRange.range()})),e.range());return c.has(s)||c.set(s,[this.evaluateRangeValue(e,t),t.map((function(e){return e.criterionPackage.lambda}))]),i.setCriterionFunctionValues(this.cacheKey(t),c),a.forEach((function(e){void 0!==e&&e.addDependentCacheRange(i)})),c.get(s)[0]}return this.evaluateRangeValue(e,t)}},{key:"tryToGetRangeVertexForRangeValue",value:function(e){var t=e.range();return void 0===t?void 0:this.dependencyGraph.getRange(t.start,t.end)}},{key:"reduceFunction",value:function(e){var t,n=this.reduceInitialValue,r=Lv(e);try{for(r.s();!(t=r.n()).done;){var o=t.value;n=this.composeFunction(n,o)}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"findAlreadyComputedValueInCache",value:function(e,t,n){return e.getCriterionFunctionValue(t,n)}},{key:"evaluateRangeValue",value:function(e,t){var n=t.map((function(e){return e.criterionPackage.lambda})),r=Array.from(e.valuesFromTopLeftCorner()).map(this.mapFunction)[Symbol.iterator](),o=Gv(n,t.map((function(e){return e.conditionRange.iterateValuesFromTopLeftCorner()})),r);return this.reduceFunction(o)}},{key:"buildNewCriterionCache",value:function(e,t,n){var r,o=this,i=this.dependencyGraph.getRange(n.start,n.end),a=function(e,t,n){if(n.end.row>n.start.row){var r=Yo(n.end.sheet,n.end.col,n.end.row-1),o=e.getRange(n.start,r);if(void 0!==o)return{smallerRangeVertex:o,restValuesRange:n.withStart(Yo(n.start.sheet,n.start.col,n.end.row)),restConditionRanges:t.map((function(e){return e.withStart(Yo(e.start.sheet,e.start.col,e.end.row))}))}}return{smallerRangeVertex:null,restValuesRange:n,restConditionRanges:t}}(this.dependencyGraph,t,n),s=a.smallerRangeVertex,u=a.restConditionRanges,c=a.restValuesRange;r=s&&this.dependencyGraph.existsEdge(s,i)?s.getCriterionFunctionValues(e):new Map;var l=new Map;return r.forEach((function(e,t){var n=Pv(e,2),r=n[0],i=n[1],a=Gv(i,u.map((function(e){return Hv(o.dependencyGraph,e)})),Array.from(Hv(o.dependencyGraph,c)).map(o.mapFunction)[Symbol.iterator]()),s=o.composeFunction(r,o.reduceFunction(a));o.interpreter.stats.incrementCriterionFunctionPartialCacheUsed(),l.set(t,[s,i])})),l}}])&&jv(t.prototype,n),r&&jv(t,r),e}(),Vv=function e(t,n){Uv(this,e),this.conditionRange=t,this.criterionPackage=n};function Hv(e,t){var n,r,o;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:n=Lv(t.addresses(e)),i.prev=1,n.s();case 3:if((r=n.n()).done){i.next=9;break}return o=r.value,i.next=7,xt(e.getScalarValue(o));case 7:i.next=3;break;case 9:i.next=14;break;case 11:i.prev=11,i.t0=i.catch(1),n.e(i.t0);case 14:return i.prev=14,n.f(),i.finish(14);case 17:case"end":return i.stop()}}),Iv,null,[[1,11,14,17]])}function Gv(e,t,n){var r,o,i,a;return regeneratorRuntime.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:r=Lv(n),s.prev=1,r.s();case 3:if((o=r.n()).done){s.next=15;break}if(i=o.value,(a=t.map((function(e){return t=e[Symbol.iterator](),n=t.next(),r=n.done,o=n.value,r?{rest:xv()}:{value:o,rest:t};var t,n,r,o}))).every((function(e){return Object.prototype.hasOwnProperty.call(e,"value")}))){s.next=8;break}return s.abrupt("return");case 8:if(!zv(a.map((function(e){return e.value})),e).every((function(e){var t=Pv(e,2),n=t[0];return(0,t[1])(n)}))){s.next=12;break}return s.next=12,i;case 12:t=a.map((function(e){return e.rest}));case 13:s.next=3;break;case 15:s.next=20;break;case 17:s.prev=17,s.t0=s.catch(1),r.e(s.t0);case 20:return s.prev=20,r.f(),s.finish(20);case 23:case"end":return s.stop()}}),_v,null,[[1,17,20,23]])}function zv(e,t){for(var n=[],r=0;r<Math.min(e.length,t.length);r++)n.push([e[r],t[r]]);return n}function Wv(e){return(Wv="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $v(e,t){return($v=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Yv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=qv(e);if(t){var o=qv(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Kv(this,n)}}function Kv(e,t){return!t||"object"!==Wv(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function qv(e){return(qv=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Xv(e){return function(e){if(Array.isArray(e))return Jv(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return Jv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Jv(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Jv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Qv(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Zv(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ey(e,t,n){return t&&Zv(e.prototype,t),n&&Zv(e,n),e}var ty=function(){function e(t,n){Qv(this,e),this.sum=t,this.count=n}return ey(e,[{key:"compose",value:function(t){return new e(this.sum+t.sum,this.count+t.count)}},{key:"averageValue",value:function(){return this.count>0?this.sum/this.count:void 0}}],[{key:"single",value:function(t){return new e(t,1)}}]),e}();function ny(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["SUMIF"].concat(Xv(t)).join(",")}function ry(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["AVERAGEIF"].concat(Xv(t)).join(",")}function oy(e){var t=e.map((function(e){return"".concat(e.conditionRange.range().sheet,",").concat(e.conditionRange.range().start.col,",").concat(e.conditionRange.range().start.row)}));return["COUNTIFS"].concat(Xv(t)).join(",")}ty.empty=new ty(0,0);var iy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$v(e,t)}(n,e);var t=Yv(n);function n(){return Qv(this,n),t.apply(this,arguments)}return ey(n,[{key:"sumif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMIF"),(function(e,t,r){var o=n.interpreter.criterionBuilder.fromCellValue(t,n.interpreter.arithmeticHelper);return void 0===o?new Ho(Mo.VALUE,Ne.BadCriterion):(r=null!=r?r:e,new Bv(n.interpreter,ny,0,(function(e,t){return n.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return xt(e)})).compute(r,[new Vv(e,o)]))}))}},{key:"sumifs",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMIFS"),(function(e){for(var t=[],r=0;r<(arguments.length<=1?0:arguments.length-1);r+=2){var o=r+1<1||arguments.length<=r+1?void 0:arguments[r+1],i=n.interpreter.criterionBuilder.fromCellValue(r+1+1<1||arguments.length<=r+1+1?void 0:arguments[r+1+1],n.interpreter.arithmeticHelper);if(void 0===i)return new Ho(Mo.VALUE,Ne.BadCriterion);t.push(new Vv(o,i))}return new Bv(n.interpreter,ny,0,(function(e,t){return n.interpreter.arithmeticHelper.nonstrictadd(e,t)}),(function(e){return xt(e)})).compute(e,t)}))}},{key:"averageif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("AVERAGEIF"),(function(e,t,r){var o=n.interpreter.criterionBuilder.fromCellValue(t,n.interpreter.arithmeticHelper);if(void 0===o)return new Ho(Mo.VALUE,Ne.BadCriterion);r=null!=r?r:e;var i=new Bv(n.interpreter,ry,ty.empty,(function(e,t){return e.compose(t)}),(function(e){return Bt(e)?ty.single(xt(e)):ty.empty})).compute(r,[new Vv(e,o)]);return i instanceof Ho?i:i.averageValue()||new Ho(Mo.DIV_BY_ZERO)}))}},{key:"countif",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("COUNTIF"),(function(e,t){var r=n.interpreter.criterionBuilder.fromCellValue(t,n.interpreter.arithmeticHelper);return void 0===r?new Ho(Mo.VALUE,Ne.BadCriterion):new Bv(n.interpreter,(function(){return"COUNTIF"}),0,(function(e,t){return e+t}),(function(){return 1})).compute(e,[new Vv(e,r)])}))}},{key:"countifs",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("COUNTIFS"),(function(){for(var e=[],t=0;t<arguments.length;t+=2){var r=t<0||arguments.length<=t?void 0:arguments[t],o=n.interpreter.criterionBuilder.fromCellValue(t+1<0||arguments.length<=t+1?void 0:arguments[t+1],n.interpreter.arithmeticHelper);if(void 0===o)return new Ho(Mo.VALUE,Ne.BadCriterion);e.push(new Vv(r,o))}return new Bv(n.interpreter,oy,0,(function(e,t){return e+t}),(function(){return 1})).compute(e[0].conditionRange,e)}))}}]),n}(El);function ay(e){return(ay="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function sy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function uy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function cy(e,t){return(cy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ly(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=hy(e);if(t){var o=hy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return fy(this,n)}}function fy(e,t){return!t||"object"!==ay(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function hy(e){return(hy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}iy.implementedFunctions={SUMIF:{method:"sumif",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NOERROR},{argumentType:pl.RANGE,optionalArg:!0}]},COUNTIF:{method:"countif",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NOERROR}]},AVERAGEIF:{method:"averageif",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NOERROR},{argumentType:pl.RANGE,optionalArg:!0}]},SUMIFS:{method:"sumifs",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE},{argumentType:pl.NOERROR}],repeatLastArgs:2},COUNTIFS:{method:"countifs",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NOERROR}],repeatLastArgs:2}};var py=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&cy(e,t)}(i,e);var t,n,r,o=ly(i);function i(){return sy(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"sumproduct",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SUMPRODUCT"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.VALUE,Ne.EqualLength);for(var r,o,i=0,a=e.iterateValuesFromTopLeftCorner(),s=t.iterateValuesFromTopLeftCorner();r=a.next(),o=s.next(),!r.done&&!o.done;){if(r.value instanceof Ho)return r.value;if(o.value instanceof Ho)return o.value;var u=n.coerceScalarToNumberOrError(r.value),c=n.coerceScalarToNumberOrError(o.value);Bt(u)&&Bt(c)&&(i+=xt(u)*xt(c))}return i}))}}])&&uy(t.prototype,n),r&&uy(t,r),i}(El);py.implementedFunctions={SUMPRODUCT:{method:"sumproduct",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]}};n("OM9Z");function dy(e){return(dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function my(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function vy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yy(e,t){return(yy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function gy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ey(e);if(t){var o=Ey(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return by(this,n)}}function by(e,t){return!t||"object"!==dy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ey(e){return(Ey=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var wy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&yy(e,t)}(i,e);var t,n,r,o=gy(i);function i(){return my(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"concatenate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONCATENATE"),(function(){var e;return(e="").concat.apply(e,arguments)}))}},{key:"split",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SPLIT"),(function(e,t){var n=e.split(" ");return t>=n.length||t<0?new Ho(Mo.VALUE,Ne.IndexBounds):n[t]}))}},{key:"len",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEN"),(function(e){return e.length}))}},{key:"lower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOWER"),(function(e){return e.toLowerCase()}))}},{key:"trim",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TRIM"),(function(e){return e.replace(/^ +| +$/g,"").replace(/ +/g," ")}))}},{key:"proper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PROPER"),(function(e){return e.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()}))}))}},{key:"clean",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CLEAN"),(function(e){return e.replace(/[\u0000-\u001F]/g,"")}))}},{key:"exact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXACT"),(function(e,t){return e===t}))}},{key:"rept",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPT"),(function(e,t){return t<0?new Ho(Mo.VALUE,Ne.NegativeCount):e.repeat(t)}))}},{key:"right",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RIGHT"),(function(e,t){return t<0?new Ho(Mo.VALUE,Ne.NegativeLength):0===t?"":e.slice(-t)}))}},{key:"left",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LEFT"),(function(e,t){return t<0?new Ho(Mo.VALUE,Ne.NegativeLength):e.slice(0,t)}))}},{key:"mid",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MID"),(function(e,t,n){return t<1?new Ho(Mo.VALUE,Ne.LessThanOne):n<0?new Ho(Mo.VALUE,Ne.NegativeLength):e.substring(t-1,t+n-1)}))}},{key:"replace",value:function(e,t){return this.runFunction(e.args,t,this.metadata("REPLACE"),(function(e,t,n,r){return t<1?new Ho(Mo.VALUE,Ne.LessThanOne):n<0?new Ho(Mo.VALUE,Ne.NegativeLength):e.substring(0,t-1)+r+e.substring(t+n-1)}))}},{key:"search",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SEARCH"),(function(e,t,r){if(r<1||r>t.length)return new Ho(Mo.VALUE,Ne.LengthBounds);var o,i=t.substring(r-1).toLowerCase();return o=n.interpreter.arithmeticHelper.requiresRegex(e)?n.interpreter.arithmeticHelper.searchString(e,i):i.indexOf(e.toLowerCase()),(o+=r)>0?o:new Ho(Mo.VALUE,Ne.PatternNotFound)}))}},{key:"substitute",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUBSTITUTE"),(function(e,t,n,r){var o,i=new RegExp(t,"g");if(void 0===r)return e.replace(i,n);if(r<1)return new Ho(Mo.VALUE,Ne.LessThanOne);for(var a=0;null!==(o=i.exec(e));)if(r===++a)return e.substring(0,o.index)+n+e.substring(i.lastIndex);return e}))}},{key:"find",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FIND"),(function(e,t,n){if(n<1||n>t.length)return new Ho(Mo.VALUE,Ne.IndexBounds);var r=t.substring(n-1).indexOf(e)+n;return r>0?r:new Ho(Mo.VALUE,Ne.PatternNotFound)}))}},{key:"t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T"),(function(e){return e instanceof Ho||"string"==typeof e?e:""}))}},{key:"upper",value:function(e,t){return this.runFunction(e.args,t,this.metadata("UPPER"),(function(e){return e.toUpperCase()}))}}])&&vy(t.prototype,n),r&&vy(t,r),i}(El);wy.implementedFunctions={CONCATENATE:{method:"concatenate",parameters:[{argumentType:pl.STRING}],repeatLastArgs:1,expandRanges:!0},EXACT:{method:"exact",parameters:[{argumentType:pl.STRING},{argumentType:pl.STRING}]},SPLIT:{method:"split",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER}]},LEN:{method:"len",parameters:[{argumentType:pl.STRING}]},LOWER:{method:"lower",parameters:[{argumentType:pl.STRING}]},MID:{method:"mid",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},TRIM:{method:"trim",parameters:[{argumentType:pl.STRING}]},T:{method:"t",parameters:[{argumentType:pl.SCALAR}]},PROPER:{method:"proper",parameters:[{argumentType:pl.STRING}]},CLEAN:{method:"clean",parameters:[{argumentType:pl.STRING}]},REPT:{method:"rept",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER}]},RIGHT:{method:"right",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,defaultValue:1}]},LEFT:{method:"left",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER,defaultValue:1}]},REPLACE:{method:"replace",parameters:[{argumentType:pl.STRING},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.STRING}]},SEARCH:{method:"search",parameters:[{argumentType:pl.STRING},{argumentType:pl.STRING},{argumentType:pl.NUMBER,defaultValue:1}]},SUBSTITUTE:{method:"substitute",parameters:[{argumentType:pl.STRING},{argumentType:pl.STRING},{argumentType:pl.STRING},{argumentType:pl.NUMBER,optionalArg:!0}]},FIND:{method:"find",parameters:[{argumentType:pl.STRING},{argumentType:pl.STRING},{argumentType:pl.NUMBER,defaultValue:1}]},UPPER:{method:"upper",parameters:[{argumentType:pl.STRING}]}};n("AmFO"),n("eajv"),n("/5zm"),n("Uydy"),n("eJiR"),n("n/mU");function Sy(e){return(Sy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Ty(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Oy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ry(e,t){return(Ry=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Ny(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ay(e);if(t){var o=Ay(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ky(this,n)}}function ky(e,t){return!t||"object"!==Sy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ay(e){return(Ay=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Cy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ry(e,t)}(i,e);var t,n,r,o=Ny(i);function i(){return Ty(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"acos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOS"),Math.acos)}},{key:"asin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASIN"),Math.asin)}},{key:"cos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COS"),Math.cos)}},{key:"sin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIN"),Math.sin)}},{key:"tan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TAN"),Math.tan)}},{key:"atan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN"),Math.atan)}},{key:"atan2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATAN2"),(function(e,t){return 0===e&&0===t?new Ho(Mo.DIV_BY_ZERO):Math.atan2(t,e)}))}},{key:"cot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COT"),(function(e){return 0===e?new Ho(Mo.DIV_BY_ZERO):1/Math.tan(e)}))}},{key:"acot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOT"),(function(e){return 0===e?Hd/2:Math.atan(1/e)}))}},{key:"sec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SEC"),(function(e){return 1/Math.cos(e)}))}},{key:"csc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSC"),(function(e){return 0===e?new Ho(Mo.DIV_BY_ZERO):1/Math.sin(e)}))}},{key:"sinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SINH"),Math.sinh)}},{key:"asinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ASINH"),Math.asinh)}},{key:"cosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COSH"),Math.cosh)}},{key:"acosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOSH"),Math.acosh)}},{key:"tanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TANH"),Math.tanh)}},{key:"atanh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ATANH"),Math.atanh)}},{key:"coth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COTH"),(function(e){return 0===e?new Ho(Mo.DIV_BY_ZERO):1/Math.tanh(e)}))}},{key:"acoth",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ACOTH"),(function(e){return 0===e?new Ho(Mo.NUM,Ne.NonZero):Math.atanh(1/e)}))}},{key:"sech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SECH"),(function(e){return 1/Math.cosh(e)}))}},{key:"csch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CSCH"),(function(e){return 0===e?new Ho(Mo.DIV_BY_ZERO):1/Math.sinh(e)}))}}])&&Oy(t.prototype,n),r&&Oy(t,r),i}(El);function My(e){return(My="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Iy(e,t){return(Iy=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ly(e);if(t){var o=Ly(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Py(this,n)}}function Py(e,t){return!t||"object"!==My(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ly(e){return(Ly=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Cy.implementedFunctions={ACOS:{method:"acos",parameters:[{argumentType:pl.NUMBER}]},ASIN:{method:"asin",parameters:[{argumentType:pl.NUMBER}]},COS:{method:"cos",parameters:[{argumentType:pl.NUMBER}]},SIN:{method:"sin",parameters:[{argumentType:pl.NUMBER}]},TAN:{method:"tan",parameters:[{argumentType:pl.NUMBER}]},ATAN:{method:"atan",parameters:[{argumentType:pl.NUMBER}]},ATAN2:{method:"atan2",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},COT:{method:"cot",parameters:[{argumentType:pl.NUMBER}]},SEC:{method:"sec",parameters:[{argumentType:pl.NUMBER}]},CSC:{method:"csc",parameters:[{argumentType:pl.NUMBER}]},SINH:{method:"sinh",parameters:[{argumentType:pl.NUMBER}]},COSH:{method:"cosh",parameters:[{argumentType:pl.NUMBER}]},TANH:{method:"tanh",parameters:[{argumentType:pl.NUMBER}]},COTH:{method:"coth",parameters:[{argumentType:pl.NUMBER}]},SECH:{method:"sech",parameters:[{argumentType:pl.NUMBER}]},CSCH:{method:"csch",parameters:[{argumentType:pl.NUMBER}]},ACOT:{method:"acot",parameters:[{argumentType:pl.NUMBER}]},ASINH:{method:"asinh",parameters:[{argumentType:pl.NUMBER}]},ACOSH:{method:"acosh",parameters:[{argumentType:pl.NUMBER}]},ATANH:{method:"atanh",parameters:[{argumentType:pl.NUMBER}]},ACOTH:{method:"acoth",parameters:[{argumentType:pl.NUMBER}]}};var Fy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Iy(e,t)}(i,e);var t,n,r,o=_y(i);function i(e,t){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(n=o.call(this,t)).config=e,n.dependencyGraph=t,n}return t=i,(n=[{key:"find",value:function(e,t,n){if("string"==typeof e&&(e=sa(e)),t.width()<this.config.binarySearchThreshold||!n){var r=this.dependencyGraph.computeListOfValuesInRange(t).map(xt).map((function(e){return"string"==typeof e?sa(e):e})).indexOf(e);return r<0?r:r+t.start.col}return Qu(t,e,this.dependencyGraph,"col")}}])&&xy(t.prototype,n),r&&xy(t,r),i}(tc);function Dy(e){return(Dy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Uy(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function jy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function By(e,t){return(By=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Vy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Gy(e);if(t){var o=Gy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Hy(this,n)}}function Hy(e,t){return!t||"object"!==Dy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Gy(e){return(Gy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var zy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&By(e,t)}(i,e);var t,n,r,o=Vy(i);function i(){var e;return Uy(this,i),(e=o.apply(this,arguments)).rowSearch=new Fy(e.config,e.dependencyGraph),e}return t=i,(n=[{key:"vlookup",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("VLOOKUP"),(function(e,t,r,o){var i=t.range();return void 0===i?new Ho(Mo.VALUE,Ne.WrongType):r<1?new Ho(Mo.VALUE,Ne.LessThanOne):r>i.width()?new Ho(Mo.REF,Ne.IndexLarge):n.doVlookup(Ki(e),i,r-1,o)}))}},{key:"hlookup",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("HLOOKUP"),(function(e,t,r,o){var i=t.range();return void 0===i?new Ho(Mo.VALUE,Ne.WrongType):r<1?new Ho(Mo.VALUE,Ne.LessThanOne):r>i.height()?new Ho(Mo.REF,Ne.IndexLarge):n.doHlookup(Ki(e),i,r-1,o)}))}},{key:"match",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("MATCH"),(function(e,t,r){var o=t.range();return void 0===o?new Ho(Mo.VALUE,Ne.WrongType):n.doMatch(Ki(e),o,r)}))}},{key:"doVlookup",value:function(e,t,n,r){this.dependencyGraph.stats.start(qt.VLOOKUP);var o=yt.spanFrom(t.start,1,t.height()),i=this.searchInRange(e,o,r,this.columnSearch);if(this.dependencyGraph.stats.end(qt.VLOOKUP),-1===i)return new Ho(Mo.NA,Ne.ValueNotFound);var a=Yo(t.sheet,t.start.col+n,i),s=this.dependencyGraph.getCellValue(a);return s instanceof Qt?new Ho(Mo.VALUE,Ne.WrongType):s}},{key:"doHlookup",value:function(e,t,n,r){var o=yt.spanFrom(t.start,t.width(),1),i=this.searchInRange(e,o,r,this.rowSearch);if(-1===i)return new Ho(Mo.NA,Ne.ValueNotFound);var a=Yo(t.sheet,i,t.start.row+n),s=this.dependencyGraph.getCellValue(a);return s instanceof Qt?new Ho(Mo.VALUE,Ne.WrongType):s}},{key:"doMatch",value:function(e,t,n){if(t.width()>1&&t.height()>1)return new Ho(Mo.NA);if(1===t.width()){var r=this.columnSearch.find(e,t,0!==n);return-1===r?new Ho(Mo.NA,Ne.ValueNotFound):r-t.start.row+1}var o=this.rowSearch.find(e,t,0!==n);return-1===o?new Ho(Mo.NA,Ne.ValueNotFound):o-t.start.col+1}},{key:"searchInRange",value:function(e,t,n,r){return!n&&"string"==typeof e&&this.interpreter.arithmeticHelper.requiresRegex(e)?r.advancedFind(this.interpreter.arithmeticHelper.eqMatcherFunction(e),t):r.find(e,t,n)}}])&&jy(t.prototype,n),r&&jy(t,r),i}(El);function Wy(e){return(Wy="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Yy(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ky(e,t){return(Ky=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function qy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Jy(e);if(t){var o=Jy(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Xy(this,n)}}function Xy(e,t){return!t||"object"!==Wy(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Jy(e){return(Jy=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}zy.implementedFunctions={VLOOKUP:{method:"vlookup",parameters:[{argumentType:pl.NOERROR},{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.BOOLEAN,defaultValue:!0}]},HLOOKUP:{method:"hlookup",parameters:[{argumentType:pl.NOERROR},{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.BOOLEAN,defaultValue:!0}]},MATCH:{method:"match",parameters:[{argumentType:pl.NOERROR},{argumentType:pl.RANGE},{argumentType:pl.NUMBER,defaultValue:1}]}};var Qy=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ky(e,t)}(i,e);var t,n,r,o=qy(i);function i(){return $y(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"roman",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("ROMAN"),(function(e,t){return e=Math.trunc(e),!1===t?t=4:!0===t&&(t=0),(t=xt(n.coerceScalarToNumberOrError(t)))instanceof Ho?t:(t=Math.trunc(t))<0?new Ho(Mo.VALUE,Ne.ValueSmall):t>4?new Ho(Mo.VALUE,Ne.ValueLarge):function(e,t){var n={val:e%1e3,acc:"M".repeat(Math.floor(e/1e3))};return 4===t&&(eg(n,"IM",999,1e3),eg(n,"ID",499,500)),t>=3&&(eg(n,"VM",995,1e3),eg(n,"VD",495,500)),t>=2&&(eg(n,"XM",990,1e3),eg(n,"XD",490,500)),t>=1&&(eg(n,"LM",950,1e3),eg(n,"LD",450,500)),eg(n,"CM",900,1e3),eg(n,"CD",400,500),eg(n,"D",500,900),n.acc+="C".repeat(Math.floor(n.val/100)),n.val%=100,t>=2&&(eg(n,"IC",99,100),eg(n,"IL",49,50)),t>=1&&(eg(n,"VC",95,100),eg(n,"VL",45,50)),eg(n,"XC",90,100),eg(n,"XL",40,50),eg(n,"L",50,90),n.acc+="X".repeat(Math.floor(n.val/10)),n.val%=10,eg(n,"IX",9,10),eg(n,"IV",4,5),eg(n,"V",5,9),n.acc+="I".repeat(n.val),n.acc}(e,t)}))}},{key:"arabic",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ARABIC"),(function(e){var t=!1;if((e=e.trim().toUpperCase()).startsWith("-")&&(t=!0,""===(e=e.slice(1))))return new Ho(Mo.VALUE,Ne.InvalidRoman);var n={input:e,acc:0};return Zy(n,{token:"MMM",val:3e3},{token:"MM",val:2e3},{token:"M",val:1e3}),Zy(n,{token:"IM",val:999},{token:"VM",val:995},{token:"XM",val:990},{token:"LM",val:950},{token:"CM",val:900}),Zy(n,{token:"D",val:500},{token:"ID",val:499},{token:"VD",val:495},{token:"XD",val:490},{token:"LD",val:450},{token:"CD",val:400}),Zy(n,{token:"CCC",val:300},{token:"CC",val:200},{token:"C",val:100}),Zy(n,{token:"IC",val:99},{token:"VC",val:95},{token:"XC",val:90}),Zy(n,{token:"L",val:50},{token:"IL",val:49},{token:"VL",val:45},{token:"XL",val:40}),Zy(n,{token:"XXX",val:30},{token:"XX",val:20},{token:"X",val:10}),Zy(n,{token:"IX",val:9}),Zy(n,{token:"V",val:5},{token:"IV",val:4}),Zy(n,{token:"III",val:3},{token:"II",val:2},{token:"I",val:1}),""!==n.input?new Ho(Mo.VALUE,Ne.InvalidRoman):t?-n.acc:n.acc}))}}])&&Yy(t.prototype,n),r&&Yy(t,r),i}(El);function Zy(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var o=0,i=n;o<i.length;o++){var a=i[o];if(e.input.startsWith(a.token)){e.input=e.input.slice(a.token.length),e.acc+=a.val;break}}}function eg(e,t,n,r){e.val>=n&&e.val<r&&(e.val-=n,e.acc+=t)}function tg(e){return(tg="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ng(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rg(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function og(e,t){return(og=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ig(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sg(e);if(t){var o=sg(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ag(this,n)}}function ag(e,t){return!t||"object"!==tg(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sg(e){return(sg=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Qy.implementedFunctions={ROMAN:{method:"roman",parameters:[{argumentType:pl.NUMBER,minValue:1,lessThan:4e3},{argumentType:pl.NOERROR,optionalArg:!0,defaultValue:0}]},ARABIC:{method:"arabic",parameters:[{argumentType:pl.STRING}]}};var ug=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&og(e,t)}(i,e);var t,n,r,o=ig(i);function i(){return ng(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"add",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.ADD"),this.interpreter.arithmeticHelper.addWithEpsilon)}},{key:"concat",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.CONCAT"),this.interpreter.arithmeticHelper.concat)}},{key:"divide",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.DIVIDE"),this.interpreter.arithmeticHelper.divide)}},{key:"eq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.EQ"),this.interpreter.arithmeticHelper.eq)}},{key:"gt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GT"),this.interpreter.arithmeticHelper.gt)}},{key:"gte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.GTE"),this.interpreter.arithmeticHelper.geq)}},{key:"lt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LT"),this.interpreter.arithmeticHelper.lt)}},{key:"lte",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.LTE"),this.interpreter.arithmeticHelper.leq)}},{key:"minus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MINUS"),this.interpreter.arithmeticHelper.subtract)}},{key:"multiply",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.MULTIPLY"),this.interpreter.arithmeticHelper.multiply)}},{key:"ne",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.NE"),this.interpreter.arithmeticHelper.neq)}},{key:"pow",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.POW"),this.interpreter.arithmeticHelper.pow)}},{key:"uminus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UMINUS"),this.interpreter.arithmeticHelper.unaryMinus)}},{key:"upercent",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UNARY_PERCENT"),this.interpreter.arithmeticHelper.unaryPercent)}},{key:"uplus",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HF.UPLUS"),this.interpreter.arithmeticHelper.unaryPlus)}}])&&rg(t.prototype,n),r&&rg(t,r),i}(El);ug.implementedFunctions={"HF.ADD":{method:"add",parameters:[{argumentType:pl.NUMBER,passSubtype:!0},{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.CONCAT":{method:"concat",parameters:[{argumentType:pl.STRING,passSubtype:!0},{argumentType:pl.STRING,passSubtype:!0}]},"HF.DIVIDE":{method:"divide",parameters:[{argumentType:pl.NUMBER,passSubtype:!0},{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.EQ":{method:"eq",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.GT":{method:"gt",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.GTE":{method:"gte",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.LT":{method:"lt",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.LTE":{method:"lte",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.MINUS":{method:"minus",parameters:[{argumentType:pl.NUMBER,passSubtype:!0},{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.MULTIPLY":{method:"multiply",parameters:[{argumentType:pl.NUMBER,passSubtype:!0},{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.NE":{method:"ne",parameters:[{argumentType:pl.NOERROR,passSubtype:!0},{argumentType:pl.NOERROR,passSubtype:!0}]},"HF.POW":{method:"pow",parameters:[{argumentType:pl.NUMBER,passSubtype:!0},{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.UMINUS":{method:"uminus",parameters:[{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.UNARY_PERCENT":{method:"upercent",parameters:[{argumentType:pl.NUMBER,passSubtype:!0}]},"HF.UPLUS":{method:"uplus",parameters:[{argumentType:pl.NUMBER,passSubtype:!0}]}};var cg=Math;function lg(e,t){for(var n=0,r=0;n<e.length;++n)r=t*r+e[n];return r}function fg(e,t,n,r,o){if(0===t)return n;if(1===t)return r;for(var i=2/e,a=r,s=1;s<t;++s)a=r*s*i+o*n,n=r,r=a;return a}function hg(e,t,n,r,o){return function(n,i){if(r){if(0===n)return 1==r?-1/0:1/0;if(n<0)return NaN}return 0===i?e(n):1===i?t(n):i<0?NaN:fg(n,i|=0,e(n),t(n),o)}}var pg,dg,mg,vg,yg,gg,bg,Eg,wg,Sg,Tg,Og,Rg,Ng=function(){var e=.636619772,t=[57568490574,-13362590354,651619640.7,-11214424.18,77392.33017,-184.9052456].reverse(),n=[57568490411,1029532985,9494680.718,59272.64853,267.8532712,1].reverse(),r=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),o=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34935152e-8].reverse();function i(i){var a=0,s=0,u=0,c=i*i;if(i<8)a=(s=lg(t,c))/(u=lg(n,c));else{var l=i-.785398164;s=lg(r,c=64/c),u=lg(o,c),a=cg.sqrt(e/i)*(cg.cos(l)*s-cg.sin(l)*u*8/i)}return a}var a=[72362614232,-7895059235,242396853.1,-2972611.439,15704.4826,-30.16036606].reverse(),s=[144725228442,2300535178,18583304.74,99447.43394,376.9991397,1].reverse(),u=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),c=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse();function l(t){var n=0,r=0,o=0,i=t*t,l=cg.abs(t)-2.356194491;return Math.abs(t)<8?n=(r=t*lg(a,i))/(o=lg(s,i)):(r=lg(u,i=64/i),o=lg(c,i),n=cg.sqrt(e/cg.abs(t))*(cg.cos(l)*r-cg.sin(l)*o*8/cg.abs(t)),t<0&&(n=-n)),n}return function e(t,n){if(n=Math.round(n),!isFinite(t))return isNaN(t)?t:0;if(n<0)return(n%2?-1:1)*e(t,-n);if(t<0)return(n%2?-1:1)*e(-t,n);if(0===n)return i(t);if(1===n)return l(t);if(0===t)return 0;var r=0;if(t>n)r=fg(t,n,i(t),l(t),-1);else{for(var o=!1,a=0,s=0,u=1,c=0,f=2/t,h=2*cg.floor((n+cg.floor(cg.sqrt(40*n)))/2);h>0;h--)c=h*f*u-a,a=u,u=c,cg.abs(u)>1e10&&(u*=1e-10,a*=1e-10,r*=1e-10,s*=1e-10),o&&(s+=u),o=!o,h==n&&(r=a);r/=s=2*s-u}return r}}(),kg=(pg=.636619772,dg=[-2957821389,7062834065,-512359803.6,10879881.29,-86327.92757,228.4622733].reverse(),mg=[40076544269,745249964.8,7189466.438,47447.2647,226.1030244,1].reverse(),vg=[1,-.001098628627,2734510407e-14,-2073370639e-15,2.093887211e-7].reverse(),yg=[-.01562499995,.0001430488765,-6911147651e-15,7.621095161e-7,-9.34945152e-8].reverse(),gg=[-4900604943e3,127527439e4,-51534381390,734926455.1,-4237922.726,8511.937935].reverse(),bg=[249958057e5,424441966400,3733650367,22459040.02,102042.605,354.9632885,1].reverse(),Eg=[1,.00183105,-3516396496e-14,2457520174e-15,-2.40337019e-7].reverse(),wg=[.04687499995,-.0002002690873,8449199096e-15,-8.8228987e-7,1.05787412e-7].reverse(),hg((function(e){var t=0,n=0,r=0,o=e*e,i=e-.785398164;return e<8?t=(n=lg(dg,o))/(r=lg(mg,o))+pg*Ng(e,0)*cg.log(e):(n=lg(vg,o=64/o),r=lg(yg,o),t=cg.sqrt(pg/e)*(cg.sin(i)*n+cg.cos(i)*r*8/e)),t}),(function(e){var t=0,n=0,r=0,o=e*e,i=e-2.356194491;return e<8?t=(n=e*lg(gg,o))/(r=lg(bg,o))+pg*(Ng(e,1)*cg.log(e)-1/e):(n=lg(Eg,o=64/o),r=lg(wg,o),t=cg.sqrt(pg/e)*(cg.sin(i)*n+cg.cos(i)*r*8/e)),t}),0,1,-1)),Ag=(Sg=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),Tg=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),Og=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),Rg=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function e(t,n){if(0===(n=Math.round(n)))return function(e){return e<=3.75?lg(Sg,e*e/14.0625):cg.exp(cg.abs(e))/cg.sqrt(cg.abs(e))*lg(Tg,3.75/cg.abs(e))}(t);if(1===n)return function(e){return e<3.75?e*lg(Og,e*e/14.0625):(e<0?-1:1)*cg.exp(cg.abs(e))/cg.sqrt(cg.abs(e))*lg(Rg,3.75/cg.abs(e))}(t);if(n<0)return NaN;if(0===cg.abs(t))return 0;if(t==1/0)return 1/0;var r,o=0,i=2/cg.abs(t),a=0,s=1,u=0;for(r=2*cg.round((n+cg.round(cg.sqrt(40*n)))/2);r>0;r--)u=r*i*s+a,a=s,s=u,cg.abs(s)>1e10&&(s*=1e-10,a*=1e-10,o*=1e-10),r==n&&(o=a);return o*=e(t,0)/s,t<0&&n%2?-o:o}),Cg=function(){var e=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),t=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse();var n=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),r=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return hg((function(n){return n<=2?-cg.log(n/2)*Ag(n,0)+lg(e,n*n/4):cg.exp(-n)/cg.sqrt(n)*lg(t,2/n)}),(function(e){return e<=2?cg.log(e/2)*Ag(e,1)+1/e*lg(n,e*e/4):cg.exp(-e)/cg.sqrt(e)*lg(r,2/e)}),0,2,1)}();function Mg(e){var t,n,r,o,i=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,1.5626441722e-8,-8.5238095915e-8,6.529054439e-9,5.059343495e-9,-9.91364156e-10,-2.27365122e-10,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],a=i.length-1,s=!1,u=0,c=0;if(0===e)return 0;for(e<0&&(e=-e,s=!0),n=4*(t=2/(2+e))-2;a>0;a--)r=u,u=n*u-c+i[a],c=r;return o=t*Math.exp(-e*e+.5*(i[0]+n*u)-c),s?o-1:1-o}function xg(e){return 1-Mg(e)}function Ig(e){var t,n,r,o,i=0;if(e>=2)return-100;if(e<=0)return 100;for(o=e<1?e:2-e,t=-.70711*((2.30753+.27061*(r=Math.sqrt(-2*Math.log(o/2))))/(1+r*(.99229+.04481*r))-r);i<2;i++)t+=(n=xg(t)-o)/(1.1283791670955126*Math.exp(-t*t)-t*n);return e<1?t:-t}var _g=function(e,t){return e<0?0:t*Math.exp(-t*e)},Pg=function(e,t){return e<0?0:1-Math.exp(-t*e)};function Lg(e){var t,n,r,o,i=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],a=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],s=!1,u=0,c=0,l=0,f=e;if(e>171.6243769536076)return 1/0;if(f<=0){if(!(o=f%1))return 1/0;s=(1&f?-1:1)*Math.PI/Math.sin(Math.PI*o),f=1-f}for(r=f,n=f<1?f++:(f-=u=(0|f)-1)-1,t=0;t<8;++t)l=(l+i[t])*n,c=c*n+a[t];if(o=l/c+1,r<f)o/=r;else if(r>f)for(t=0;t<u;++t)o*=f,f++;return s&&(o=s/o),o}var Fg=function(e,t,n){return e<0?0:0===e&&1===t?1/n:Math.exp((t-1)*Math.log(e)-e/n-jg(t)-t*Math.log(n))},Dg=function(e,t,n){return e<0?0:Bg(t,e/n)},Ug=function(e,t,n){return Vg(e,t)*n};function jg(e){var t,n,r,o=0,i=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(n=t=e)+5.5,r-=(t+.5)*Math.log(r);o<6;o++)a+=i[o]/++n;return Math.log(2.5066282746310007*a/t)-r}function Bg(e,t){var n,r=jg(e),o=e,i=1/e,a=i,s=t+1-e,u=1/1e-30,c=1/s,l=c,f=1,h=-~(8.5*Math.log(e>=1?e:1/e)+.4*e+17);if(t<0||e<=0)return NaN;if(t<e+1){for(;f<=h;f++)i+=a*=t/++o;return i*Math.exp(-t+e*Math.log(t)-r)}for(;f<=h;f++)l*=(c=1/(c=(n=-f*(f-e))*c+(s+=2)))*(u=s+n/u);return 1-l*Math.exp(-t+e*Math.log(t)-r)}function Vg(e,t){var n,r,o,i,a,s,u=0,c=t-1,l=jg(t);if(e>=1)return Math.max(100,t+100*Math.sqrt(t));if(e<=0)return 0;for(t>1?(a=Math.log(c),s=Math.exp(c*(a-1)-l),i=e<.5?e:1-e,n=(2.30753+.27061*(r=Math.sqrt(-2*Math.log(i))))/(1+r*(.99229+.04481*r))-r,e<.5&&(n=-n),n=Math.max(.001,t*Math.pow(1-1/(9*t)-n/(3*Math.sqrt(t)),3))):n=e<(r=1-t*(.253+.12*t))?Math.pow(e/r,1/t):1-Math.log(1-(e-r)/(1-r));u<12;u++){if(n<=0)return 0;if((n-=r=(o=(Bg(t,n)-e)/(r=t>1?s*Math.exp(-(n-c)+c*(Math.log(n)-a)):Math.exp(-n+c*Math.log(n)-l)))/(1-.5*Math.min(1,o*((t-1)/n-1))))<=0&&(n=.5*(n+r)),Math.abs(r)<1e-8*n)break}return n}var Hg=function(e,t,n){return Math.exp(-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(e-t,2)/(2*n*n))},Gg=function(e,t,n){return.5*(1+Mg((e-t)/Math.sqrt(2*n*n)))},zg=function(e,t,n){return-1.4142135623730951*n*Ig(2*e)+t},Wg=function(e,t,n){return e>1||e<0?0:1==t&&1==n?1:t<512&&n<512?Math.pow(e,t-1)*Math.pow(1-e,n-1)/Kg(t,n):Math.exp((t-1)*Math.log(e)+(n-1)*Math.log(1-e)-qg(t,n))},$g=function(e,t,n){return e>1||e<0?+(e>1):Jg(e,t,n)},Yg=function(e,t,n){return Xg(e,t,n)};function Kg(e,t){if(!(e<=0||t<=0))return e+t>170?Math.exp(qg(e,t)):Lg(e)*Lg(t)/Lg(e+t)}function qg(e,t){return jg(e)+jg(t)-jg(e+t)}function Xg(e,t,n){var r,o,i,a,s,u,c,l,f,h,p=t-1,d=n-1,m=0;if(e<=0)return 0;if(e>=1)return 1;for(t>=1&&n>=1?(i=e<.5?e:1-e,u=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,e<.5&&(u=-u),c=(u*u-3)/6,l=2/(1/(2*t-1)+1/(2*n-1)),f=u*Math.sqrt(c+l)/l-(1/(2*n-1)-1/(2*t-1))*(c+5/6-2/(3*l)),u=t/(t+n*Math.exp(2*f))):(r=Math.log(t/(t+n)),o=Math.log(n/(t+n)),u=e<(a=Math.exp(t*r)/t)/(f=a+(s=Math.exp(n*o)/n))?Math.pow(t*f*e,1/t):1-Math.pow(n*f*(1-e),1/n)),h=-jg(t)-jg(n)+jg(t+n);m<10;m++){if(0===u||1===u)return u;if((u-=a=(s=(Jg(u,t,n)-e)/(a=Math.exp(p*Math.log(u)+d*Math.log(1-u)+h)))/(1-.5*Math.min(1,s*(p/u-d/(1-u)))))<=0&&(u=.5*(u+a)),u>=1&&(u=.5*(u+a+1)),Math.abs(a)<1e-8*u&&m>0)break}return u}function Jg(e,t,n){var r=0===e||1===e?0:Math.exp(jg(t+n)-jg(t)-jg(n)+t*Math.log(e)+n*Math.log(1-e));return!(e<0||e>1)&&(e<(t+1)/(t+n+2)?r*Qg(e,t,n)/t:1-r*Qg(1-e,n,t)/n)}function Qg(e,t,n){var r,o,i,a,s=1,u=t+n,c=t+1,l=t-1,f=1,h=1-u*e/c;for(Math.abs(h)<1e-30&&(h=1e-30),a=h=1/h;s<=100&&(h=1+(o=s*(n-s)*e/((l+(r=2*s))*(t+r)))*h,Math.abs(h)<1e-30&&(h=1e-30),f=1+o/f,Math.abs(f)<1e-30&&(f=1e-30),a*=(h=1/h)*f,h=1+(o=-(t+s)*(u+s)*e/((t+r)*(c+r)))*h,Math.abs(h)<1e-30&&(h=1e-30),f=1+o/f,Math.abs(f)<1e-30&&(f=1e-30),a*=i=(h=1/h)*f,!(Math.abs(i-1)<3e-7));s++);return a}var Zg=function(e,t,n){return 0===n||1===n?t*n===e?1:0:nb(t,e)*Math.pow(n,e)*Math.pow(1-n,t-e)},eb=function(e,t,n){var r;if(e<0)return 0;if(e>=t)return 1;if(n<0||n>1||t<=0)return NaN;var o=n,i=(e=Math.floor(e))+1,a=t-e,s=i+a,u=Math.exp(jg(s)-jg(a)-jg(i)+i*Math.log(o)+a*Math.log(1-o));return r=o<(i+1)/(s+2)?u*tb(o,i,a,1e-10):1-u*tb(1-o,a,i,1e-10),Math.round(1/1e-10*(1-r))/(1/1e-10)};function tb(e,t,n,r){for(var o,i=0,a=1,s=1,u=1,c=0,l=0;Math.abs((s-l)/s)>r;)l=s,a=u+(o=-(t+c)*(t+n+c)*e/(t+2*c)/(t+2*c+1))*a,s=(i=s+o*i)+(o=(c+=1)*(n-c)*e/(t+2*c-1)/(t+2*c))*s,i/=u=a+o*u,a/=u,s/=u,u=1;return s/t}function nb(e,t){return e>170||t>170?Math.exp(function(e,t){return rb(e)-rb(t)-rb(e-t)}(e,t)):ob(e)/ob(t)/ob(e-t)}function rb(e){return e<0?NaN:jg(e+1)}function ob(e){return e<0?NaN:Lg(e+1)}var ib=function(e,t){return e<0?0:0===e&&2===t?.5:Math.exp((t/2-1)*Math.log(e)-e/2-t/2*Math.log(2)-jg(t/2))},ab=function(e,t){return e<0?0:Bg(t/2,e/2)},sb=function(e,t){return 2*Vg(e,.5*t)},ub=function(e,t,n){return e<0?0:t<=2?0===e&&t<2?1/0:0===e&&2===t?1:1/Kg(t/2,n/2)*Math.pow(t/n,t/2)*Math.pow(e,t/2-1)*Math.pow(1+t/n*e,-(t+n)/2):t*(n/(n+e*t))/2*Zg((t-2)/2,(t+n-2)/2,t*e/(n+e*t))},cb=function(e,t,n){return e<0?0:Jg(t*e/(t*e+n),t/2,n/2)},lb=function(e,t,n){return n/(t*(1/Xg(e,t/2,n/2)-1))},fb=function(e,t,n){return e<0||t<0||n<0?0:n/t*Math.pow(e/t,n-1)*Math.exp(-Math.pow(e/t,n))},hb=function(e,t,n){return e<0?0:1-Math.exp(-Math.pow(e/t,n))},pb={pdf:function(e,t){return t<0||e%1!=0||e<0?0:Math.pow(t,e)*Math.exp(-t)/ob(e)},cdf:function(e,t){var n=0;if(e<0)return 0;for(var r=0;n<=e;n++)r+=pb.pdf(n,t);return r}},db={pdf:function(e,t,n,r){if(e<0||e<n-(t-r))return 0;if(e>r||e>n)return 0;if(2*n>t)return 2*r>t?db.pdf(t-n-r+e,t,t-n,t-r):db.pdf(r-e,t,t-n,r);if(2*r>t)return db.pdf(n-e,t,n,t-r);if(n<r)return db.pdf(e,t,r,n);for(var o=1,i=0,a=0;a<e;a++){for(;o>1&&i<r;)o*=1-n/(t-i),i++;o*=(r-a)*(n-a)/((a+1)*(t-n-r+a+1))}for(;i<r;i++)o*=1-n/(t-i);return Math.min(1,Math.max(0,o))},cdf:function e(t,n,r,o){if(t<0||t<r-(n-o))return 0;if(t>=o||t>=r)return 1;if(2*r>n)return 2*o>n?e(n-r-o+t,n,n-r,n-o):1-db.cdf(o-t-1,n,n-r,o);if(2*o>n)return 1-db.cdf(r-t-1,n,r,n-o);if(r<o)return db.cdf(t,n,o,r);for(var i=1,a=1,s=0,u=0;u<t;u++){for(;i>1&&s<o;){var c=1-r/(n-s);a*=c,i*=c,s++}i+=a*=(o-u)*(r-u)/((u+1)*(n-r-o+u+1))}for(;s<o;s++)i*=1-r/(n-s);return Math.min(1,Math.max(0,i))}},mb=function(e,t){return t=t>1e100?1e100:t,1/(Math.sqrt(t)*Kg(.5,t/2))*Math.pow(1+e*e/t,-(t+1)/2)},vb=function(e,t){var n=t/2;return Jg((e+Math.sqrt(e*e+t))/(2*Math.sqrt(e*e+t)),n,n)},yb=function(e,t){var n=Xg(2*Math.min(e,1-e),.5*t,.5);return n=Math.sqrt(t*(1-n)/n),e>.5?n:-n},gb=function(e,t,n){return e<=0?0:Math.exp(-Math.log(e)-.5*Math.log(2*Math.PI)-Math.log(n)-Math.pow(Math.log(e)-t,2)/(2*n*n))},bb=function(e,t,n){return e<0?0:.5+.5*Mg((Math.log(e)-t)/Math.sqrt(2*n*n))},Eb=function(e,t,n){return Math.exp(-1.4142135623730951*n*Ig(2*e)+t)},wb={pdf:function(e,t,n){return e===e>>>0&&(e<0?0:nb(e+t-1,t-1)*Math.pow(1-n,e)*Math.pow(n,t))},cdf:function(e,t,n){var r=0,o=0;if(e<0)return 0;for(;o<=e;o++)r+=wb.pdf(o,t,n);return r}};function Sb(e){for(var t=0,n=e.length;--n>=0;)t+=e[n];return t}function Tb(e){return Sb(e)/e.length}function Ob(e){for(var t,n=Tb(e),r=0,o=e.length;--o>=0;)r+=(t=e[o]-n)*t;return r}function Rb(e,t){return Ob(e)/(e.length-(t?1:0))}function Nb(e,t){return Math.sqrt(Rb(e,t))}function kb(e){return Math.pow(function(e){for(var t=1,n=e.length;--n>=0;)t*=e[n];return t}(e),1/e.length)}function Ab(e,t){var n,r=Tb(e),o=Tb(t),i=e.length,a=new Array(i);for(n=0;n<i;n++)a[n]=(e[n]-r)*(t[n]-o);return Sb(a)/(i-1)}function Cb(e,t){return Ab(e,t)/Nb(e,1)/Nb(t,1)}function Mb(e){return(Mb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ib(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _b(e,t){return(_b=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Pb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Fb(e);if(t){var o=Fb(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Lb(this,n)}}function Lb(e,t){return!t||"object"!==Mb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Fb(e){return(Fb=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Db=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_b(e,t)}(i,e);var t,n,r,o=Pb(i);function i(){return xb(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"erf",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERF"),(function(e,t){return void 0===t?Mg(e):Mg(t)-Mg(e)}))}},{key:"erfc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("ERFC"),xg)}},{key:"expondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("EXPON.DIST"),(function(e,t,n){return n?Pg(e,t):_g(e,t)}))}},{key:"fisher",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHER"),(function(e){return Math.log((1+e)/(1-e))/2}))}},{key:"fisherinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FISHERINV"),(function(e){return 1-2/(Math.exp(2*e)+1)}))}},{key:"gamma",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA"),Lg)}},{key:"gammadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.DIST"),(function(e,t,n,r){return r?Dg(e,t,n):Fg(e,t,n)}))}},{key:"gammaln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMALN"),jg)}},{key:"gammainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAMMA.INV"),Ug)}},{key:"gauss",value:function(e,t){return this.runFunction(e.args,t,this.metadata("GAUSS"),(function(e){return Gg(e,0,1)-.5}))}},{key:"betadist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.DIST"),(function(e,t,n,r,o,i){return e<=o?new Ho(Mo.NUM,Ne.ValueSmall):e>=i?new Ho(Mo.NUM,Ne.ValueLarge):(e=(e-o)/(i-o),r?$g(e,t,n):Wg(e,t,n))}))}},{key:"betainv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BETA.INV"),(function(e,t,n,r,o){return r>=o?new Ho(Mo.NUM,Ne.WrongOrder):Yg(e,t,n)*(o-r)+r}))}},{key:"binomialdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.DIST"),(function(e,t,n,r){return e>t?new Ho(Mo.NUM,Ne.WrongOrder):(e=Math.trunc(e),t=Math.trunc(t),r?eb(e,t,n):Zg(e,t,n))}))}},{key:"binomialinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BINOM.INV"),(function(e,t,n){for(var r=-1,o=e=Math.trunc(e);o>r+1;){var i=Math.trunc((r+o)/2);eb(i,e,t)>=n?o=i:r=i}return o}))}},{key:"besselifn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELI"),(function(e,t){return Ag(e,Math.trunc(t))}))}},{key:"besseljfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELJ"),(function(e,t){return Ng(e,Math.trunc(t))}))}},{key:"besselkfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELK"),(function(e,t){return Cg(e,Math.trunc(t))}))}},{key:"besselyfn",value:function(e,t){return this.runFunction(e.args,t,this.metadata("BESSELY"),(function(e,t){return kg(e,Math.trunc(t))}))}},{key:"chisqdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST"),(function(e,t,n){return t=Math.trunc(t),n?ab(e,t):ib(e,t)}))}},{key:"chisqdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.DIST.RT"),(function(e,t){return 1-ab(e,Math.trunc(t))}))}},{key:"chisqinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV"),(function(e,t){return sb(e,Math.trunc(t))}))}},{key:"chisqinvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.INV.RT"),(function(e,t){return sb(1-e,Math.trunc(t))}))}},{key:"fdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST"),(function(e,t,n,r){return t=Math.trunc(t),n=Math.trunc(n),r?cb(e,t,n):ub(e,t,n)}))}},{key:"fdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.DIST.RT"),(function(e,t,n){return 1-cb(e,Math.trunc(t),Math.trunc(n))}))}},{key:"finv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV"),(function(e,t,n){return lb(e,Math.trunc(t),Math.trunc(n))}))}},{key:"finvrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("F.INV.RT"),(function(e,t,n){return lb(1-e,Math.trunc(t),Math.trunc(n))}))}},{key:"weibulldist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("WEIBULL.DIST"),(function(e,t,n,r){return r?hb(e,n,t):fb(e,n,t)}))}},{key:"poissondist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("POISSON.DIST"),(function(e,t,n){return e=Math.trunc(e),n?pb.cdf(e,t):pb.pdf(e,t)}))}},{key:"hypgeomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("HYPGEOM.DIST"),(function(e,t,n,r,o){return e>t||e>n||t>r||n>r||e+r<n+t?new Ho(Mo.NUM,Ne.ValueLarge):(e=Math.trunc(e),t=Math.trunc(t),n=Math.trunc(n),r=Math.trunc(r),o?db.cdf(e,r,n,t):db.pdf(e,r,n,t))}))}},{key:"tdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST"),(function(e,t,n){return t=Math.trunc(t),n?vb(e,t):mb(e,t)}))}},{key:"tdist2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.2T"),(function(e,t){return 2*(1-vb(e,Math.trunc(t)))}))}},{key:"tdistrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.DIST.RT"),(function(e,t){return 1-vb(e,Math.trunc(t))}))}},{key:"tdistold",value:function(e,t){return this.runFunction(e.args,t,this.metadata("TDIST"),(function(e,t,n){return n*(1-vb(e,Math.trunc(t)))}))}},{key:"tinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV"),(function(e,t){return yb(e,Math.trunc(t))}))}},{key:"tinv2t",value:function(e,t){return this.runFunction(e.args,t,this.metadata("T.INV.2T"),(function(e,t){return yb(1-e/2,Math.trunc(t))}))}},{key:"lognormdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.DIST"),(function(e,t,n,r){return r?bb(e,t,n):gb(e,t,n)}))}},{key:"lognorminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("LOGNORM.INV"),(function(e,t,n){return Eb(e,t,n)}))}},{key:"normdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.DIST"),(function(e,t,n,r){return r?Gg(e,t,n):Hg(e,t,n)}))}},{key:"norminv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.INV"),(function(e,t,n){return zg(e,t,n)}))}},{key:"normsdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.DIST"),(function(e,t){return t?Gg(e,0,1):Hg(e,0,1)}))}},{key:"normsinv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NORM.S.INV"),(function(e){return zg(e,0,1)}))}},{key:"phi",value:function(e,t){return this.runFunction(e.args,t,this.metadata("PHI"),(function(e){return Hg(e,0,1)}))}},{key:"negbinomdist",value:function(e,t){return this.runFunction(e.args,t,this.metadata("NEGBINOM.DIST"),(function(e,t,n,r){return e=Math.trunc(e),t=Math.trunc(t),r?wb.cdf(e,t,n):wb.pdf(e,t,n)}))}},{key:"confidencenorm",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.NORM"),(function(e,t,n){return function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(zg(t[1]/2,0,1)*t[2]/Math.sqrt(t[3])):Math.abs(zg(t[1]/2,0,1)*Nb(t[2])/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,Math.trunc(n))[1]-1}))}},{key:"confidencet",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CONFIDENCE.T"),(function(e,t,n){return 1===(n=Math.trunc(n))?new Ho(Mo.DIV_BY_ZERO):function(){var e,t=[].slice.call(arguments),n=new Array(2);return e=4===t.length?Math.abs(yb(t[1]/2,t[3]-1)*t[2]/Math.sqrt(t[3])):Math.abs(yb(t[1]/2,t[2].length-1)*Nb(t[2],!0)/Math.sqrt(t[2].length)),n[0]=t[0]-e,n[1]=t[0]+e,n}(1,e,t,n)[1]-1}))}},{key:"standardize",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STANDARDIZE"),(function(e,t,n){return(e-t)/n}))}}])&&Ib(t.prototype,n),r&&Ib(t,r),i}(El);Db.implementedFunctions={ERF:{method:"erf",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0}]},ERFC:{method:"erfc",parameters:[{argumentType:pl.NUMBER}]},"EXPON.DIST":{method:"expondist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},FISHER:{method:"fisher",parameters:[{argumentType:pl.NUMBER,greaterThan:-1,lessThan:1}]},FISHERINV:{method:"fisherinv",parameters:[{argumentType:pl.NUMBER}]},GAMMA:{method:"gamma",parameters:[{argumentType:pl.NUMBER}]},"GAMMA.DIST":{method:"gammadist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},GAMMALN:{method:"gammaln",parameters:[{argumentType:pl.NUMBER,greaterThan:0}]},"GAMMA.INV":{method:"gammainv",parameters:[{argumentType:pl.NUMBER,minValue:0,lessThan:1},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0}]},GAUSS:{method:"gauss",parameters:[{argumentType:pl.NUMBER}]},"BETA.DIST":{method:"betadist",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:1}]},"BETA.INV":{method:"betainv",parameters:[{argumentType:pl.NUMBER,greaterThan:0,maxValue:1},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,defaultValue:0},{argumentType:pl.NUMBER,defaultValue:1}]},"BINOM.DIST":{method:"binomialdist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.BOOLEAN}]},"BINOM.INV":{method:"binomialinv",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.NUMBER,greaterThan:0,lessThan:1}]},BESSELI:{method:"besselifn",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},BESSELJ:{method:"besseljfn",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},BESSELK:{method:"besselkfn",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},BESSELY:{method:"besselyfn",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:0}]},"CHISQ.DIST":{method:"chisqdist",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:1,maxValue:1e10},{argumentType:pl.BOOLEAN}]},"CHISQ.DIST.RT":{method:"chisqdistrt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV":{method:"chisqinv",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.NUMBER,minValue:1,maxValue:1e10}]},"CHISQ.INV.RT":{method:"chisqinvrt",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.NUMBER,minValue:1}]},"F.DIST":{method:"fdist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.BOOLEAN}]},"F.DIST.RT":{method:"fdistrt",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.NUMBER,minValue:1}]},"F.INV":{method:"finv",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.NUMBER,minValue:1}]},"F.INV.RT":{method:"finvrt",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.NUMBER,minValue:1}]},"WEIBULL.DIST":{method:"weibulldist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},"POISSON.DIST":{method:"poissondist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.BOOLEAN}]},"HYPGEOM.DIST":{method:"hypgeomdist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},"T.DIST":{method:"tdist",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.BOOLEAN}]},"T.DIST.2T":{method:"tdist2t",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1}]},"T.DIST.RT":{method:"tdistrt",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,minValue:1}]},TDIST:{method:"tdistold",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.INTEGER,minValue:1,maxValue:2}]},"T.INV":{method:"tinv",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1},{argumentType:pl.NUMBER,minValue:1}]},"T.INV.2T":{method:"tinv2t",parameters:[{argumentType:pl.NUMBER,greaterThan:0,maxValue:1},{argumentType:pl.NUMBER,minValue:1}]},"LOGNORM.DIST":{method:"lognormdist",parameters:[{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},"LOGNORM.INV":{method:"lognorminv",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0}]},"NORM.DIST":{method:"normdist",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.BOOLEAN}]},"NORM.INV":{method:"norminv",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0}]},"NORM.S.DIST":{method:"normsdist",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.BOOLEAN}]},"NORM.S.INV":{method:"normsinv",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1}]},PHI:{method:"phi",parameters:[{argumentType:pl.NUMBER}]},"NEGBINOM.DIST":{method:"negbinomdist",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:1},{argumentType:pl.NUMBER,minValue:0,maxValue:1},{argumentType:pl.BOOLEAN}]},"CONFIDENCE.NORM":{method:"confidencenorm",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,minValue:1}]},"CONFIDENCE.T":{method:"confidencet",parameters:[{argumentType:pl.NUMBER,greaterThan:0,lessThan:1},{argumentType:pl.NUMBER,greaterThan:0},{argumentType:pl.NUMBER,minValue:1}]},STANDARDIZE:{method:"standardize",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,greaterThan:0}]}},Db.aliases={NEGBINOMDIST:"NEGBINOM.DIST",EXPONDIST:"EXPON.DIST",BETADIST:"BETA.DIST",NORMDIST:"NORM.DIST",NORMINV:"NORM.INV",NORMSDIST:"NORM.S.DIST",NORMSINV:"NORM.S.INV",LOGNORMDIST:"LOGNORM.DIST",LOGINV:"LOGNORM.INV",TINV:"T.INV.2T",HYPGEOMDIST:"HYPGEOM.DIST",POISSON:"POISSON.DIST",WEIBULL:"WEIBULL.DIST",FINV:"F.INV.RT",FDIST:"F.DIST.RT",CHIDIST:"CHISQ.DIST.RT",CHIINV:"CHISQ.INV.RT",GAMMADIST:"GAMMA.DIST","GAMMALN.PRECISE":"GAMMALN",GAMMAINV:"GAMMA.INV",BETAINV:"BETA.INV",BINOMDIST:"BINOM.DIST",CONFIDENCE:"CONFIDENCE.NORM",CRITBINOM:"BINOM.INV",WEIBULLDIST:"WEIBULL.DIST",TINV2T:"T.INV.2T",TDISTRT:"T.DIST.RT",TDIST2T:"T.DIST.2T",FINVRT:"F.INV.RT",FDISTRT:"F.DIST.RT",CHIDISTRT:"CHISQ.DIST.RT",CHIINVRT:"CHISQ.INV.RT",LOGNORMINV:"LOGNORM.INV",POISSONDIST:"POISSON.DIST"};n("r/Vq");function Ub(e){return(Ub="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function jb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Bb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Vb(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Hb(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Gb(e,t){return(Gb=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function zb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=$b(e);if(t){var o=$b(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Wb(this,n)}}function Wb(e,t){return!t||"object"!==Ub(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function $b(e){return($b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Yb=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Gb(e,t)}(i,e);var t,n,r,o=zb(i);function i(){return Vb(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"fact",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACT"),(function(e){e=Math.trunc(e);for(var t=1,n=1;n<=e;n++)t*=n;return t}))}},{key:"factdouble",value:function(e,t){return this.runFunction(e.args,t,this.metadata("FACTDOUBLE"),(function(e){for(var t=1,n=e=Math.trunc(e);n>=1;n-=2)t*=n;return t}))}},{key:"combin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBIN"),(function(e,t){return t>e?new Ho(Mo.NUM,Ne.WrongOrder):Kb(e=Math.trunc(e),t=Math.trunc(t))}))}},{key:"combina",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMBINA"),(function(e,t){return(e=Math.trunc(e))+(t=Math.trunc(t))-1>=1030?new Ho(Mo.NUM,Ne.ValueLarge):0===e&&0===t?1:Kb(e+t-1,t)}))}},{key:"gcd",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("GCD"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(o instanceof Ho)return o;var i,a=0,s=jb(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u<0)return new Ho(Mo.NUM,Ne.ValueSmall);a=qb(a,Math.trunc(u))}}catch(e){s.e(e)}finally{s.f()}return a>Number.MAX_SAFE_INTEGER?new Ho(Mo.NUM,Ne.ValueLarge):a}))}},{key:"lcm",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("LCM"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersCoerceRangesDropNulls(t);if(o instanceof Ho)return o;var i,a=1,s=jb(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;if(u<0)return new Ho(Mo.NUM,Ne.ValueSmall);a=Xb(a,Math.trunc(u))}}catch(e){s.e(e)}finally{s.f()}return a>Number.MAX_SAFE_INTEGER?new Ho(Mo.NUM,Ne.ValueLarge):a}))}},{key:"mround",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MROUND"),(function(e,t){return 0===t?0:e>0&&t<0||e<0&&t>0?new Ho(Mo.NUM,Ne.DistinctSigns):Math.round(e/t)*t}))}},{key:"multinomial",value:function(e,t){return this.runFunction(e.args,t,this.metadata("MULTINOMIAL"),(function(){for(var e=0,t=1,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];for(var i=0,a=r;i<a.length;i++){var s=a[i];if(s<0)return new Ho(Mo.NUM,Ne.ValueSmall);s=Math.trunc(s);for(var u=1;u<=s;u++)t*=(e+u)/u;e+=s}return Math.round(t)}))}},{key:"quotient",value:function(e,t){return this.runFunction(e.args,t,this.metadata("QUOTIENT"),(function(e,t){return 0===t?new Ho(Mo.DIV_BY_ZERO):Math.trunc(e/t)}))}},{key:"seriessum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SERIESSUM"),(function(e,t,r,o){var i=n.interpreter.arithmeticHelper.manyToOnlyNumbersDropNulls(o.valuesFromTopLeftCorner());if(i instanceof Ho)return i;var a=0;i.reverse();var s,u=jb(i);try{for(u.s();!(s=u.n()).done;){var c=s.value;a*=Math.pow(e,r),a+=c}}catch(e){u.e(e)}finally{u.f()}return a*Math.pow(e,t)}))}},{key:"sign",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SIGN"),(function(e){return e>0?1:e<0?-1:0}))}},{key:"sumx2my2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2MY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new Ho(Mo.NA,Ne.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof Ho)return s;if(u instanceof Ho)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s,2)-Math.pow(u,2))}return i}))}},{key:"sumx2py2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMX2PY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new Ho(Mo.NA,Ne.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof Ho)return s;if(u instanceof Ho)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s,2)+Math.pow(u,2))}return i}))}},{key:"sumxmy2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SUMXMY2"),(function(e,t){var n=e.valuesFromTopLeftCorner(),r=t.valuesFromTopLeftCorner();if(n.length!==r.length)return new Ho(Mo.NA,Ne.EqualLength);for(var o=n.length,i=0,a=0;a<o;a++){var s=n[a],u=r[a];if(s instanceof Ho)return s;if(u instanceof Ho)return u;"number"==typeof s&&"number"==typeof u&&(i+=Math.pow(s-u,2))}return i}))}}])&&Hb(t.prototype,n),r&&Hb(t,r),i}(El);function Kb(e,t){2*t>e&&(t=e-t);for(var n=1,r=1;r<=t;r++)n*=(e-t+r)/r;return Math.round(n)}function qb(e,t){if(e<t){var n=[t,e];e=n[0],t=n[1]}for(;t>0;){var r=[t,e%t];e=r[0],t=r[1]}return e}function Xb(e,t){return 0===e||0===t?0:e*(t/qb(e,t))}function Jb(e){return(Jb="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Qb(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=eE(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function Zb(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=e&&("undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==n)return;var r,o,i=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(r=n.next()).done)&&(i.push(r.value),!t||i.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return i}(e,t)||eE(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function eE(e,t){if(e){if("string"==typeof e)return tE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tE(e,t):void 0}}function tE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function rE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oE(e,t){return(oE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function iE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=sE(e);if(t){var o=sE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return aE(this,n)}}function aE(e,t){return!t||"object"!==Jb(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function sE(e){return(sE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}Yb.implementedFunctions={FACT:{method:"fact",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:170}]},FACTDOUBLE:{method:"factdouble",parameters:[{argumentType:pl.NUMBER,minValue:0,maxValue:288}]},COMBIN:{method:"combin",parameters:[{argumentType:pl.NUMBER,minValue:0,lessThan:1030},{argumentType:pl.NUMBER,minValue:0}]},COMBINA:{method:"combina",parameters:[{argumentType:pl.NUMBER,minValue:0},{argumentType:pl.NUMBER,minValue:0}]},GCD:{method:"gcd",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},LCM:{method:"lcm",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},MROUND:{method:"mround",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},MULTINOMIAL:{method:"multinomial",parameters:[{argumentType:pl.NUMBER}],repeatLastArgs:1,expandRanges:!0},QUOTIENT:{method:"quotient",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER}]},SERIESSUM:{method:"seriessum",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.RANGE}]},SIGN:{method:"sign",parameters:[{argumentType:pl.NUMBER}]},SUMX2MY2:{method:"sumx2my2",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},SUMX2PY2:{method:"sumx2py2",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},SUMXMY2:{method:"sumxmy2",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]}};var uE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oE(e,t)}(i,e);var t,n,r,o=iE(i);function i(){return nE(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"complex",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COMPLEX"),(function(e,t,n){return"i"!==n&&"j"!==n?new Ho(Mo.VALUE,Ne.ShouldBeIorJ):zi([e,t],n)}))}},{key:"imabs",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMABS"),yE)}},{key:"imaginary",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMAGINARY"),(function(e){var t=Zb(e,2);return t[0],t[1]}))}},{key:"imreal",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMREAL"),(function(e){var t=Zb(e,2),n=t[0];return t[1],n}))}},{key:"imargument",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMARGUMENT"),(function(e){var t=Zb(e,2),n=t[0],r=t[1];return 0===n&&0===r?new Ho(Mo.DIV_BY_ZERO):Math.atan2(r,n)}))}},{key:"imconjugate",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCONJUGATE"),(function(e){var t=Zb(e,2);return zi([t[0],-t[1]])}))}},{key:"imcos",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOS"),(function(e){return zi(hE(e))}))}},{key:"imcosh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOSH"),(function(e){return zi(pE(e))}))}},{key:"imcot",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCOT"),(function(e){return zi(fE(hE(e),dE(e)))}))}},{key:"imcsc",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSC"),(function(e){return zi(fE([1,0],dE(e)))}))}},{key:"imcsch",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMCSCH"),(function(e){return zi(fE([1,0],mE(e)))}))}},{key:"imsec",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSEC"),(function(e){return zi(fE([1,0],hE(e)))}))}},{key:"imsech",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSECH"),(function(e){return zi(fE([1,0],pE(e)))}))}},{key:"imsin",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSIN"),(function(e){return zi(dE(e))}))}},{key:"imsinh",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSINH"),(function(e){return zi(mE(e))}))}},{key:"imtan",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMTAN"),(function(e){return zi(fE(dE(e),hE(e)))}))}},{key:"imdiv",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMDIV"),(function(e,t){return zi(fE(e,t))}))}},{key:"improduct",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("IMPRODUCT"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceComplexExactRanges(t);if(o instanceof Ho)return o;var i,a=[1,0],s=Qb(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;a=lE(a,u)}}catch(e){s.e(e)}finally{s.f()}return zi(a)}))}},{key:"imsum",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("IMSUM"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceComplexExactRanges(t);if(o instanceof Ho)return o;var i,a=[0,0],s=Qb(o);try{for(s.s();!(i=s.n()).done;){var u=i.value;a=cE(a,u)}}catch(e){s.e(e)}finally{s.f()}return zi(a)}))}},{key:"imsub",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSUB"),(function(e,t){return zi((n=t,r=Zb(e,2),o=r[0],i=r[1],a=Zb(n,2),s=a[0],u=a[1],[o-s,i-u]));var n,r,o,i,a,s,u}))}},{key:"imexp",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMEXP"),(function(e){return zi(vE(e))}))}},{key:"imln",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLN"),(function(e){return zi(gE(e))}))}},{key:"imlog10",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG10"),(function(e){var t=Zb(gE(e),2),n=t[0],r=t[1],o=Math.log(10);return zi([n/o,r/o])}))}},{key:"imlog2",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMLOG2"),(function(e){var t=Zb(gE(e),2),n=t[0],r=t[1],o=Math.log(2);return zi([n/o,r/o])}))}},{key:"impower",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMPOWER"),(function(e,t){return zi(bE(e,t))}))}},{key:"imsqrt",value:function(e,t){return this.runFunction(e.args,t,this.metadata("IMSQRT"),(function(e){return zi(bE(e,.5))}))}}])&&rE(t.prototype,n),r&&rE(t,r),i}(El);function cE(e,t){var n=Zb(e,2),r=n[0],o=n[1],i=Zb(t,2);return[r+i[0],o+i[1]]}function lE(e,t){var n=Zb(e,2),r=n[0],o=n[1],i=Zb(t,2),a=i[0],s=i[1];return[r*a-o*s,r*s+a*o]}function fE(e,t){var n=Zb(e,2),r=n[0],o=n[1],i=Zb(t,2),a=i[0],s=i[1],u=Math.pow(a,2)+Math.pow(s,2),c=Zb(lE([r,o],[a,-s]),2);return[c[0]/u,c[1]/u]}function hE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.cos(n)*Math.cosh(r),-Math.sin(n)*Math.sinh(r)]}function pE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.cosh(n)*Math.cos(r),Math.sinh(n)*Math.sin(r)]}function dE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.sin(n)*Math.cosh(r),Math.cos(n)*Math.sinh(r)]}function mE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.sinh(n)*Math.cos(r),Math.cosh(n)*Math.sin(r)]}function vE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.exp(n)*Math.cos(r),Math.exp(n)*Math.sin(r)]}function yE(e){var t=Zb(e,2),n=t[0],r=t[1];return Math.sqrt(n*n+r*r)}function gE(e){var t=Zb(e,2),n=t[0],r=t[1];return[Math.log(yE([n,r])),Math.atan2(r,n)]}function bE(e,t){var n=Zb(gE(e),2);return vE([t*n[0],t*n[1]])}function EE(e){return(EE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function wE(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return SE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}function SE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function TE(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function OE(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function RE(e,t){return(RE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function NE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=AE(e);if(t){var o=AE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return kE(this,n)}}function kE(e,t){return!t||"object"!==EE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function AE(e){return(AE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}uE.implementedFunctions={COMPLEX:{method:"complex",parameters:[{argumentType:pl.NUMBER},{argumentType:pl.NUMBER},{argumentType:pl.STRING,defaultValue:"i"}]},IMABS:{method:"imabs",parameters:[{argumentType:pl.COMPLEX}]},IMAGINARY:{method:"imaginary",parameters:[{argumentType:pl.COMPLEX}]},IMREAL:{method:"imreal",parameters:[{argumentType:pl.COMPLEX}]},IMARGUMENT:{method:"imargument",parameters:[{argumentType:pl.COMPLEX}]},IMCONJUGATE:{method:"imconjugate",parameters:[{argumentType:pl.COMPLEX}]},IMCOS:{method:"imcos",parameters:[{argumentType:pl.COMPLEX}]},IMCOSH:{method:"imcosh",parameters:[{argumentType:pl.COMPLEX}]},IMCOT:{method:"imcot",parameters:[{argumentType:pl.COMPLEX}]},IMCSC:{method:"imcsc",parameters:[{argumentType:pl.COMPLEX}]},IMCSCH:{method:"imcsch",parameters:[{argumentType:pl.COMPLEX}]},IMSEC:{method:"imsec",parameters:[{argumentType:pl.COMPLEX}]},IMSECH:{method:"imsech",parameters:[{argumentType:pl.COMPLEX}]},IMSIN:{method:"imsin",parameters:[{argumentType:pl.COMPLEX}]},IMSINH:{method:"imsinh",parameters:[{argumentType:pl.COMPLEX}]},IMTAN:{method:"imtan",parameters:[{argumentType:pl.COMPLEX}]},IMDIV:{method:"imdiv",parameters:[{argumentType:pl.COMPLEX},{argumentType:pl.COMPLEX}]},IMPRODUCT:{method:"improduct",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},IMSUM:{method:"imsum",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},IMSUB:{method:"imsub",parameters:[{argumentType:pl.COMPLEX},{argumentType:pl.COMPLEX}]},IMEXP:{method:"imexp",parameters:[{argumentType:pl.COMPLEX}]},IMLN:{method:"imln",parameters:[{argumentType:pl.COMPLEX}]},IMLOG10:{method:"imlog10",parameters:[{argumentType:pl.COMPLEX}]},IMLOG2:{method:"imlog2",parameters:[{argumentType:pl.COMPLEX}]},IMPOWER:{method:"impower",parameters:[{argumentType:pl.COMPLEX},{argumentType:pl.NUMBER}]},IMSQRT:{method:"imsqrt",parameters:[{argumentType:pl.COMPLEX}]}};var CE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&RE(e,t)}(i,e);var t,n,r,o=NE(i);function i(){return TE(this,i),o.apply(this,arguments)}return t=i,(n=[{key:"avedev",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("AVEDEV"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof Ho)return o;if(0===o.length)return new Ho(Mo.DIV_BY_ZERO);var i=Tb(o);return o.reduce((function(e,t){return e+Math.abs(t-i)}),0)/o.length}))}},{key:"devsq",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("DEVSQ"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);return o instanceof Ho?o:0===o.length?0:Ob(o)}))}},{key:"geomean",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("GEOMEAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof Ho)return o;if(0===o.length)return new Ho(Mo.NUM,Ne.OneValue);var i,a=wE(o);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s<=0)return new Ho(Mo.NUM,Ne.ValueSmall)}}catch(e){a.e(e)}finally{a.f()}return kb(o)}))}},{key:"harmean",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("HARMEAN"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof Ho)return o;if(0===o.length)return new Ho(Mo.NUM,Ne.OneValue);var i,a=wE(o);try{for(a.s();!(i=a.n()).done;){var s=i.value;if(s<=0)return new Ho(Mo.NUM,Ne.ValueSmall)}}catch(e){a.e(e)}finally{a.f()}return o.length/o.reduce((function(e,t){return e+1/t}),0)}))}},{key:"correl",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CORREL"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);return n instanceof Ho?n:n[0].length<=1?new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues):Cb(n[0],n[1])}))}},{key:"rsq",value:function(e,t){return this.runFunction(e.args,t,this.metadata("RSQ"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);return n instanceof Ho?n:n[0].length<=1?new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues):Math.pow(Cb(n[0],n[1]),2)}))}},{key:"covariancep",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.P"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);if(n instanceof Ho)return n;var r=n[0].length;return r<1?new Ho(Mo.DIV_BY_ZERO,Ne.OneValue):1===r?0:Ab(n[0],n[1])*(r-1)/r}))}},{key:"covariances",value:function(e,t){return this.runFunction(e.args,t,this.metadata("COVARIANCE.S"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);return n instanceof Ho?n:n[0].length<=1?new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues):Ab(n[0],n[1])}))}},{key:"ztest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("Z.TEST"),(function(e,t,r){var o=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner());if(o instanceof Ho)return o;var i=o.length;if(void 0===r){if(i<2)return new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues);r=Nb(o,!0)}return i<1?new Ho(Mo.NA,Ne.OneValue):0===r?new Ho(Mo.DIV_BY_ZERO):1-Gg((Tb(o)-t)/(r/Math.sqrt(i)),0,1)}))}},{key:"ftest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("F.TEST"),(function(e,t){var r=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),o=n.interpreter.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(r instanceof Ho)return r;if(o instanceof Ho)return o;if(r.length<=1||o.length<=1)return new Ho(Mo.DIV_BY_ZERO);var i=Rb(r,!0),a=Rb(o,!0);if(0===i||0===a)return new Ho(Mo.DIV_BY_ZERO);var s=cb(i/a,r.length-1,o.length-1);return 2*Math.min(s,1-s)}))}},{key:"steyx",value:function(e,t){return this.runFunction(e.args,t,this.metadata("STEYX"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);if(n instanceof Ho)return n;var r=n[0].length;return r<=2?new Ho(Mo.DIV_BY_ZERO,Ne.ThreeValues):Math.sqrt((Ob(n[0])-Math.pow(Ab(n[0],n[1])*(r-1),2)/Ob(n[1]))/(r-2))}))}},{key:"slope",value:function(e,t){return this.runFunction(e.args,t,this.metadata("SLOPE"),(function(e,t){if(e.numberOfElements()!==t.numberOfElements())return new Ho(Mo.NA,Ne.EqualLength);var n=ME(e,t);if(n instanceof Ho)return n;var r=n[0].length;return r<=1?new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues):Ab(n[0],n[1])*(r-1)/Ob(n[1])}))}},{key:"chisqtest",value:function(e,t){return this.runFunction(e.args,t,this.metadata("CHISQ.TEST"),(function(e,t){var n=e.height(),r=e.width();if(t.height()!==n||t.width()!==r)return new Ho(Mo.NA,Ne.EqualLength);var o=ME(e,t);if(o instanceof Ho)return o;if(o[0].length<=1)return new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues);for(var i=0,a=0;a<o[0].length;a++){if(0===o[1][a])return new Ho(Mo.DIV_BY_ZERO);i+=Math.pow(o[0][a]-o[1][a],2)/o[1][a]}return i<0?new Ho(Mo.NUM,Ne.NaN):1-ab(i,n>1&&r>1?(n-1)*(r-1):n*r-1)}))}},{key:"ttest",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("T.TEST"),(function(e,t,r,o){var i=n.interpreter.arithmeticHelper.manyToExactNumbers(e.valuesFromTopLeftCorner()),a=n.interpreter.arithmeticHelper.manyToExactNumbers(t.valuesFromTopLeftCorner());if(i instanceof Ho)return i;if(a instanceof Ho)return a;var s=i.length,u=a.length;if(1===o){if(u!==s)return new Ho(Mo.NA,Ne.EqualLength);if(s<=1)return new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues);for(var c=Array(s),l=0;l<s;l++)c[l]=i[l]-a[l];var f=Nb(c,!0);if(0===f)return new Ho(Mo.DIV_BY_ZERO);var h=Math.abs(Math.sqrt(s)*Tb(c)/f);return r*(1-vb(h,s-1))}if(2===o){if(s<=1||u<=1)return new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues);var p=(Ob(i)+Ob(a))/(s+u-2);if(0===p)return new Ho(Mo.DIV_BY_ZERO);var d=Math.abs((Tb(i)-Tb(a))/Math.sqrt(p*(1/s+1/u)));return r*(1-vb(d,s+u-2))}if(s<=1||u<=1)return new Ho(Mo.DIV_BY_ZERO,Ne.TwoValues);var m=Rb(i,!0),v=Rb(a,!0);if(0===m&&0===v)return new Ho(Mo.DIV_BY_ZERO);var y=Math.abs((Tb(i)-Tb(a))/Math.sqrt(m/s+v/u)),g=Math.pow(m/s+v/u,2)/(Math.pow(m/s,2)/(s-1)+Math.pow(v/u,2)/(u-1));return r*(1-vb(y,g))}))}},{key:"skew",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SKEW"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof Ho)return o;var i=o.length;if(i<3)return new Ho(Mo.DIV_BY_ZERO,Ne.ThreeValues);var a=Tb(o),s=Nb(o,!0);return 0===s?new Ho(Mo.DIV_BY_ZERO):o.reduce((function(e,t){return e+Math.pow((t-a)/s,3)}),0)*i/(i-1)/(i-2)}))}},{key:"skewp",value:function(e,t){var n=this;return this.runFunction(e.args,t,this.metadata("SKEW.P"),(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];var o=n.interpreter.arithmeticHelper.coerceNumbersExactRanges(t);if(o instanceof Ho)return o;var i=o.length;if(i<3)return new Ho(Mo.DIV_BY_ZERO,Ne.ThreeValues);var a=Tb(o),s=Nb(o,!1);return 0===s?new Ho(Mo.DIV_BY_ZERO):o.reduce((function(e,t){return e+Math.pow((t-a)/s,3)}),0)/i}))}}])&&OE(t.prototype,n),r&&OE(t,r),i}(El);function ME(e,t){for(var n,r,o=e.iterateValuesFromTopLeftCorner(),i=t.iterateValuesFromTopLeftCorner(),a=[],s=[];n=o.next(),r=i.next(),!n.done&&!r.done;){var u=n.value,c=r.value;if(u instanceof Ho)return u;if(c instanceof Ho)return c;Bt(u)&&Bt(c)&&(a.push(xt(u)),s.push(xt(c)))}return[a,s]}function xE(e){return(xE="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function IE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _E(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function PE(e,t){return(PE=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function LE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=DE(e);if(t){var o=DE(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return FE(this,n)}}function FE(e,t){return!t||"object"!==xE(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function DE(e){return(DE=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}CE.implementedFunctions={AVEDEV:{method:"avedev",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},DEVSQ:{method:"devsq",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},GEOMEAN:{method:"geomean",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},HARMEAN:{method:"harmean",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},CORREL:{method:"correl",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},RSQ:{method:"rsq",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},"COVARIANCE.P":{method:"covariancep",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},"COVARIANCE.S":{method:"covariances",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},"Z.TEST":{method:"ztest",parameters:[{argumentType:pl.RANGE},{argumentType:pl.NUMBER},{argumentType:pl.NUMBER,optionalArg:!0}]},"F.TEST":{method:"ftest",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},STEYX:{method:"steyx",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},SLOPE:{method:"slope",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},"CHISQ.TEST":{method:"chisqtest",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE}]},"T.TEST":{method:"ttest",parameters:[{argumentType:pl.RANGE},{argumentType:pl.RANGE},{argumentType:pl.INTEGER,minValue:1,maxValue:2},{argumentType:pl.INTEGER,minValue:1,maxValue:3}]},SKEW:{method:"skew",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1},"SKEW.P":{method:"skewp",parameters:[{argumentType:pl.ANY}],repeatLastArgs:1}},CE.aliases={COVAR:"COVARIANCE.P",FTEST:"F.TEST",PEARSON:"CORREL",ZTEST:"Z.TEST",CHITEST:"CHISQ.TEST",TTEST:"T.TEST",COVARIANCEP:"COVARIANCE.P",COVARIANCES:"COVARIANCE.S",SKEWP:"SKEW.P"};var UE=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&PE(e,t)}(n,e);var t=LE(n);function n(){return _E(this,n),t.apply(this,arguments)}return n}(cf);UE.HyperFormula=cf,UE.ErrorType=Mo,UE.CellType=xo,UE.CellValueType=Fo,UE.CellValueDetailedType=Do,UE.DetailedCellError=Jo,UE.ExportedCellChange=Bu,UE.ExportedNamedExpressionChange=Vu,UE.ConfigValueTooBigError=Bn,UE.ConfigValueTooSmallError=jn,UE.EvaluationSuspendedError=Hn,UE.ExpectedOneOfValuesError=Vn,UE.ExpectedValueOfTypeError=Dn,UE.FunctionPlugin=El,UE.FunctionPluginValidationError=Yn,UE.InvalidAddressError=kn,UE.InvalidArgumentsError=An,UE.LanguageNotRegisteredError=Wn,UE.LanguageAlreadyRegisteredError=$n,UE.MatrixFormulasNotSupportedError=Jn,UE.MissingTranslationError=Gn,UE.NamedExpressionDoesNotExistError=xn,UE.NamedExpressionNameIsAlreadyTakenError=Cn,UE.NamedExpressionNameIsInvalidError=Mn,UE.NoOperationToRedoError=_n,UE.NoOperationToUndoError=In,UE.NoRelativeAddressesAllowedError=Qn,UE.NoSheetWithIdError=Sn,UE.NoSheetWithNameError=Tn,UE.NotAFormulaError=Nn,UE.NothingToPasteError=Pn,UE.ProtectedFunctionTranslationError=zn,UE.SheetNameAlreadyTakenError=On,UE.SheetSizeLimitExceededError=Rn,UE.SourceLocationHasMatrixError=qn,UE.TargetLocationHasMatrixError=Xn,UE.UnableToParseError=Fn;var jE=If.defaultConfig.language;cf.registerLanguage(jE,_f),cf.languages[_f.langCode]=_f;var BE,VE=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return IE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw i}}}}(Object.getOwnPropertyNames(r));try{for(VE.s();!(BE=VE.n()).done;){var HE=BE.value;HE.startsWith("_")||cf.registerFunctionPlugin(r[HE])}}catch(e){VE.e(e)}finally{VE.f()}var GE=n("t2rG"),zE=n.n(GE),WE=n("Nfqw"),$E=n("w7Oj");function YE(e){this.content=e}YE.prototype={constructor:YE,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,o=r.find(e),i=r.content.slice();return-1==o?i.push(n||e,t):(i[o+1]=t,n&&(i[o]=n)),new YE(i)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new YE(n)},addToStart:function(e,t){return new YE([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new YE(n)},addBefore:function(e,t,n){var r=this.remove(t),o=r.content.slice(),i=r.find(e);return o.splice(-1==i?o.length:i,0,t,n),new YE(o)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=YE.from(e)).size?new YE(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=YE.from(e)).size?new YE(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=YE.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},get size(){return this.content.length>>1}},YE.from=function(e){if(e instanceof YE)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new YE(t)};var KE=YE;var qE=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize},XE={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};qE.prototype.nodesBetween=function(e,t,n,r,o){void 0===r&&(r=0);for(var i=0,a=0;a<t;i++){var s=this.content[i],u=a+s.nodeSize;if(u>e&&!1!==n(s,r+a,o,i)&&s.content.size){var c=a+1;s.nodesBetween(Math.max(0,e-c),Math.min(s.content.size,t-c),n,r+c)}a=u}},qE.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},qE.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(a,s){a.isText?(o+=a.text.slice(Math.max(e,s)-s,t-s),i=!n):a.isLeaf&&r?(o+=r,i=!n):!i&&a.isBlock&&(o+=n,i=!0)}),0),o},qE.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new qE(r,this.size+e.size)},qE.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var n=[],r=0;if(t>e)for(var o=0,i=0;i<t;o++){var a=this.content[o],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),n.push(a),r+=a.nodeSize),i=s}return new qE(n,r)},qE.prototype.cutByIndex=function(e,t){return e==t?qE.empty:0==e&&t==this.content.length?this:new qE(this.content.slice(e,t))},qE.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new qE(r,o)},qE.prototype.addToStart=function(e){return new qE([e].concat(this.content),this.size+e.nodeSize)},qE.prototype.addToEnd=function(e){return new qE(this.content.concat(e),this.size+e.nodeSize)},qE.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},XE.firstChild.get=function(){return this.content.length?this.content[0]:null},XE.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},XE.childCount.get=function(){return this.content.length},qE.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},qE.prototype.maybeChild=function(e){return this.content[e]},qE.prototype.forEach=function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}},qE.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),function e(t,n,r){for(var o=0;;o++){if(o==t.childCount||o==n.childCount)return t.childCount==n.childCount?null:r;var i=t.child(o),a=n.child(o);if(i!=a){if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(var s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){var u=e(i.content,a.content,r+1);if(null!=u)return u}r+=i.nodeSize}else r+=i.nodeSize}}(this,e,t)},qE.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),function e(t,n,r,o){for(var i=t.childCount,a=n.childCount;;){if(0==i||0==a)return i==a?null:{a:r,b:o};var s=t.child(--i),u=n.child(--a),c=s.nodeSize;if(s!=u){if(!s.sameMarkup(u))return{a:r,b:o};if(s.isText&&s.text!=u.text){for(var l=0,f=Math.min(s.text.length,u.text.length);l<f&&s.text[s.text.length-l-1]==u.text[u.text.length-l-1];)l++,r--,o--;return{a:r,b:o}}if(s.content.size||u.content.size){var h=e(s.content,u.content,r-1,o-1);if(h)return h}r-=c,o-=c}else r-=c,o-=c}}(this,e,t,n)},qE.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return QE(0,e);if(e==this.size)return QE(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=e)return o==e||t>0?QE(n+1,o):QE(n,r);r=o}},qE.prototype.toString=function(){return"<"+this.toStringInner()+">"},qE.prototype.toStringInner=function(){return this.content.join(", ")},qE.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},qE.fromJSON=function(e,t){if(!t)return qE.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new qE(t.map(e.nodeFromJSON))},qE.fromArray=function(e){if(!e.length)return qE.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new qE(t||e,n)},qE.from=function(e){if(!e)return qE.empty;if(e instanceof qE)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new qE([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(qE.prototype,XE);var JE={index:0,offset:0};function QE(e,t){return JE.index=e,JE.offset=t,JE}function ZE(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!ZE(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!ZE(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}qE.empty=new qE([],0);var ew=function(e,t){this.type=e,this.attrs=t};function tw(e){var t=Error.call(this,e);return t.__proto__=tw.prototype,t}ew.prototype.addToSet=function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t},ew.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},ew.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},ew.prototype.eq=function(e){return this==e||this.type==e.type&&ZE(this.attrs,e.attrs)},ew.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},ew.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},ew.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},ew.setFrom=function(e){if(!e||0==e.length)return ew.none;if(e instanceof ew)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},ew.none=[],tw.prototype=Object.create(Error.prototype),tw.prototype.constructor=tw,tw.prototype.name="ReplaceError";var nw=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},rw={size:{configurable:!0}};function ow(e,t,n){if(n.openStart>e.depth)throw new tw("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new tw("Inconsistent open depths");return function e(t,n,r,o){var i=t.index(o),a=t.node(o);if(i==n.index(o)&&o<t.depth-r.openStart){var s=e(t,n,r,o+1);return a.copy(a.content.replaceChild(i,s))}if(r.content.size){if(r.openStart||r.openEnd||t.depth!=o||n.depth!=o){var u=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(qE.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t),c=u.start,l=u.end;return cw(a,function e(t,n,r,o,i){var a=t.depth>i&&aw(t,n,i+1),s=o.depth>i&&aw(r,o,i+1),u=[];uw(null,t,i,u),a&&s&&n.index(i)==r.index(i)?(iw(a,s),sw(cw(a,e(t,n,r,o,i+1)),u)):(a&&sw(cw(a,lw(t,n,i+1)),u),uw(n,r,i,u),s&&sw(cw(s,lw(r,o,i+1)),u));return uw(o,null,i,u),new qE(u)}(t,c,l,n,o))}var f=t.parent,h=f.content;return cw(f,h.cut(0,t.parentOffset).append(r.content).append(h.cut(n.parentOffset)))}return cw(a,lw(t,n,o))}(e,t,n,0)}function iw(e,t){if(!t.type.compatibleContent(e.type))throw new tw("Cannot join "+t.type.name+" onto "+e.type.name)}function aw(e,t,n){var r=e.node(n);return iw(r,t.node(n)),r}function sw(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function uw(e,t,n,r){var o=(t||e).node(n),i=0,a=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(sw(e.nodeAfter,r),i++));for(var s=i;s<a;s++)sw(o.child(s),r);t&&t.depth==n&&t.textOffset&&sw(t.nodeBefore,r)}function cw(e,t){if(!e.type.validContent(t))throw new tw("Invalid content for node "+e.type.name);return e.copy(t)}function lw(e,t,n){var r=[];(uw(null,e,n,r),e.depth>n)&&sw(cw(aw(e,t,n+1),lw(e,t,n+1)),r);return uw(t,null,n,r),new qE(r)}rw.size.get=function(){return this.content.size-this.openStart-this.openEnd},nw.prototype.insertAt=function(e,t){var n=function e(t,n,r,o){var i=t.findIndex(n),a=i.index,s=i.offset,u=t.maybeChild(a);if(s==n||u.isText)return o&&!o.canReplace(a,a,r)?null:t.cut(0,n).append(r).append(t.cut(n));var c=e(u.content,n-s-1,r);return c&&t.replaceChild(a,u.copy(c))}(this.content,e+this.openStart,t,null);return n&&new nw(n,this.openStart,this.openEnd)},nw.prototype.removeBetween=function(e,t){return new nw(function e(t,n,r){var o=t.findIndex(n),i=o.index,a=o.offset,s=t.maybeChild(i),u=t.findIndex(r),c=u.index,l=u.offset;if(a==n||s.isText){if(l!=r&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(i!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(e(s.content,n-a-1,r-a-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},nw.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},nw.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},nw.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},nw.fromJSON=function(e,t){if(!t)return nw.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new nw(qE.fromJSON(e,t.content),n,r)},nw.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new nw(e,n,r)},Object.defineProperties(nw.prototype,rw),nw.empty=new nw(qE.empty,0,0);var fw=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},hw={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};fw.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},hw.parent.get=function(){return this.node(this.depth)},hw.doc.get=function(){return this.node(0)},fw.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},fw.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},fw.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},fw.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},fw.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},fw.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},fw.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},hw.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},hw.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},hw.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},fw.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r},fw.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return ew.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,a=0;a<i.length;a++)!1!==i[a].type.spec.inclusive||r&&i[a].isInSet(r.marks)||(i=i[a--].removeFromSet(i));return i},fw.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},fw.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},fw.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new vw(this,e,n)},fw.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},fw.prototype.max=function(e){return e.pos>this.pos?e:this},fw.prototype.min=function(e){return e.pos<this.pos?e:this},fw.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},fw.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var a=i.content.findIndex(o),s=a.index,u=a.offset,c=o-u;if(n.push(i,s,r+u),!c)break;if((i=i.child(s)).isText)break;o=c-1,r+=u+1}return new fw(t,n,o)},fw.resolveCached=function(e,t){for(var n=0;n<pw.length;n++){var r=pw[n];if(r.pos==t&&r.doc==e)return r}var o=pw[dw]=fw.resolve(e,t);return dw=(dw+1)%mw,o},Object.defineProperties(fw.prototype,hw);var pw=[],dw=0,mw=12,vw=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},yw={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};yw.start.get=function(){return this.$from.before(this.depth+1)},yw.end.get=function(){return this.$to.after(this.depth+1)},yw.parent.get=function(){return this.$from.node(this.depth)},yw.startIndex.get=function(){return this.$from.index(this.depth)},yw.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(vw.prototype,yw);var gw=Object.create(null),bw=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||qE.empty,this.marks=r||ew.none},Ew={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Ew.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},Ew.childCount.get=function(){return this.content.childCount},bw.prototype.child=function(e){return this.content.child(e)},bw.prototype.maybeChild=function(e){return this.content.maybeChild(e)},bw.prototype.forEach=function(e){this.content.forEach(e)},bw.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},bw.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},Ew.textContent.get=function(){return this.textBetween(0,this.content.size,"")},bw.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},Ew.firstChild.get=function(){return this.content.firstChild},Ew.lastChild.get=function(){return this.content.lastChild},bw.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},bw.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},bw.prototype.hasMarkup=function(e,t,n){return this.type==e&&ZE(this.attrs,t||e.defaultAttrs||gw)&&ew.sameSet(this.marks,n||ew.none)},bw.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},bw.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},bw.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},bw.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return nw.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),a=r.start(i),s=r.node(i).content.cut(r.pos-a,o.pos-a);return new nw(s,r.depth-i,o.depth-i)},bw.prototype.replace=function(e,t,n){return ow(this.resolve(e),this.resolve(t),n)},bw.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}},bw.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},bw.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},bw.prototype.resolve=function(e){return fw.resolveCached(this,e)},bw.prototype.resolveNoCache=function(e){return fw.resolve(this,e)},bw.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r},Ew.isBlock.get=function(){return this.type.isBlock},Ew.isTextblock.get=function(){return this.type.isTextblock},Ew.inlineContent.get=function(){return this.type.inlineContent},Ew.isInline.get=function(){return this.type.isInline},Ew.isText.get=function(){return this.type.isText},Ew.isLeaf.get=function(){return this.type.isLeaf},Ew.isAtom.get=function(){return this.type.isAtom},bw.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Sw(this.marks,e)},bw.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},bw.prototype.canReplace=function(e,t,n,r,o){void 0===n&&(n=qE.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(e).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(var s=r;s<o;s++)if(!this.type.allowsMarks(n.child(s).marks))return!1;return!0},bw.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},bw.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},bw.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=ew.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!ew.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},bw.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},bw.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=qE.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(bw.prototype,Ew);var ww=function(e){function t(t,n,r,o){if(e.call(this,t,n,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={textContent:{configurable:!0},nodeSize:{configurable:!0}};return t.prototype.toString=function(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Sw(this.marks,JSON.stringify(this.text))},n.textContent.get=function(){return this.text},t.prototype.textBetween=function(e,t){return this.text.slice(e,t)},n.nodeSize.get=function(){return this.text.length},t.prototype.mark=function(e){return e==this.marks?this:new t(this.type,this.attrs,this.text,e)},t.prototype.withText=function(e){return e==this.text?this:new t(this.type,this.attrs,e,this.marks)},t.prototype.cut=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.text.length),0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))},t.prototype.eq=function(e){return this.sameMarkup(e)&&this.text==e.text},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.text=this.text,t},Object.defineProperties(t.prototype,n),t}(bw);function Sw(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}var Tw=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},Ow={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};Tw.parse=function(e,t){var n=new Rw(e,t);if(null==n.next)return Tw.empty;var r=kw(n);n.next&&n.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),a=i>-1&&o[i+1];_w(e,r).forEach((function(e){a||o.push(n,a=[]),-1==a.indexOf(e)&&a.push(e)}))}}))}));for(var i=t[r.join(",")]=new Tw(r.indexOf(e.length-1)>-1),a=0;a<o.length;a+=2){var s=o[a+1].sort(Iw);i.next.push(o[a],t[s.join(",")]||n(s))}return i}(_w(e,0))}(function(e){var t=[[]];return o(function e(t,i){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(e(n,i))}),[]);if("seq"==t.type)for(var a=0;;a++){var s=e(t.exprs[a],i);if(a==t.exprs.length-1)return s;o(s,i=n())}else{if("star"==t.type){var u=n();return r(i,u),o(e(t.expr,u),u),[r(u)]}if("plus"==t.type){var c=n();return o(e(t.expr,i),c),o(e(t.expr,c),c),[r(c)]}if("opt"==t.type)return[r(i)].concat(e(t.expr,i));if("range"==t.type){for(var l=i,f=0;f<t.min;f++){var h=n();o(e(t.expr,l),h),l=h}if(-1==t.max)o(e(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(e(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(i,null,t.value)]}}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}}(r));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,a=[],s=0;s<o.next.length;s+=2){var u=o.next[s],c=o.next[s+1];a.push(u.name),!i||u.isText||u.hasRequiredAttrs()||(i=!1),-1==r.indexOf(c)&&r.push(c)}i&&t.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},Tw.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},Tw.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},Ow.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},Ow.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},Tw.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var n=0;n<e.next.length;n+=2)if(this.next[t]==e.next[n])return!0;return!1},Tw.prototype.fillBefore=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var s=i.matchFragment(e,n);if(s&&(!t||s.validEnd))return qE.from(a.map((function(e){return e.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var c=i.next[u],l=i.next[u+1];if(!c.isText&&!c.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,a.concat(c));if(f)return f}}}(this,[])},Tw.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n},Tw.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],a=r;a.type;a=a.via)i.push(a.type);return i.reverse()}for(var s=0;s<o.next.length;s+=2){var u=o.next[s];u.isLeaf||u.hasRequiredAttrs()||u.name in t||r.type&&!o.next[s+1].validEnd||(n.push({match:u.contentMatch,type:u,via:r}),t[u.name]=!0)}}},Ow.edgeCount.get=function(){return this.next.length>>1},Tw.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},Tw.prototype.toString=function(){var e=[];return function t(n){e.push(n);for(var r=1;r<n.next.length;r+=2)-1==e.indexOf(n.next[r])&&t(n.next[r])}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)r+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return r})).join("\n")},Object.defineProperties(Tw.prototype,Ow),Tw.empty=new Tw(!0);var Rw=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},Nw={next:{configurable:!0}};function kw(e){var t=[];do{t.push(Aw(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function Aw(e){var t=[];do{t.push(Cw(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Cw(e){for(var t=function(e){if(e.eat("(")){var t=kw(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var a=n[i];a.groups.indexOf(t)>-1&&o.push(a)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=xw(e,t)}return t}function Mw(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function xw(e,t){var n=Mw(e),r=n;return e.eat(",")&&(r="}"!=e.next?Mw(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Iw(e,t){return t-e}function _w(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var a=o[i],s=a.term,u=a.to;s||-1!=n.indexOf(u)||t(u)}}(t),n.sort(Iw)}function Pw(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function Lw(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function Fw(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new jw(e[n]);return t}Nw.next.get=function(){return this.tokens[this.pos]},Rw.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},Rw.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(Rw.prototype,Nw);var Dw=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=Fw(n.attrs),this.defaultAttrs=Pw(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},Uw={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};Uw.isInline.get=function(){return!this.isBlock},Uw.isTextblock.get=function(){return this.isBlock&&this.inlineContent},Uw.isLeaf.get=function(){return this.contentMatch==Tw.empty},Uw.isAtom.get=function(){return this.isLeaf||this.spec.atom},Dw.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},Dw.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},Dw.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:Lw(this.attrs,e)},Dw.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new bw(this,this.computeAttrs(e),qE.from(t),ew.setFrom(n))},Dw.prototype.createChecked=function(e,t,n){if(t=qE.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new bw(this,this.computeAttrs(e),t,ew.setFrom(n))},Dw.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),(t=qE.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(qE.empty,!0);return o?new bw(this,e,t.append(o),ew.setFrom(n)):null},Dw.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0},Dw.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},Dw.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},Dw.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:ew.empty:e},Dw.compile=function(e,t){var n=Object.create(null);e.forEach((function(e,r){return n[e]=new Dw(e,t,r)}));var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(Dw.prototype,Uw);var jw=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},Bw={isRequired:{configurable:!0}};Bw.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(jw.prototype,Bw);var Vw=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=Fw(r.attrs),this.rank=t,this.excluded=null;var o=Pw(this.attrs);this.instance=o&&new ew(this,o)};Vw.prototype.create=function(e){return!e&&this.instance?this.instance:new ew(this,Lw(this.attrs,e))},Vw.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach((function(e,o){return n[e]=new Vw(e,r++,t,o)})),n},Vw.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},Vw.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},Vw.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var Hw=function(e){for(var t in this.spec={},e)this.spec[t]=e[t];this.spec.nodes=KE.from(e.nodes),this.spec.marks=KE.from(e.marks),this.nodes=Dw.compile(this.spec.nodes,this),this.marks=Vw.compile(this.spec.marks,this);var n=Object.create(null);for(var r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");var o=this.nodes[r],i=o.spec.content||"",a=o.spec.marks;o.contentMatch=n[i]||(n[i]=Tw.parse(i,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.markSet="_"==a?null:a?Gw(this,a.split(" ")):""!=a&&o.inlineContent?null:[]}for(var s in this.marks){var u=this.marks[s],c=u.spec.excludes;u.excluded=null==c?[u]:""==c?[]:Gw(this,c.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached=Object.create(null),this.cached.wrappings=Object.create(null)};function Gw(e,t){for(var n=[],r=0;r<t.length;r++){var o=t[r],i=e.marks[o],a=i;if(i)n.push(i);else for(var s in e.marks){var u=e.marks[s];("_"==o||u.spec.group&&u.spec.group.split(" ").indexOf(o)>-1)&&n.push(a=u)}if(!a)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}Hw.prototype.node=function(e,t,n,r){if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Dw))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)},Hw.prototype.text=function(e,t){var n=this.nodes.text;return new ww(n,n.defaultAttrs,e,ew.setFrom(t))},Hw.prototype.mark=function(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)},Hw.prototype.nodeFromJSON=function(e){return bw.fromJSON(this,e)},Hw.prototype.markFromJSON=function(e){return ew.fromJSON(this,e)},Hw.prototype.nodeType=function(e){var t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t};var zw=function(e,t){var n=this;this.schema=e,this.rules=t,this.tags=[],this.styles=[],t.forEach((function(e){e.tag?n.tags.push(e):e.style&&n.styles.push(e)})),this.normalizeLists=!this.tags.some((function(t){if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;var n=e.nodes[t.node];return n.contentMatch.matchType(n)}))};zw.prototype.parse=function(e,t){void 0===t&&(t={});var n=new Xw(this,t,!1);return n.addAll(e,null,t.from,t.to),n.finish()},zw.prototype.parseSlice=function(e,t){void 0===t&&(t={});var n=new Xw(this,t,!0);return n.addAll(e,null,t.from,t.to),nw.maxOpen(n.finish())},zw.prototype.matchTag=function(e,t,n){for(var r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){var o=this.tags[r];if(Qw(e,o.tag)&&(void 0===o.namespace||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){var i=o.getAttrs(e);if(!1===i)continue;o.attrs=i}return o}}},zw.prototype.matchStyle=function(e,t,n,r){for(var o=r?this.styles.indexOf(r)+1:0;o<this.styles.length;o++){var i=this.styles[o];if(!(0!=i.style.indexOf(e)||i.context&&!n.matchesContext(i.context)||i.style.length>e.length&&(61!=i.style.charCodeAt(e.length)||i.style.slice(e.length+1)!=t))){if(i.getAttrs){var a=i.getAttrs(t);if(!1===a)continue;i.attrs=a}return i}}},zw.schemaRules=function(e){var t=[];function n(e){for(var n=null==e.priority?50:e.priority,r=0;r<t.length;r++){var o=t[r];if((null==o.priority?50:o.priority)<n)break}t.splice(r,0,e)}var r=function(t){var r=e.marks[t].spec.parseDOM;r&&r.forEach((function(e){n(e=Zw(e)),e.mark=t}))};for(var o in e.marks)r(o);var i;for(var a in e.nodes)i=void 0,(i=e.nodes[a].spec.parseDOM)&&i.forEach((function(e){n(e=Zw(e)),e.node=a}));return t},zw.fromSchema=function(e){return e.cached.domParser||(e.cached.domParser=new zw(e,zw.schemaRules(e)))};var Ww={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},$w={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Yw={ol:!0,ul:!0};function Kw(e){return(e?1:0)|("full"===e?2:0)}var qw=function(e,t,n,r,o,i,a){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&a?null:e.contentMatch),this.options=a,this.content=[],this.marks=n,this.activeMarks=ew.none,this.pendingMarks=r,this.stashMarks=[]};qw.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(qE.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},qw.prototype.finish=function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=qE.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(qE.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},qw.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},qw.prototype.applyPending=function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):eS(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},qw.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!Ww.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var Xw=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n;var r,o=t.topNode,i=Kw(t.preserveWhitespace)|(n?4:0);r=o?new qw(o.type,o.attrs,ew.none,ew.none,!0,t.topMatch||o.type.contentMatch,i):new qw(n?null:e.schema.topNodeType,null,ew.none,ew.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},Jw={top:{configurable:!0},currentPos:{configurable:!0}};function Qw(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Zw(e){var t={};for(var n in e)t[n]=e[n];return t}function eS(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(e)){var i=[],a=function(e){i.push(e);for(var n=0;n<e.edgeCount;n++){var r=e.edge(n),o=r.type,s=r.next;if(o==t)return!0;if(i.indexOf(s)<0&&a(s))return!0}};return a(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}Jw.top.get=function(){return this.nodes[this.open]},Xw.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),n=t?this.readStyles(function(e){var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(e),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},Xw.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},Xw.prototype.addElement=function(e,t){var n,r=e.nodeName.toLowerCase();Yw.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&Yw.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:$w.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,a=this.top,s=this.needsBlock;if(Ww.hasOwnProperty(r))i=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(a),this.needsBlock=s}else this.addElementByRule(e,o,!1===o.consuming?n:null)},Xw.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},Xw.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},Xw.prototype.readStyles=function(e){var t=ew.none;e:for(var n=0;n<e.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(e[n],e[n+1],this,r);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return t},Xw.prototype.addElementByRule=function(e,t,n){var r,o,i,a=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return a.insertNode(e)}));else{var u=t.contentElement;"string"==typeof u?u=e.querySelector(u):"function"==typeof u&&(u=u(e)),u||(u=e),this.findAround(e,u,!0),this.addAll(u,r)}r&&(this.sync(s),this.open--),i&&this.removePendingMark(i,s)},Xw.prototype.addAll=function(e,t,n,r){for(var o=n||0,i=n?e.childNodes[n]:e.firstChild,a=null==r?null:e.childNodes[r];i!=a;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&Ww.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},Xw.prototype.findPlace=function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var a=0;a<t.length;a++)this.enterInner(t[a],null,!1);return!0},Xw.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1},Xw.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r},Xw.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==r?-5&o.options:Kw(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new qw(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},Xw.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},Xw.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},Xw.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},Jw.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},Xw.prototype.findAtPoint=function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)},Xw.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},Xw.prototype.findAround=function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node))t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},Xw.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},Xw.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),a=function(e,s){for(;e>=0;e--){var u=n[e];if(""==u){if(e==n.length-1||0==e)continue;for(;s>=i;s--)if(a(e-1,s))return!0;return!1}var c=s>0||0==s&&o?t.nodes[s].type:r&&s>=i?r.node(s-i).type:null;if(!c||c.name!=u&&-1==c.groups.indexOf(u))return!1;s--}return!0};return a(n.length-1,this.open)},Xw.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},Xw.prototype.addPendingMark=function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},Xw.prototype.removePendingMark=function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}},Object.defineProperties(Xw.prototype,Jw);var tS=function(e,t){this.nodes=e||{},this.marks=t||{}};function nS(e){var t={};for(var n in e){var r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function rS(e){return e.document||window.document}tS.prototype.serializeFragment=function(e,t,n){var r=this;void 0===t&&(t={}),n||(n=rS(t).createDocumentFragment());var o=n,i=null;return e.forEach((function(e){if(i||e.marks.length){i||(i=[]);for(var n=0,a=0;n<i.length&&a<e.marks.length;){var s=e.marks[a];if(r.marks[s.type.name]){if(!s.eq(i[n])||!1===s.type.spec.spanning)break;n+=2,a++}else a++}for(;n<i.length;)o=i.pop(),i.pop();for(;a<e.marks.length;){var u=e.marks[a++],c=r.serializeMark(u,e.isInline,t);c&&(i.push(u,o),o.appendChild(c.dom),o=c.contentDOM||c.dom)}}o.appendChild(r.serializeNode(e,t))})),n},tS.prototype.serializeNode=function(e,t){void 0===t&&(t={});var n=tS.renderSpec(rS(t),this.nodes[e.type.name](e)),r=n.dom,o=n.contentDOM;if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");t.onContent?t.onContent(e,o,t):this.serializeFragment(e.content,t,o)}return r},tS.prototype.serializeNodeAndMarks=function(e,t){void 0===t&&(t={});for(var n=this.serializeNode(e,t),r=e.marks.length-1;r>=0;r--){var o=this.serializeMark(e.marks[r],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(n),n=o.dom)}return n},tS.prototype.serializeMark=function(e,t,n){void 0===n&&(n={});var r=this.marks[e.type.name];return r&&tS.renderSpec(rS(n),r(e,t))},tS.renderSpec=function(e,t,n){if(void 0===n&&(n=null),"string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;var r=t[0],o=r.indexOf(" ");o>0&&(n=r.slice(0,o),r=r.slice(o+1));var i=null,a=n?e.createElementNS(n,r):e.createElement(r),s=t[1],u=1;if(s&&"object"==typeof s&&null==s.nodeType&&!Array.isArray(s))for(var c in u=2,s)if(null!=s[c]){var l=c.indexOf(" ");l>0?a.setAttributeNS(c.slice(0,l),c.slice(l+1),s[c]):a.setAttribute(c,s[c])}for(var f=u;f<t.length;f++){var h=t[f];if(0===h){if(f<t.length-1||f>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:a,contentDOM:a}}var p=tS.renderSpec(e,h,n),d=p.dom,m=p.contentDOM;if(a.appendChild(d),m){if(i)throw new RangeError("Multiple content holes");i=m}}return{dom:a,contentDOM:i}},tS.fromSchema=function(e){return e.cached.domSerializer||(e.cached.domSerializer=new tS(this.nodesFromSchema(e),this.marksFromSchema(e)))},tS.nodesFromSchema=function(e){var t=nS(e.nodes);return t.text||(t.text=function(e){return e.text}),t},tS.marksFromSchema=function(e){return nS(e.marks)};var oS=Math.pow(2,16);function iS(e,t){return e+t*oS}function aS(e){return 65535&e}var sS=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},uS=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};uS.prototype.recover=function(e){var t=0,n=aS(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/oS}(e)},uS.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},uS.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},uS.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?r:0);if(s>e)break;var u=this.ranges[a+o],c=this.ranges[a+i],l=s+u;if(e<=l){var f=s+r+((u?e==s?-1:e==l?1:t:t)<0?0:c);if(n)return f;var h=e==(t<0?s:l)?null:iS(a/3,e-s);return new sS(f,t<0?e!=s:e!=l,h)}r+=c-u}return n?e+r:new sS(e+r)},uS.prototype.touches=function(e,t){for(var n=0,r=aS(t),o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?n:0);if(s>e)break;var u=this.ranges[a+o];if(e<=s+u&&a==3*r)return!0;n+=this.ranges[a+i]-u}return!1},uS.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],a=i-(this.inverted?o:0),s=i+(this.inverted?0:o),u=this.ranges[r+t],c=this.ranges[r+n];e(a,a+u,s,s+c),o+=c-u}},uS.prototype.invert=function(){return new uS(this.ranges,!this.inverted)},uS.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},uS.offset=function(e){return 0==e?uS.empty:new uS(e<0?[0,-e,0]:[0,0,e])},uS.empty=new uS([]);var cS=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};function lS(e){var t=Error.call(this,e);return t.__proto__=lS.prototype,t}cS.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new cS(this.maps,this.mirror,e,t)},cS.prototype.copy=function(){return new cS(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},cS.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},cS.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},cS.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},cS.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},cS.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},cS.prototype.invert=function(){var e=new cS;return e.appendMappingInverted(this),e},cS.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},cS.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},cS.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var a=this.getMirror(o);if(null!=a&&a>o&&a<this.to){o=a,e=this.maps[a].recover(i.recover);continue}}i.deleted&&(r=!0),e=i.pos}return n?e:new sS(e,r)},lS.prototype=Object.create(Error.prototype),lS.prototype.constructor=lS,lS.prototype.name="TransformError";var fS=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new cS},hS={before:{configurable:!0},docChanged:{configurable:!0}};function pS(){throw new Error("Override me")}hS.before.get=function(){return this.docs.length?this.docs[0]:this.doc},fS.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new lS(t.failed);return this},fS.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},hS.docChanged.get=function(){return this.steps.length>0},fS.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(fS.prototype,hS);var dS=Object.create(null),mS=function(){};mS.prototype.apply=function(e){return pS()},mS.prototype.getMap=function(){return uS.empty},mS.prototype.invert=function(e){return pS()},mS.prototype.map=function(e){return pS()},mS.prototype.merge=function(e){return null},mS.prototype.toJSON=function(){return pS()},mS.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=dS[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},mS.jsonID=function(e,t){if(e in dS)throw new RangeError("Duplicate use of step JSON ID "+e);return dS[e]=t,t.prototype.jsonID=e,t};var vS=function(e,t){this.doc=e,this.failed=t};vS.ok=function(e){return new vS(e,null)},vS.fail=function(e){return new vS(null,e)},vS.fromReplace=function(e,t,n,r){try{return vS.ok(e.replace(t,n,r))}catch(e){if(e instanceof tw)return vS.fail(e.message);throw e}};var yS=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&bS(e,this.from,this.to)?vS.fail("Structure replace would overwrite content"):vS.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new uS([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?nw.empty:new nw(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?nw.empty:new nw(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,nw.fromJSON(e,n.slice),!!n.structure)},t}(mS);mS.jsonID("replace",yS);var gS=function(e){function t(t,n,r,o,i,a,s){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=a,this.structure=!!s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(bS(e,this.from,this.gapFrom)||bS(e,this.gapTo,this.to)))return vS.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return vS.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?vS.fromReplace(e,this.from,this.to,n):vS.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new uS([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,nw.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(mS);function bS(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var a=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,o--}return!1}function ES(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function wS(e){for(var t=e.parent.content.cutByIndex(e.startIndex,e.endIndex),n=e.depth;;--n){var r=e.$from.node(n),o=e.$from.index(n),i=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(o,i,t))return n;if(0==n||r.type.spec.isolating||!ES(r,o,i))break}}function SS(e,t,n,r){void 0===r&&(r=e);var o=function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.contentMatchAt(r).findWrapping(t);if(!i)return null;var a=i.length?i[0]:t;return n.canReplaceWith(r,o,a)?i:null}(e,t),i=o&&function(e,t){var n=e.parent,r=e.startIndex,o=e.endIndex,i=n.child(r),a=t.contentMatch.findWrapping(i.type);if(!a)return null;for(var s=(a.length?a[a.length-1]:t).contentMatch,u=r;s&&u<o;u++)s=s.matchType(n.child(u).type);if(!s||!s.validEnd)return null;return a}(r,t);return i?o.map(TS).concat({type:t,attrs:n}).concat(i.map(TS)):null}function TS(e){return{type:e,attrs:null}}function OS(e,t,n,r){void 0===n&&(n=1);var o=e.resolve(t),i=o.depth-n,a=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!a.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(var s=o.depth-1,u=n-2;s>i;s--,u--){var c=o.node(s),l=o.index(s);if(c.type.spec.isolating)return!1;var f=c.content.cutByIndex(l,c.childCount),h=r&&r[u]||c;if(h!=c&&(f=f.replaceChild(0,h.type.create(h.attrs))),!c.canReplace(l+1,c.childCount)||!h.type.validContent(f))return!1}var p=o.indexAfter(i),d=r&&r[0];return o.node(i).canReplaceWith(p,p,d?d.type:o.node(i+1).type)}function RS(e,t){var n=e.resolve(t),r=n.index();return NS(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function NS(e,t){return e&&t&&!e.isLeaf&&e.canAppend(t)}function kS(e,t,n){var r=e.resolve(t);if(!n.content.size)return t;for(var o=n.content,i=0;i<n.openStart;i++)o=o.firstChild.content;for(var a=1;a<=(0==n.openStart&&n.size?2:1);a++)for(var s=r.depth;s>=0;s--){var u=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,c=r.index(s)+(u>0?1:0),l=r.node(s),f=!1;if(1==a)f=l.canReplace(c,c,o);else{var h=l.contentMatchAt(c).findWrapping(o.firstChild.type);f=h&&l.canReplaceWith(c,c,h[0])}if(f)return 0==u?r.pos:u<0?r.before(s+1):r.after(s+1)}return null}function AS(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(AS(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return qE.fromArray(r)}mS.jsonID("replaceAround",gS),fS.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),a=r.after(o+1),s=i,u=a,c=qE.empty,l=0,f=o,h=!1;f>t;f--)h||n.index(f)>0?(h=!0,c=qE.from(n.node(f).copy(c)),l++):s--;for(var p=qE.empty,d=0,m=o,v=!1;m>t;m--)v||r.after(m+1)<r.end(m)?(v=!0,p=qE.from(r.node(m).copy(p)),d++):u++;return this.step(new gS(s,u,i,a,new nw(c.append(p),l,d),c.size-l,!0))},fS.prototype.wrap=function(e,t){for(var n=qE.empty,r=t.length-1;r>=0;r--)n=qE.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new gS(o,i,o,i,new nw(n,0,0),t.length,!0))},fS.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var a=o.mapping.slice(i),s=a.map(t,1),u=a.map(t+e.nodeSize,1);return o.step(new gS(s,u,s+1,u-1,new nw(qE.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}})),this},fS.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new gS(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new nw(qE.from(i),0,0),1,!0))},fS.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=qE.empty,i=qE.empty,a=r.depth,s=r.depth-t,u=t-1;a>s;a--,u--){o=qE.from(r.node(a).copy(o));var c=n&&n[u];i=qE.from(c?c.type.create(c.attrs,i):r.node(a).copy(i))}return this.step(new yS(e,e,new nw(o.append(i),t,t),!0))},fS.prototype.join=function(e,t){void 0===t&&(t=1);var n=new yS(e-t,e+t,nw.empty,!0);return this.step(n)};var CS=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new nw(AS(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return vS.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new MS(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(mS);mS.jsonID("addMark",CS);var MS=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new nw(AS(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),n.openStart,n.openEnd);return vS.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new CS(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(mS);function xS(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}mS.jsonID("removeMark",MS),fS.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],a=null,s=null;return this.doc.nodesBetween(e,t,(function(r,u,c){if(r.isInline){var l=r.marks;if(!n.isInSet(l)&&c.type.allowsMarkType(n.type)){for(var f=Math.max(u,e),h=Math.min(u+r.nodeSize,t),p=n.addToSet(l),d=0;d<l.length;d++)l[d].isInSet(p)||(a&&a.to==f&&a.mark.eq(l[d])?a.to=h:o.push(a=new MS(f,h,l[d])));s&&s.to==f?s.to=h:i.push(s=new CS(f,h,n))}}})),o.forEach((function(e){return r.step(e)})),i.forEach((function(e){return r.step(e)})),this},fS.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(r,a){if(r.isInline){i++;var s=null;if(n instanceof Vw)for(var u,c=r.marks;u=n.isInSet(c);)(s||(s=[])).push(u),c=u.removeFromSet(c);else n?n.isInSet(r.marks)&&(s=[n]):s=r.marks;if(s&&s.length)for(var l=Math.min(a+r.nodeSize,t),f=0;f<s.length;f++){for(var h=s[f],p=void 0,d=0;d<o.length;d++){var m=o[d];m.step==i-1&&h.eq(o[d].style)&&(p=m)}p?(p.to=l,p.step=i):o.push({style:h,from:Math.max(a,e),to:l,step:i})}}})),o.forEach((function(e){return r.step(new MS(e.from,e.to,e.style))})),this},fS.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,a=0;a<r.childCount;a++){var s=r.child(a),u=i+s.nodeSize,c=n.matchType(s.type,s.attrs);if(c){n=c;for(var l=0;l<s.marks.length;l++)t.allowsMarkType(s.marks[l].type)||this.step(new MS(i,u,s.marks[l]))}else o.push(new yS(i,u,nw.empty));i=u}if(!n.validEnd){var f=n.fillBefore(qE.empty,!0);this.replace(i,i,new nw(f,0,0))}for(var h=o.length-1;h>=0;h--)this.step(o[h]);return this},fS.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=nw.empty);var r=function(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=nw.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return xS(o,i,r)?new yS(t,n,r):new IS(o,i,r).fit()}(this.doc,e,t,n);return r&&this.step(r),this},fS.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new nw(qE.from(n),0,0))},fS.prototype.delete=function(e,t){return this.replace(e,t,nw.empty)},fS.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var IS=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=qE.empty;for(var i=e.depth;i>0;i--)this.placed=qE.from(e.node(i).copy(this.placed))},_S={depth:{configurable:!0}};function PS(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(PS(e.firstChild.content,t-1,n)))}function LS(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(LS(e.lastChild.content,t-1,n)))}function FS(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function DS(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,DS(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(qE.empty,!0)))),e.copy(r)}function US(e,t,n,r,o){var i=e.node(t),a=o?e.indexAfter(t):e.index(t);if(a==i.childCount&&!n.compatibleContent(i.type))return null;var s=r.fillBefore(i.content,!0,a);return s&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,a)?s:null}function jS(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(jS(i.content,t+1,n,r,i)))}if(t>r){var a=o.contentMatchAt(0),s=a.fillBefore(e).append(e);e=s.append(a.matchFragment(s).fillBefore(qE.empty,!0))}return e}function BS(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;o==t.start(r)&&n.push(r)}return n}_S.depth.get=function(){return this.frontier.length-1},IS.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,a=r.depth,s=o.depth;a&&s&&1==i.childCount;)i=i.firstChild.content,a--,s--;var u=new nw(i,a,s);return t>-1?new gS(r.pos,t,this.$to.pos,this.$to.end(),u,n):u.size||r.pos!=this.$to.pos?new yS(r.pos,o.pos,u):void 0},IS.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var n=void 0,r=(t?(n=FS(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],a=i.type,s=i.match,u=void 0,c=void 0;if(1==e&&(r?s.matchType(r.type)||(c=s.fillBefore(qE.from(r),!1)):a.compatibleContent(n.type)))return{sliceDepth:t,frontierDepth:o,parent:n,inject:c};if(2==e&&r&&(u=s.findWrapping(r.type)))return{sliceDepth:t,frontierDepth:o,parent:n,wrap:u};if(n&&s.matchType(n.type))break}},IS.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=FS(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new nw(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},IS.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=FS(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new nw(PS(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new nw(PS(t,n,1),n,r)},IS.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var a=0;a<i.length;a++)this.openFrontierNode(i[a]);var s=this.unplaced,u=r?r.content:s.content,c=s.openStart-t,l=0,f=[],h=this.frontier[n],p=h.match,d=h.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));p=p.matchFragment(o)}for(var v=u.size+t-(s.content.size-s.openEnd);l<u.childCount;){var y=u.child(l),g=p.matchType(y.type);if(!g)break;(++l>1||0==c||y.content.size)&&(p=g,f.push(DS(y.mark(d.allowedMarks(y.marks)),1==l?c:0,l==u.childCount?v:-1)))}var b=l==u.childCount;b||(v=-1),this.placed=LS(this.placed,n,qE.from(f)),this.frontier[n].match=p,b&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var E=0,w=u;E<v;E++){var S=w.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),w=S.content}this.unplaced=b?0==t?nw.empty:new nw(PS(s.content,t-1,1),t-1,v<0?s.openEnd:t-1):new nw(PS(s.content,t,l),s.openStart,s.openEnd)},IS.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!US(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},IS.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),a=US(e,t,o,r,i);if(a){for(var s=t-1;s>=0;s--){var u=this.frontier[s],c=u.match,l=US(e,s,u.type,c,!0);if(!l||l.childCount)continue e}return{depth:t,fit:a,move:i?e.doc.resolve(e.after(t+1)):e}}}},IS.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=LS(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e},IS.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=LS(this.placed,this.depth,qE.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},IS.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(qE.empty,!0);e.childCount&&(this.placed=LS(this.placed,this.frontier.length,e))},Object.defineProperties(IS.prototype,_S),fS.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(xS(r,o,n))return this.step(new yS(e,t,n));var i=BS(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var a=-(r.depth+1);i.unshift(a);for(var s=r.depth,u=r.pos-1;s>0;s--,u--){var c=r.node(s).type.spec;if(c.defining||c.isolating)break;i.indexOf(s)>-1?a=s:r.before(s)==u&&i.splice(1,0,-s)}for(var l=i.indexOf(a),f=[],h=n.openStart,p=n.content,d=0;;d++){var m=p.firstChild;if(f.push(m),d==n.openStart)break;p=m.content}h>0&&f[h-1].type.spec.defining&&r.node(l).type!=f[h-1].type?h-=1:h>=2&&f[h-1].isTextblock&&f[h-2].type.spec.defining&&r.node(l).type!=f[h-2].type&&(h-=2);for(var v=n.openStart;v>=0;v--){var y=(v+h+1)%(n.openStart+1),g=f[y];if(g)for(var b=0;b<i.length;b++){var E=i[(b+l)%i.length],w=!0;E<0&&(w=!1,E=-E);var S=r.node(E-1),T=r.index(E-1);if(S.canReplaceWith(T,T,g.type,g.marks))return this.replace(r.before(E),w?o.after(E):t,new nw(jS(n.content,0,n.openStart,y),y,n.openEnd))}}for(var O=this.steps.length,R=i.length-1;R>=0&&(this.replace(e,t,n),!(this.steps.length>O));R--){var N=i[R];N<0||(e=r.before(N),t=o.after(N))}return this},fS.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var a=r.depth-1;a>=0;a--){var s=r.indexAfter(a);if(r.node(a).canReplaceWith(s,s,n))return r.after(a+1);if(s<r.node(a).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new nw(qE.from(n),0,0))},fS.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=BS(n,r),i=0;i<o.length;i++){var a=o[i],s=i==o.length-1;if(s&&0==a||n.node(a).type.contentMatch.validEnd)return this.delete(n.start(a),r.end(a));if(a>0&&(s||n.node(a-1).canReplace(n.index(a-1),r.indexAfter(a-1))))return this.delete(n.before(a),r.after(a))}for(var u=1;u<=n.depth&&u<=r.depth;u++)if(e-n.start(u)==n.depth-u&&t>n.end(u)&&r.end(u)-t!=r.depth-u)return this.delete(n.before(u),t);return this.delete(e,t)};var VS=Object.create(null),HS=function(e,t,n){this.ranges=n||[new zS(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},GS={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};GS.anchor.get=function(){return this.$anchor.pos},GS.head.get=function(){return this.$head.pos},GS.from.get=function(){return this.$from.pos},GS.to.get=function(){return this.$to.pos},GS.$from.get=function(){return this.ranges[0].$from},GS.$to.get=function(){return this.ranges[0].$to},GS.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},HS.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},HS.prototype.replace=function(e,t){void 0===t&&(t=nw.empty);for(var n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,a=this.ranges,s=0;s<a.length;s++){var u=a[s],c=u.$from,l=u.$to,f=e.mapping.slice(i);e.replaceRange(f.map(c.pos),f.map(l.pos),s?nw.empty:t),0==s&&QS(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},HS.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],a=i.$from,s=i.$to,u=e.mapping.slice(n),c=u.map(a.pos),l=u.map(s.pos);o?e.deleteRange(c,l):(e.replaceRangeWith(c,l,t),QS(e,n,t.isInline?-1:1))}},HS.findFrom=function(e,t,n){var r=e.parent.inlineContent?new WS(e):JS(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?JS(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):JS(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}},HS.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new qS(e.node(0))},HS.atStart=function(e){return JS(e,e,0,0,1)||new qS(e)},HS.atEnd=function(e){return JS(e,e,e.content.size,e.childCount,-1)||new qS(e)},HS.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=VS[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},HS.jsonID=function(e,t){if(e in VS)throw new RangeError("Duplicate use of selection JSON ID "+e);return VS[e]=t,t.prototype.jsonID=e,t},HS.prototype.getBookmark=function(){return WS.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(HS.prototype,GS),HS.prototype.visible=!0;var zS=function(e,t){this.$from=e,this.$to=t},WS=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=nw.empty),e.prototype.replace.call(this,t,n),n==nw.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new $S(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var a=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!a)return e.near(r,o);r=a.$head}return n.parent.inlineContent||(0==i||(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new t(n,r)},Object.defineProperties(t.prototype,n),t}(HS);HS.jsonID("text",WS);var $S=function(e,t){this.anchor=e,this.head=t};$S.prototype.map=function(e){return new $S(e.map(this.anchor),e.map(this.head))},$S.prototype.resolve=function(e){return WS.between(e.resolve(this.anchor),e.resolve(this.head))};var YS=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,a=o.pos,s=n.resolve(a);return i?e.near(s):new t(s)},t.prototype.content=function(){return new nw(qE.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new KS(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(HS);YS.prototype.visible=!1,HS.jsonID("node",YS);var KS=function(e){this.anchor=e};KS.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new $S(r,r):new KS(r)},KS.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&YS.isSelectable(n)?new YS(t):HS.near(t)};var qS=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,n){if(void 0===n&&(n=nw.empty),n==nw.empty){t.delete(0,t.doc.content.size);var r=e.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else e.prototype.replace.call(this,t,n)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return XS},t}(HS);HS.jsonID("all",qS);var XS={map:function(){return this},resolve:function(e){return new qS(e)}};function JS(e,t,n,r,o,i){if(t.inlineContent)return WS.create(e,n);for(var a=r-(o>0?0:1);o>0?a<t.childCount:a>=0;a+=o){var s=t.child(a);if(s.isAtom){if(!i&&YS.isSelectable(s))return YS.create(e,n-(o<0?s.nodeSize:0))}else{var u=JS(e,s,n+o,o<0?s.childCount:0,o,i);if(u)return u}n+=s.nodeSize*o}}function QS(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];if(i instanceof yS||i instanceof gS)e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(HS.near(e.doc.resolve(o),n))}}var ZS=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return ew.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ew.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(HS.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(fS);function eT(e,t){return t&&e?e.bind(t):e}var tT=function(e,t,n){this.name=e,this.init=eT(t.init,n),this.apply=eT(t.apply,n)},nT=[new tT("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new tT("selection",{init:function(e,t){return e.selection||HS.atStart(t.doc)},apply:function(e){return e.selection}}),new tT("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new tT("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],rT=function(e,t){var n=this;this.schema=e,this.fields=nT.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new tT(e.key,e.spec.state,e))}))},oT=function(e){this.config=e},iT={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};iT.schema.get=function(){return this.config.schema},iT.plugins.get=function(){return this.config.plugins},oT.prototype.apply=function(e){return this.applyTransaction(e).state},oT.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0},oT.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var a=this.config.plugins[i];if(a.spec.appendTransaction){var s=r?r[i].n:0,u=r?r[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,u,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}},oT.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new oT(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<aT.length;i++)aT[i](this,e,t);return t},iT.tr.get=function(){return new ZS(this)},oT.create=function(e){for(var t=new rT(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new oT(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},oT.prototype.reconfigure=function(e){for(var t=new rT(this.schema,e.plugins),n=t.fields,r=new oT(t),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(e,r)}return r},oT.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t},oT.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new rT(e.schema,e.plugins),o=new oT(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=bw.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=HS.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var a=n[i],s=a.spec.state;if(a.key==r.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=s.fromJSON.call(a,e,t[i],o))}o[r.name]=r.init(e,o)}})),o},oT.addApplyListener=function(e){aT.push(e)},oT.removeApplyListener=function(e){var t=aT.indexOf(e);t>-1&&aT.splice(t,1)},Object.defineProperties(oT.prototype,iT);var aT=[];var sT=function(e){this.props={},e.props&&function e(t,n,r){for(var o in t){var i=t[o];i instanceof Function?i=i.bind(n):"handleDOMEvents"==o&&(i=e(i,n,{})),r[o]=i}return r}(e.props,this,this.props),this.spec=e,this.key=e.key?e.key.key:cT("plugin")};sT.prototype.getState=function(e){return e[this.key]};var uT=Object.create(null);function cT(e){return e in uT?e+"$"+ ++uT[e]:(uT[e]=0,e+"$")}var lT=function(e){void 0===e&&(e="key"),this.key=cT(e)};lT.prototype.get=function(e){return e.config.pluginsByKey[this.key]},lT.prototype.getState=function(e){return e[this.key]};var fT={};if("undefined"!=typeof navigator&&"undefined"!=typeof document){var hT=/Edge\/(\d+)/.exec(navigator.userAgent),pT=/MSIE \d/.test(navigator.userAgent),dT=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);fT.mac=/Mac/.test(navigator.platform);var mT=fT.ie=!!(pT||dT||hT);fT.ie_version=pT?document.documentMode||6:dT?+dT[1]:hT?+hT[1]:null,fT.gecko=!mT&&/gecko\/(\d+)/i.test(navigator.userAgent),fT.gecko_version=fT.gecko&&+(/Firefox\/(\d+)/.exec(navigator.userAgent)||[0,0])[1];var vT=!mT&&/Chrome\/(\d+)/.exec(navigator.userAgent);fT.chrome=!!vT,fT.chrome_version=vT&&+vT[1],fT.safari=!mT&&/Apple Computer/.test(navigator.vendor),fT.ios=fT.safari&&(/Mobile\/\w+/.test(navigator.userAgent)||navigator.maxTouchPoints>2),fT.android=/Android \d/.test(navigator.userAgent),fT.webkit="webkitFontSmoothing"in document.documentElement.style,fT.webkit_version=fT.webkit&&+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]}var yT=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},gT=function(e){var t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t},bT=null,ET=function(e,t,n){var r=bT||(bT=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},wT=function(e,t,n,r){return n&&(TT(e,t,n,r,-1)||TT(e,t,n,r,1))},ST=/^(img|br|input|textarea|hr)$/i;function TT(e,t,n,r,o){for(;;){if(e==n&&t==r)return!0;if(t==(o<0?0:OT(e))){var i=e.parentNode;if(1!=i.nodeType||RT(e)||ST.test(e.nodeName)||"false"==e.contentEditable)return!1;t=yT(e)+(o<0?0:1),e=i}else{if(1!=e.nodeType)return!1;if("false"==(e=e.childNodes[t+(o<0?-1:0)]).contentEditable)return!1;t=o<0?OT(e):0}}}function OT(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function RT(e){for(var t,n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}var NT=function(e){var t=e.isCollapsed;return t&&fT.chrome&&e.rangeCount&&!e.getRangeAt(0).collapsed&&(t=!1),t};function kT(e,t){var n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}function AT(e){return{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function CT(e,t){return"number"==typeof e?e:e[t]}function MT(e){var t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function xT(e,t,n){for(var r=e.someProp("scrollThreshold")||0,o=e.someProp("scrollMargin")||5,i=e.dom.ownerDocument,a=n||e.dom;a;a=gT(a))if(1==a.nodeType){var s=a==i.body||1!=a.nodeType,u=s?AT(i):MT(a),c=0,l=0;if(t.top<u.top+CT(r,"top")?l=-(u.top-t.top+CT(o,"top")):t.bottom>u.bottom-CT(r,"bottom")&&(l=t.bottom-u.bottom+CT(o,"bottom")),t.left<u.left+CT(r,"left")?c=-(u.left-t.left+CT(o,"left")):t.right>u.right-CT(r,"right")&&(c=t.right-u.right+CT(o,"right")),c||l)if(s)i.defaultView.scrollBy(c,l);else{var f=a.scrollLeft,h=a.scrollTop;l&&(a.scrollTop+=l),c&&(a.scrollLeft+=c);var p=a.scrollLeft-f,d=a.scrollTop-h;t={left:t.left-p,top:t.top-d,right:t.right-p,bottom:t.bottom-d}}if(s)break}}function IT(e){for(var t=[],n=e.ownerDocument;e&&(t.push({dom:e,top:e.scrollTop,left:e.scrollLeft}),e!=n);e=gT(e));return t}function _T(e,t){for(var n=0;n<e.length;n++){var r=e[n],o=r.dom,i=r.top,a=r.left;o.scrollTop!=i+t&&(o.scrollTop=i+t),o.scrollLeft!=a&&(o.scrollLeft=a)}}var PT=null;function LT(e,t){for(var n,r,o=2e8,i=0,a=t.top,s=t.top,u=e.firstChild,c=0;u;u=u.nextSibling,c++){var l=void 0;if(1==u.nodeType)l=u.getClientRects();else{if(3!=u.nodeType)continue;l=ET(u).getClientRects()}for(var f=0;f<l.length;f++){var h=l[f];if(h.top<=a&&h.bottom>=s){a=Math.max(h.bottom,a),s=Math.min(h.top,s);var p=h.left>t.left?h.left-t.left:h.right<t.left?t.left-h.right:0;if(p<o){n=u,o=p,r=p&&3==n.nodeType?{left:h.right<t.left?h.right:h.left,top:t.top}:t,1==u.nodeType&&p&&(i=c+(t.left>=(h.left+h.right)/2?1:0));continue}}!n&&(t.left>=h.right&&t.top>=h.top||t.left>=h.left&&t.top>=h.bottom)&&(i=c+1)}}return n&&3==n.nodeType?function(e,t){for(var n=e.nodeValue.length,r=document.createRange(),o=0;o<n;o++){r.setEnd(e,o+1),r.setStart(e,o);var i=UT(r,1);if(i.top!=i.bottom&&FT(t,i))return{node:e,offset:o+(t.left>=(i.left+i.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:i}:LT(n,r)}function FT(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function DT(e,t){var n,r,o,i,a=e.root;if(a.caretPositionFromPoint)try{var s=a.caretPositionFromPoint(t.left,t.top);s&&(o=(n=s).offsetNode,i=n.offset)}catch(e){}if(!o&&a.caretRangeFromPoint){var u=a.caretRangeFromPoint(t.left,t.top);u&&(o=(r=u).startContainer,i=r.startOffset)}var c,l=a.elementFromPoint(t.left,t.top+1);if(!l||!e.dom.contains(1!=l.nodeType?l.parentNode:l)){var f=e.dom.getBoundingClientRect();if(!FT(t,f))return null;if(!(l=function e(t,n,r){var o=t.childNodes.length;if(o&&r.top<r.bottom)for(var i=Math.max(0,Math.min(o-1,Math.floor(o*(n.top-r.top)/(r.bottom-r.top))-2)),a=i;;){var s=t.childNodes[a];if(1==s.nodeType)for(var u=s.getClientRects(),c=0;c<u.length;c++){var l=u[c];if(FT(n,l))return e(s,n,l)}if((a=(a+1)%o)==i)break}return t}(e.dom,t,f)))return null}if(fT.safari)for(var h=l;o&&h;h=gT(h))h.draggable&&(o=i=null);if(l=function(e,t){var n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(l,t),o){if(fT.gecko&&1==o.nodeType&&(i=Math.min(i,o.childNodes.length))<o.childNodes.length){var p,d=o.childNodes[i];"IMG"==d.nodeName&&(p=d.getBoundingClientRect()).right<=t.left&&p.bottom>t.top&&i++}o==e.dom&&i==o.childNodes.length-1&&1==o.lastChild.nodeType&&t.top>o.lastChild.getBoundingClientRect().bottom?c=e.state.doc.content.size:0!=i&&1==o.nodeType&&"BR"==o.childNodes[i-1].nodeName||(c=function(e,t,n,r){for(var o=-1,i=t;i!=e.dom;){var a=e.docView.nearestDesc(i,!0);if(!a)return null;if(a.node.isBlock&&a.parent){var s=a.dom.getBoundingClientRect();if(s.left>r.left||s.top>r.top)o=a.posBefore;else{if(!(s.right<r.left||s.bottom<r.top))break;o=a.posAfter}}i=a.dom.parentNode}return o>-1?o:e.docView.posFromDOM(t,n)}(e,o,i,t))}null==c&&(c=function(e,t,n){var r=LT(t,n),o=r.node,i=r.offset,a=-1;if(1==o.nodeType&&!o.firstChild){var s=o.getBoundingClientRect();a=s.left!=s.right&&n.left>(s.left+s.right)/2?1:-1}return e.docView.posFromDOM(o,i,a)}(e,l,t));var m=e.docView.nearestDesc(l,!0);return{pos:c,inside:m?m.posAtStart-m.border:-1}}function UT(e,t){var n=e.getClientRects();return n.length?n[t<0?0:n.length-1]:e.getBoundingClientRect()}var jT=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function BT(e,t,n){var r=e.docView.domFromPos(t,n<0?-1:1),o=r.node,i=r.offset,a=fT.webkit||fT.gecko;if(3==o.nodeType){if(!a||!jT.test(o.nodeValue)&&(n<0?i:i!=o.nodeValue.length)){var s=i,u=i,c=n<0?1:-1;return n<0&&!i?(u++,c=-1):n>=0&&i==o.nodeValue.length?(s--,c=1):n<0?s--:u++,VT(UT(ET(o,s,u),c),c<0)}var l=UT(ET(o,i,i),n);if(fT.gecko&&i&&/\s/.test(o.nodeValue[i-1])&&i<o.nodeValue.length){var f=UT(ET(o,i-1,i-1),-1);if(f.top==l.top){var h=UT(ET(o,i,i+1),-1);if(h.top!=l.top)return VT(h,h.left<f.left)}}return l}if(!e.state.doc.resolve(t).parent.inlineContent){if(i&&(n<0||i==OT(o))){var p=o.childNodes[i-1];if(1==p.nodeType)return HT(p.getBoundingClientRect(),!1)}if(i<OT(o)){var d=o.childNodes[i];if(1==d.nodeType)return HT(d.getBoundingClientRect(),!0)}return HT(o.getBoundingClientRect(),n>=0)}if(i&&(n<0||i==OT(o))){var m=o.childNodes[i-1],v=3==m.nodeType?ET(m,OT(m)-(a?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(v)return VT(UT(v,1),!1)}if(i<OT(o)){var y=o.childNodes[i],g=3==y.nodeType?ET(y,0,a?0:1):1==y.nodeType?y:null;if(g)return VT(UT(g,-1),!0)}return VT(UT(3==o.nodeType?ET(o):o,-n),n>=0)}function VT(e,t){if(0==e.width)return e;var n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function HT(e,t){if(0==e.height)return e;var n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function GT(e,t,n){var r=e.state,o=e.root.activeElement;r!=t&&e.updateState(t),o!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),o!=e.dom&&o&&o.focus()}}var zT=/[\u0590-\u08ac]/;var WT=null,$T=null,YT=!1;function KT(e,t,n){return WT==t&&$T==n?YT:(WT=t,$T=n,YT="up"==n||"down"==n?function(e,t,n){var r=t.selection,o="up"==n?r.$from:r.$to;return GT(e,t,(function(){for(var t=e.docView.domFromPos(o.pos,"up"==n?-1:1).node;;){var r=e.docView.nearestDesc(t,!0);if(!r)break;if(r.node.isBlock){t=r.dom;break}t=r.dom.parentNode}for(var i=BT(e,o.pos,1),a=t.firstChild;a;a=a.nextSibling){var s=void 0;if(1==a.nodeType)s=a.getClientRects();else{if(3!=a.nodeType)continue;s=ET(a,0,a.nodeValue.length).getClientRects()}for(var u=0;u<s.length;u++){var c=s[u];if(c.bottom>c.top&&("up"==n?c.bottom<i.top+1:c.top>i.bottom-1))return!1}}return!0}))}(e,t,n):function(e,t,n){var r=t.selection.$head;if(!r.parent.isTextblock)return!1;var o=r.parentOffset,i=!o,a=o==r.parent.content.size,s=getSelection();return zT.test(r.parent.textContent)&&s.modify?GT(e,t,(function(){var t=s.getRangeAt(0),o=s.focusNode,i=s.focusOffset,a=s.caretBidiLevel;s.modify("move",n,"character");var u=!(r.depth?e.docView.domAfterPos(r.before()):e.dom).contains(1==s.focusNode.nodeType?s.focusNode:s.focusNode.parentNode)||o==s.focusNode&&i==s.focusOffset;return s.removeAllRanges(),s.addRange(t),null!=a&&(s.caretBidiLevel=a),u})):"left"==n||"backward"==n?i:a}(e,t,n))}var qT=function(e,t,n,r){this.parent=e,this.children=t,this.dom=n,n.pmViewDesc=this,this.contentDOM=r,this.dirty=0},XT={beforePosition:{configurable:!0},size:{configurable:!0},border:{configurable:!0},posBefore:{configurable:!0},posAtStart:{configurable:!0},posAfter:{configurable:!0},posAtEnd:{configurable:!0},contentLost:{configurable:!0},domAtom:{configurable:!0}};qT.prototype.matchesWidget=function(){return!1},qT.prototype.matchesMark=function(){return!1},qT.prototype.matchesNode=function(){return!1},qT.prototype.matchesHack=function(e){return!1},XT.beforePosition.get=function(){return!1},qT.prototype.parseRule=function(){return null},qT.prototype.stopEvent=function(){return!1},XT.size.get=function(){for(var e=0,t=0;t<this.children.length;t++)e+=this.children[t].size;return e},XT.border.get=function(){return 0},qT.prototype.destroy=function(){this.parent=null,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=null);for(var e=0;e<this.children.length;e++)this.children[e].destroy()},qT.prototype.posBeforeChild=function(e){for(var t=0,n=this.posAtStart;t<this.children.length;t++){var r=this.children[t];if(r==e)return n;n+=r.size}},XT.posBefore.get=function(){return this.parent.posBeforeChild(this)},XT.posAtStart.get=function(){return this.parent?this.parent.posBeforeChild(this)+this.border:0},XT.posAfter.get=function(){return this.posBefore+this.size},XT.posAtEnd.get=function(){return this.posAtStart+this.size-2*this.border},qT.prototype.localPosFromDOM=function(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){var r,o;if(e==this.contentDOM)r=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;r=e.previousSibling}for(;r&&(!(o=r.pmViewDesc)||o.parent!=this);)r=r.previousSibling;return r?this.posBeforeChild(o)+o.size:this.posAtStart}var i,a;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&(!(a=i.pmViewDesc)||a.parent!=this);)i=i.nextSibling;return i?this.posBeforeChild(a):this.posAtEnd}var s;if(e==this.dom&&this.contentDOM)s=t>yT(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))s=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(var u=e;;u=u.parentNode){if(u==this.dom){s=!1;break}if(u.parentNode.firstChild!=u)break}if(null==s&&t==e.childNodes.length)for(var c=e;;c=c.parentNode){if(c==this.dom){s=!0;break}if(c.parentNode.lastChild!=c)break}}return(null==s?n>0:s)?this.posAtEnd:this.posAtStart},qT.prototype.nearestDesc=function(e,t){for(var n=!0,r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o&&(!t||o.node)){if(!n||!o.nodeDOM||(1==o.nodeDOM.nodeType?o.nodeDOM.contains(1==e.nodeType?e:e.parentNode):o.nodeDOM==e))return o;n=!1}}},qT.prototype.getDesc=function(e){for(var t=e.pmViewDesc,n=t;n;n=n.parent)if(n==this)return t},qT.prototype.posFromDOM=function(e,t,n){for(var r=e;r;r=r.parentNode){var o=this.getDesc(r);if(o)return o.localPosFromDOM(e,t,n)}return-1},qT.prototype.descAt=function(e){for(var t=0,n=0;t<this.children.length;t++){var r=this.children[t],o=n+r.size;if(n==e&&o!=n){for(;!r.border&&r.children.length;)r=r.children[0];return r}if(e<o)return r.descAt(e-n-r.border);n=o}},qT.prototype.domFromPos=function(e,t){if(!this.contentDOM)return{node:this.dom,offset:0};for(var n=0,r=0,o=!0;;r++,o=!1){for(;r<this.children.length&&(this.children[r].beforePosition||this.children[r].dom.parentNode!=this.contentDOM);)n+=this.children[r++].size;var i=r==this.children.length?null:this.children[r];if(n==e&&(0==t||!i||!i.size||i.border||t<0&&o)||i&&i.domAtom&&e<n+i.size)return{node:this.contentDOM,offset:i?yT(i.dom):this.contentDOM.childNodes.length};if(!i)throw new Error("Invalid position "+e);var a=n+i.size;if(!i.domAtom&&(t<0&&!i.border?a>=e:a>e)&&(a>e||r+1>=this.children.length||!this.children[r+1].beforePosition))return i.domFromPos(e-n-i.border,t);n=a}},qT.prototype.parseRange=function(e,t,n){if(void 0===n&&(n=0),0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};for(var r=-1,o=-1,i=n,a=0;;a++){var s=this.children[a],u=i+s.size;if(-1==r&&e<=u){var c=i+s.border;if(e>=c&&t<=u-s.border&&s.node&&s.contentDOM&&this.contentDOM.contains(s.contentDOM))return s.parseRange(e,t,c);e=i;for(var l=a;l>0;l--){var f=this.children[l-1];if(f.size&&f.dom.parentNode==this.contentDOM&&!f.emptyChildAt(1)){r=yT(f.dom)+1;break}e-=f.size}-1==r&&(r=0)}if(r>-1&&(u>t||a==this.children.length-1)){t=u;for(var h=a+1;h<this.children.length;h++){var p=this.children[h];if(p.size&&p.dom.parentNode==this.contentDOM&&!p.emptyChildAt(-1)){o=yT(p.dom);break}t+=p.size}-1==o&&(o=this.contentDOM.childNodes.length);break}i=u}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:o}},qT.prototype.emptyChildAt=function(e){if(this.border||!this.contentDOM||!this.children.length)return!1;var t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)},qT.prototype.domAfterPos=function(e){var t=this.domFromPos(e,0),n=t.node,r=t.offset;if(1!=n.nodeType||r==n.childNodes.length)throw new RangeError("No node after pos "+e);return n.childNodes[r]},qT.prototype.setSelection=function(e,t,n,r){for(var o=Math.min(e,t),i=Math.max(e,t),a=0,s=0;a<this.children.length;a++){var u=this.children[a],c=s+u.size;if(o>s&&i<c)return u.setSelection(e-s-u.border,t-s-u.border,n,r);s=c}var l=this.domFromPos(e,e?-1:1),f=t==e?l:this.domFromPos(t,t?-1:1),h=n.getSelection(),p=!1;if((fT.gecko||fT.safari)&&e==t){var d=l.node,m=l.offset;if(3==d.nodeType){if((p=m&&"\n"==d.nodeValue[m-1])&&m==d.nodeValue.length)for(var v=d,y=void 0;v;v=v.parentNode){if(y=v.nextSibling){"BR"==y.nodeName&&(l=f={node:y.parentNode,offset:yT(y)+1});break}var g=v.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{var b=d.childNodes[m-1];p=b&&("BR"==b.nodeName||"false"==b.contentEditable)}}if(fT.gecko&&h.focusNode&&h.focusNode!=f.node&&1==h.focusNode.nodeType){var E=h.focusNode.childNodes[h.focusOffset];E&&"false"==E.contentEditable&&(r=!0)}if(r||p&&fT.safari||!wT(l.node,l.offset,h.anchorNode,h.anchorOffset)||!wT(f.node,f.offset,h.focusNode,h.focusOffset)){var w=!1;if((h.extend||e==t)&&!p){h.collapse(l.node,l.offset);try{e!=t&&h.extend(f.node,f.offset),w=!0}catch(e){if(!(e instanceof DOMException))throw e}}if(!w){if(e>t){var S=l;l=f,f=S}var T=document.createRange();T.setEnd(f.node,f.offset),T.setStart(l.node,l.offset),h.removeAllRanges(),h.addRange(T)}}},qT.prototype.ignoreMutation=function(e){return!this.contentDOM&&"selection"!=e.type},XT.contentLost.get=function(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)},qT.prototype.markDirty=function(e,t){for(var n=0,r=0;r<this.children.length;r++){var o=this.children[r],i=n+o.size;if(n==i?e<=i&&t>=n:e<i&&t>n){var a=n+o.border,s=i-o.border;if(e>=a&&t<=s)return this.dirty=e==n||t==i?2:1,void(e!=a||t!=s||!o.contentLost&&o.dom.parentNode==this.contentDOM?o.markDirty(e-a,t-a):o.dirty=3);o.dirty=3}n=i}this.dirty=2},qT.prototype.markParentsDirty=function(){for(var e=1,t=this.parent;t;t=t.parent,e++){var n=1==e?2:1;t.dirty<n&&(t.dirty=n)}},XT.domAtom.get=function(){return!1},Object.defineProperties(qT.prototype,XT);var JT=[],QT=function(e){function t(t,n,r,o){var i,a=n.type.toDOM;if("function"==typeof a&&(a=a(r,(function(){return i?i.parent?i.parent.posBeforeChild(i):void 0:o}))),!n.type.spec.raw){if(1!=a.nodeType){var s=document.createElement("span");s.appendChild(a),a=s}a.contentEditable=!1,a.classList.add("ProseMirror-widget")}e.call(this,t,JT,a,null),this.widget=n,i=this}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={beforePosition:{configurable:!0},domAtom:{configurable:!0}};return n.beforePosition.get=function(){return this.widget.type.side<0},t.prototype.matchesWidget=function(e){return 0==this.dirty&&e.type.eq(this.widget.type)},t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.stopEvent=function(e){var t=this.widget.spec.stopEvent;return!!t&&t(e)},t.prototype.ignoreMutation=function(e){return"selection"!=e.type||this.widget.spec.ignoreSelection},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(qT),ZT=function(e){function t(t,n,r,o){e.call(this,t,JT,n,null),this.textDOM=r,this.text=o}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0}};return n.size.get=function(){return this.text.length},t.prototype.localPosFromDOM=function(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t},t.prototype.domFromPos=function(e){return{node:this.textDOM,offset:e}},t.prototype.ignoreMutation=function(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue},Object.defineProperties(t.prototype,n),t}(qT),eO=function(e){function t(t,n,r,o){e.call(this,t,[],r,o),this.mark=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.create=function(e,n,r,o){var i=o.nodeViews[n.type.name],a=i&&i(n,o,r);return a&&a.dom||(a=tS.renderSpec(document,n.type.spec.toDOM(n,r))),new t(e,n,a.dom,a.contentDOM||a.dom)},t.prototype.parseRule=function(){return{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}},t.prototype.matchesMark=function(e){return 3!=this.dirty&&this.mark.eq(e)},t.prototype.markDirty=function(t,n){if(e.prototype.markDirty.call(this,t,n),0!=this.dirty){for(var r=this.parent;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=0}},t.prototype.slice=function(e,n,r){var o=t.create(this.parent,this.mark,!0,r),i=this.children,a=this.size;n<a&&(i=vO(i,n,a,r)),e>0&&(i=vO(i,0,e,r));for(var s=0;s<i.length;s++)i[s].parent=o;return o.children=i,o},t}(qT),tO=function(e){function t(t,n,r,o,i,a,s,u,c){e.call(this,t,n.isLeaf?JT:[],i,a),this.nodeDOM=s,this.node=n,this.outerDeco=r,this.innerDeco=o,a&&this.updateChildren(u,c)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={size:{configurable:!0},border:{configurable:!0},domAtom:{configurable:!0}};return t.create=function(e,n,r,o,i,a){var s,u,c=i.nodeViews[n.type.name],l=c&&c(n,i,(function(){return u?u.parent?u.parent.posBeforeChild(u):void 0:a}),r,o),f=l&&l.dom,h=l&&l.contentDOM;if(n.isText)if(f){if(3!=f.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else f=document.createTextNode(n.text);else f||(f=(s=tS.renderSpec(document,n.type.spec.toDOM(n))).dom,h=s.contentDOM);h||n.isText||"BR"==f.nodeName||(f.hasAttribute("contenteditable")||(f.contentEditable=!1),n.type.spec.draggable&&(f.draggable=!0));var p=f;return f=fO(f,r,n),l?u=new iO(e,n,r,o,f,h,p,l,i,a+1):n.isText?new rO(e,n,r,o,f,p,i):new t(e,n,r,o,f,h,p,i,a+1)},t.prototype.parseRule=function(){var e=this;if(this.node.type.spec.reparseInView)return null;var t={node:this.node.type.name,attrs:this.node.attrs};return this.node.type.spec.code&&(t.preserveWhitespace="full"),this.contentDOM&&!this.contentLost?t.contentElement=this.contentDOM:t.getContent=function(){return e.contentDOM?qE.empty:e.node.content},t},t.prototype.matchesNode=function(e,t,n){return 0==this.dirty&&e.eq(this.node)&&hO(t,this.outerDeco)&&n.eq(this.innerDeco)},n.size.get=function(){return this.node.nodeSize},n.border.get=function(){return this.node.isLeaf?0:1},t.prototype.updateChildren=function(e,t){var n=this,r=this.node.inlineContent,o=t,i=r&&e.composing&&this.localCompositionNode(e,t),a=new dO(this,i&&i.node);!function(e,t,n,r){var o=t.locals(e),i=0;if(0==o.length){for(var a=0;a<e.childCount;a++){var s=e.child(a);r(s,o,t.forChild(i,s),a),i+=s.nodeSize}return}for(var u=0,c=[],l=null,f=0;;){if(u<o.length&&o[u].to==i){for(var h=o[u++],p=void 0;u<o.length&&o[u].to==i;)(p||(p=[h])).push(o[u++]);if(p){p.sort(mO);for(var d=0;d<p.length;d++)n(p[d],f,!!l)}else n(h,f,!!l)}var m=void 0,v=void 0;if(l)v=-1,m=l,l=null;else{if(!(f<e.childCount))break;v=f,m=e.child(f++)}for(var y=0;y<c.length;y++)c[y].to<=i&&c.splice(y--,1);for(;u<o.length&&o[u].from<=i&&o[u].to>i;)c.push(o[u++]);var g=i+m.nodeSize;if(m.isText){var b=g;u<o.length&&o[u].from<b&&(b=o[u].from);for(var E=0;E<c.length;E++)c[E].to<b&&(b=c[E].to);b<g&&(l=m.cut(b-i),m=m.cut(0,b-i),g=b,v=-1)}var w=c.length?m.isInline&&!m.isLeaf?c.filter((function(e){return!e.inline})):c.slice():JT;r(m,w,t.forChild(i,m),v),i=g}}(this.node,this.innerDeco,(function(t,i,s){t.spec.marks?a.syncToMarks(t.spec.marks,r,e):t.type.side>=0&&!s&&a.syncToMarks(i==n.node.childCount?ew.none:n.node.child(i).marks,r,e),a.placeWidget(t,e,o)}),(function(t,n,i,s){a.syncToMarks(t.marks,r,e),a.findNodeMatch(t,n,i,s)||a.updateNextNode(t,n,i,e,s)||a.addNode(t,n,i,e,o),o+=t.nodeSize})),a.syncToMarks(JT,r,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(i&&this.protectLocalComposition(e,i),function e(t,n,r){for(var o=t.firstChild,i=!1,a=0;a<n.length;a++){var s=n[a],u=s.dom;if(u.parentNode==t){for(;u!=o;)o=pO(o),i=!0;o=o.nextSibling}else i=!0,t.insertBefore(u,o);if(s instanceof eO){var c=o?o.previousSibling:t.lastChild;e(s.contentDOM,s.children,r),o=c?c.nextSibling:t.firstChild}}for(;o;)o=pO(o),i=!0;i&&r.trackWrites==t&&(r.trackWrites=null)}(this.contentDOM,this.children,e),fT.ios&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){var t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))},t.prototype.localCompositionNode=function(e,t){var n=e.state.selection,r=n.from,o=n.to;if(!(!(e.state.selection instanceof WS)||r<t||o>t+this.node.content.size)){var i=e.root.getSelection(),a=function(e,t){for(;;){if(3==e.nodeType)return e;if(1==e.nodeType&&t>0){if(e.childNodes.length>t&&3==e.childNodes[t].nodeType)return e.childNodes[t];e=e.childNodes[t-1],t=OT(e)}else{if(!(1==e.nodeType&&t<e.childNodes.length))return null;e=e.childNodes[t],t=0}}}(i.focusNode,i.focusOffset);if(a&&this.dom.contains(a.parentNode)){var s=a.nodeValue,u=function(e,t,n,r){for(var o=0,i=0;o<e.childCount&&i<=r;){var a=e.child(o++),s=i;if(i+=a.nodeSize,a.isText){for(var u=a.text;o<e.childCount;){var c=e.child(o++);if(i+=c.nodeSize,!c.isText)break;u+=c.text}if(i>=n){var l=u.lastIndexOf(t,r-s);if(l>=0&&l+t.length+s>=n)return s+l}}}return-1}(this.node.content,s,r-t,o-t);return u<0?null:{node:a,pos:u,text:s}}}},t.prototype.protectLocalComposition=function(e,t){var n=t.node,r=t.pos,o=t.text;if(!this.getDesc(n)){for(var i=n;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=null)}var a=new ZT(this,i,n,o);e.compositionNodes.push(a),this.children=vO(this.children,r,r+o.length,e,a)}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)},t.prototype.updateInner=function(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0},t.prototype.updateOuterDeco=function(e){if(!hO(e,this.outerDeco)){var t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=cO(this.dom,this.nodeDOM,uO(this.outerDeco,this.node,t),uO(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=null,this.dom.pmViewDesc=this),this.outerDeco=e}},t.prototype.selectNode=function(){this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)},t.prototype.deselectNode=function(){this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable")},n.domAtom.get=function(){return this.node.isAtom},Object.defineProperties(t.prototype,n),t}(qT);function nO(e,t,n,r,o){return fO(r,t,e),new tO(null,e,t,n,r,r,r,o,0)}var rO=function(e){function t(t,n,r,o,i,a,s){e.call(this,t,n,r,o,i,null,a,s)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){for(var e=this.nodeDOM.parentNode;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}},t.prototype.update=function(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)},t.prototype.inParent=function(){for(var e=this.parent.contentDOM,t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1},t.prototype.domFromPos=function(e){return{node:this.nodeDOM,offset:e}},t.prototype.localPosFromDOM=function(t,n,r){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):e.prototype.localPosFromDOM.call(this,t,n,r)},t.prototype.ignoreMutation=function(e){return"characterData"!=e.type&&"selection"!=e.type},t.prototype.slice=function(e,n,r){var o=this.node.cut(e,n),i=document.createTextNode(o.text);return new t(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)},t.prototype.markDirty=function(t,n){e.prototype.markDirty.call(this,t,n),this.dom==this.nodeDOM||0!=t&&n!=this.nodeDOM.nodeValue.length||(this.dirty=3)},n.domAtom.get=function(){return!1},Object.defineProperties(t.prototype,n),t}(tO),oO=function(e){function t(){e.apply(this,arguments)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={domAtom:{configurable:!0}};return t.prototype.parseRule=function(){return{ignore:!0}},t.prototype.matchesHack=function(e){return 0==this.dirty&&this.dom.nodeName==e},n.domAtom.get=function(){return!0},Object.defineProperties(t.prototype,n),t}(qT),iO=function(e){function t(t,n,r,o,i,a,s,u,c,l){e.call(this,t,n,r,o,i,a,s,c,l),this.spec=u}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.update=function(t,n,r,o){if(3==this.dirty)return!1;if(this.spec.update){var i=this.spec.update(t,n,r);return i&&this.updateInner(t,n,r,o),i}return!(!this.contentDOM&&!t.isLeaf)&&e.prototype.update.call(this,t,n,r,o)},t.prototype.selectNode=function(){this.spec.selectNode?this.spec.selectNode():e.prototype.selectNode.call(this)},t.prototype.deselectNode=function(){this.spec.deselectNode?this.spec.deselectNode():e.prototype.deselectNode.call(this)},t.prototype.setSelection=function(t,n,r,o){this.spec.setSelection?this.spec.setSelection(t,n,r):e.prototype.setSelection.call(this,t,n,r,o)},t.prototype.destroy=function(){this.spec.destroy&&this.spec.destroy(),e.prototype.destroy.call(this)},t.prototype.stopEvent=function(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)},t.prototype.ignoreMutation=function(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):e.prototype.ignoreMutation.call(this,t)},t}(tO);function aO(e){e&&(this.nodeName=e)}aO.prototype=Object.create(null);var sO=[new aO];function uO(e,t,n){if(0==e.length)return sO;for(var r=n?sO[0]:new aO,o=[r],i=0;i<e.length;i++){var a=e[i].type.attrs;if(a)for(var s in a.nodeName&&o.push(r=new aO(a.nodeName)),a){var u=a[s];null!=u&&(n&&1==o.length&&o.push(r=new aO(t.isInline?"span":"div")),"class"==s?r.class=(r.class?r.class+" ":"")+u:"style"==s?r.style=(r.style?r.style+";":"")+u:"nodeName"!=s&&(r[s]=u))}}return o}function cO(e,t,n,r){if(n==sO&&r==sO)return t;for(var o=t,i=0;i<r.length;i++){var a=r[i],s=n[i];if(i){var u=void 0;s&&s.nodeName==a.nodeName&&o!=e&&(u=o.parentNode)&&u.tagName.toLowerCase()==a.nodeName||((u=document.createElement(a.nodeName)).pmIsDeco=!0,u.appendChild(o),s=sO[0]),o=u}lO(o,s||sO[0],a)}return o}function lO(e,t,n){for(var r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(var o in n)"class"!=o&&"style"!=o&&"nodeName"!=o&&n[o]!=t[o]&&e.setAttribute(o,n[o]);if(t.class!=n.class){for(var i=t.class?t.class.split(" ").filter(Boolean):JT,a=n.class?n.class.split(" ").filter(Boolean):JT,s=0;s<i.length;s++)-1==a.indexOf(i[s])&&e.classList.remove(i[s]);for(var u=0;u<a.length;u++)-1==i.indexOf(a[u])&&e.classList.add(a[u])}if(t.style!=n.style){if(t.style)for(var c,l=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;c=l.exec(t.style);)e.style.removeProperty(c[1]);n.style&&(e.style.cssText+=n.style)}}function fO(e,t,n){return cO(e,e,sO,uO(t,n,1!=e.nodeType))}function hO(e,t){if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function pO(e){var t=e.nextSibling;return e.parentNode.removeChild(e),t}var dO=function(e,t){this.top=e,this.lock=t,this.index=0,this.stack=[],this.changed=!1,this.preMatch=function(e,t){for(var n=e.childCount,r=t.length,o=new Map;n>0&&r>0;r--){var i=t[r-1],a=i.node;if(a){if(a!=e.child(n-1))break;--n,o.set(i,n)}}return{index:n,matched:o}}(e.node.content,e.children)};function mO(e,t){return e.type.side-t.type.side}function vO(e,t,n,r,o){for(var i=[],a=0,s=0;a<e.length;a++){var u=e[a],c=s,l=s+=u.size;c>=n||l<=t?i.push(u):(c<t&&i.push(u.slice(0,t-c,r)),o&&(i.push(o),o=null),l>n&&i.push(u.slice(n-c,u.size,r)))}return i}function yO(e,t){var n=e.root.getSelection(),r=e.state.doc;if(!n.focusNode)return null;var o=e.docView.nearestDesc(n.focusNode),i=o&&0==o.size,a=e.docView.posFromDOM(n.focusNode,n.focusOffset);if(a<0)return null;var s,u,c=r.resolve(a);if(NT(n)){for(s=c;o&&!o.node;)o=o.parent;if(o&&o.node.isAtom&&YS.isSelectable(o.node)&&o.parent&&(!o.node.isInline||!function(e,t,n){for(var r=0==t,o=t==OT(e);r||o;){if(e==n)return!0;var i=yT(e);if(!(e=e.parentNode))return!1;r=r&&0==i,o=o&&i==OT(e)}}(n.focusNode,n.focusOffset,o.dom))){var l=o.posBefore;u=new YS(a==l?c:r.resolve(l))}}else{var f=e.docView.posFromDOM(n.anchorNode,n.anchorOffset);if(f<0)return null;s=r.resolve(f)}u||(u=NO(e,s,c,"pointer"==t||e.state.selection.head<c.pos&&!i?1:-1));return u}function gO(e){return e.editable?e.hasFocus():kO(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function bO(e,t){var n=e.state.selection;if(OO(e,n),gO(e)){if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){var t=e.root.getSelection(),n=document.createRange(),r=e.cursorWrapper.dom,o="IMG"==r.nodeName;o?n.setEnd(r.parentNode,yT(r)+1):n.setEnd(r,0);n.collapse(!1),t.removeAllRanges(),t.addRange(n),!o&&!e.state.selection.visible&&fT.ie&&fT.ie_version<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{var r,o,i=n.anchor,a=n.head;!EO||n instanceof WS||(n.$from.parent.inlineContent||(r=wO(e,n.from)),n.empty||n.$from.parent.inlineContent||(o=wO(e,n.to))),e.docView.setSelection(i,a,e.root,t),EO&&(r&&TO(r),o&&TO(o)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){var t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.hideSelectionGuard);var n=e.root.getSelection(),r=n.anchorNode,o=n.anchorOffset;t.addEventListener("selectionchange",e.hideSelectionGuard=function(){n.anchorNode==r&&n.anchorOffset==o||(t.removeEventListener("selectionchange",e.hideSelectionGuard),setTimeout((function(){gO(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")}),20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}dO.prototype.destroyBetween=function(e,t){if(e!=t){for(var n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}},dO.prototype.destroyRest=function(){this.destroyBetween(this.index,this.top.children.length)},dO.prototype.syncToMarks=function(e,t,n){for(var r=0,o=this.stack.length>>1,i=Math.min(o,e.length);r<i&&(r==o-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<o;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);for(var a=-1,s=this.index;s<Math.min(this.index+3,this.top.children.length);s++)if(this.top.children[s].matchesMark(e[o])){a=s;break}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{var u=eO.create(this.top,e[o],t,n);this.top.children.splice(this.index,0,u),this.top=u,this.changed=!0}this.index=0,o++}},dO.prototype.findNodeMatch=function(e,t,n,r){var o=this.top.children,i=-1;if(r>=this.preMatch.index){for(var a=this.index;a<o.length;a++)if(o[a].matchesNode(e,t,n)){i=a;break}}else for(var s=this.index,u=Math.min(o.length,s+1);s<u;s++){var c=o[s];if(c.matchesNode(e,t,n)&&!this.preMatch.matched.has(c)){i=s;break}}return!(i<0)&&(this.destroyBetween(this.index,i),this.index++,!0)},dO.prototype.updateNextNode=function(e,t,n,r,o){for(var i=this.index;i<this.top.children.length;i++){var a=this.top.children[i];if(a instanceof tO){var s=this.preMatch.matched.get(a);if(null!=s&&s!=o)return!1;var u=a.dom;if(!(this.lock&&(u==this.lock||1==u.nodeType&&u.contains(this.lock.parentNode))&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&hO(t,a.outerDeco)))&&a.update(e,t,n,r))return this.destroyBetween(this.index,i),a.dom!=u&&(this.changed=!0),this.index++,!0;break}}return!1},dO.prototype.addNode=function(e,t,n,r,o){this.top.children.splice(this.index++,0,tO.create(this.top,e,t,n,r,o)),this.changed=!0},dO.prototype.placeWidget=function(e,t,n){var r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){var o=new QT(this.top,e,t,n);this.top.children.splice(this.index++,0,o),this.changed=!0}else this.index++},dO.prototype.addTextblockHacks=function(){for(var e=this.top.children[this.index-1];e instanceof eO;)e=e.children[e.children.length-1];e&&e instanceof rO&&!/\n$/.test(e.node.text)||(fT.safari&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG"),this.addHackNode("BR"))},dO.prototype.addHackNode=function(e){if(this.index<this.top.children.length&&this.top.children[this.index].matchesHack(e))this.index++;else{var t=document.createElement(e);this.top.children.splice(this.index++,0,new oO(this.top,JT,t,null)),this.changed=!0}};var EO=fT.safari||fT.chrome&&fT.chrome_version<63;function wO(e,t){var n=e.docView.domFromPos(t,0),r=n.node,o=n.offset,i=o<r.childNodes.length?r.childNodes[o]:null,a=o?r.childNodes[o-1]:null;if(fT.safari&&i&&"false"==i.contentEditable)return SO(i);if(!(i&&"false"!=i.contentEditable||a&&"false"!=a.contentEditable)){if(i)return SO(i);if(a)return SO(a)}}function SO(e){return e.contentEditable="true",fT.safari&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function TO(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function OO(e,t){if(t instanceof YS){var n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&(RO(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else RO(e)}function RO(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=null)}function NO(e,t,n,r){return e.someProp("createSelectionBetween",(function(r){return r(e,t,n)}))||WS.between(t,n,r)}function kO(e){var t=e.root.getSelection();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(e){return!1}}function AO(e,t){var n=e.selection,r=n.$anchor,o=n.$head,i=t>0?r.max(o):r.min(o),a=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return a&&HS.findFrom(a,t)}function CO(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function MO(e,t,n){var r=e.state.selection;if(!(r instanceof WS)){if(r instanceof YS&&r.node.isInline)return CO(e,new WS(t>0?r.$to:r.$from));var o=AO(e.state,t);return!!o&&CO(e,o)}if(!r.empty||n.indexOf("s")>-1)return!1;if(e.endOfTextblock(t>0?"right":"left")){var i=AO(e.state,t);return!!(i&&i instanceof YS)&&CO(e,i)}if(!(fT.mac&&n.indexOf("m")>-1)){var a,s=r.$head,u=s.textOffset?null:t<0?s.nodeBefore:s.nodeAfter;if(!u||u.isText)return!1;var c=t<0?s.pos-u.nodeSize:s.pos;return!!(u.isAtom||(a=e.docView.descAt(c))&&!a.contentDOM)&&(YS.isSelectable(u)?CO(e,new YS(t<0?e.state.doc.resolve(s.pos-u.nodeSize):s)):!!fT.webkit&&CO(e,new WS(e.state.doc.resolve(t<0?c:c+u.nodeSize))))}}function xO(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function IO(e){var t=e.pmViewDesc;return t&&0==t.size&&(e.nextSibling||"BR"!=e.nodeName)}function _O(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){var o,i,a=!1;for(fT.gecko&&1==n.nodeType&&r<xO(n)&&IO(n.childNodes[r])&&(a=!0);;)if(r>0){if(1!=n.nodeType)break;var s=n.childNodes[r-1];if(IO(s))o=n,i=--r;else{if(3!=s.nodeType)break;r=(n=s).nodeValue.length}}else{if(LO(n))break;for(var u=n.previousSibling;u&&IO(u);)o=n.parentNode,i=yT(u),u=u.previousSibling;if(u)r=xO(n=u);else{if((n=n.parentNode)==e.dom)break;r=0}}a?FO(e,t,n,r):o&&FO(e,t,o,i)}}function PO(e){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n){for(var o,i,a=xO(n);;)if(r<a){if(1!=n.nodeType)break;if(!IO(n.childNodes[r]))break;o=n,i=++r}else{if(LO(n))break;for(var s=n.nextSibling;s&&IO(s);)o=s.parentNode,i=yT(s)+1,s=s.nextSibling;if(s)r=0,a=xO(n=s);else{if((n=n.parentNode)==e.dom)break;r=a=0}}o&&FO(e,t,o,i)}}function LO(e){var t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function FO(e,t,n,r){if(NT(t)){var o=document.createRange();o.setEnd(n,r),o.setStart(n,r),t.removeAllRanges(),t.addRange(o)}else t.extend&&t.extend(n,r);e.domObserver.setCurSelection();var i=e.state;setTimeout((function(){e.state==i&&bO(e)}),50)}function DO(e,t,n){var r=e.state.selection;if(r instanceof WS&&!r.empty||n.indexOf("s")>-1)return!1;if(fT.mac&&n.indexOf("m")>-1)return!1;var o=r.$from,i=r.$to;if(!o.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){var a=AO(e.state,t);if(a&&a instanceof YS)return CO(e,a)}if(!o.parent.inlineContent){var s=t<0?o:i,u=r instanceof qS?HS.near(s,t):HS.findFrom(s,t);return!!u&&CO(e,u)}return!1}function UO(e,t){if(!(e.state.selection instanceof WS))return!0;var n=e.state.selection,r=n.$head,o=n.$anchor,i=n.empty;if(!r.sameParent(o))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;var a=!r.textOffset&&(t<0?r.nodeBefore:r.nodeAfter);if(a&&!a.isText){var s=e.state.tr;return t<0?s.delete(r.pos-a.nodeSize,r.pos):s.delete(r.pos,r.pos+a.nodeSize),e.dispatch(s),!0}return!1}function jO(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function BO(e,t){var n=t.keyCode,r=function(e){var t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);return 8==n||fT.mac&&72==n&&"c"==r?UO(e,-1)||_O(e):46==n||fT.mac&&68==n&&"c"==r?UO(e,1)||PO(e):13==n||27==n||(37==n?MO(e,-1,r)||_O(e):39==n?MO(e,1,r)||PO(e):38==n?DO(e,-1,r)||_O(e):40==n?function(e){if(fT.safari&&!(e.state.selection.$head.parentOffset>0)){var t=e.root.getSelection(),n=t.focusNode,r=t.focusOffset;if(n&&1==n.nodeType&&0==r&&n.firstChild&&"false"==n.firstChild.contentEditable){var o=n.firstChild;jO(e,o,!0),setTimeout((function(){return jO(e,o,!1)}),20)}}}(e)||DO(e,1,r)||PO(e):r==(fT.mac?"m":"c")&&(66==n||73==n||89==n||90==n))}function VO(e){var t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(fT.safari&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){var n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(e.parentNode.lastChild==e||fT.safari&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0}}function HO(e,t,n,r,o){if(t<0){var i=e.lastSelectionTime>Date.now()-50?e.lastSelectionOrigin:null,a=yO(e,i);if(a&&!e.state.selection.eq(a)){var s=e.state.tr.setSelection(a);"pointer"==i?s.setMeta("pointer",!0):"key"==i&&s.scrollIntoView(),e.dispatch(s)}}else{var u=e.state.doc.resolve(t),c=u.sharedDepth(n);t=u.before(c+1),n=e.state.doc.resolve(n).after(c+1);var l=e.state.selection,f=function(e,t,n){var r=e.docView.parseRange(t,n),o=r.node,i=r.fromOffset,a=r.toOffset,s=r.from,u=r.to,c=e.root.getSelection(),l=null,f=c.anchorNode;if(f&&e.dom.contains(1==f.nodeType?f:f.parentNode)&&(l=[{node:f,offset:c.anchorOffset}],NT(c)||l.push({node:c.focusNode,offset:c.focusOffset})),fT.chrome&&8===e.lastKeyCode)for(var h=a;h>i;h--){var p=o.childNodes[h-1],d=p.pmViewDesc;if("BR"==p.nodeName&&!d){a=h;break}if(!d||d.size)break}var m=e.state.doc,v=e.someProp("domParser")||zw.fromSchema(e.state.schema),y=m.resolve(s),g=null,b=v.parse(o,{topNode:y.parent,topMatch:y.parent.contentMatchAt(y.index()),topOpen:!0,from:i,to:a,preserveWhitespace:!y.parent.type.spec.code||"full",editableContent:!0,findPositions:l,ruleFromNode:VO,context:y});if(l&&null!=l[0].pos){var E=l[0].pos,w=l[1]&&l[1].pos;null==w&&(w=E),g={anchor:E+s,head:w+s}}return{doc:b,sel:g,from:s,to:u}}(e,t,n);if(fT.chrome&&e.cursorWrapper&&f.sel&&f.sel.anchor==e.cursorWrapper.deco.from){var h=e.cursorWrapper.deco.type.toDOM.nextSibling,p=h&&h.nodeValue?h.nodeValue.length:1;f.sel={anchor:f.sel.anchor+p,head:f.sel.anchor+p}}var d,m,v=e.state.doc,y=v.slice(f.from,f.to);8===e.lastKeyCode&&Date.now()-100<e.lastKeyCodeTime?(d=e.state.selection.to,m="end"):(d=e.state.selection.from,m="start"),e.lastKeyCode=null;var g=function(e,t,n,r,o){var i=e.findDiffStart(t,n);if(null==i)return null;var a=e.findDiffEnd(t,n+e.size,n+t.size),s=a.a,u=a.b;if("end"==o){var c=Math.max(0,i-Math.min(s,u));r-=s+c-i}if(s<i&&e.size<t.size){u=(i-=r<=i&&r>=s?i-r:0)+(u-s),s=i}else if(u<i){s=(i-=r<=i&&r>=u?i-r:0)+(s-u),u=i}return{start:i,endA:s,endB:u}}(y.content,f.doc.content,f.from,d,m);if(!g){if(!(r&&l instanceof WS&&!l.empty&&l.$head.sameParent(l.$anchor))||e.composing||f.sel&&f.sel.anchor!=f.sel.head){if((fT.ios&&e.lastIOSEnter>Date.now()-225||fT.android)&&o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName}))&&e.someProp("handleKeyDown",(function(t){return t(e,kT(13,"Enter"))})))return void(e.lastIOSEnter=0);if(f.sel){var b=GO(e,e.state.doc,f.sel);b&&!b.eq(e.state.selection)&&e.dispatch(e.state.tr.setSelection(b))}return}g={start:l.from,endA:l.to,endB:l.to}}e.domChangeCount++,e.state.selection.from<e.state.selection.to&&g.start==g.endB&&e.state.selection instanceof WS&&(g.start>e.state.selection.from&&g.start<=e.state.selection.from+2?g.start=e.state.selection.from:g.endA<e.state.selection.to&&g.endA>=e.state.selection.to-2&&(g.endB+=e.state.selection.to-g.endA,g.endA=e.state.selection.to)),fT.ie&&fT.ie_version<=11&&g.endB==g.start+1&&g.endA==g.start&&g.start>f.from&&"  "==f.doc.textBetween(g.start-f.from-1,g.start-f.from+1)&&(g.start--,g.endA--,g.endB--);var E,w=f.doc.resolveNoCache(g.start-f.from),S=f.doc.resolveNoCache(g.endB-f.from),T=w.sameParent(S)&&w.parent.inlineContent;if((fT.ios&&e.lastIOSEnter>Date.now()-225&&(!T||o.some((function(e){return"DIV"==e.nodeName||"P"==e.nodeName})))||!T&&w.pos<f.doc.content.size&&(E=HS.findFrom(f.doc.resolve(w.pos+1),1,!0))&&E.head==S.pos)&&e.someProp("handleKeyDown",(function(t){return t(e,kT(13,"Enter"))})))e.lastIOSEnter=0;else if(e.state.selection.anchor>g.start&&function(e,t,n,r,o){if(!r.parent.isTextblock||n-t<=o.pos-r.pos||zO(r,!0,!1)<o.pos)return!1;var i=e.resolve(t);if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;var a=e.resolve(zO(i,!0,!0));if(!a.parent.isTextblock||a.pos>n||zO(a,!0,!1)<n)return!1;return r.parent.content.cut(r.parentOffset).eq(a.parent.content)}(v,g.start,g.endA,w,S)&&e.someProp("handleKeyDown",(function(t){return t(e,kT(8,"Backspace"))})))fT.android&&fT.chrome&&e.domObserver.suppressSelectionUpdates();else{fT.chrome&&fT.android&&g.toB==g.from&&(e.lastAndroidDelete=Date.now()),fT.android&&!T&&w.start()!=S.start()&&0==S.parentOffset&&w.depth==S.depth&&f.sel&&f.sel.anchor==f.sel.head&&f.sel.head==g.endA&&(g.endB-=2,S=f.doc.resolveNoCache(g.endB-f.from),setTimeout((function(){e.someProp("handleKeyDown",(function(t){return t(e,kT(13,"Enter"))}))}),20));var O,R,N,k,A=g.start,C=g.endA;if(T)if(w.pos==S.pos)fT.ie&&fT.ie_version<=11&&0==w.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout((function(){return bO(e)}),20)),O=e.state.tr.delete(A,C),R=v.resolve(g.start).marksAcross(v.resolve(g.endA));else if(g.endA==g.endB&&(k=v.resolve(g.start))&&(N=function(e,t){for(var n,r,o,i=e.firstChild.marks,a=t.firstChild.marks,s=i,u=a,c=0;c<a.length;c++)s=a[c].removeFromSet(s);for(var l=0;l<i.length;l++)u=i[l].removeFromSet(u);if(1==s.length&&0==u.length)r=s[0],n="add",o=function(e){return e.mark(r.addToSet(e.marks))};else{if(0!=s.length||1!=u.length)return null;r=u[0],n="remove",o=function(e){return e.mark(r.removeFromSet(e.marks))}}for(var f=[],h=0;h<t.childCount;h++)f.push(o(t.child(h)));if(qE.from(f).eq(e))return{mark:r,type:n}}(w.parent.content.cut(w.parentOffset,S.parentOffset),k.parent.content.cut(k.parentOffset,g.endA-k.start()))))O=e.state.tr,"add"==N.type?O.addMark(A,C,N.mark):O.removeMark(A,C,N.mark);else if(w.parent.child(w.index()).isText&&w.index()==S.index()-(S.textOffset?0:1)){var M=w.parent.textBetween(w.parentOffset,S.parentOffset);if(e.someProp("handleTextInput",(function(t){return t(e,A,C,M)})))return;O=e.state.tr.insertText(M,A,C)}if(O||(O=e.state.tr.replace(A,C,f.doc.slice(g.start-f.from,g.endB-f.from))),f.sel){var x=GO(e,O.doc,f.sel);x&&!(fT.chrome&&fT.android&&e.composing&&x.empty&&(g.start!=g.endB||e.lastAndroidDelete<Date.now()-100)&&(x.head==A||x.head==O.mapping.map(C)-1)||fT.ie&&x.empty&&x.head==A)&&O.setSelection(x)}R&&O.ensureMarks(R),e.dispatch(O.scrollIntoView())}}}function GO(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:NO(e,t.resolve(n.anchor),t.resolve(n.head))}function zO(e,t,n){for(var r=e.depth,o=t?e.end():e.pos;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,o++,t=!1;if(n)for(var i=e.node(r).maybeChild(e.indexAfter(r));i&&!i.isLeaf;)i=i.firstChild,o++;return o}function WO(e,t){for(var n=[],r=t.content,o=t.openStart,i=t.openEnd;o>1&&i>1&&1==r.childCount&&1==r.firstChild.childCount;){o--,i--;var a=r.firstChild;n.push(a.type.name,a.attrs!=a.type.defaultAttrs?a.attrs:null),r=a.content}var s=e.someProp("clipboardSerializer")||tS.fromSchema(e.state.schema),u=JO(),c=u.createElement("div");c.appendChild(s.serializeFragment(r,{document:u}));for(var l,f=c.firstChild;f&&1==f.nodeType&&(l=qO[f.nodeName.toLowerCase()]);){for(var h=l.length-1;h>=0;h--){for(var p=u.createElement(l[h]);c.firstChild;)p.appendChild(c.firstChild);c.appendChild(p)}f=c.firstChild}return f&&1==f.nodeType&&f.setAttribute("data-pm-slice",o+" "+i+" "+JSON.stringify(n)),{dom:c,text:e.someProp("clipboardTextSerializer",(function(e){return e(t)}))||t.content.textBetween(0,t.content.size,"\n\n")}}function $O(e,t,n,r,o){var i,a,s=o.parent.type.spec.code;if(!n&&!t)return null;var u=t&&(r||s||!n);if(u){if(e.someProp("transformPastedText",(function(e){t=e(t,s||r)})),s)return new nw(qE.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0);var c=e.someProp("clipboardTextParser",(function(e){return e(t,o,r)}));c?a=c:(i=document.createElement("div"),t.trim().split(/(?:\r\n?|\n)+/).forEach((function(e){i.appendChild(document.createElement("p")).textContent=e})))}else e.someProp("transformPastedHTML",(function(e){n=e(n)})),i=function(e){var t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));var n,r=JO().createElement("div"),o=/<([a-z][^>\s]+)/i.exec(e);(n=o&&qO[o[1].toLowerCase()])&&(e=n.map((function(e){return"<"+e+">"})).join("")+e+n.map((function(e){return"</"+e+">"})).reverse().join(""));if(r.innerHTML=e,n)for(var i=0;i<n.length;i++)r=r.querySelector(n[i])||r;return r}(n);var l=i&&i.querySelector("[data-pm-slice]"),f=l&&/^(\d+) (\d+) (.*)/.exec(l.getAttribute("data-pm-slice"));if(!a){var h=e.someProp("clipboardParser")||e.someProp("domParser")||zw.fromSchema(e.state.schema);a=h.parseSlice(i,{preserveWhitespace:!(!u&&!f),context:o})}return a=f?function(e,t){if(!e.size)return e;var n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(t){return e}for(var o=e.content,i=e.openStart,a=e.openEnd,s=n.length-2;s>=0;s-=2){var u=r.nodes[n[s]];if(!u||u.hasRequiredAttrs())break;o=qE.from(u.create(n[s+1],o)),i++,a++}return new nw(o,i,a)}(function(e,t,n){t<e.openStart&&(e=new nw(KO(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd));n<e.openEnd&&(e=new nw(KO(e.content,1,n,e.openEnd,0,0),e.openStart,n));return e}(a,+f[1],+f[2]),f[3]):nw.maxOpen(function(e,t){if(e.childCount<2)return e;for(var n=function(n){var r=t.node(n).contentMatchAt(t.index(n)),o=void 0,i=[];if(e.forEach((function(e){if(i){var t,n=r.findWrapping(e.type);if(!n)return i=null;if(t=i.length&&o.length&&function e(t,n,r,o,i){if(i<t.length&&i<n.length&&t[i]==n[i]){var a=e(t,n,r,o.lastChild,i+1);if(a)return o.copy(o.content.replaceChild(o.childCount-1,a));if(o.contentMatchAt(o.childCount).matchType(i==t.length-1?r.type:t[i+1]))return o.copy(o.content.append(qE.from(YO(r,t,i+1))))}}(n,o,e,i[i.length-1],0))i[i.length-1]=t;else{i.length&&(i[i.length-1]=function e(t,n){if(0==n)return t;var r=t.content.replaceChild(t.childCount-1,e(t.lastChild,n-1)),o=t.contentMatchAt(t.childCount).fillBefore(qE.empty,!0);return t.copy(r.append(o))}(i[i.length-1],o.length));var a=YO(e,n);i.push(a),r=r.matchType(a.type,a.attrs),o=n}}})),i)return{v:qE.from(i)}},r=t.depth;r>=0;r--){var o=n(r);if(o)return o.v}return e}(a.content,o),!1),e.someProp("transformPasted",(function(e){a=e(a)})),a}function YO(e,t,n){void 0===n&&(n=0);for(var r=t.length-1;r>=n;r--)e=t[r].create(null,qE.from(e));return e}function KO(e,t,n,r,o,i){var a=t<0?e.firstChild:e.lastChild,s=a.content;return o<r-1&&(s=KO(s,t,n,r,o+1,i)),o>=n&&(s=t<0?a.contentMatchAt(0).fillBefore(s,e.childCount>1||i<=o).append(s):s.append(a.contentMatchAt(a.childCount).fillBefore(qE.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,a.copy(s))}var qO={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]},XO=null;function JO(){return XO||(XO=document.implementation.createHTMLDocument("title"))}var QO={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},ZO=fT.ie&&fT.ie_version<=11,eR=function(){this.anchorNode=this.anchorOffset=this.focusNode=this.focusOffset=null};eR.prototype.set=function(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset},eR.prototype.eq=function(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset};var tR=function(e,t){var n=this;this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=window.MutationObserver&&new window.MutationObserver((function(e){for(var t=0;t<e.length;t++)n.queue.push(e[t]);fT.ie&&fT.ie_version<=11&&e.some((function(e){return"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length}))?n.flushSoon():n.flush()})),this.currentSelection=new eR,ZO&&(this.onCharData=function(e){n.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),n.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.suppressingSelectionUpdates=!1};tR.prototype.flushSoon=function(){var e=this;this.flushingSoon<0&&(this.flushingSoon=window.setTimeout((function(){e.flushingSoon=-1,e.flush()}),20))},tR.prototype.forceFlush=function(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())},tR.prototype.start=function(){this.observer&&this.observer.observe(this.view.dom,QO),ZO&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()},tR.prototype.stop=function(){var e=this;if(this.observer){var t=this.observer.takeRecords();if(t.length){for(var n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout((function(){return e.flush()}),20)}this.observer.disconnect()}ZO&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()},tR.prototype.connectSelection=function(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)},tR.prototype.disconnectSelection=function(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)},tR.prototype.suppressSelectionUpdates=function(){var e=this;this.suppressingSelectionUpdates=!0,setTimeout((function(){return e.suppressingSelectionUpdates=!1}),50)},tR.prototype.onSelectionChange=function(){if((!(e=this.view).editable||e.root.activeElement==e.dom)&&kO(e)){var e;if(this.suppressingSelectionUpdates)return bO(this.view);if(fT.ie&&fT.ie_version<=11&&!this.view.state.selection.empty){var t=this.view.root.getSelection();if(t.focusNode&&wT(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}},tR.prototype.setCurSelection=function(){this.currentSelection.set(this.view.root.getSelection())},tR.prototype.ignoreSelectionChange=function(e){if(0==e.rangeCount)return!0;var t=e.getRangeAt(0).commonAncestorContainer,n=this.view.docView.nearestDesc(t);return n&&n.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0},tR.prototype.flush=function(){if(this.view.docView&&!(this.flushingSoon>-1)){var e=this.observer?this.observer.takeRecords():[];this.queue.length&&(e=this.queue.concat(e),this.queue.length=0);var t=this.view.root.getSelection(),n=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(t)&&kO(this.view)&&!this.ignoreSelectionChange(t),r=-1,o=-1,i=!1,a=[];if(this.view.editable)for(var s=0;s<e.length;s++){var u=this.registerMutation(e[s],a);u&&(r=r<0?u.from:Math.min(u.from,r),o=o<0?u.to:Math.max(u.to,o),u.typeOver&&(i=!0))}if(fT.gecko&&a.length>1){var c=a.filter((function(e){return"BR"==e.nodeName}));if(2==c.length){var l=c[0],f=c[1];l.parentNode&&l.parentNode.parentNode==f.parentNode?f.remove():l.remove()}}(r>-1||n)&&(r>-1&&(this.view.docView.markDirty(r,o),function(e){if(nR)return;nR=!0,"normal"==getComputedStyle(e.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.")}(this.view)),this.handleDOMChange(r,o,i,a),this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(t)||bO(this.view),this.currentSelection.set(t))}},tR.prototype.registerMutation=function(e,t){if(t.indexOf(e.target)>-1)return null;var n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(var r=0;r<e.addedNodes.length;r++)t.push(e.addedNodes[r]);if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};var o=e.previousSibling,i=e.nextSibling;if(fT.ie&&fT.ie_version<=11&&e.addedNodes.length)for(var a=0;a<e.addedNodes.length;a++){var s=e.addedNodes[a],u=s.previousSibling,c=s.nextSibling;(!u||Array.prototype.indexOf.call(e.addedNodes,u)<0)&&(o=u),(!c||Array.prototype.indexOf.call(e.addedNodes,c)<0)&&(i=c)}var l=o&&o.parentNode==e.target?yT(o)+1:0,f=n.localPosFromDOM(e.target,l,-1),h=i&&i.parentNode==e.target?yT(i):e.target.childNodes.length;return{from:f,to:n.localPosFromDOM(e.target,h,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}};var nR=!1;var rR={},oR={};function iR(e,t){e.lastSelectionOrigin=t,e.lastSelectionTime=Date.now()}function aR(e){e.someProp("handleDOMEvents",(function(t){for(var n in t)e.eventHandlers[n]||e.dom.addEventListener(n,e.eventHandlers[n]=function(t){return sR(e,t)})}))}function sR(e,t){return e.someProp("handleDOMEvents",(function(n){var r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)}))}function uR(e){return{left:e.clientX,top:e.clientY}}function cR(e,t,n,r,o){if(-1==r)return!1;for(var i=e.state.doc.resolve(r),a=function(r){if(e.someProp(t,(function(t){return r>i.depth?t(e,n,i.nodeAfter,i.before(r),o,!0):t(e,n,i.node(r),i.before(r),o,!1)})))return{v:!0}},s=i.depth+1;s>0;s--){var u=a(s);if(u)return u.v}return!1}function lR(e,t,n){e.focused||e.focus();var r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function fR(e,t,n,r,o){return cR(e,"handleClickOn",t,n,r)||e.someProp("handleClick",(function(n){return n(e,t,r)}))||(o?function(e,t){if(-1==t)return!1;var n,r,o=e.state.selection;o instanceof YS&&(n=o.node);for(var i=e.state.doc.resolve(t),a=i.depth+1;a>0;a--){var s=a>i.depth?i.nodeAfter:i.node(a);if(YS.isSelectable(s)){r=n&&o.$from.depth>0&&a>=o.$from.depth&&i.before(o.$from.depth+1)==o.$from.pos?i.before(o.$from.depth):i.before(a);break}}return null!=r&&(lR(e,YS.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;var n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&YS.isSelectable(r))&&(lR(e,new YS(n),"pointer"),!0)}(e,n))}function hR(e,t,n,r){return cR(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",(function(n){return n(e,t,r)}))}function pR(e,t,n,r){return cR(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",(function(n){return n(e,t,r)}))||function(e,t,n){if(0!=n.button)return!1;var r=e.state.doc;if(-1==t)return!!r.inlineContent&&(lR(e,WS.create(r,0,r.content.size),"pointer"),!0);for(var o=r.resolve(t),i=o.depth+1;i>0;i--){var a=i>o.depth?o.nodeAfter:o.node(i),s=o.before(i);if(a.inlineContent)lR(e,WS.create(r,s+1,s+1+a.content.size),"pointer");else{if(!YS.isSelectable(a))continue;lR(e,YS.create(r,s),"pointer")}return!0}}(e,n,r)}function dR(e){return wR(e)}oR.keydown=function(e,t){if(e.shiftKey=16==t.keyCode||t.shiftKey,!yR(e,t))if(229!=t.keyCode&&e.domObserver.forceFlush(),e.lastKeyCode=t.keyCode,e.lastKeyCodeTime=Date.now(),!fT.ios||13!=t.keyCode||t.ctrlKey||t.altKey||t.metaKey)e.someProp("handleKeyDown",(function(n){return n(e,t)}))||BO(e,t)?t.preventDefault():iR(e,"key");else{var n=Date.now();e.lastIOSEnter=n,e.lastIOSEnterFallbackTimeout=setTimeout((function(){e.lastIOSEnter==n&&(e.someProp("handleKeyDown",(function(t){return t(e,kT(13,"Enter"))})),e.lastIOSEnter=0)}),200)}},oR.keyup=function(e,t){16==t.keyCode&&(e.shiftKey=!1)},oR.keypress=function(e,t){if(!(yR(e,t)||!t.charCode||t.ctrlKey&&!t.altKey||fT.mac&&t.metaKey))if(e.someProp("handleKeyPress",(function(n){return n(e,t)})))t.preventDefault();else{var n=e.state.selection;if(!(n instanceof WS&&n.$from.sameParent(n.$to))){var r=String.fromCharCode(t.charCode);e.someProp("handleTextInput",(function(t){return t(e,n.$from.pos,n.$to.pos,r)}))||e.dispatch(e.state.tr.insertText(r).scrollIntoView()),t.preventDefault()}}};var mR=fT.mac?"metaKey":"ctrlKey";rR.mousedown=function(e,t){e.shiftKey=t.shiftKey;var n=dR(e),r=Date.now(),o="singleClick";r-e.lastClick.time<500&&function(e,t){var n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(t,e.lastClick)&&!t[mR]&&("singleClick"==e.lastClick.type?o="doubleClick":"doubleClick"==e.lastClick.type&&(o="tripleClick")),e.lastClick={time:r,x:t.clientX,y:t.clientY,type:o};var i=e.posAtCoords(uR(t));i&&("singleClick"==o?(e.mouseDown&&e.mouseDown.done(),e.mouseDown=new vR(e,i,t,n)):("doubleClick"==o?hR:pR)(e,i.pos,i.inside,t)?t.preventDefault():iR(e,"pointer"))};var vR=function(e,t,n,r){var o,i,a=this;if(this.view=e,this.startDoc=e.state.doc,this.pos=t,this.event=n,this.flushed=r,this.selectNode=n[mR],this.allowDefault=n.shiftKey||0!=n.button,t.inside>-1)o=e.state.doc.nodeAt(t.inside),i=t.inside;else{var s=e.state.doc.resolve(t.pos);o=s.parent,i=s.depth?s.before():0}this.mightDrag=null;var u=r?null:n.target,c=u?e.docView.nearestDesc(u,!0):null;this.target=c?c.dom:null;var l=e.state.selection;(0==n.button&&o.type.spec.draggable&&!1!==o.type.spec.selectable||l instanceof YS&&l.from<=i&&l.to>i)&&(this.mightDrag={node:o,pos:i,addAttr:this.target&&!this.target.draggable,setUneditable:this.target&&fT.gecko&&!this.target.hasAttribute("contentEditable")}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout((function(){a.view.mouseDown==a&&a.target.setAttribute("contentEditable","false")}),20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),iR(e,"pointer")};function yR(e,t){return!!e.composing||!!(fT.safari&&Math.abs(t.timeStamp-e.compositionEndedAt)<500)&&(e.compositionEndedAt=-2e8,!0)}vR.prototype.done=function(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.view.mouseDown=null},vR.prototype.up=function(e){if(this.done(),this.view.dom.contains(3==e.target.nodeType?e.target.parentNode:e.target)){var t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(uR(e))),this.allowDefault||!t?iR(this.view,"pointer"):fR(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():this.flushed||fT.safari&&this.mightDrag&&!this.mightDrag.node.isAtom||fT.chrome&&!(this.view.state.selection instanceof WS)&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2?(lR(this.view,HS.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):iR(this.view,"pointer")}},vR.prototype.move=function(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0),iR(this.view,"pointer"),0==e.buttons&&this.done()},rR.touchdown=function(e){dR(e),iR(e,"pointer")},rR.contextmenu=function(e){return dR(e)};var gR=fT.android?5e3:-1;function bR(e,t){clearTimeout(e.composingTimeout),t>-1&&(e.composingTimeout=setTimeout((function(){return wR(e)}),t))}function ER(e){for(e.composing=!1;e.compositionNodes.length>0;)e.compositionNodes.pop().markParentsDirty()}function wR(e,t){if(e.domObserver.forceFlush(),ER(e),t||e.docView.dirty){var n=yO(e);return n&&!n.eq(e.state.selection)?e.dispatch(e.state.tr.setSelection(n)):e.updateState(e.state),!0}return!1}oR.compositionstart=oR.compositionupdate=function(e){if(!e.composing){e.domObserver.flush();var t=e.state,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some((function(e){return!1===e.type.spec.inclusive}))))e.markCursor=e.state.storedMarks||n.marks(),wR(e,!0),e.markCursor=null;else if(wR(e),fT.gecko&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length)for(var r=e.root.getSelection(),o=r.focusNode,i=r.focusOffset;o&&1==o.nodeType&&0!=i;){var a=i<0?o.lastChild:o.childNodes[i-1];if(!a)break;if(3==a.nodeType){r.collapse(a,a.nodeValue.length);break}o=a,i=-1}e.composing=!0}bR(e,gR)},oR.compositionend=function(e,t){e.composing&&(e.composing=!1,e.compositionEndedAt=t.timeStamp,bR(e,20))};var SR=fT.ie&&fT.ie_version<15||fT.ios&&fT.webkit_version<604;function TR(e,t,n,r){var o=$O(e,t,n,e.shiftKey,e.state.selection.$from);if(e.someProp("handlePaste",(function(t){return t(e,r,o||nw.empty)})))return!0;if(!o)return!1;var i=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(o),a=i?e.state.tr.replaceSelectionWith(i,e.shiftKey):e.state.tr.replaceSelection(o);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}rR.copy=oR.cut=function(e,t){var n=e.state.selection,r="cut"==t.type;if(!n.empty){var o=SR?null:t.clipboardData,i=WO(e,n.content()),a=i.dom,s=i.text;o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",s)):function(e,t){if(e.dom.parentNode){var n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";var r=getSelection(),o=document.createRange();o.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout((function(){n.parentNode&&n.parentNode.removeChild(n),e.focus()}),50)}}(e,a),r&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))}},oR.paste=function(e,t){var n=SR?null:t.clipboardData;n&&TR(e,n.getData("text/plain"),n.getData("text/html"),t)?t.preventDefault():function(e,t){if(e.dom.parentNode){var n=e.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus(),setTimeout((function(){e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?TR(e,r.value,null,t):TR(e,r.textContent,r.innerHTML,t)}),50)}}(e,t)};var OR=function(e,t){this.slice=e,this.move=t},RR=fT.mac?"altKey":"ctrlKey";for(var NR in rR.dragstart=function(e,t){var n=e.mouseDown;if(n&&n.done(),t.dataTransfer){var r=e.state.selection,o=r.empty?null:e.posAtCoords(uR(t));if(o&&o.pos>=r.from&&o.pos<=(r instanceof YS?r.to-1:r.to));else if(n&&n.mightDrag)e.dispatch(e.state.tr.setSelection(YS.create(e.state.doc,n.mightDrag.pos)));else if(t.target&&1==t.target.nodeType){var i=e.docView.nearestDesc(t.target,!0);if(!i||!i.node.type.spec.draggable||i==e.docView)return;e.dispatch(e.state.tr.setSelection(YS.create(e.state.doc,i.posBefore)))}var a=e.state.selection.content(),s=WO(e,a),u=s.dom,c=s.text;t.dataTransfer.clearData(),t.dataTransfer.setData(SR?"Text":"text/html",u.innerHTML),t.dataTransfer.effectAllowed="copyMove",SR||t.dataTransfer.setData("text/plain",c),e.dragging=new OR(a,!t[RR])}},rR.dragend=function(e){var t=e.dragging;window.setTimeout((function(){e.dragging==t&&(e.dragging=null)}),50)},oR.dragover=oR.dragenter=function(e,t){return t.preventDefault()},oR.drop=function(e,t){var n=e.dragging;if(e.dragging=null,t.dataTransfer){var r=e.posAtCoords(uR(t));if(r){var o=e.state.doc.resolve(r.pos);if(o){var i=n&&n.slice;i?e.someProp("transformPasted",(function(e){i=e(i)})):i=$O(e,t.dataTransfer.getData(SR?"Text":"text/plain"),SR?null:t.dataTransfer.getData("text/html"),!1,o);var a=n&&!t[RR];if(e.someProp("handleDrop",(function(n){return n(e,t,i||nw.empty,a)})))t.preventDefault();else if(i){t.preventDefault();var s=i?kS(e.state.doc,o.pos,i):o.pos;null==s&&(s=o.pos);var u=e.state.tr;a&&u.deleteSelection();var c=u.mapping.map(s),l=0==i.openStart&&0==i.openEnd&&1==i.content.childCount,f=u.doc;if(l?u.replaceRangeWith(c,c,i.content.firstChild):u.replaceRange(c,c,i),!u.doc.eq(f)){var h=u.doc.resolve(c);if(l&&YS.isSelectable(i.content.firstChild)&&h.nodeAfter&&h.nodeAfter.sameMarkup(i.content.firstChild))u.setSelection(new YS(h));else{var p=u.mapping.map(s);u.mapping.maps[u.mapping.maps.length-1].forEach((function(e,t,n,r){return p=r})),u.setSelection(NO(e,h,u.doc.resolve(p)))}e.focus(),e.dispatch(u.setMeta("uiEvent","drop"))}}}}}},rR.focus=function(e){e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout((function(){e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.root.getSelection())&&bO(e)}),20))},rR.blur=function(e){e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),e.domObserver.currentSelection.set({}),e.focused=!1)},rR.beforeinput=function(e,t){if(fT.chrome&&fT.android&&"deleteContentBackward"==t.inputType){var n=e.domChangeCount;setTimeout((function(){if(e.domChangeCount==n&&(e.dom.blur(),e.focus(),!e.someProp("handleKeyDown",(function(t){return t(e,kT(8,"Backspace"))})))){var t=e.state.selection.$cursor;t&&t.pos>0&&e.dispatch(e.state.tr.delete(t.pos-1,t.pos).scrollIntoView())}}),50)}},oR)rR[NR]=oR[NR];function kR(e,t){if(e==t)return!0;for(var n in e)if(e[n]!==t[n])return!1;for(var r in t)if(!(r in e))return!1;return!0}var AR=function(e,t){this.spec=t||PR,this.side=this.spec.side||0,this.toDOM=e};AR.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,this.side<0?-1:1),i=o.pos;return o.deleted?null:new xR(i-n,i-n,this)},AR.prototype.valid=function(){return!0},AR.prototype.eq=function(e){return this==e||e instanceof AR&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&kR(this.spec,e.spec))};var CR=function(e,t){this.spec=t||PR,this.attrs=e};CR.prototype.map=function(e,t,n,r){var o=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,i=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return o>=i?null:new xR(o,i,this)},CR.prototype.valid=function(e,t){return t.from<t.to},CR.prototype.eq=function(e){return this==e||e instanceof CR&&kR(this.attrs,e.attrs)&&kR(this.spec,e.spec)},CR.is=function(e){return e.type instanceof CR};var MR=function(e,t){this.spec=t||PR,this.attrs=e};MR.prototype.map=function(e,t,n,r){var o=e.mapResult(t.from+r,1);if(o.deleted)return null;var i=e.mapResult(t.to+r,-1);return i.deleted||i.pos<=o.pos?null:new xR(o.pos-n,i.pos-n,this)},MR.prototype.valid=function(e,t){var n=e.content.findIndex(t.from),r=n.index,o=n.offset;return o==t.from&&o+e.child(r).nodeSize==t.to},MR.prototype.eq=function(e){return this==e||e instanceof MR&&kR(this.attrs,e.attrs)&&kR(this.spec,e.spec)};var xR=function(e,t,n){this.from=e,this.to=t,this.type=n},IR={spec:{configurable:!0},inline:{configurable:!0}};xR.prototype.copy=function(e,t){return new xR(e,t,this.type)},xR.prototype.eq=function(e,t){return void 0===t&&(t=0),this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to},xR.prototype.map=function(e,t,n){return this.type.map(e,this,t,n)},xR.widget=function(e,t,n){return new xR(e,e,new AR(t,n))},xR.inline=function(e,t,n,r){return new xR(e,t,new CR(n,r))},xR.node=function(e,t,n,r){return new xR(e,t,new MR(n,r))},IR.spec.get=function(){return this.type.spec},IR.inline.get=function(){return this.type instanceof CR},Object.defineProperties(xR.prototype,IR);var _R=[],PR={},LR=function(e,t){this.local=e&&e.length?e:_R,this.children=t&&t.length?t:_R};LR.create=function(e,t){return t.length?VR(t,e,0,PR):FR},LR.prototype.find=function(e,t,n){var r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r},LR.prototype.findInner=function(e,t,n,r,o){for(var i=0;i<this.local.length;i++){var a=this.local[i];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&n.push(a.copy(a.from+r,a.to+r))}for(var s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){var u=this.children[s]+1;this.children[s+2].findInner(e-u,t-u,n,r+u,o)}},LR.prototype.map=function(e,t,n){return this==FR||0==e.maps.length?this:this.mapInner(e,t,0,0,n||PR)},LR.prototype.mapInner=function(e,t,n,r,o){for(var i,a=0;a<this.local.length;a++){var s=this.local[a].map(e,n,r);s&&s.type.valid(t,s)?(i||(i=[])).push(s):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?function(e,t,n,r,o,i,a){for(var s=e.slice(),u=function(e,t,n,r){for(var a=0;a<s.length;a+=3){var u=s[a+1],c=void 0;-1==u||e>u+i||(t>=s[a]+i?s[a+1]=-1:n>=o&&(c=r-n-(t-e))&&(s[a]+=c,s[a+1]+=c))}},c=0;c<n.maps.length;c++)n.maps[c].forEach(u);for(var l=!1,f=0;f<s.length;f+=3)if(-1==s[f+1]){var h=n.map(e[f]+i),p=h-o;if(p<0||p>=r.content.size){l=!0;continue}var d=n.map(e[f+1]+i,-1)-o,m=r.content.findIndex(p),v=m.index,y=m.offset,g=r.maybeChild(v);if(g&&y==p&&y+g.nodeSize==d){var b=s[f+2].mapInner(n,g,h+1,e[f]+i+1,a);b!=FR?(s[f]=p,s[f+1]=d,s[f+2]=b):(s[f+1]=-2,l=!0)}else l=!0}if(l){var E=VR(function(e,t,n,r,o,i,a){function s(e,t){for(var i=0;i<e.local.length;i++){var u=e.local[i].map(r,o,t);u?n.push(u):a.onRemove&&a.onRemove(e.local[i].spec)}for(var c=0;c<e.children.length;c+=3)s(e.children[c+2],e.children[c]+t+1)}for(var u=0;u<e.length;u+=3)-1==e[u+1]&&s(e[u+2],t[u]+i+1);return n}(s,e,t||[],n,o,i,a),r,0,a);t=E.local;for(var w=0;w<s.length;w+=3)s[w+1]<0&&(s.splice(w,3),w-=3);for(var S=0,T=0;S<E.children.length;S+=3){for(var O=E.children[S];T<s.length&&s[T]<O;)T+=3;s.splice(T,0,E.children[S],E.children[S+1],E.children[S+2])}}return new LR(t&&t.sort(HR),s)}(this.children,i,e,t,n,r,o):i?new LR(i.sort(HR)):FR},LR.prototype.add=function(e,t){return t.length?this==FR?LR.create(e,t):this.addInner(e,t,0):this},LR.prototype.addInner=function(e,t,n){var r,o=this,i=0;e.forEach((function(e,a){var s,u=a+n;if(s=jR(t,e,u)){for(r||(r=o.children.slice());i<r.length&&r[i]<a;)i+=3;r[i]==a?r[i+2]=r[i+2].addInner(e,s,u+1):r.splice(i,0,a,a+e.nodeSize,VR(s,e,u+1,PR)),i+=3}}));for(var a=UR(i?BR(t):t,-n),s=0;s<a.length;s++)a[s].type.valid(e,a[s])||a.splice(s--,1);return new LR(a.length?this.local.concat(a).sort(HR):this.local,r||this.children)},LR.prototype.remove=function(e){return 0==e.length||this==FR?this:this.removeInner(e,0)},LR.prototype.removeInner=function(e,t){for(var n=this.children,r=this.local,o=0;o<n.length;o+=3){for(var i=void 0,a=n[o]+t,s=n[o+1]+t,u=0,c=void 0;u<e.length;u++)(c=e[u])&&c.from>a&&c.to<s&&(e[u]=null,(i||(i=[])).push(c));if(i){n==this.children&&(n=this.children.slice());var l=n[o+2].removeInner(i,a+1);l!=FR?n[o+2]=l:(n.splice(o,3),o-=3)}}if(r.length)for(var f=0,h=void 0;f<e.length;f++)if(h=e[f])for(var p=0;p<r.length;p++)r[p].eq(h,t)&&(r==this.local&&(r=this.local.slice()),r.splice(p--,1));return n==this.children&&r==this.local?this:r.length||n.length?new LR(r,n):FR},LR.prototype.forChild=function(e,t){if(this==FR)return this;if(t.isLeaf)return LR.empty;for(var n,r,o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}for(var i=e+1,a=i+t.content.size,s=0;s<this.local.length;s++){var u=this.local[s];if(u.from<a&&u.to>i&&u.type instanceof CR){var c=Math.max(i,u.from)-i,l=Math.min(a,u.to)-i;c<l&&(r||(r=[])).push(u.copy(c,l))}}if(r){var f=new LR(r.sort(HR));return n?new DR([f,n]):f}return n||FR},LR.prototype.eq=function(e){if(this==e)return!0;if(!(e instanceof LR)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(var t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(var n=0;n<this.children.length;n+=3)if(this.children[n]!=e.children[n]||this.children[n+1]!=e.children[n+1]||!this.children[n+2].eq(e.children[n+2]))return!1;return!0},LR.prototype.locals=function(e){return GR(this.localsInner(e))},LR.prototype.localsInner=function(e){if(this==FR)return _R;if(e.inlineContent||!this.local.some(CR.is))return this.local;for(var t=[],n=0;n<this.local.length;n++)this.local[n].type instanceof CR||t.push(this.local[n]);return t};var FR=new LR;LR.empty=FR,LR.removeOverlap=GR;var DR=function(e){this.members=e};function UR(e,t){if(!t||!e.length)return e;for(var n=[],r=0;r<e.length;r++){var o=e[r];n.push(new xR(o.from+t,o.to+t,o.type))}return n}function jR(e,t,n){if(t.isLeaf)return null;for(var r=n+t.nodeSize,o=null,i=0,a=void 0;i<e.length;i++)(a=e[i])&&a.from>n&&a.to<r&&((o||(o=[])).push(a),e[i]=null);return o}function BR(e){for(var t=[],n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function VR(e,t,n,r){var o=[],i=!1;t.forEach((function(t,a){var s=jR(e,t,a+n);if(s){i=!0;var u=VR(s,t,n+a+1,r);u!=FR&&o.push(a,a+t.nodeSize,u)}}));for(var a=UR(i?BR(e):e,-n).sort(HR),s=0;s<a.length;s++)a[s].type.valid(t,a[s])||(r.onRemove&&r.onRemove(a[s].spec),a.splice(s--,1));return a.length||o.length?new LR(a,o):FR}function HR(e,t){return e.from-t.from||e.to-t.to}function GR(e){for(var t=e,n=0;n<t.length-1;n++){var r=t[n];if(r.from!=r.to)for(var o=n+1;o<t.length;o++){var i=t[o];if(i.from!=r.from){i.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,i.from),zR(t,o,r.copy(i.from,r.to)));break}i.to!=r.to&&(t==e&&(t=e.slice()),t[o]=i.copy(i.from,r.to),zR(t,o+1,i.copy(r.to,i.to)))}}return t}function zR(e,t,n){for(;t<e.length&&HR(n,e[t])>0;)t++;e.splice(t,0,n)}function WR(e){var t=[];return e.someProp("decorations",(function(n){var r=n(e.state);r&&r!=FR&&t.push(r)})),e.cursorWrapper&&t.push(LR.create(e.state.doc,[e.cursorWrapper.deco])),DR.from(t)}DR.prototype.forChild=function(e,t){if(t.isLeaf)return LR.empty;for(var n=[],r=0;r<this.members.length;r++){var o=this.members[r].forChild(e,t);o!=FR&&(o instanceof DR?n=n.concat(o.members):n.push(o))}return DR.from(n)},DR.prototype.eq=function(e){if(!(e instanceof DR)||e.members.length!=this.members.length)return!1;for(var t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0},DR.prototype.locals=function(e){for(var t,n=!0,r=0;r<this.members.length;r++){var o=this.members[r].localsInner(e);if(o.length)if(t){n&&(t=t.slice(),n=!1);for(var i=0;i<o.length;i++)t.push(o[i])}else t=o}return t?GR(n?t:t.sort(HR)):_R},DR.from=function(e){switch(e.length){case 0:return FR;case 1:return e[0];default:return new DR(e)}};var $R=function(e,t){this._props=t,this.state=t.state,this.dispatch=this.dispatch.bind(this),this._root=null,this.focused=!1,this.trackWrites=null,this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):e.apply?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=XR(this),this.markCursor=null,this.cursorWrapper=null,qR(this),this.nodeViews=JR(this),this.docView=nO(this.state.doc,KR(this),WR(this),this.dom,this),this.lastSelectedViewDesc=null,this.dragging=null,function(e){e.shiftKey=!1,e.mouseDown=null,e.lastKeyCode=null,e.lastKeyCodeTime=0,e.lastClick={time:0,x:0,y:0,type:""},e.lastSelectionOrigin=null,e.lastSelectionTime=0,e.lastIOSEnter=0,e.lastIOSEnterFallbackTimeout=null,e.lastAndroidDelete=0,e.composing=!1,e.composingTimeout=null,e.compositionNodes=[],e.compositionEndedAt=-2e8,e.domObserver=new tR(e,(function(t,n,r,o){return HO(e,t,n,r,o)})),e.domObserver.start(),e.domChangeCount=0,e.eventHandlers=Object.create(null);var t=function(t){var n=rR[t];e.dom.addEventListener(t,e.eventHandlers[t]=function(t){!function(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(var n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}(e,t)||sR(e,t)||!e.editable&&t.type in oR||n(e,t)})};for(var n in rR)t(n);fT.safari&&e.dom.addEventListener("input",(function(){return null})),aR(e)}(this),this.pluginViews=[],this.updatePluginViews()},YR={props:{configurable:!0},root:{configurable:!0}};function KR(e){var t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",(function(n){if("function"==typeof n&&(n=n(e.state)),n)for(var r in n)"class"==r?t.class+=" "+n[r]:t[r]||"contenteditable"==r||"nodeName"==r||(t[r]=String(n[r]))})),[xR.node(0,e.state.doc.content.size,t)]}function qR(e){if(e.markCursor){var t=document.createElement("img");t.setAttribute("mark-placeholder","true"),e.cursorWrapper={dom:t,deco:xR.widget(e.state.selection.head,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function XR(e){return!e.someProp("editable",(function(t){return!1===t(e.state)}))}function JR(e){var t={};return e.someProp("nodeViews",(function(e){for(var n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])})),t}YR.props.get=function(){if(this._props.state!=this.state){var e=this._props;for(var t in this._props={},e)this._props[t]=e[t];this._props.state=this.state}return this._props},$R.prototype.update=function(e){e.handleDOMEvents!=this._props.handleDOMEvents&&aR(this),this._props=e,this.updateStateInner(e.state,!0)},$R.prototype.setProps=function(e){var t={};for(var n in this._props)t[n]=this._props[n];for(var r in t.state=this.state,e)t[r]=e[r];this.update(t)},$R.prototype.updateState=function(e){this.updateStateInner(e,this.state.plugins!=e.plugins)},$R.prototype.updateStateInner=function(e,t){var n=this,r=this.state,o=!1,i=!1;if(e.storedMarks&&this.composing&&(ER(this),i=!0),this.state=e,t){var a=JR(this);(function(e,t){var n=0,r=0;for(var o in e){if(e[o]!=t[o])return!0;n++}for(var i in t)r++;return n!=r})(a,this.nodeViews)&&(this.nodeViews=a,o=!0),aR(this)}this.editable=XR(this),qR(this);var s=WR(this),u=KR(this),c=t?"reset":e.scrollToSelection>r.scrollToSelection?"to selection":"preserve",l=o||!this.docView.matchesNode(e.doc,u,s);!l&&e.selection.eq(r.selection)||(i=!0);var f,h,p,d,m,v,y,g,b,E,w,S="preserve"==c&&i&&null==this.dom.style.overflowAnchor&&function(e){for(var t,n,r=e.dom.getBoundingClientRect(),o=Math.max(0,r.top),i=(r.left+r.right)/2,a=o+1;a<Math.min(innerHeight,r.bottom);a+=5){var s=e.root.elementFromPoint(i,a);if(s!=e.dom&&e.dom.contains(s)){var u=s.getBoundingClientRect();if(u.top>=o-20){t=s,n=u.top;break}}}return{refDOM:t,refTop:n,stack:IT(e.dom)}}(this);if(i){this.domObserver.stop();var T=l&&(fT.ie||fT.chrome)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&(d=r.selection,m=e.selection,v=Math.min(d.$anchor.sharedDepth(d.head),m.$anchor.sharedDepth(m.head)),d.$anchor.start(v)!=m.$anchor.start(v));if(l){var O=fT.chrome?this.trackWrites=this.root.getSelection().focusNode:null;!o&&this.docView.update(e.doc,u,s,this)||(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=nO(e.doc,u,s,this.dom,this)),O&&!this.trackWrites&&(T=!0)}T||!(this.mouseDown&&this.domObserver.currentSelection.eq(this.root.getSelection())&&(f=this,h=f.docView.domFromPos(f.state.selection.anchor,0),p=f.root.getSelection(),wT(h.node,h.offset,p.anchorNode,p.anchorOffset)))?bO(this,T):(OO(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(r),"reset"==c)this.dom.scrollTop=0;else if("to selection"==c){var R=this.root.getSelection().focusNode;this.someProp("handleScrollToSelection",(function(e){return e(n)}))||(e.selection instanceof YS?xT(this,this.docView.domAfterPos(e.selection.from).getBoundingClientRect(),R):xT(this,this.coordsAtPos(e.selection.head,1),R))}else S&&(g=(y=S).refDOM,b=y.refTop,E=y.stack,w=g?g.getBoundingClientRect().top:0,_T(E,0==w?0:w-b))},$R.prototype.destroyPluginViews=function(){for(var e;e=this.pluginViews.pop();)e.destroy&&e.destroy()},$R.prototype.updatePluginViews=function(e){if(e&&e.plugins==this.state.plugins)for(var t=0;t<this.pluginViews.length;t++){var n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.destroyPluginViews();for(var r=0;r<this.state.plugins.length;r++){var o=this.state.plugins[r];o.spec.view&&this.pluginViews.push(o.spec.view(this))}}},$R.prototype.someProp=function(e,t){var n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;var o=this.state.plugins;if(o)for(var i=0;i<o.length;i++){var a=o[i].props[e];if(null!=a&&(n=t?t(a):a))return n}},$R.prototype.hasFocus=function(){return this.root.activeElement==this.dom},$R.prototype.focus=function(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(PT)return e.focus(PT);var t=IT(e);e.focus(null==PT?{get preventScroll(){return PT={preventScroll:!0},!0}}:void 0),PT||(PT=!1,_T(t,0))}(this.dom),bO(this),this.domObserver.start()},YR.root.get=function(){var e=this._root;if(null==e)for(var t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=function(){return document.getSelection()}),this._root=t;return e||document},$R.prototype.posAtCoords=function(e){return DT(this,e)},$R.prototype.coordsAtPos=function(e,t){return void 0===t&&(t=1),BT(this,e,t)},$R.prototype.domAtPos=function(e,t){return void 0===t&&(t=0),this.docView.domFromPos(e,t)},$R.prototype.nodeDOM=function(e){var t=this.docView.descAt(e);return t?t.nodeDOM:null},$R.prototype.posAtDOM=function(e,t,n){void 0===n&&(n=-1);var r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r},$R.prototype.endOfTextblock=function(e,t){return KT(this,t||this.state,e)},$R.prototype.destroy=function(){this.docView&&(!function(e){for(var t in e.domObserver.stop(),e.eventHandlers)e.dom.removeEventListener(t,e.eventHandlers[t]);clearTimeout(e.composingTimeout),clearTimeout(e.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],WR(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)},$R.prototype.dispatchEvent=function(e){return function(e,t){sR(e,t)||!rR[t.type]||!e.editable&&t.type in oR||rR[t.type](e,t)}(this,e)},$R.prototype.dispatch=function(e){var t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))},Object.defineProperties($R.prototype,YR);for(var QR={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},ZR={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},eN="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),tN="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),nN="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),rN="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),oN="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),iN=eN&&(rN||+eN[1]<57)||nN&&rN,aN=0;aN<10;aN++)QR[48+aN]=QR[96+aN]=String(aN);for(aN=1;aN<=24;aN++)QR[aN+111]="F"+aN;for(aN=65;aN<=90;aN++)QR[aN]=String.fromCharCode(aN+32),ZR[aN]=String.fromCharCode(aN);for(var sN in QR)ZR.hasOwnProperty(sN)||(ZR[sN]=QR[sN]);var uN="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);function cN(e){var t,n,r,o,i=e.split(/-(?!$)/),a=i[i.length-1];"Space"==a&&(a=" ");for(var s=0;s<i.length-1;s++){var u=i[s];if(/^(cmd|meta|m)$/i.test(u))o=!0;else if(/^a(lt)?$/i.test(u))t=!0;else if(/^(c|ctrl|control)$/i.test(u))n=!0;else if(/^s(hift)?$/i.test(u))r=!0;else{if(!/^mod$/i.test(u))throw new Error("Unrecognized modifier name: "+u);uN?o=!0:n=!0}}return t&&(a="Alt-"+a),n&&(a="Ctrl-"+a),o&&(a="Meta-"+a),r&&(a="Shift-"+a),a}function lN(e,t,n){return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),!1!==n&&t.shiftKey&&(e="Shift-"+e),e}function fN(e){var t=function(e){var t=Object.create(null);for(var n in e)t[cN(n)]=e[n];return t}(e);return function(e,n){var r,o=function(e){var t=!(iN&&(e.ctrlKey||e.altKey||e.metaKey)||(tN||oN)&&e.shiftKey&&e.key&&1==e.key.length)&&e.key||(e.shiftKey?ZR:QR)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),i=1==o.length&&" "!=o,a=t[lN(o,n,!i)];if(a&&a(e.state,e.dispatch,e))return!0;if(i&&(n.shiftKey||n.altKey||n.metaKey||o.charCodeAt(0)>127)&&(r=QR[n.keyCode])&&r!=o){var s=t[lN(r,n,!0)];if(s&&s(e.state,e.dispatch,e))return!0}else if(i&&n.shiftKey){var u=t[lN(o,n,!0)];if(u&&u(e.state,e.dispatch,e))return!0}return!1}}var hN=function(e,t){var n;this.match=e,this.handler="string"==typeof t?(n=t,function(e,t,r,o){var i=n;if(t[1]){var a=t[0].lastIndexOf(t[1]);i+=t[0].slice(a+t[1].length);var s=(r+=a)-o;s>0&&(i=t[0].slice(a-s,a)+i,r=o)}return e.tr.insertText(i,r,o)}):t};function pN(e,t,n,r,o,i){if(e.composing)return!1;var a=e.state,s=a.doc.resolve(t);if(s.parent.type.spec.code)return!1;for(var u=s.parent.textBetween(Math.max(0,s.parentOffset-500),s.parentOffset,null,"￼")+r,c=0;c<o.length;c++){var l=o[c].match.exec(u),f=l&&o[c].handler(a,l,t-(l[0].length-r.length),n);if(f)return e.dispatch(f.setMeta(i,{transform:f,from:t,to:n,text:r})),!0}return!1}new hN(/--$/,"—"),new hN(/\.\.\.$/,"…"),new hN(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(")$/,"“"),new hN(/"$/,"”"),new hN(/(?:^|[\s\{\[\(\<'"\u2018\u201C])(')$/,"‘"),new hN(/'$/,"’");function dN(e,t,n,r){return new hN(e,(function(e,o,i,a){var s=n instanceof Function?n(o):n,u=e.tr.delete(i,a),c=u.doc.resolve(i).blockRange(),l=c&&SS(c,t,s);if(!l)return null;u.wrap(c,l);var f=u.doc.resolve(i-1).nodeBefore;return f&&f.type==t&&RS(u.doc,i-1)&&(!r||r(o,f))&&u.join(i-1),u}))}function mN(e,t,n){return new hN(e,(function(e,r,o,i){var a=e.doc.resolve(o),s=n instanceof Function?n(r):n;return a.node(-1).canReplaceWith(a.index(-1),a.indexAfter(-1),t)?e.tr.delete(o,i).setBlockType(o,o,t,s):null}))}function vN(e,t){return!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0)}function yN(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("backward",e):r.parentOffset>0))return!1;var o=EN(r);if(!o){var i=r.blockRange(),a=i&&wS(i);return null!=a&&(t&&t(e.tr.lift(i,a).scrollIntoView()),!0)}var s=o.nodeBefore;if(!s.type.spec.isolating&&IN(e,o,t))return!0;if(0==r.parent.content.size&&(gN(s,"end")||YS.isSelectable(s))){if(t){var u=e.tr.deleteRange(r.before(),r.after());u.setSelection(gN(s,"end")?HS.findFrom(u.doc.resolve(u.mapping.map(o.pos,-1)),-1):YS.create(u.doc,o.pos-s.nodeSize)),t(u.scrollIntoView())}return!0}return!(!s.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos-s.nodeSize,o.pos).scrollIntoView()),!0)}function gN(e,t,n){for(;e;e="start"==t?e.firstChild:e.lastChild){if(e.isTextblock)return!0;if(n&&1!=e.childCount)return!1}return!1}function bN(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):o.parentOffset>0)return!1;i=EN(o)}var a=i&&i.nodeBefore;return!(!a||!YS.isSelectable(a))&&(t&&t(e.tr.setSelection(YS.create(e.doc,i.pos-a.nodeSize)).scrollIntoView()),!0)}function EN(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function wN(e,t,n){var r=e.selection.$cursor;if(!r||(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size))return!1;var o=TN(r);if(!o)return!1;var i=o.nodeAfter;if(IN(e,o,t))return!0;if(0==r.parent.content.size&&(gN(i,"start")||YS.isSelectable(i))){if(t){var a=e.tr.deleteRange(r.before(),r.after());a.setSelection(gN(i,"start")?HS.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):YS.create(a.doc,a.mapping.map(o.pos))),t(a.scrollIntoView())}return!0}return!(!i.isAtom||o.depth!=r.depth-1)&&(t&&t(e.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0)}function SN(e,t,n){var r=e.selection,o=r.$head,i=o;if(!r.empty)return!1;if(o.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):o.parentOffset<o.parent.content.size)return!1;i=TN(o)}var a=i&&i.nodeAfter;return!(!a||!YS.isSelectable(a))&&(t&&t(e.tr.setSelection(YS.create(e.doc,i.pos)).scrollIntoView()),!0)}function TN(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){var n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}function ON(e,t){var n=e.selection,r=n.$from,o=n.$to,i=r.blockRange(o),a=i&&wS(i);return null!=a&&(t&&t(e.tr.lift(i,a).scrollIntoView()),!0)}function RN(e,t){var n=e.selection,r=n.$head,o=n.$anchor;return!(!r.parent.type.spec.code||!r.sameParent(o))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)}function NN(e){for(var t=0;t<e.edgeCount;t++){var n=e.edge(t).type;if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function kN(e,t){var n=e.selection,r=n.$head,o=n.$anchor;if(!r.parent.type.spec.code||!r.sameParent(o))return!1;var i=r.node(-1),a=r.indexAfter(-1),s=NN(i.contentMatchAt(a));if(!i.canReplaceWith(a,a,s))return!1;if(t){var u=r.after(),c=e.tr.replaceWith(u,u,s.createAndFill());c.setSelection(HS.near(c.doc.resolve(u),1)),t(c.scrollIntoView())}return!0}function AN(e,t){var n=e.selection,r=n.$from,o=n.$to;if(n instanceof qS||r.parent.inlineContent||o.parent.inlineContent)return!1;var i=NN(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(t){var a=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,s=e.tr.insert(a,i.createAndFill());s.setSelection(WS.create(s.doc,a+1)),t(s.scrollIntoView())}return!0}function CN(e,t){var n=e.selection.$cursor;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){var r=n.before();if(OS(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}var o=n.blockRange(),i=o&&wS(o);return null!=i&&(t&&t(e.tr.lift(o,i).scrollIntoView()),!0)}function MN(e,t){var n=e.selection,r=n.$from,o=n.$to;if(e.selection instanceof YS&&e.selection.node.isBlock)return!(!r.parentOffset||!OS(e.doc,r.pos))&&(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.parent.isBlock)return!1;if(t){var i=o.parentOffset==o.parent.content.size,a=e.tr;(e.selection instanceof WS||e.selection instanceof qS)&&a.deleteSelection();var s=0==r.depth?null:NN(r.node(-1).contentMatchAt(r.indexAfter(-1))),u=i&&s?[{type:s}]:null,c=OS(a.doc,a.mapping.map(r.pos),1,u);if(u||c||!OS(a.doc,a.mapping.map(r.pos),1,s&&[{type:s}])||(u=[{type:s}],c=!0),c&&(a.split(a.mapping.map(r.pos),1,u),!i&&!r.parentOffset&&r.parent.type!=s)){var l=a.mapping.map(r.before()),f=a.doc.resolve(l);r.node(-1).canReplaceWith(f.index(),f.index()+1,s)&&a.setNodeMarkup(a.mapping.map(r.before()),s)}t(a.scrollIntoView())}return!0}function xN(e,t){return t&&t(e.tr.setSelection(new qS(e.doc))),!0}function IN(e,t,n){var r,o,i=t.nodeBefore,a=t.nodeAfter;if(i.type.spec.isolating||a.type.spec.isolating)return!1;if(function(e,t,n){var r=t.nodeBefore,o=t.nodeAfter,i=t.index();return!!(r&&o&&r.type.compatibleContent(o.type))&&(!r.content.size&&t.parent.canReplace(i-1,i)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(i,i+1)||!o.isTextblock&&!RS(e.doc,t.pos))&&(n&&n(e.tr.clearIncompatible(t.pos,r.type,r.contentMatchAt(r.childCount)).join(t.pos).scrollIntoView()),!0))}(e,t,n))return!0;var s=t.parent.canReplace(t.index(),t.index()+1);if(s&&(r=(o=i.contentMatchAt(i.childCount)).findWrapping(a.type))&&o.matchType(r[0]||a.type).validEnd){if(n){for(var u=t.pos+a.nodeSize,c=qE.empty,l=r.length-1;l>=0;l--)c=qE.from(r[l].create(null,c));c=qE.from(i.copy(c));var f=e.tr.step(new gS(t.pos-1,u,t.pos,u,new nw(c,1,0),r.length,!0)),h=u+2*r.length;RS(f.doc,h)&&f.join(h),n(f.scrollIntoView())}return!0}var p=HS.findFrom(t,1),d=p&&p.$from.blockRange(p.$to),m=d&&wS(d);if(null!=m&&m>=t.depth)return n&&n(e.tr.lift(d,m).scrollIntoView()),!0;if(s&&gN(a,"start",!0)&&gN(i,"end")){for(var v=i,y=[];y.push(v),!v.isTextblock;)v=v.lastChild;for(var g=a,b=1;!g.isTextblock;g=g.firstChild)b++;if(v.canReplace(v.childCount,v.childCount,g.content)){if(n){for(var E=qE.empty,w=y.length-1;w>=0;w--)E=qE.from(y[w].copy(E));n(e.tr.step(new gS(t.pos-y.length,t.pos+a.nodeSize,t.pos+b,t.pos+a.nodeSize-b,new nw(E,y.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function _N(e,t){return function(n,r){var o=n.selection,i=o.$from,a=o.$to,s=i.blockRange(a),u=s&&SS(s,e,t);return!!u&&(r&&r(n.tr.wrap(s,u).scrollIntoView()),!0)}}function PN(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t,n,r){for(var o=0;o<e.length;o++)if(e[o](t,n,r))return!0;return!1}}var LN=PN(vN,yN,bN),FN=PN(vN,wN,SN),DN={Enter:PN(RN,AN,CN,MN),"Mod-Enter":kN,Backspace:LN,"Mod-Backspace":LN,Delete:FN,"Mod-Delete":FN,"Mod-a":xN},UN={"Ctrl-h":DN.Backspace,"Alt-Backspace":DN["Mod-Backspace"],"Ctrl-d":DN.Delete,"Ctrl-Alt-Backspace":DN["Mod-Delete"],"Alt-Delete":DN["Mod-Delete"],"Alt-d":DN["Mod-Delete"]};for(var jN in DN)UN[jN]=DN[jN];"undefined"!=typeof navigator?/Mac/.test(navigator.platform):"undefined"!=typeof os&&os.platform();function BN(e,t){return function(n,r){var o=n.selection,i=o.$from,a=o.$to,s=i.blockRange(a),u=!1,c=s;if(!s)return!1;if(s.depth>=2&&i.node(s.depth-1).type.compatibleContent(e)&&0==s.startIndex){if(0==i.index(s.depth-1))return!1;var l=n.doc.resolve(s.start-2);c=new vw(l,l,s.depth),s.endIndex<s.parent.childCount&&(s=new vw(i,n.doc.resolve(a.end(s.depth)),s.depth)),u=!0}var f=SS(c,e,t,s);return!!f&&(r&&r(function(e,t,n,r,o){for(var i=qE.empty,a=n.length-1;a>=0;a--)i=qE.from(n[a].type.create(n[a].attrs,i));e.step(new gS(t.start-(r?2:0),t.end,t.start,t.end,new nw(i,0,0),n.length,!0));for(var s=0,u=0;u<n.length;u++)n[u].type==o&&(s=u+1);for(var c=n.length-s,l=t.start+n.length-(r?2:0),f=t.parent,h=t.startIndex,p=t.endIndex,d=!0;h<p;h++,d=!1)!d&&OS(e.doc,l,c)&&(e.split(l,c),l+=2*c),l+=f.child(h).nodeSize;return e}(n.tr,s,f,u,e).scrollIntoView()),!0)}}function VN(e){return function(t,n){var r=t.selection,o=r.$from,i=r.$to,a=o.blockRange(i,(function(t){return t.childCount&&t.firstChild.type==e}));return!!a&&(!n||(o.node(a.depth-1).type==e?function(e,t,n,r){var o=e.tr,i=r.end,a=r.$to.end(r.depth);i<a&&(o.step(new gS(i-1,a,i,a,new nw(qE.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new vw(o.doc.resolve(r.$from.pos),o.doc.resolve(a),r.depth));return t(o.lift(r,wS(r)).scrollIntoView()),!0}(t,n,e,a):function(e,t,n){for(var r=e.tr,o=n.parent,i=n.end,a=n.endIndex-1,s=n.startIndex;a>s;a--)i-=o.child(a).nodeSize,r.delete(i-1,i+1);var u=r.doc.resolve(n.start),c=u.nodeAfter,l=0==n.startIndex,f=n.endIndex==o.childCount,h=u.node(-1),p=u.index(-1);if(!h.canReplace(p+(l?0:1),p+1,c.content.append(f?qE.empty:qE.from(o))))return!1;var d=u.pos,m=d+c.nodeSize;return r.step(new gS(d-(l?1:0),m+(f?1:0),d+1,m-1,new nw((l?qE.empty:qE.from(o.copy(qE.empty))).append(f?qE.empty:qE.from(o.copy(qE.empty))),l?0:1,f?0:1),l?0:1)),t(r.scrollIntoView()),!0}(t,n,a)))}}function HN(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function GN(e,t){if("string"==typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function zN(e,t){const n=GN(t,e.schema),{from:r,to:o}=e.selection;let i=[];e.doc.nodesBetween(r,o,e=>{i=[...i,e]});const a=i.reverse().find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function WN(e,t){if("string"==typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function $N(e,t){const n=WN(t,e.schema),{from:r,to:o,empty:i}=e.selection;let a=[];i?a=e.selection.$head.marks():e.doc.nodesBetween(r,o,e=>{a=[...a,...e.marks]});const s=a.find(e=>e.type.name===n.name);return s?{...s.attrs}:{}}function YN(e,t){const n=Object.keys(t);return!n.length||!!n.filter(n=>t[n]===e[n]).length}function KN(e,t,n={}){const{from:r,to:o,empty:i}=e.selection,a=t?GN(t,e.schema):null;let s=[];if(e.doc.nodesBetween(r,o,(e,t)=>{if(!e.isText){const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s=[...s,{node:e,from:n,to:i}]}}),i)return!!s.filter(e=>!a||a.name===e.node.type.name).find(e=>YN(e.node.attrs,n));const u=o-r;return s.filter(e=>!a||a.name===e.node.type.name).filter(e=>YN(e.node.attrs,n)).reduce((e,t)=>e+(t.to-t.from),0)>=u}function qN(e,t,n={}){const{from:r,to:o,empty:i}=e.selection,a=t?WN(t,e.schema):null;if(i)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!a||a.name===e.type.name).find(e=>YN(e.attrs,n));let s=0,u=[];if(e.doc.nodesBetween(r,o,(e,t)=>{if(e.isText){const n=Math.max(r,t),i=Math.min(o,t+e.nodeSize);s+=i-n,u=[...u,...e.marks.map(e=>({mark:e,from:n,to:i}))]}}),0===s)return!1;const c=u.filter(e=>!a||a.name===e.mark.type.name).filter(e=>YN(e.mark.attrs,n)).reduce((e,t)=>e+(t.to-t.from),0),l=u.filter(e=>!a||e.mark.type!==a&&e.mark.type.excludes(a)).reduce((e,t)=>e+(t.to-t.from),0);return(c>0?c+l:c)>=s}function XN(e){const t=`<body>${e}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function JN(e,t,n){if(n={slice:!0,parseOptions:{},...n},"object"==typeof e&&null!==e)try{return Array.isArray(e)?qE.fromArray(e.map(e=>t.nodeFromJSON(e))):t.nodeFromJSON(e)}catch(r){return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",r),JN("",t,n)}if("string"==typeof e){const r=zw.fromSchema(t);return n.slice?r.parseSlice(XN(e),n.parseOptions).content:r.parse(XN(e),n.parseOptions)}return JN("",t,n)}function QN(e,t,n={}){return JN(e,t,{slice:!1,parseOptions:n})}function ZN(e,t){const n=tS.fromSchema(t).serializeFragment(e.content),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}class ek{constructor(e,t){this.editor=e,this.commands=t}createCommands(){const{commands:e,editor:t}=this,{state:n,view:r}=t,{tr:o}=n,i=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([e,t])=>[e,(...e)=>{const n=t(...e)(i);return o.getMeta("preventDispatch")||r.dispatch(o),n}]))}createChain(e,t=!0){const{commands:n,editor:r}=this,{state:o,view:i}=r,a=[],s=!!e,u=e||o.tr,c={...Object.fromEntries(Object.entries(n).map(([e,n])=>[e,(...e)=>{const r=this.buildProps(u,t),o=n(...e)(r);return a.push(o),c}])),run:()=>(s||!t||u.getMeta("preventDispatch")||i.dispatch(u),a.every(e=>!0===e))};return c}createCan(e){const{commands:t,editor:n}=this,{state:r}=n,o=e||r.tr,i=this.buildProps(o,void 0);return{...Object.fromEntries(Object.entries(t).map(([e,t])=>[e,(...e)=>t(...e)({...i,dispatch:void 0})])),chain:()=>this.createChain(o,void 0)}}buildProps(e,t=!0){const{editor:n,commands:r}=this,{state:o,view:i}=n;o.storedMarks&&e.setStoredMarks(o.storedMarks);const a={tr:e,editor:n,view:i,state:this.chainableState(e,o),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([e,t])=>[e,(...e)=>t(...e)(a)]))}};return a}chainableState(e,t){let{selection:n}=e,{doc:r}=e,{storedMarks:o}=e;return{...t,schema:t.schema,plugins:t.plugins,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return o},get selection(){return n},get doc(){return r},get tr(){return n=e.selection,r=e.doc,o=e.storedMarks,e}}}}function tk(e,t,n={}){if(void 0===e.config[t]&&e.parent)return tk(e.parent,t,n);if("function"==typeof e.config[t]){return e.config[t].bind({...n,parent:e.parent?tk(e.parent,t,n):null})}return e.config[t]}function nk(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function rk(e){const t=[],{nodeExtensions:n,markExtensions:r}=nk(e),o=[...n,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0};return e.forEach(e=>{const n=tk(e,"addGlobalAttributes",{name:e.name,options:e.options});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(([e,r])=>{t.push({type:n,name:e,attribute:{...i,...r}})})})})}),o.forEach(e=>{const n={name:e.name,options:e.options},r=tk(e,"addAttributes",n);if(!r)return;const o=r();Object.entries(o).forEach(([n,r])=>{t.push({type:e.name,name:n,attribute:{...i,...r}})})}),t}function ok(...e){return e.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(([e,t])=>{n[e]?n[e]="class"===e?[n[e],t].join(" "):"style"===e?[n[e],t].join("; "):t:n[e]=t}),n},{})}function ik(e,t){return t.filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>ok(e,t),{})}function ak(e,t){return e.style?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const o=t.filter(e=>e.attribute.rendered).reduce((e,t)=>{const r=t.attribute.parseHTML?t.attribute.parseHTML(n)||{}:{[t.name]:(o=n.getAttribute(t.name),"string"!=typeof o?o:o.match(/^\d*(\.\d+)?$/)?Number(o):"true"===o||"false"!==o&&o)};var o;return{...e,...Object.fromEntries(Object.entries(r).filter(([,e])=>null!=e))}},{});return{...r,...o}}}}function sk(e,t,...n){return"function"==typeof e?t?e.bind(t)(...n):e(...n):e}function uk(e){return Object.fromEntries(Object.entries(e).filter(([e,t])=>("attrs"!==e||!function(e={}){return 0===Object.keys(e).length&&e.constructor===Object}(t))&&null!=t))}function ck(e){var t;const n=rk(e),{nodeExtensions:r,markExtensions:o}=nk(e),i=null===(t=r.find(e=>tk(e,"topNode")))||void 0===t?void 0:t.name,a=Object.fromEntries(r.map(t=>{const r=n.filter(e=>e.type===t.name),o={name:t.name,options:t.options},i=uk({...e.reduce((e,n)=>{const r=tk(n,"extendNodeSchema",o);return{...e,...r?r(t):{}}},{}),content:sk(tk(t,"content",o)),marks:sk(tk(t,"marks",o)),group:sk(tk(t,"group",o)),inline:sk(tk(t,"inline",o)),atom:sk(tk(t,"atom",o)),selectable:sk(tk(t,"selectable",o)),draggable:sk(tk(t,"draggable",o)),code:sk(tk(t,"code",o)),defining:sk(tk(t,"defining",o)),isolating:sk(tk(t,"isolating",o)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=sk(tk(t,"parseHTML",o));a&&(i.parseDOM=a.map(e=>ak(e,r)));const s=tk(t,"renderHTML",o);return s&&(i.toDOM=e=>s({node:e,HTMLAttributes:ik(e,r)})),[t.name,i]})),s=Object.fromEntries(o.map(t=>{const r=n.filter(e=>e.type===t.name),o={name:t.name,options:t.options},i=uk({...e.reduce((e,n)=>{const r=tk(n,"extendMarkSchema",o);return{...e,...r?r(t):{}}},{}),inclusive:sk(tk(t,"inclusive",o)),excludes:sk(tk(t,"excludes",o)),group:sk(tk(t,"group",o)),spanning:sk(tk(t,"spanning",o)),attrs:Object.fromEntries(r.map(e=>{var t;return[e.name,{default:null===(t=null==e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=sk(tk(t,"parseHTML",o));a&&(i.parseDOM=a.map(e=>ak(e,r)));const s=tk(t,"renderHTML",o);return s&&(i.toDOM=e=>s({mark:e,HTMLAttributes:ik(e,r)})),[t.name,i]}));return new Hw({topNode:i,nodes:a,marks:s})}function lk(e,t){return t.nodes[e]?t.nodes[e]:t.marks[e]?t.marks[e]:null}class fk{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=fk.resolve(e),this.schema=ck(this.extensions),this.extensions.forEach(e=>{var t;const n={name:e.name,options:e.options,editor:this.editor,type:lk(e.name,this.schema)};if("mark"===e.type){(null===(t=sk(tk(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const r=tk(e,"onBeforeCreate",n);r&&this.editor.on("beforeCreate",r);const o=tk(e,"onCreate",n);o&&this.editor.on("create",o);const i=tk(e,"onUpdate",n);i&&this.editor.on("update",i);const a=tk(e,"onSelectionUpdate",n);a&&this.editor.on("selectionUpdate",a);const s=tk(e,"onTransaction",n);s&&this.editor.on("transaction",s);const u=tk(e,"onFocus",n);u&&this.editor.on("focus",u);const c=tk(e,"onBlur",n);c&&this.editor.on("blur",c);const l=tk(e,"onDestroy",n);l&&this.editor.on("destroy",l)})}static resolve(e){return fk.sort(fk.flatten(e))}static flatten(e){return e.map(e=>{const t=tk(e,"addExtensions",{name:e.name,options:e.options});return t?[e,...this.flatten(t())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{const n=tk(e,"priority")||100,r=tk(t,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n=tk(t,"addCommands",{name:t.name,options:t.options,editor:this.editor,type:lk(t.name,this.schema)});return n?{...e,...n()}:e},{})}get plugins(){return[...this.extensions].reverse().map(e=>{const t={name:e.name,options:e.options,editor:this.editor,type:lk(e.name,this.schema)},n=[],r=tk(e,"addKeyboardShortcuts",t);if(r){const e=function(e){return new sT({props:{handleKeyDown:fN(e)}})}(Object.fromEntries(Object.entries(r()).map(([e,t])=>[e,()=>t({editor:this.editor})])));n.push(e)}const o=tk(e,"addInputRules",t);if(this.editor.options.enableInputRules&&o){const e=o(),t=e.length?[(i={rules:e},a=i.rules,s=new sT({state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(this);return n||(e.selectionSet||e.docChanged?null:t)}},props:{handleTextInput:function(e,t,n,r){return pN(e,t,n,r,a,s)},handleDOMEvents:{compositionend:function(e){setTimeout((function(){var t=e.state.selection.$cursor;t&&pN(e,t.pos,t.pos,"",a,s)}))}}},isInputRules:!0}),s)]:[];n.push(...t)}var i,a,s;const u=tk(e,"addPasteRules",t);if(this.editor.options.enablePasteRules&&u){const e=u();n.push(...e)}const c=tk(e,"addProseMirrorPlugins",t);if(c){const e=c();n.push(...e)}return n}).flat()}get attributes(){return rk(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=nk(this.extensions);return Object.fromEntries(t.filter(e=>!!tk(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,editor:e,type:GN(t.name,this.schema)},o=tk(t,"addNodeView",r);if(!o)return[];return[t.name,(r,i,a,s)=>{const u=ik(r,n);return o()({editor:e,node:r,getPos:a,decorations:s,HTMLAttributes:u,extension:t})}]}))}get textSerializers(){const{editor:e}=this,{nodeExtensions:t}=nk(this.extensions);return Object.fromEntries(t.filter(e=>!!tk(e,"renderText")).map(t=>{const n=tk(t,"renderText",{name:t.name,options:t.options,editor:e,type:GN(t.name,this.schema)});if(!n)return[];return[t.name,e=>n(e)]}))}}function hk(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function pk(e,t){const n={...e};return hk(e)&&hk(t)&&Object.keys(t).forEach(r=>{hk(t[r])?r in e?n[r]=pk(e[r],t[r]):Object.assign(n,{[r]:t[r]}):Object.assign(n,{[r]:t[r]})}),n}class dk{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,this.options=this.config.defaultOptions}static create(e={}){return new dk(e)}configure(e={}){const t=this.extend();return t.options=pk(this.options,e),t}extend(e={}){const t=new dk(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,t.options=e.defaultOptions?e.defaultOptions:t.parent.options,t}}const mk=dk.create({name:"editable",addProseMirrorPlugins(){return[new sT({key:new lT("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{from:t,to:n}=e.state.selection;return((e,t,n,r,o)=>{let i="",a=!0;return e.state.doc.nodesBetween(t,n,(s,u)=>{var c;const l=e.extensionManager.textSerializers[s.type.name];l?(i+=l({node:s}),a=!r):s.isText?(i+=null===(c=null==s?void 0:s.text)||void 0===c?void 0:c.slice(Math.max(t,u)-u,n-u),a=!r):s.isLeaf&&o?(i+=o,a=!r):!a&&s.isBlock&&(i+=r,a=!0)},0),i})(e,t,n,"\n")}}})]}});var vk=Object.freeze({__proto__:null,blur:()=>({view:e})=>(e.dom.blur(),!0)});var yk=Object.freeze({__proto__:null,clearContent:(e=!1)=>({commands:t})=>t.setContent("",e)});var gk=Object.freeze({__proto__:null,clearNodes:()=>({state:e,tr:t,dispatch:n})=>{const{selection:r}=t,{ranges:o}=r;return o.forEach(r=>{e.doc.nodesBetween(r.$from.pos,r.$to.pos,(e,r)=>{if(e.type.isText)return;const o=t.doc.resolve(t.mapping.map(r)),i=t.doc.resolve(t.mapping.map(r+e.nodeSize)),a=o.blockRange(i);if(!a)return;const s=wS(a);if(e.type.isTextblock&&n){const{defaultType:e}=o.parent.contentMatchAt(o.index());t.setNodeMarkup(a.start,e)}(s||0===s)&&n&&t.lift(a,s)})}),!0}});var bk=Object.freeze({__proto__:null,command:e=>t=>e(t)});var Ek=Object.freeze({__proto__:null,createParagraphNear:()=>({state:e,dispatch:t})=>AN(e,t)});var wk=Object.freeze({__proto__:null,deleteRange:e=>({tr:t,dispatch:n})=>{const{from:r,to:o}=e;return n&&t.delete(r,o),!0}});var Sk=Object.freeze({__proto__:null,deleteSelection:()=>({state:e,dispatch:t})=>vN(e,t)});var Tk=Object.freeze({__proto__:null,enter:()=>({commands:e})=>e.keyboardShortcut("Enter")});var Ok=Object.freeze({__proto__:null,exitCode:()=>({state:e,dispatch:t})=>kN(e,t)});function Rk(e,t,n={}){return e.find(e=>e.type===t&&YN(e.attrs,n))}function Nk(e,t,n={}){return!!Rk(e,t,n)}function kk(e,t,n={}){if(!e||!t)return;const r=e.parent.childAfter(e.parentOffset);if(!r.node)return;const o=Rk(r.node.marks,t,n);if(!o)return;let i=e.index(),a=e.start()+r.offset,s=i+1,u=a+r.node.nodeSize;for(Rk(r.node.marks,t,n);i>0&&o.isInSet(e.parent.child(i-1).marks);)i-=1,a-=e.parent.child(i).nodeSize;for(;s<e.parent.childCount&&Nk(e.parent.child(s).marks,t,n);)u+=e.parent.child(s).nodeSize,s+=1;return{from:a,to:u}}var Ak=Object.freeze({__proto__:null,extendMarkRange:(e,t={})=>({tr:n,state:r,dispatch:o})=>{const i=WN(e,r.schema),{doc:a,selection:s}=n,{$from:u,from:c,to:l}=s;if(o){const e=kk(u,i,t);if(e&&e.from<=c&&e.to>=l){const t=WS.create(a,e.from,e.to);n.setSelection(t)}}return!0}});var Ck=Object.freeze({__proto__:null,first:e=>t=>{const n="function"==typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1}});function Mk(e=0,t=0,n=0){return Math.min(Math.max(e,t),n)}function xk(e){return e&&"object"==typeof e&&!Array.isArray(e)&&!function(e){var t;return"class"===(null===(t=e.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(e)}function Ik(e){return xk(e)&&e instanceof WS}var _k=Object.freeze({__proto__:null,focus:(e=null)=>({editor:t,view:n,tr:r,dispatch:o})=>{if(n.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!Ik(t.state.selection))return n.focus(),!0;const{from:i,to:a}=function(e,t=null){if(!t)return null;if("start"===t||!0===t)return{from:0,to:0};if("end"===t){const{size:t}=e.doc.content;return{from:t,to:t}}return{from:t,to:t}}(t.state,e)||t.state.selection,{doc:s,storedMarks:u}=r,c=Mk(i,0,s.content.size),l=Mk(a,0,s.content.size),f=WS.create(s,c,l),h=t.state.selection.eq(f);return o&&(r.setSelection(f),h&&u&&r.setStoredMarks(u),n.focus()),!0}});var Pk=Object.freeze({__proto__:null,forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r}))});var Lk=Object.freeze({__proto__:null,insertContent:e=>({tr:t,commands:n})=>n.insertContentAt({from:t.selection.from,to:t.selection.to},e)});var Fk=Object.freeze({__proto__:null,insertContentAt:(e,t)=>({tr:n,dispatch:r,editor:o})=>{if(r){const r=JN(t,o.schema,{parseOptions:{preserveWhitespace:"full"}});if("<>"===r.toString())return!0;const{from:i,to:a}="number"==typeof e?{from:e,to:e}:e;n.replaceWith(i,a,r),function(e,t,n){const r=e.steps.length-1;if(r<t)return;const o=e.steps[r];if(!(o instanceof yS||o instanceof gS))return;const i=e.mapping.maps[r];let a=0;i.forEach((e,t,n,r)=>{0===a&&(a=r)}),e.setSelection(HS.near(e.doc.resolve(a),n))}(n,n.steps.length-1,1)}return!0}});var Dk=Object.freeze({__proto__:null,joinBackward:()=>({state:e,dispatch:t})=>yN(e,t)});var Uk=Object.freeze({__proto__:null,joinForward:()=>({state:e,dispatch:t})=>wN(e,t)});const jk="undefined"!=typeof navigator&&/Mac/.test(navigator.platform);var Bk=Object.freeze({__proto__:null,keyboardShortcut:e=>({editor:t,view:n,tr:r,dispatch:o})=>{const i=function(e){const t=e.split(/-(?!$)/);let n,r,o,i,a=t[t.length-1];"Space"===a&&(a=" ");for(let e=0;e<t.length-1;e+=1){const a=t[e];if(/^(cmd|meta|m)$/i.test(a))i=!0;else if(/^a(lt)?$/i.test(a))n=!0;else if(/^(c|ctrl|control)$/i.test(a))r=!0;else if(/^s(hift)?$/i.test(a))o=!0;else{if(!/^mod$/i.test(a))throw new Error("Unrecognized modifier name: "+a);jk?i=!0:r=!0}}return n&&(a="Alt-"+a),r&&(a="Ctrl-"+a),i&&(a="Meta-"+a),o&&(a="Shift-"+a),a}(e).split(/-(?!$)/),a=i.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),s=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),u=t.captureTransaction(()=>{n.someProp("handleKeyDown",e=>e(n,s))});return null==u||u.steps.forEach(e=>{const t=e.map(r.mapping);t&&o&&r.maybeStep(t)}),!0}});var Vk=Object.freeze({__proto__:null,lift:(e,t={})=>({state:n,dispatch:r})=>!!KN(n,GN(e,n.schema),t)&&ON(n,r)});var Hk=Object.freeze({__proto__:null,liftEmptyBlock:()=>({state:e,dispatch:t})=>CN(e,t)});var Gk=Object.freeze({__proto__:null,liftListItem:e=>({state:t,dispatch:n})=>VN(GN(e,t.schema))(t,n)});var zk=Object.freeze({__proto__:null,newlineInCode:()=>({state:e,dispatch:t})=>RN(e,t)});var Wk=Object.freeze({__proto__:null,replace:(e,t={})=>({state:n,commands:r})=>{console.warn("[tiptap warn]: replace() is deprecated. please use insertContent() instead.");const{from:o,to:i}=n.selection,a={from:o,to:i};return r.replaceRange(a,e,t)}});var $k=Object.freeze({__proto__:null,replaceRange:(e,t,n={})=>({tr:r,state:o,dispatch:i})=>{console.warn("[tiptap warn]: replaceRange() is deprecated. please use insertContent() instead.");const a=GN(t,o.schema),{from:s,to:u}=e;return i&&r.replaceRangeWith(s,u,a.create(n)),!0}});function Yk(e,t){const n="string"==typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}var Kk=Object.freeze({__proto__:null,resetAttributes:(e,t)=>({tr:n,state:r,dispatch:o})=>{let i=null,a=null;const s=HN("string"==typeof e?e:e.name,r.schema);return!!s&&("node"===s&&(i=GN(e,r.schema)),"mark"===s&&(a=WN(e,r.schema)),o&&n.selection.ranges.forEach(e=>{r.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,Yk(e.attrs,t)),a&&e.marks.length&&e.marks.forEach(o=>{a===o.type&&n.addMark(r,r+e.nodeSize,a.create(Yk(o.attrs,t)))})})}),!0)}});var qk=Object.freeze({__proto__:null,scrollIntoView:()=>({tr:e,dispatch:t})=>(t&&e.scrollIntoView(),!0)});var Xk=Object.freeze({__proto__:null,selectAll:()=>({state:e,dispatch:t})=>xN(e,t)});var Jk=Object.freeze({__proto__:null,selectNodeBackward:()=>({state:e,dispatch:t})=>bN(e,t)});var Qk=Object.freeze({__proto__:null,selectNodeForward:()=>({state:e,dispatch:t})=>SN(e,t)});var Zk=Object.freeze({__proto__:null,selectParentNode:()=>({state:e,dispatch:t})=>function(e,t){var n,r=e.selection,o=r.$from,i=r.to,a=o.sharedDepth(i);return 0!=a&&(n=o.before(a),t&&t(e.tr.setSelection(YS.create(e.doc,n))),!0)}(e,t)});var eA=Object.freeze({__proto__:null,setContent:(e,t=!1,n={})=>({tr:r,editor:o,dispatch:i})=>{const{doc:a}=r,s=QN(e,o.schema,n),u=WS.create(a,0,a.content.size);return i&&r.setSelection(u).replaceSelectionWith(s,!1).setMeta("preventUpdate",!t),!0}});var tA=Object.freeze({__proto__:null,setMark:(e,t={})=>({tr:n,state:r,dispatch:o})=>{const{selection:i}=n,{empty:a,ranges:s}=i,u=WN(e,r.schema);if(o)if(a){const e=$N(r,u);n.addStoredMark(u.create({...e,...t}))}else s.forEach(e=>{const o=e.$from.pos,i=e.$to.pos;r.doc.nodesBetween(o,i,(e,r)=>{const a=Math.max(r,o),s=Math.min(r+e.nodeSize,i);e.marks.find(e=>e.type===u)?e.marks.forEach(e=>{u===e.type&&n.addMark(a,s,u.create({...e.attrs,...t}))}):n.addMark(a,s,u.create(t))})});return!0}});var nA=Object.freeze({__proto__:null,setMeta:(e,t)=>({tr:n})=>(n.setMeta(e,t),!0)});var rA=Object.freeze({__proto__:null,setNode:(e,t={})=>({state:n,dispatch:r})=>{const o=GN(e,n.schema);return(i=o,a=t,function(e,t){var n=e.selection,r=n.from,o=n.to,s=!1;return e.doc.nodesBetween(r,o,(function(t,n){if(s)return!1;if(t.isTextblock&&!t.hasMarkup(i,a))if(t.type==i)s=!0;else{var r=e.doc.resolve(n),o=r.index();s=r.parent.canReplaceWith(o,o+1,i)}})),!!s&&(t&&t(e.tr.setBlockType(r,o,i,a).scrollIntoView()),!0)})(n,r);var i,a}});var oA=Object.freeze({__proto__:null,setNodeSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,r=Mk(e,0,n.content.size),o=YS.create(n,r);t.setSelection(o)}return!0}});var iA=Object.freeze({__proto__:null,setTextSelection:e=>({tr:t,dispatch:n})=>{if(n){const{doc:n}=t,{from:r,to:o}="number"==typeof e?{from:e,to:e}:e,i=Mk(r,0,n.content.size),a=Mk(o,0,n.content.size),s=WS.create(n,i,a);t.setSelection(s)}return!0}});var aA=Object.freeze({__proto__:null,sinkListItem:e=>({state:t,dispatch:n})=>{const r=GN(e,t.schema);return(o=r,function(e,t){var n=e.selection,r=n.$from,i=n.$to,a=r.blockRange(i,(function(e){return e.childCount&&e.firstChild.type==o}));if(!a)return!1;var s=a.startIndex;if(0==s)return!1;var u=a.parent,c=u.child(s-1);if(c.type!=o)return!1;if(t){var l=c.lastChild&&c.lastChild.type==u.type,f=qE.from(l?o.create():null),h=new nw(qE.from(o.create(null,qE.from(u.type.create(null,f)))),l?3:1,0),p=a.start,d=a.end;t(e.tr.step(new gS(p-(l?3:1),d,p,d,h,1,!0)).scrollIntoView())}return!0})(t,n);var o}});function sA(e,t,n){return Object.fromEntries(Object.entries(n).filter(([n])=>{const r=e.find(e=>e.type===t&&e.name===n);return!!r&&r.attribute.keepOnSplit}))}function uA(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(e=>null==t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}var cA=Object.freeze({__proto__:null,splitBlock:({keepMarks:e=!0}={})=>({tr:t,state:n,dispatch:r,editor:o})=>{const{selection:i,doc:a}=t,{$from:s,$to:u}=i,c=sA(o.extensionManager.attributes,s.node().type.name,s.node().attrs);if(i instanceof YS&&i.node.isBlock)return!(!s.parentOffset||!OS(a,s.pos))&&(r&&(e&&uA(n,o.extensionManager.splittableMarks),t.split(s.pos).scrollIntoView()),!0);if(!s.parent.isBlock)return!1;if(r){const r=u.parentOffset===u.parent.content.size;i instanceof WS&&t.deleteSelection();const a=0===s.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(s.node(-1).contentMatchAt(s.indexAfter(-1)));let l=r&&a?[{type:a,attrs:c}]:void 0,f=OS(t.doc,t.mapping.map(s.pos),1,l);if(l||f||!OS(t.doc,t.mapping.map(s.pos),1,a?[{type:a}]:void 0)||(f=!0,l=a?[{type:a,attrs:c}]:void 0),f&&(t.split(t.mapping.map(s.pos),1,l),a&&!r&&!s.parentOffset&&s.parent.type!==a)){const e=t.mapping.map(s.before()),n=t.doc.resolve(e);s.node(-1).canReplaceWith(n.index(),n.index()+1,a)&&t.setNodeMarkup(t.mapping.map(s.before()),a)}e&&uA(n,o.extensionManager.splittableMarks),t.scrollIntoView()}return!0}});var lA=Object.freeze({__proto__:null,splitListItem:e=>({tr:t,state:n,dispatch:r,editor:o})=>{var i;const a=GN(e,n.schema),{$from:s,$to:u}=n.selection,c=n.selection.node;if(c&&c.isBlock||s.depth<2||!s.sameParent(u))return!1;const l=s.node(-1);if(l.type!==a)return!1;const f=o.extensionManager.attributes;if(0===s.parent.content.size&&s.node(-1).childCount===s.indexAfter(-1)){if(2===s.depth||s.node(-3).type!==a||s.index(-2)!==s.node(-2).childCount-1)return!1;if(r){let e=qE.empty;const n=s.index(-1)?1:s.index(-2)?2:3;for(let t=s.depth-n;t>=s.depth-3;t-=1)e=qE.from(s.node(t).copy(e));const r=s.indexAfter(-1)<s.node(-2).childCount?1:s.indexAfter(-2)<s.node(-3).childCount?2:3,o=sA(f,s.node().type.name,s.node().attrs),u=(null===(i=a.contentMatch.defaultType)||void 0===i?void 0:i.createAndFill(o))||void 0;e=e.append(qE.from(a.createAndFill(null,u)||void 0));const c=s.before(s.depth-(n-1));t.replace(c,s.after(-r),new nw(e,4-n,0));let l=-1;t.doc.nodesBetween(c,t.doc.content.size,(e,t)=>{if(l>-1)return!1;e.isTextblock&&0===e.content.size&&(l=t+1)}),l>-1&&t.setSelection(WS.near(t.doc.resolve(l))),t.scrollIntoView()}return!0}const h=u.pos===s.end()?l.contentMatchAt(0).defaultType:null,p=sA(f,l.type.name,l.attrs),d=sA(f,s.node().type.name,s.node().attrs);t.delete(s.pos,u.pos);const m=h?[{type:a,attrs:p},{type:h,attrs:d}]:[{type:a,attrs:p}];return!!OS(t.doc,s.pos,2)&&(r&&t.split(s.pos,2,m).scrollIntoView(),!0)}});function fA(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}function hA(e,t){const{nodeExtensions:n}=nk(t),r=n.find(t=>t.name===e);if(!r)return!1;const o=sk(tk(r,"group",{name:r.name,options:r.options}));return"string"==typeof o&&o.split(" ").includes("list")}var pA=Object.freeze({__proto__:null,toggleList:(e,t)=>({editor:n,tr:r,state:o,dispatch:i,chain:a,commands:s,can:u})=>{const{extensions:c}=n.extensionManager,l=GN(e,o.schema),f=GN(t,o.schema),{selection:h}=o,{$from:p,$to:d}=h,m=p.blockRange(d);if(!m)return!1;const v=(y=e=>hA(e.type.name,c),e=>fA(e.$from,y))(h);var y;if(m.depth>=1&&v&&m.depth-v.depth<=1){if(v.node.type===l)return s.liftListItem(f);if(hA(v.node.type.name,c)&&l.validContent(v.node.content)&&i)return r.setNodeMarkup(v.pos,l),!0}return u().wrapInList(l)?s.wrapInList(l):a().clearNodes().wrapInList(l).run()}});var dA=Object.freeze({__proto__:null,toggleMark:(e,t={})=>({state:n,commands:r})=>{const o=WN(e,n.schema);return qN(n,o,t)?r.unsetMark(o):r.setMark(o,t)}});var mA=Object.freeze({__proto__:null,toggleNode:(e,t,n={})=>({state:r,commands:o})=>{const i=GN(e,r.schema),a=GN(t,r.schema);return KN(r,i,n)?o.setNode(a):o.setNode(i,n)}});var vA=Object.freeze({__proto__:null,toggleWrap:(e,t={})=>({state:n,dispatch:r})=>{const o=GN(e,n.schema);return KN(n,o,t)?ON(n,r):_N(o,t)(n,r)}});var yA=Object.freeze({__proto__:null,undoInputRule:()=>({state:e,dispatch:t})=>function(e,t){for(var n=e.plugins,r=0;r<n.length;r++){var o=n[r],i=void 0;if(o.spec.isInputRules&&(i=o.getState(e))){if(t){for(var a=e.tr,s=i.transform,u=s.steps.length-1;u>=0;u--)a.step(s.steps[u].invert(s.docs[u]));if(i.text){var c=a.doc.resolve(i.from).marks();a.replaceWith(i.from,i.to,e.schema.text(i.text,c))}else a.delete(i.from,i.to);t(a)}return!0}}return!1}(e,t)});var gA=Object.freeze({__proto__:null,unsetAllMarks:()=>({tr:e,state:t,dispatch:n})=>{const{selection:r}=e,{empty:o,ranges:i}=r;return o||n&&Object.entries(t.schema.marks).forEach(([,t])=>{i.forEach(n=>{e.removeMark(n.$from.pos,n.$to.pos,t)})}),!0}});var bA=Object.freeze({__proto__:null,unsetMark:e=>({tr:t,state:n,dispatch:r})=>{const{selection:o}=t,i=WN(e,n.schema),{$from:a,empty:s,ranges:u}=o;if(r){if(s){let{from:e,to:n}=o;const r=kk(a,i);r&&(e=r.from,n=r.to),t.removeMark(e,n,i)}else u.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos,i)});t.removeStoredMark(i)}return!0}});var EA=Object.freeze({__proto__:null,updateAttributes:(e,t={})=>({tr:n,state:r,dispatch:o})=>{let i=null,a=null;const s=HN("string"==typeof e?e:e.name,r.schema);return!!s&&("node"===s&&(i=GN(e,r.schema)),"mark"===s&&(a=WN(e,r.schema)),o&&n.selection.ranges.forEach(e=>{const o=e.$from.pos,s=e.$to.pos;r.doc.nodesBetween(o,s,(e,r)=>{i&&i===e.type&&n.setNodeMarkup(r,void 0,{...e.attrs,...t}),a&&e.marks.length&&e.marks.forEach(i=>{if(a===i.type){const u=Math.max(r,o),c=Math.min(r+e.nodeSize,s);n.addMark(u,c,a.create({...i.attrs,...t}))}})})}),!0)}});var wA=Object.freeze({__proto__:null,wrapIn:(e,t={})=>({state:n,dispatch:r})=>{const o=GN(e,n.schema);return!KN(n,o,t)&&_N(o,t)(n,r)}});var SA=Object.freeze({__proto__:null,wrapInList:(e,t={})=>({state:n,dispatch:r})=>BN(GN(e,n.schema),t)(n,r)});const TA=dk.create({name:"commands",addCommands:()=>({...vk,...yk,...gk,...bk,...Ek,...wk,...Sk,...Tk,...Ok,...Ak,...Ck,..._k,...Pk,...Lk,...Fk,...Dk,...Uk,...Bk,...Vk,...Hk,...Gk,...zk,...Wk,...$k,...Kk,...qk,...Xk,...Jk,...Qk,...Zk,...eA,...tA,...nA,...rA,...oA,...iA,...aA,...cA,...lA,...pA,...dA,...mA,...vA,...yA,...gA,...bA,...EA,...wA,...SA})}),OA=dk.create({name:"editable",addProseMirrorPlugins(){return[new sT({key:new lT("editable"),props:{editable:()=>this.editor.options.editable}})]}}),RA=dk.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new sT({key:new lT("focusEvents"),props:{attributes:{tabindex:"0"},handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),NA=dk.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(({commands:e})=>[()=>e.undoInputRule(),()=>e.deleteSelection(),()=>e.joinBackward(),()=>e.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:e})=>[()=>e.deleteSelection(),()=>e.joinForward(),()=>e.selectNodeForward()]);return{Enter:()=>this.editor.commands.first(({commands:e})=>[()=>e.newlineInCode(),()=>e.createParagraphNear(),()=>e.liftEmptyBlock(),()=>e.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:()=>e(),"Mod-Backspace":()=>e(),Delete:()=>t(),"Mod-Delete":()=>t()}}});var kA=Object.freeze({__proto__:null,ClipboardTextSerializer:mk,Commands:TA,Editable:OA,FocusEvents:RA,Keymap:NA});class AA{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,this.options=this.config.defaultOptions}static create(e={}){return new AA(e)}configure(e={}){const t=this.extend();return t.options=pk(this.options,e),t}extend(e={}){const t=new AA(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,t.options=e.defaultOptions?e.defaultOptions:t.parent.options,t}}class CA{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,this.options=this.config.defaultOptions}static create(e={}){return new CA(e)}configure(e={}){const t=this.extend();return t.options=pk(this.options,e),t}extend(e={}){const t=new CA(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,t.options=e.defaultOptions?e.defaultOptions:t.parent.options,t}}function MA(e,t,n){return new hN(e,(e,r,o,i)=>{const a=n instanceof Function?n(r):n,{tr:s}=e,u=r[r.length-1],c=r[0];let l=i;if(u){const n=c.search(/\S/),r=o+c.indexOf(u),f=r+u.length;if(function(e,t,n){let r=[];return n.doc.nodesBetween(e,t,(e,t)=>{r=[...r,...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n}))]}),r}(o,i,e).filter(e=>{const{excluded:n}=e.mark.type;return n.find(e=>e.name===t.name)}).filter(e=>e.to>r).length)return null;f<i&&s.delete(f,i),r>o&&s.delete(o+n,r),l=o+n+u.length,s.addMark(o+n,l,t.create(a)),s.removeStoredMark(t)}return s})}function xA(e,t,n){const r=(o,i)=>{const a=[];return o.forEach(o=>{if(o.isText&&o.text){const{text:r}=o;let s,u=0;for(;null!==(s=e.exec(r));){const e=Math.max(s.length-2,0),r=Math.max(s.length-1,0);if(null==i?void 0:i.type.allowsMarkType(t)){const i=s.index+s[0].indexOf(s[e]),c=i+s[e].length,l=i+s[e].lastIndexOf(s[r]),f=l+s[r].length,h=n instanceof Function?n(s):n;i>0&&a.push(o.cut(u,i)),a.push(o.cut(l,f).mark(t.create(h).addToSet(o.marks))),u=c}}u<r.length&&a.push(o.cut(u))}else a.push(o.copy(r(o.content,o)))}),qE.fromArray(a)};return new sT({key:new lT("markPasteRule"),props:{transformPasted:e=>new nw(r(e.content),e.openStart,e.openEnd)}})}function IA(e,t,n){const r=e.coordsAtPos(t),o=e.coordsAtPos(n,-1),i=Math.min(r.top,o.top),a=Math.max(r.bottom,o.bottom),s=Math.min(r.left,o.left),u=Math.max(r.right,o.right),c={top:i,bottom:a,left:s,right:u,width:u-s,height:a-i,x:s,y:i};return{...c,toJSON:()=>c}}function _A(e){var t=e.getBoundingClientRect();return{width:t.width,height:t.height,top:t.top,right:t.right,bottom:t.bottom,left:t.left,x:t.left,y:t.top}}function PA(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function LA(e){var t=PA(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function FA(e){return e instanceof PA(e).Element||e instanceof Element}function DA(e){return e instanceof PA(e).HTMLElement||e instanceof HTMLElement}function UA(e){return"undefined"!=typeof ShadowRoot&&(e instanceof PA(e).ShadowRoot||e instanceof ShadowRoot)}function jA(e){return e?(e.nodeName||"").toLowerCase():null}function BA(e){return((FA(e)?e.ownerDocument:e.document)||window.document).documentElement}function VA(e){return _A(BA(e)).left+LA(e).scrollLeft}function HA(e){return PA(e).getComputedStyle(e)}function GA(e){var t=HA(e),n=t.overflow,r=t.overflowX,o=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+o+r)}function zA(e,t,n){void 0===n&&(n=!1);var r,o,i=BA(t),a=_A(e),s=DA(t),u={scrollLeft:0,scrollTop:0},c={x:0,y:0};return(s||!s&&!n)&&(("body"!==jA(t)||GA(i))&&(u=(r=t)!==PA(r)&&DA(r)?{scrollLeft:(o=r).scrollLeft,scrollTop:o.scrollTop}:LA(r)),DA(t)?((c=_A(t)).x+=t.clientLeft,c.y+=t.clientTop):i&&(c.x=VA(i))),{x:a.left+u.scrollLeft-c.x,y:a.top+u.scrollTop-c.y,width:a.width,height:a.height}}function WA(e){var t=_A(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function $A(e){return"html"===jA(e)?e:e.assignedSlot||e.parentNode||(UA(e)?e.host:null)||BA(e)}function YA(e,t){var n;void 0===t&&(t=[]);var r=function e(t){return["html","body","#document"].indexOf(jA(t))>=0?t.ownerDocument.body:DA(t)&&GA(t)?t:e($A(t))}(e),o=r===(null==(n=e.ownerDocument)?void 0:n.body),i=PA(r),a=o?[i].concat(i.visualViewport||[],GA(r)?r:[]):r,s=t.concat(a);return o?s:s.concat(YA($A(a)))}function KA(e){return["table","td","th"].indexOf(jA(e))>=0}function qA(e){return DA(e)&&"fixed"!==HA(e).position?e.offsetParent:null}function XA(e){for(var t=PA(e),n=qA(e);n&&KA(n)&&"static"===HA(n).position;)n=qA(n);return n&&("html"===jA(n)||"body"===jA(n)&&"static"===HA(n).position)?t:n||function(e){var t=-1!==navigator.userAgent.toLowerCase().indexOf("firefox");if(-1!==navigator.userAgent.indexOf("Trident")&&DA(e)&&"fixed"===HA(e).position)return null;for(var n=$A(e);DA(n)&&["html","body"].indexOf(jA(n))<0;){var r=HA(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var JA="top",QA="bottom",ZA="right",eC="left",tC=[JA,QA,ZA,eC],nC=tC.reduce((function(e,t){return e.concat([t+"-start",t+"-end"])}),[]),rC=[].concat(tC,["auto"]).reduce((function(e,t){return e.concat([t,t+"-start",t+"-end"])}),[]),oC=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function iC(e){var t=new Map,n=new Set,r=[];return e.forEach((function(e){t.set(e.name,e)})),e.forEach((function(e){n.has(e.name)||function e(o){n.add(o.name),[].concat(o.requires||[],o.requiresIfExists||[]).forEach((function(r){if(!n.has(r)){var o=t.get(r);o&&e(o)}})),r.push(o)}(e)})),r}var aC={placement:"bottom",modifiers:[],strategy:"absolute"};function sC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some((function(e){return!(e&&"function"==typeof e.getBoundingClientRect)}))}function uC(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,o=t.defaultOptions,i=void 0===o?aC:o;return function(e,t,n){void 0===n&&(n=i);var o,a,s={placement:"bottom",orderedModifiers:[],options:Object.assign({},aC,i),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},u=[],c=!1,l={state:s,setOptions:function(n){f(),s.options=Object.assign({},i,s.options,n),s.scrollParents={reference:FA(e)?YA(e):e.contextElement?YA(e.contextElement):[],popper:YA(t)};var o=function(e){var t=iC(e);return oC.reduce((function(e,n){return e.concat(t.filter((function(e){return e.phase===n})))}),[])}(function(e){var t=e.reduce((function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e}),{});return Object.keys(t).map((function(e){return t[e]}))}([].concat(r,s.options.modifiers)));return s.orderedModifiers=o.filter((function(e){return e.enabled})),s.orderedModifiers.forEach((function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,o=e.effect;if("function"==typeof o){var i=o({state:s,name:t,instance:l,options:r});u.push(i||function(){})}})),l.update()},forceUpdate:function(){if(!c){var e=s.elements,t=e.reference,n=e.popper;if(sC(t,n)){s.rects={reference:zA(t,XA(n),"fixed"===s.options.strategy),popper:WA(n)},s.reset=!1,s.placement=s.options.placement,s.orderedModifiers.forEach((function(e){return s.modifiersData[e.name]=Object.assign({},e.data)}));for(var r=0;r<s.orderedModifiers.length;r++)if(!0!==s.reset){var o=s.orderedModifiers[r],i=o.fn,a=o.options,u=void 0===a?{}:a,f=o.name;"function"==typeof i&&(s=i({state:s,options:u,name:f,instance:l})||s)}else s.reset=!1,r=-1}}},update:(o=function(){return new Promise((function(e){l.forceUpdate(),e(s)}))},function(){return a||(a=new Promise((function(e){Promise.resolve().then((function(){a=void 0,e(o())}))}))),a}),destroy:function(){f(),c=!0}};if(!sC(e,t))return l;function f(){u.forEach((function(e){return e()})),u=[]}return l.setOptions(n).then((function(e){!c&&n.onFirstUpdate&&n.onFirstUpdate(e)})),l}}var cC={passive:!0};var lC={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,o=r.scroll,i=void 0===o||o,a=r.resize,s=void 0===a||a,u=PA(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return i&&c.forEach((function(e){e.addEventListener("scroll",n.update,cC)})),s&&u.addEventListener("resize",n.update,cC),function(){i&&c.forEach((function(e){e.removeEventListener("scroll",n.update,cC)})),s&&u.removeEventListener("resize",n.update,cC)}},data:{}};function fC(e){return e.split("-")[0]}function hC(e){return e.split("-")[1]}function pC(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function dC(e){var t,n=e.reference,r=e.element,o=e.placement,i=o?fC(o):null,a=o?hC(o):null,s=n.x+n.width/2-r.width/2,u=n.y+n.height/2-r.height/2;switch(i){case JA:t={x:s,y:n.y-r.height};break;case QA:t={x:s,y:n.y+n.height};break;case ZA:t={x:n.x+n.width,y:u};break;case eC:t={x:n.x-r.width,y:u};break;default:t={x:n.x,y:n.y}}var c=i?pC(i):null;if(null!=c){var l="y"===c?"height":"width";switch(a){case"start":t[c]=t[c]-(n[l]/2-r[l]/2);break;case"end":t[c]=t[c]+(n[l]/2-r[l]/2)}}return t}var mC={name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=dC({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},vC=Math.max,yC=Math.min,gC=Math.round,bC={top:"auto",right:"auto",bottom:"auto",left:"auto"};function EC(e){var t,n=e.popper,r=e.popperRect,o=e.placement,i=e.offsets,a=e.position,s=e.gpuAcceleration,u=e.adaptive,c=e.roundOffsets,l=!0===c?function(e){var t=e.x,n=e.y,r=window.devicePixelRatio||1;return{x:gC(gC(t*r)/r)||0,y:gC(gC(n*r)/r)||0}}(i):"function"==typeof c?c(i):i,f=l.x,h=void 0===f?0:f,p=l.y,d=void 0===p?0:p,m=i.hasOwnProperty("x"),v=i.hasOwnProperty("y"),y=eC,g=JA,b=window;if(u){var E=XA(n),w="clientHeight",S="clientWidth";E===PA(n)&&"static"!==HA(E=BA(n)).position&&(w="scrollHeight",S="scrollWidth"),E=E,o===JA&&(g=QA,d-=E[w]-r.height,d*=s?1:-1),o===eC&&(y=ZA,h-=E[S]-r.width,h*=s?1:-1)}var T,O=Object.assign({position:a},u&&bC);return s?Object.assign({},O,((T={})[g]=v?"0":"",T[y]=m?"0":"",T.transform=(b.devicePixelRatio||1)<2?"translate("+h+"px, "+d+"px)":"translate3d("+h+"px, "+d+"px, 0)",T)):Object.assign({},O,((t={})[g]=v?d+"px":"",t[y]=m?h+"px":"",t.transform="",t))}var wC={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach((function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},o=t.elements[e];DA(o)&&jA(o)&&(Object.assign(o.style,n),Object.keys(r).forEach((function(e){var t=r[e];!1===t?o.removeAttribute(e):o.setAttribute(e,!0===t?"":t)})))}))},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach((function(e){var r=t.elements[e],o=t.attributes[e]||{},i=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce((function(e,t){return e[t]="",e}),{});DA(r)&&jA(r)&&(Object.assign(r.style,i),Object.keys(o).forEach((function(e){r.removeAttribute(e)})))}))}},requires:["computeStyles"]};var SC={left:"right",right:"left",bottom:"top",top:"bottom"};function TC(e){return e.replace(/left|right|bottom|top/g,(function(e){return SC[e]}))}var OC={start:"end",end:"start"};function RC(e){return e.replace(/start|end/g,(function(e){return OC[e]}))}function NC(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&UA(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function kC(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function AC(e,t){return"viewport"===t?kC(function(e){var t=PA(e),n=BA(e),r=t.visualViewport,o=n.clientWidth,i=n.clientHeight,a=0,s=0;return r&&(o=r.width,i=r.height,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)||(a=r.offsetLeft,s=r.offsetTop)),{width:o,height:i,x:a+VA(e),y:s}}(e)):DA(t)?function(e){var t=_A(e);return t.top=t.top+e.clientTop,t.left=t.left+e.clientLeft,t.bottom=t.top+e.clientHeight,t.right=t.left+e.clientWidth,t.width=e.clientWidth,t.height=e.clientHeight,t.x=t.left,t.y=t.top,t}(t):kC(function(e){var t,n=BA(e),r=LA(e),o=null==(t=e.ownerDocument)?void 0:t.body,i=vC(n.scrollWidth,n.clientWidth,o?o.scrollWidth:0,o?o.clientWidth:0),a=vC(n.scrollHeight,n.clientHeight,o?o.scrollHeight:0,o?o.clientHeight:0),s=-r.scrollLeft+VA(e),u=-r.scrollTop;return"rtl"===HA(o||n).direction&&(s+=vC(n.clientWidth,o?o.clientWidth:0)-i),{width:i,height:a,x:s,y:u}}(BA(e)))}function CC(e,t,n){var r="clippingParents"===t?function(e){var t=YA($A(e)),n=["absolute","fixed"].indexOf(HA(e).position)>=0&&DA(e)?XA(e):e;return FA(n)?t.filter((function(e){return FA(e)&&NC(e,n)&&"body"!==jA(e)})):[]}(e):[].concat(t),o=[].concat(r,[n]),i=o[0],a=o.reduce((function(t,n){var r=AC(e,n);return t.top=vC(r.top,t.top),t.right=yC(r.right,t.right),t.bottom=yC(r.bottom,t.bottom),t.left=vC(r.left,t.left),t}),AC(e,i));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function MC(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function xC(e,t){return t.reduce((function(t,n){return t[n]=e,t}),{})}function IC(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=void 0===r?e.placement:r,i=n.boundary,a=void 0===i?"clippingParents":i,s=n.rootBoundary,u=void 0===s?"viewport":s,c=n.elementContext,l=void 0===c?"popper":c,f=n.altBoundary,h=void 0!==f&&f,p=n.padding,d=void 0===p?0:p,m=MC("number"!=typeof d?d:xC(d,tC)),v="popper"===l?"reference":"popper",y=e.elements.reference,g=e.rects.popper,b=e.elements[h?v:l],E=CC(FA(b)?b:b.contextElement||BA(e.elements.popper),a,u),w=_A(y),S=dC({reference:w,element:g,strategy:"absolute",placement:o}),T=kC(Object.assign({},g,S)),O="popper"===l?T:w,R={top:E.top-O.top+m.top,bottom:O.bottom-E.bottom+m.bottom,left:E.left-O.left+m.left,right:O.right-E.right+m.right},N=e.modifiersData.offset;if("popper"===l&&N){var k=N[o];Object.keys(R).forEach((function(e){var t=[ZA,QA].indexOf(e)>=0?1:-1,n=[JA,QA].indexOf(e)>=0?"y":"x";R[e]+=k[n]*t}))}return R}function _C(e,t,n){return vC(e,yC(t,n))}function PC(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function LC(e){return[JA,ZA,QA,eC].some((function(t){return e[t]>=0}))}var FC=uC({defaultModifiers:[lC,mC,{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,o=void 0===r||r,i=n.adaptive,a=void 0===i||i,s=n.roundOffsets,u=void 0===s||s,c={placement:fC(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:o};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,EC(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:a,roundOffsets:u})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,EC(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:u})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},wC,{name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.offset,i=void 0===o?[0,0]:o,a=rC.reduce((function(e,n){return e[n]=function(e,t,n){var r=fC(e),o=[eC,JA].indexOf(r)>=0?-1:1,i="function"==typeof n?n(Object.assign({},t,{placement:e})):n,a=i[0],s=i[1];return a=a||0,s=(s||0)*o,[eC,ZA].indexOf(r)>=0?{x:s,y:a}:{x:a,y:s}}(n,t.rects,i),e}),{}),s=a[t.placement],u=s.x,c=s.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=u,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=a}},{name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0===a||a,u=n.fallbackPlacements,c=n.padding,l=n.boundary,f=n.rootBoundary,h=n.altBoundary,p=n.flipVariations,d=void 0===p||p,m=n.allowedAutoPlacements,v=t.options.placement,y=fC(v),g=u||(y===v||!d?[TC(v)]:function(e){if("auto"===fC(e))return[];var t=TC(e);return[RC(e),t,RC(t)]}(v)),b=[v].concat(g).reduce((function(e,n){return e.concat("auto"===fC(n)?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,o=n.boundary,i=n.rootBoundary,a=n.padding,s=n.flipVariations,u=n.allowedAutoPlacements,c=void 0===u?rC:u,l=hC(r),f=l?s?nC:nC.filter((function(e){return hC(e)===l})):tC,h=f.filter((function(e){return c.indexOf(e)>=0}));0===h.length&&(h=f);var p=h.reduce((function(t,n){return t[n]=IC(e,{placement:n,boundary:o,rootBoundary:i,padding:a})[fC(n)],t}),{});return Object.keys(p).sort((function(e,t){return p[e]-p[t]}))}(t,{placement:n,boundary:l,rootBoundary:f,padding:c,flipVariations:d,allowedAutoPlacements:m}):n)}),[]),E=t.rects.reference,w=t.rects.popper,S=new Map,T=!0,O=b[0],R=0;R<b.length;R++){var N=b[R],k=fC(N),A="start"===hC(N),C=[JA,QA].indexOf(k)>=0,M=C?"width":"height",x=IC(t,{placement:N,boundary:l,rootBoundary:f,altBoundary:h,padding:c}),I=C?A?ZA:eC:A?QA:JA;E[M]>w[M]&&(I=TC(I));var _=TC(I),P=[];if(i&&P.push(x[k]<=0),s&&P.push(x[I]<=0,x[_]<=0),P.every((function(e){return e}))){O=N,T=!1;break}S.set(N,P)}if(T)for(var L=function(e){var t=b.find((function(t){var n=S.get(t);if(n)return n.slice(0,e).every((function(e){return e}))}));if(t)return O=t,"break"},F=d?3:1;F>0;F--){if("break"===L(F))break}t.placement!==O&&(t.modifiersData[r]._skip=!0,t.placement=O,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}},{name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,o=n.mainAxis,i=void 0===o||o,a=n.altAxis,s=void 0!==a&&a,u=n.boundary,c=n.rootBoundary,l=n.altBoundary,f=n.padding,h=n.tether,p=void 0===h||h,d=n.tetherOffset,m=void 0===d?0:d,v=IC(t,{boundary:u,rootBoundary:c,padding:f,altBoundary:l}),y=fC(t.placement),g=hC(t.placement),b=!g,E=pC(y),w="x"===E?"y":"x",S=t.modifiersData.popperOffsets,T=t.rects.reference,O=t.rects.popper,R="function"==typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,N={x:0,y:0};if(S){if(i||s){var k="y"===E?JA:eC,A="y"===E?QA:ZA,C="y"===E?"height":"width",M=S[E],x=S[E]+v[k],I=S[E]-v[A],_=p?-O[C]/2:0,P="start"===g?T[C]:O[C],L="start"===g?-O[C]:-T[C],F=t.elements.arrow,D=p&&F?WA(F):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},j=U[k],B=U[A],V=_C(0,T[C],D[C]),H=b?T[C]/2-_-V-j-R:P-V-j-R,G=b?-T[C]/2+_+V+B+R:L+V+B+R,z=t.elements.arrow&&XA(t.elements.arrow),W=z?"y"===E?z.clientTop||0:z.clientLeft||0:0,$=t.modifiersData.offset?t.modifiersData.offset[t.placement][E]:0,Y=S[E]+H-$-W,K=S[E]+G-$;if(i){var q=_C(p?yC(x,Y):x,M,p?vC(I,K):I);S[E]=q,N[E]=q-M}if(s){var X="x"===E?JA:eC,J="x"===E?QA:ZA,Q=S[w],Z=Q+v[X],ee=Q-v[J],te=_C(p?yC(Z,Y):Z,Q,p?vC(ee,K):ee);S[w]=te,N[w]=te-Q}}t.modifiersData[r]=N}},requiresIfExists:["offset"]},{name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,o=e.options,i=n.elements.arrow,a=n.modifiersData.popperOffsets,s=fC(n.placement),u=pC(s),c=[eC,ZA].indexOf(s)>=0?"height":"width";if(i&&a){var l=function(e,t){return MC("number"!=typeof(e="function"==typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:xC(e,tC))}(o.padding,n),f=WA(i),h="y"===u?JA:eC,p="y"===u?QA:ZA,d=n.rects.reference[c]+n.rects.reference[u]-a[u]-n.rects.popper[c],m=a[u]-n.rects.reference[u],v=XA(i),y=v?"y"===u?v.clientHeight||0:v.clientWidth||0:0,g=d/2-m/2,b=l[h],E=y-f[c]-l[p],w=y/2-f[c]/2+g,S=_C(b,w,E),T=u;n.modifiersData[r]=((t={})[T]=S,t.centerOffset=S-w,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!=typeof r||(r=t.elements.popper.querySelector(r)))&&NC(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,o=t.rects.popper,i=t.modifiersData.preventOverflow,a=IC(t,{elementContext:"reference"}),s=IC(t,{altBoundary:!0}),u=PC(a,r),c=PC(s,o,i),l=LC(u),f=LC(c);t.modifiersData[n]={referenceClippingOffsets:u,popperEscapeOffsets:c,isReferenceHidden:l,hasPopperEscaped:f},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":l,"data-popper-escaped":f})}}]}),DC={passive:!0,capture:!0};function UC(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function jC(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function BC(e,t){return"function"==typeof e?e.apply(void 0,t):e}function VC(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout((function(){e(r)}),t)};var n}function HC(e){return[].concat(e)}function GC(e,t){-1===e.indexOf(t)&&e.push(t)}function zC(e){return e.split("-")[0]}function WC(e){return[].slice.call(e)}function $C(){return document.createElement("div")}function YC(e){return["Element","Fragment"].some((function(t){return jC(e,t)}))}function KC(e){return jC(e,"MouseEvent")}function qC(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function XC(e){return YC(e)?[e]:function(e){return jC(e,"NodeList")}(e)?WC(e):Array.isArray(e)?e:WC(document.querySelectorAll(e))}function JC(e,t){e.forEach((function(e){e&&(e.style.transitionDuration=t+"ms")}))}function QC(e,t){e.forEach((function(e){e&&e.setAttribute("data-state",t)}))}function ZC(e){var t,n=HC(e)[0];return(null==n||null==(t=n.ownerDocument)?void 0:t.body)?n.ownerDocument:document}function eM(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach((function(t){e[r](t,n)}))}var tM={isTouch:!1},nM=0;function rM(){tM.isTouch||(tM.isTouch=!0,window.performance&&document.addEventListener("mousemove",oM))}function oM(){var e=performance.now();e-nM<20&&(tM.isTouch=!1,document.removeEventListener("mousemove",oM)),nM=e}function iM(){var e=document.activeElement;if(qC(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var aM="undefined"!=typeof window&&"undefined"!=typeof document?navigator.userAgent:"",sM=/MSIE |Trident\//.test(aM);var uM={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},cM=Object.assign({appendTo:function(){return document.body},aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},uM,{},{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),lM=Object.keys(cM);function fM(e){var t=(e.plugins||[]).reduce((function(t,n){var r=n.name,o=n.defaultValue;return r&&(t[r]=void 0!==e[r]?e[r]:o),t}),{});return Object.assign({},e,{},t)}function hM(e,t){var n=Object.assign({},t,{content:BC(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(fM(Object.assign({},cM,{plugins:t}))):lM).reduce((function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(e){t[n]=r}return t}),{})}(e,t.plugins));return n.aria=Object.assign({},cM.aria,{},n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function pM(e,t){e.innerHTML=t}function dM(e){var t=$C();return!0===e?t.className="tippy-arrow":(t.className="tippy-svg-arrow",YC(e)?t.appendChild(e):pM(t,e)),t}function mM(e,t){YC(t.content)?(pM(e,""),e.appendChild(t.content)):"function"!=typeof t.content&&(t.allowHTML?pM(e,t.content):e.textContent=t.content)}function vM(e){var t=e.firstElementChild,n=WC(t.children);return{box:t,content:n.find((function(e){return e.classList.contains("tippy-content")})),arrow:n.find((function(e){return e.classList.contains("tippy-arrow")||e.classList.contains("tippy-svg-arrow")})),backdrop:n.find((function(e){return e.classList.contains("tippy-backdrop")}))}}function yM(e){var t=$C(),n=$C();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=$C();function o(n,r){var o=vM(t),i=o.box,a=o.content,s=o.arrow;r.theme?i.setAttribute("data-theme",r.theme):i.removeAttribute("data-theme"),"string"==typeof r.animation?i.setAttribute("data-animation",r.animation):i.removeAttribute("data-animation"),r.inertia?i.setAttribute("data-inertia",""):i.removeAttribute("data-inertia"),i.style.maxWidth="number"==typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?i.setAttribute("role",r.role):i.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||mM(a,e.props),r.arrow?s?n.arrow!==r.arrow&&(i.removeChild(s),i.appendChild(dM(r.arrow))):i.appendChild(dM(r.arrow)):s&&i.removeChild(s)}return r.className="tippy-content",r.setAttribute("data-state","hidden"),mM(r,e.props),t.appendChild(n),n.appendChild(r),o(e.props,e.props),{popper:t,onUpdate:o}}yM.$$tippy=!0;var gM=1,bM=[],EM=[];function wM(e,t){var n,r,o,i,a,s,u,c,l,f=hM(e,Object.assign({},cM,{},fM((n=t,Object.keys(n).reduce((function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e}),{}))))),h=!1,p=!1,d=!1,m=!1,v=[],y=VC(K,f.interactiveDebounce),g=gM++,b=(l=f.plugins).filter((function(e,t){return l.indexOf(e)===t})),E={id:g,reference:e,popper:$C(),popperInstance:null,props:f,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:b,clearDelayTimeouts:function(){clearTimeout(r),clearTimeout(o),cancelAnimationFrame(i)},setProps:function(t){0;if(E.state.isDestroyed)return;P("onBeforeUpdate",[E,t]),$();var n=E.props,r=hM(e,Object.assign({},E.props,{},t,{ignoreAttributes:!0}));E.props=r,W(),n.interactiveDebounce!==r.interactiveDebounce&&(D(),y=VC(K,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?HC(n.triggerTarget).forEach((function(e){e.removeAttribute("aria-expanded")})):r.triggerTarget&&e.removeAttribute("aria-expanded");F(),_(),T&&T(n,r);E.popperInstance&&(Q(),ee().forEach((function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)})));P("onAfterUpdate",[E,t])},setContent:function(e){E.setProps({content:e})},show:function(){0;var e=E.state.isVisible,t=E.state.isDestroyed,n=!E.state.isEnabled,r=tM.isTouch&&!E.props.touch,o=UC(E.props.duration,0,cM.duration);if(e||t||n||r)return;if(C().hasAttribute("disabled"))return;if(P("onShow",[E],!1),!1===E.props.onShow(E))return;E.state.isVisible=!0,A()&&(S.style.visibility="visible");_(),V(),E.state.isMounted||(S.style.transition="none");if(A()){var i=x(),a=i.box,s=i.content;JC([a,s],0)}u=function(){var e;if(E.state.isVisible&&!m){if(m=!0,S.offsetHeight,S.style.transition=E.props.moveTransition,A()&&E.props.animation){var t=x(),n=t.box,r=t.content;JC([n,r],o),QC([n,r],"visible")}L(),F(),GC(EM,E),null==(e=E.popperInstance)||e.forceUpdate(),E.state.isMounted=!0,P("onMount",[E]),E.props.animation&&A()&&function(e,t){G(e,t)}(o,(function(){E.state.isShown=!0,P("onShown",[E])}))}},function(){var e,t=E.props.appendTo,n=C();e=E.props.interactive&&t===cM.appendTo||"parent"===t?n.parentNode:BC(t,[n]);e.contains(S)||e.appendChild(S);Q(),!1}()},hide:function(){0;var e=!E.state.isVisible,t=E.state.isDestroyed,n=!E.state.isEnabled,r=UC(E.props.duration,1,cM.duration);if(e||t||n)return;if(P("onHide",[E],!1),!1===E.props.onHide(E))return;E.state.isVisible=!1,E.state.isShown=!1,m=!1,h=!1,A()&&(S.style.visibility="hidden");if(D(),H(),_(),A()){var o=x(),i=o.box,a=o.content;E.props.animation&&(JC([i,a],r),QC([i,a],"hidden"))}L(),F(),E.props.animation?A()&&function(e,t){G(e,(function(){!E.state.isVisible&&S.parentNode&&S.parentNode.contains(S)&&t()}))}(r,E.unmount):E.unmount()},hideWithInteractivity:function(e){0;M().addEventListener("mousemove",y),GC(bM,y),y(e)},enable:function(){E.state.isEnabled=!0},disable:function(){E.hide(),E.state.isEnabled=!1},unmount:function(){0;E.state.isVisible&&E.hide();if(!E.state.isMounted)return;Z(),ee().forEach((function(e){e._tippy.unmount()})),S.parentNode&&S.parentNode.removeChild(S);EM=EM.filter((function(e){return e!==E})),E.state.isMounted=!1,P("onHidden",[E])},destroy:function(){0;if(E.state.isDestroyed)return;E.clearDelayTimeouts(),E.unmount(),$(),delete e._tippy,E.state.isDestroyed=!0,P("onDestroy",[E])}};if(!f.render)return E;var w=f.render(E),S=w.popper,T=w.onUpdate;S.setAttribute("data-tippy-root",""),S.id="tippy-"+E.id,E.popper=S,e._tippy=E,S._tippy=E;var O=b.map((function(e){return e.fn(E)})),R=e.hasAttribute("aria-expanded");return W(),F(),_(),P("onCreate",[E]),f.showOnCreate&&te(),S.addEventListener("mouseenter",(function(){E.props.interactive&&E.state.isVisible&&E.clearDelayTimeouts()})),S.addEventListener("mouseleave",(function(e){E.props.interactive&&E.props.trigger.indexOf("mouseenter")>=0&&(M().addEventListener("mousemove",y),y(e))})),E;function N(){var e=E.props.touch;return Array.isArray(e)?e:[e,0]}function k(){return"hold"===N()[0]}function A(){var e;return!!(null==(e=E.props.render)?void 0:e.$$tippy)}function C(){return c||e}function M(){var e=C().parentNode;return e?ZC(e):document}function x(){return vM(S)}function I(e){return E.state.isMounted&&!E.state.isVisible||tM.isTouch||a&&"focus"===a.type?0:UC(E.props.delay,e?0:1,cM.delay)}function _(){S.style.pointerEvents=E.props.interactive&&E.state.isVisible?"":"none",S.style.zIndex=""+E.props.zIndex}function P(e,t,n){var r;(void 0===n&&(n=!0),O.forEach((function(n){n[e]&&n[e].apply(void 0,t)})),n)&&(r=E.props)[e].apply(r,t)}function L(){var t=E.props.aria;if(t.content){var n="aria-"+t.content,r=S.id;HC(E.props.triggerTarget||e).forEach((function(e){var t=e.getAttribute(n);if(E.state.isVisible)e.setAttribute(n,t?t+" "+r:r);else{var o=t&&t.replace(r,"").trim();o?e.setAttribute(n,o):e.removeAttribute(n)}}))}}function F(){!R&&E.props.aria.expanded&&HC(E.props.triggerTarget||e).forEach((function(e){E.props.interactive?e.setAttribute("aria-expanded",E.state.isVisible&&e===C()?"true":"false"):e.removeAttribute("aria-expanded")}))}function D(){M().removeEventListener("mousemove",y),bM=bM.filter((function(e){return e!==y}))}function U(e){if(!(tM.isTouch&&(d||"mousedown"===e.type)||E.props.interactive&&S.contains(e.target))){if(C().contains(e.target)){if(tM.isTouch)return;if(E.state.isVisible&&E.props.trigger.indexOf("click")>=0)return}else P("onClickOutside",[E,e]);!0===E.props.hideOnClick&&(E.clearDelayTimeouts(),E.hide(),p=!0,setTimeout((function(){p=!1})),E.state.isMounted||H())}}function j(){d=!0}function B(){d=!1}function V(){var e=M();e.addEventListener("mousedown",U,!0),e.addEventListener("touchend",U,DC),e.addEventListener("touchstart",B,DC),e.addEventListener("touchmove",j,DC)}function H(){var e=M();e.removeEventListener("mousedown",U,!0),e.removeEventListener("touchend",U,DC),e.removeEventListener("touchstart",B,DC),e.removeEventListener("touchmove",j,DC)}function G(e,t){var n=x().box;function r(e){e.target===n&&(eM(n,"remove",r),t())}if(0===e)return t();eM(n,"remove",s),eM(n,"add",r),s=r}function z(t,n,r){void 0===r&&(r=!1),HC(E.props.triggerTarget||e).forEach((function(e){e.addEventListener(t,n,r),v.push({node:e,eventType:t,handler:n,options:r})}))}function W(){var e;k()&&(z("touchstart",Y,{passive:!0}),z("touchend",q,{passive:!0})),(e=E.props.trigger,e.split(/\s+/).filter(Boolean)).forEach((function(e){if("manual"!==e)switch(z(e,Y),e){case"mouseenter":z("mouseleave",q);break;case"focus":z(sM?"focusout":"blur",X);break;case"focusin":z("focusout",X)}}))}function $(){v.forEach((function(e){var t=e.node,n=e.eventType,r=e.handler,o=e.options;t.removeEventListener(n,r,o)})),v=[]}function Y(e){var t,n=!1;if(E.state.isEnabled&&!J(e)&&!p){var r="focus"===(null==(t=a)?void 0:t.type);a=e,c=e.currentTarget,F(),!E.state.isVisible&&KC(e)&&bM.forEach((function(t){return t(e)})),"click"===e.type&&(E.props.trigger.indexOf("mouseenter")<0||h)&&!1!==E.props.hideOnClick&&E.state.isVisible?n=!0:te(e),"click"===e.type&&(h=!n),n&&!r&&ne(e)}}function K(e){var t=e.target,n=C().contains(t)||S.contains(t);"mousemove"===e.type&&n||function(e,t){var n=t.clientX,r=t.clientY;return e.every((function(e){var t=e.popperRect,o=e.popperState,i=e.props.interactiveBorder,a=zC(o.placement),s=o.modifiersData.offset;if(!s)return!0;var u="bottom"===a?s.top.y:0,c="top"===a?s.bottom.y:0,l="right"===a?s.left.x:0,f="left"===a?s.right.x:0,h=t.top-r+u>i,p=r-t.bottom-c>i,d=t.left-n+l>i,m=n-t.right-f>i;return h||p||d||m}))}(ee().concat(S).map((function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:f}:null})).filter(Boolean),e)&&(D(),ne(e))}function q(e){J(e)||E.props.trigger.indexOf("click")>=0&&h||(E.props.interactive?E.hideWithInteractivity(e):ne(e))}function X(e){E.props.trigger.indexOf("focusin")<0&&e.target!==C()||E.props.interactive&&e.relatedTarget&&S.contains(e.relatedTarget)||ne(e)}function J(e){return!!tM.isTouch&&k()!==e.type.indexOf("touch")>=0}function Q(){Z();var t=E.props,n=t.popperOptions,r=t.placement,o=t.offset,i=t.getReferenceClientRect,a=t.moveTransition,s=A()?vM(S).arrow:null,c=i?{getBoundingClientRect:i,contextElement:i.contextElement||C()}:e,l=[{name:"offset",options:{offset:o}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!a}},{name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(A()){var n=x().box;["placement","reference-hidden","escaped"].forEach((function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)})),t.attributes.popper={}}}}];A()&&s&&l.push({name:"arrow",options:{element:s,padding:3}}),l.push.apply(l,(null==n?void 0:n.modifiers)||[]),E.popperInstance=FC(c,S,Object.assign({},n,{placement:r,onFirstUpdate:u,modifiers:l}))}function Z(){E.popperInstance&&(E.popperInstance.destroy(),E.popperInstance=null)}function ee(){return WC(S.querySelectorAll("[data-tippy-root]"))}function te(e){E.clearDelayTimeouts(),e&&P("onTrigger",[E,e]),V();var t=I(!0),n=N(),o=n[0],i=n[1];tM.isTouch&&"hold"===o&&i&&(t=i),t?r=setTimeout((function(){E.show()}),t):E.show()}function ne(e){if(E.clearDelayTimeouts(),P("onUntrigger",[E,e]),E.state.isVisible){if(!(E.props.trigger.indexOf("mouseenter")>=0&&E.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&h)){var t=I(!1);t?o=setTimeout((function(){E.state.isVisible&&E.hide()}),t):i=requestAnimationFrame((function(){E.hide()}))}}else H()}}function SM(e,t){void 0===t&&(t={});var n=cM.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",rM,DC),window.addEventListener("blur",iM);var r=Object.assign({},t,{plugins:n}),o=XC(e).reduce((function(e,t){var n=t&&wM(t,r);return n&&e.push(n),e}),[]);return YC(e)?o[0]:o}SM.defaultProps=cM,SM.setDefaultProps=function(e){Object.keys(e).forEach((function(t){cM[t]=e[t]}))},SM.currentInput=tM;Object.assign({},wC,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}});SM.setDefaultProps({render:yM});var TM=SM;class OM{constructor({editor:e,element:t,view:n,tippyOptions:r}){this.preventHide=!1,this.mousedownHandler=()=>{this.preventHide=!0},this.dragstartHandler=()=>{this.hide()},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||this.hide()},this.editor=e,this.element=t,this.view=n,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.view.dom.addEventListener("dragstart",this.dragstartHandler),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(r),this.element.style.visibility="visible"}createTooltip(e={}){this.tippy=TM(this.view.dom,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"top",hideOnClick:"toggle",...e})}update(e,t){const{state:n,composing:r}=e,{doc:o,selection:i}=n,a=t&&t.doc.eq(o)&&t.selection.eq(i);if(r||a)return;const{empty:s,ranges:u}=i,c=Math.min(...u.map(e=>e.$from.pos)),l=Math.max(...u.map(e=>e.$to.pos)),f=!o.textBetween(c,l).length&&Ik(e.state.selection);s||f?this.hide():(this.tippy.setProps({getReferenceClientRect:()=>{if(xk(t=e.state.selection)&&t instanceof YS){const t=e.nodeDOM(c);if(t)return t.getBoundingClientRect()}var t;return IA(e,c,l)}}),this.show())}show(){this.tippy.show()}hide(){this.tippy.hide()}destroy(){this.tippy.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler),this.view.dom.removeEventListener("dragstart",this.dragstartHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const RM=new lT("menuBubble"),NM=e=>new sT({key:RM,view:t=>new OM({view:t,...e})});dk.create({name:"bubbleMenu",defaultOptions:{element:null,tippyOptions:{}},addProseMirrorPlugins(){return this.options.element?[NM({editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions})]:[]}});class kM{constructor({editor:e,element:t,view:n,tippyOptions:r}){this.preventHide=!1,this.mousedownHandler=()=>{this.preventHide=!0},this.focusHandler=()=>{setTimeout(()=>this.update(this.editor.view))},this.blurHandler=({event:e})=>{var t;this.preventHide?this.preventHide=!1:(null==e?void 0:e.relatedTarget)&&(null===(t=this.element.parentNode)||void 0===t?void 0:t.contains(e.relatedTarget))||this.hide()},this.editor=e,this.element=t,this.view=n,this.element.addEventListener("mousedown",this.mousedownHandler,{capture:!0}),this.editor.on("focus",this.focusHandler),this.editor.on("blur",this.blurHandler),this.createTooltip(r),this.element.style.visibility="visible"}createTooltip(e={}){this.tippy=TM(this.view.dom,{duration:0,getReferenceClientRect:null,content:this.element,interactive:!0,trigger:"manual",placement:"right",hideOnClick:"toggle",...e})}update(e,t){const{state:n,composing:r}=e,{doc:o,selection:i}=n,a=t&&t.doc.eq(o)&&t.selection.eq(i);if(r||a)return;const{$anchor:s,empty:u,from:c,to:l}=i,f=1===s.depth,h=!i.$anchor.parent.isLeaf&&!i.$anchor.parent.textContent;u&&(f&&h)?(this.tippy.setProps({getReferenceClientRect:()=>IA(e,c,l)}),this.show()):this.hide()}show(){this.tippy.show()}hide(){this.tippy.hide()}destroy(){this.tippy.destroy(),this.element.removeEventListener("mousedown",this.mousedownHandler),this.editor.off("focus",this.focusHandler),this.editor.off("blur",this.blurHandler)}}const AM=new lT("menuFloating"),CM=e=>new sT({key:AM,view:t=>new kM({view:t,...e})});dk.create({name:"floatingMenu",defaultOptions:{element:null,tippyOptions:{}},addProseMirrorPlugins(){return this.options.element?[CM({editor:this.editor,element:this.options.element,tippyOptions:this.options.tippyOptions})]:[]}}),n("Kw5r");class MM extends class extends class{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const n=this.callbacks[e];return n&&n.forEach(e=>e.apply(this,t)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}removeAllListeners(){this.callbacks={}}}{constructor(e={}){super(),this.isFocused=!1,this.options={element:document.createElement("div"),content:"",injectCSS:!0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get commands(){return this.commandManager.createCommands()}chain(){return this.commandManager.createChain()}can(){return this.commandManager.createCan()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e){const t=document.querySelector("style[data-tiptap-style]");if(null!==t)return t;const n=document.createElement("style");return n.setAttribute("data-tiptap-style",""),n.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(n),n}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}'))}setOptions(e={}){this.options={...this.options,...e}}setEditable(e){this.setOptions({editable:e}),this.view&&this.state&&!this.isDestroyed&&this.view.updateState(this.state)}get isEditable(){return this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n="function"==typeof t?t(e,this.state.plugins):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});this.view.updateState(r)}unregisterPlugin(e){if(this.isDestroyed)return;const t="string"==typeof e?e+"$":e.key,n=this.state.reconfigure({plugins:this.state.plugins.filter(e=>!e.key.startsWith(t))});this.view.updateState(n)}createExtensionManager(){const e=[...Object.entries(kA).map(([,e])=>e),...this.options.extensions].filter(e=>["extension","node","mark"].includes(null==e?void 0:e.type));this.extensionManager=new fk(e,this)}createCommandManager(){this.commandManager=new ek(this,this.extensionManager.commands)}createSchema(){this.schema=this.extensionManager.schema}createView(){this.view=new $R(this.options.element,{...this.options.editorProps,dispatchTransaction:this.dispatchTransaction.bind(this),state:oT.create({doc:QN(this.options.content,this.schema,this.options.parseOptions)})});const e=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(e),this.createNodeViews();this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)}):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this});const r=e.getMeta("focus"),o=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event}),o&&this.emit("blur",{editor:this,event:o.event}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return function(e,t){const n=HN("string"==typeof t?t:t.name,e.schema);return"node"===n?zN(e,t):"mark"===n?$N(e,t):{}}(this.state,e)}getNodeAttributes(e){return console.warn("[tiptap warn]: editor.getNodeAttributes() is deprecated. please use editor.getAttributes() instead."),zN(this.state,e)}getMarkAttributes(e){return console.warn("[tiptap warn]: editor.getMarkAttributes() is deprecated. please use editor.getAttributes() instead."),$N(this.state,e)}isActive(e,t){const n="string"==typeof e?e:null,r="string"==typeof e?t:e;return function(e,t,n={}){if(!t)return KN(e,null,n)||qN(e,null,n);const r=HN(t,e.schema);return"node"===r?KN(e,t,n):"mark"===r&&qN(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ZN(this.state.doc,this.schema)}get isEmpty(){return function(e){var t;const n=null===(t=e.type.createAndFill())||void 0===t?void 0:t.toJSON(),r=e.toJSON();return JSON.stringify(n)===JSON.stringify(r)}(this.state.doc)}getCharacterCount(){return this.state.doc.content.size-2}destroy(){var e;this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners(),(e=this.css)&&e.parentNode&&e.parentNode.removeChild(e)}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}}{constructor(){super(...arguments),this.contentComponent=null}}const xM={name:"EditorContent",props:{editor:{default:null,type:Object}},watch:{editor:{immediate:!0,handler(e){e&&e.options.element&&this.$nextTick(()=>{const t=this.$el;t&&e.options.element.firstChild&&(t.append(...e.options.element.childNodes),e.contentComponent=this,e.setOptions({element:t}),e.createNodeViews())})}}},render:e=>e("div"),beforeDestroy(){const{editor:e}=this;if(!e)return;if(e.isDestroyed||e.view.setProps({nodeViews:{}}),e.contentComponent=null,!e.options.element.firstChild)return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}};Boolean;var IM=function(e,t){var n=this;this.editorView=e,this.width=t.width||1,this.color=t.color||"black",this.class=t.class,this.cursorPos=null,this.element=null,this.timeout=null,this.handlers=["dragover","dragend","drop","dragleave"].map((function(t){var r=function(e){return n[t](e)};return e.dom.addEventListener(t,r),{name:t,handler:r}}))};IM.prototype.destroy=function(){var e=this;this.handlers.forEach((function(t){var n=t.name,r=t.handler;return e.editorView.dom.removeEventListener(n,r)}))},IM.prototype.update=function(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())},IM.prototype.setCursor=function(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())},IM.prototype.updateOverlay=function(){var e,t=this.editorView.state.doc.resolve(this.cursorPos);if(!t.parent.inlineContent){var n=t.nodeBefore,r=t.nodeAfter;if(n||r){var o=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0)).getBoundingClientRect(),i=n?o.bottom:o.top;n&&r&&(i=(i+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),e={left:o.left,right:o.right,top:i-this.width/2,bottom:i+this.width/2}}}if(!e){var a=this.editorView.coordsAtPos(this.cursorPos);e={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}var s,u,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none; background-color: "+this.color),!c||c==document.body&&"static"==getComputedStyle(c).position)s=-pageXOffset,u=-pageYOffset;else{var l=c.getBoundingClientRect();s=l.left-c.scrollLeft,u=l.top-c.scrollTop}this.element.style.left=e.left-s+"px",this.element.style.top=e.top-u+"px",this.element.style.width=e.right-e.left+"px",this.element.style.height=e.bottom-e.top+"px"},IM.prototype.scheduleRemoval=function(e){var t=this;clearTimeout(this.timeout),this.timeout=setTimeout((function(){return t.setCursor(null)}),e)},IM.prototype.dragover=function(e){if(this.editorView.editable){var t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY});if(t){var n=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice&&null==(n=kS(this.editorView.state.doc,n,this.editorView.dragging.slice)))return this.setCursor(null);this.setCursor(n),this.scheduleRemoval(5e3)}}},IM.prototype.dragend=function(){this.scheduleRemoval(20)},IM.prototype.drop=function(){this.scheduleRemoval(20)},IM.prototype.dragleave=function(e){e.target!=this.editorView.dom&&this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)};var _M=dk.create({name:"dropCursor",defaultOptions:{color:"currentColor",width:1,class:null},addProseMirrorPlugins(){return[(e=this.options,void 0===e&&(e={}),new sT({view:function(t){return new IM(t,e)}}))];var e}}),PM=function(e){function t(t){e.call(this,t,t)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));return t.valid(o)?new t(o):e.near(o)},t.prototype.content=function(){return nw.empty},t.prototype.eq=function(e){return e instanceof t&&e.head==this.head},t.prototype.toJSON=function(){return{type:"gapcursor",pos:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new t(e.resolve(n.pos))},t.prototype.getBookmark=function(){return new LM(this.anchor)},t.valid=function(e){var t=e.parent;if(t.isTextblock||!function(e){for(var t=e.depth;t>=0;t--){var n=e.index(t);if(0!=n)for(var r=e.node(t).child(n-1);;r=r.lastChild){if(0==r.childCount&&!r.inlineContent||r.isAtom||r.type.spec.isolating)return!0;if(r.inlineContent)return!1}}return!0}(e)||!function(e){for(var t=e.depth;t>=0;t--){var n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(var o=r.child(n);;o=o.firstChild){if(0==o.childCount&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}(e))return!1;var n=t.type.spec.allowGapCursor;if(null!=n)return n;var r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock},t.findFrom=function(e,n,r){e:for(;;){if(!r&&t.valid(e))return e;for(var o=e.pos,i=null,a=e.depth;;a--){var s=e.node(a);if(n>0?e.indexAfter(a)<s.childCount:e.index(a)>0){i=s.child(n>0?e.indexAfter(a):e.index(a)-1);break}if(0==a)return null;o+=n;var u=e.doc.resolve(o);if(t.valid(u))return u}for(;;){var c=n>0?i.firstChild:i.lastChild;if(!c){if(i.isAtom&&!i.isText&&!YS.isSelectable(i)){e=e.doc.resolve(o+i.nodeSize*n),r=!1;continue e}break}i=c,o+=n;var l=e.doc.resolve(o);if(t.valid(l))return l}return null}},t}(HS);PM.prototype.visible=!1,HS.jsonID("gapcursor",PM);var LM=function(e){this.pos=e};LM.prototype.map=function(e){return new LM(e.map(this.pos))},LM.prototype.resolve=function(e){var t=e.resolve(this.pos);return PM.valid(t)?new PM(t):HS.near(t)};var FM=fN({ArrowLeft:DM("horiz",-1),ArrowRight:DM("horiz",1),ArrowUp:DM("vert",-1),ArrowDown:DM("vert",1)});function DM(e,t){var n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,o){var i=e.selection,a=t>0?i.$to:i.$from,s=i.empty;if(i instanceof WS){if(!o.endOfTextblock(n)||0==a.depth)return!1;s=!1,a=e.doc.resolve(t>0?a.after():a.before())}var u=PM.findFrom(a,t,s);return!!u&&(r&&r(e.tr.setSelection(new PM(u))),!0)}}function UM(e,t,n){if(!e.editable)return!1;var r=e.state.doc.resolve(t);if(!PM.valid(r))return!1;var o=e.posAtCoords({left:n.clientX,top:n.clientY}).inside;return!(o>-1&&YS.isSelectable(e.state.doc.nodeAt(o)))&&(e.dispatch(e.state.tr.setSelection(new PM(r))),!0)}function jM(e){if(!(e.selection instanceof PM))return null;var t=document.createElement("div");return t.className="ProseMirror-gapcursor",LR.create(e.doc,[xR.widget(e.selection.head,t,{key:"gapcursor"})])}var BM=dk.create({name:"gapCursor",addProseMirrorPlugins:()=>[new sT({props:{decorations:jM,createSelectionBetween:function(e,t,n){if(t.pos==n.pos&&PM.valid(n))return new PM(n)},handleClick:UM,handleKeyDown:FM}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=sk(tk(e,"allowGapCursor",{name:e.name,options:e.options})))&&void 0!==t?t:null}}});var VM=AA.create({name:"doc",topNode:!0,content:"block+"});var HM=AA.create({name:"paragraph",priority:1e3,defaultOptions:{HTMLAttributes:{}},group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML({HTMLAttributes:e}){return["p",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setParagraph:()=>({commands:e})=>e.toggleNode("paragraph","paragraph")}),addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}});var GM=AA.create({name:"text",group:"inline"}),zM=function(){};zM.prototype.append=function(e){return e.length?(e=zM.from(e),!this.length&&e||e.length<200&&this.leafAppend(e)||this.length<200&&e.leafPrepend(this)||this.appendInner(e)):this},zM.prototype.prepend=function(e){return e.length?zM.from(e).append(this):this},zM.prototype.appendInner=function(e){return new $M(this,e)},zM.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?zM.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},zM.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},zM.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},zM.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach((function(t,n){return r.push(e(t,n))}),t,n),r},zM.from=function(e){return e instanceof zM?e:e&&e.length?new WM(e):zM.empty};var WM=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var o=t;o<n;o++)if(!1===e(this.values[o],r+o))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var o=t-1;o>=n;o--)if(!1===e(this.values[o],r+o))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=200)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=200)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(zM);zM.empty=new WM([]);var $M=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var o=this.left.length;return!(t<o&&!1===this.left.forEachInner(e,t,Math.min(n,o),r))&&(!(n>o&&!1===this.right.forEachInner(e,Math.max(t-o,0),Math.min(this.length,n)-o,r+o))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var o=this.left.length;return!(t>o&&!1===this.right.forEachInvertedInner(e,t-o,Math.max(n,o)-o,r+o))&&(!(n<o&&!1===this.left.forEachInvertedInner(e,Math.min(t,o),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(zM),YM=zM,KM=function(e,t){this.items=e,this.eventCount=t};KM.prototype.popEvent=function(e,t){var n=this;if(0==this.eventCount)return null;for(var r,o,i=this.items.length;;i--){if(this.items.get(i-1).selection){--i;break}}t&&(r=this.remapping(i,this.items.length),o=r.maps.length);var a,s,u=e.tr,c=[],l=[];return this.items.forEach((function(e,t){if(!e.step)return r||(r=n.remapping(i,t+1),o=r.maps.length),o--,void l.push(e);if(r){l.push(new qM(e.map));var f,h=e.step.map(r.slice(o));h&&u.maybeStep(h).doc&&(f=u.mapping.maps[u.mapping.maps.length-1],c.push(new qM(f,null,null,c.length+l.length))),o--,f&&r.appendMap(f,o)}else u.maybeStep(e.step);return e.selection?(a=r?e.selection.map(r.slice(o)):e.selection,s=new KM(n.items.slice(0,i).append(l.reverse().concat(c)),n.eventCount-1),!1):void 0}),this.items.length,0),{remaining:s,transform:u,selection:a}},KM.prototype.addTransform=function(e,t,n,r){for(var o=[],i=this.eventCount,a=this.items,s=!r&&a.length?a.get(a.length-1):null,u=0;u<e.steps.length;u++){var c,l=e.steps[u].invert(e.docs[u]),f=new qM(e.mapping.maps[u],l,t);(c=s&&s.merge(f))&&(f=c,u?o.pop():a=a.slice(0,a.length-1)),o.push(f),t&&(i++,t=null),r||(s=f)}var h,p,d,m=i-n.depth;return m>JM&&(p=m,(h=a).forEach((function(e,t){if(e.selection&&0==p--)return d=t,!1})),a=h.slice(d),i-=m),new KM(a.append(o),i)},KM.prototype.remapping=function(e,t){var n=new cS;return this.items.forEach((function(t,r){var o=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:null;n.appendMap(t.map,o)}),e,t),n},KM.prototype.addMaps=function(e){return 0==this.eventCount?this:new KM(this.items.append(e.map((function(e){return new qM(e)}))),this.eventCount)},KM.prototype.rebased=function(e,t){if(!this.eventCount)return this;var n=[],r=Math.max(0,this.items.length-t),o=e.mapping,i=e.steps.length,a=this.eventCount;this.items.forEach((function(e){e.selection&&a--}),r);var s=t;this.items.forEach((function(t){var r=o.getMirror(--s);if(null!=r){i=Math.min(i,r);var u=o.maps[r];if(t.step){var c=e.steps[r].invert(e.docs[r]),l=t.selection&&t.selection.map(o.slice(s+1,r));l&&a++,n.push(new qM(u,c,l))}else n.push(new qM(u))}}),r);for(var u=[],c=t;c<i;c++)u.push(new qM(o.maps[c]));var l=this.items.slice(0,r).append(u).append(n),f=new KM(l,a);return f.emptyItemCount()>500&&(f=f.compress(this.items.length-n.length)),f},KM.prototype.emptyItemCount=function(){var e=0;return this.items.forEach((function(t){t.step||e++})),e},KM.prototype.compress=function(e){void 0===e&&(e=this.items.length);var t=this.remapping(0,e),n=t.maps.length,r=[],o=0;return this.items.forEach((function(i,a){if(a>=e)r.push(i),i.selection&&o++;else if(i.step){var s=i.step.map(t.slice(n)),u=s&&s.getMap();if(n--,u&&t.appendMap(u,n),s){var c=i.selection&&i.selection.map(t.slice(n));c&&o++;var l,f=new qM(u.invert(),s,c),h=r.length-1;(l=r.length&&r[h].merge(f))?r[h]=l:r.push(f)}}else i.map&&n--}),this.items.length,0),new KM(YM.from(r.reverse()),o)},KM.empty=new KM(YM.empty,0);var qM=function(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r};qM.prototype.merge=function(e){if(this.step&&e.step&&!e.selection){var t=e.step.merge(this.step);if(t)return new qM(t.getMap().invert(),t,this.selection)}};var XM=function(e,t,n,r){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r},JM=20;function QM(e){var t=[];return e.forEach((function(e,n,r,o){return t.push(r,o)})),t}function ZM(e,t){if(!e)return null;for(var n=[],r=0;r<e.length;r+=2){var o=t.map(e[r],1),i=t.map(e[r+1],-1);o<=i&&n.push(o,i)}return n}function ex(e,t,n,r){var o=rx(t),i=ox.get(t).spec.config,a=(r?e.undone:e.done).popEvent(t,o);if(a){var s=a.selection.resolve(a.transform.doc),u=(r?e.done:e.undone).addTransform(a.transform,t.selection.getBookmark(),i,o),c=new XM(r?u:a.remaining,r?a.remaining:u,null,0);n(a.transform.setSelection(s).setMeta(ox,{redo:r,historyState:c}).scrollIntoView())}}var tx=!1,nx=null;function rx(e){var t=e.plugins;if(nx!=t){tx=!1,nx=t;for(var n=0;n<t.length;n++)if(t[n].spec.historyPreserveItems){tx=!0;break}}return tx}var ox=new lT("history"),ix=new lT("closeHistory");function ax(e){return e={depth:e&&e.depth||100,newGroupDelay:e&&e.newGroupDelay||500},new sT({key:ox,state:{init:function(){return new XM(KM.empty,KM.empty,null,0)},apply:function(t,n,r){return function(e,t,n,r){var o,i=n.getMeta(ox);if(i)return i.historyState;n.getMeta(ix)&&(e=new XM(e.done,e.undone,null,0));var a=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(a&&a.getMeta(ox))return a.getMeta(ox).redo?new XM(e.done.addTransform(n,null,r,rx(t)),e.undone,QM(n.mapping.maps[n.steps.length-1]),e.prevTime):new XM(e.done,e.undone.addTransform(n,null,r,rx(t)),null,e.prevTime);if(!1===n.getMeta("addToHistory")||a&&!1===a.getMeta("addToHistory"))return(o=n.getMeta("rebased"))?new XM(e.done.rebased(n,o),e.undone.rebased(n,o),ZM(e.prevRanges,n.mapping),e.prevTime):new XM(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),ZM(e.prevRanges,n.mapping),e.prevTime);var s=0==e.prevTime||!a&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;var n=!1;return e.mapping.maps[0].forEach((function(e,r){for(var o=0;o<t.length;o+=2)e<=t[o+1]&&r>=t[o]&&(n=!0)})),n}(n,e.prevRanges)),u=a?ZM(e.prevRanges,n.mapping):QM(n.mapping.maps[n.steps.length-1]);return new XM(e.done.addTransform(n,s?t.selection.getBookmark():null,r,rx(t)),KM.empty,u,n.time)}(n,r,t,e)}},config:e})}var sx=dk.create({name:"history",defaultOptions:{depth:100,newGroupDelay:500},addCommands:()=>({undo:()=>({state:e,dispatch:t})=>function(e,t){var n=ox.getState(e);return!(!n||0==n.done.eventCount)&&(t&&ex(n,e,t,!1),!0)}(e,t),redo:()=>({state:e,dispatch:t})=>function(e,t){var n=ox.getState(e);return!(!n||0==n.undone.eventCount)&&(t&&ex(n,e,t,!0),!0)}(e,t)}),addProseMirrorPlugins(){return[ax(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Mod-y":()=>this.editor.commands.redo(),"Shift-Mod-z":()=>this.editor.commands.redo()}}});const ux=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/gm,cx=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/gm,lx=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/gm,fx=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/gm;var hx=CA.create({name:"bold",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],renderHTML({HTMLAttributes:e}){return["strong",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setBold:()=>({commands:e})=>e.setMark("bold"),toggleBold:()=>({commands:e})=>e.toggleMark("bold"),unsetBold:()=>({commands:e})=>e.unsetMark("bold")}),addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold()}},addInputRules(){return[MA(ux,this.type),MA(lx,this.type)]},addPasteRules(){return[xA(cx,this.type),xA(fx,this.type)]}});const px=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/gm,dx=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/gm,mx=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/gm,vx=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/gm;var yx=CA.create({name:"italic",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=italic"}],renderHTML({HTMLAttributes:e}){return["em",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setItalic:()=>({commands:e})=>e.setMark("italic"),toggleItalic:()=>({commands:e})=>e.toggleMark("italic"),unsetItalic:()=>({commands:e})=>e.unsetMark("italic")}),addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[MA(px,this.type),MA(mx,this.type)]},addPasteRules(){return[xA(dx,this.type),xA(vx,this.type)]}});const gx=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/gm;var bx=CA.create({name:"code",defaultOptions:{HTMLAttributes:{}},excludes:"_",parseHTML:()=>[{tag:"code"}],renderHTML({HTMLAttributes:e}){return["code",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setCode:()=>({commands:e})=>e.setMark("code"),toggleCode:()=>({commands:e})=>e.toggleMark("code"),unsetCode:()=>({commands:e})=>e.unsetMark("code")}),addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[MA(gx,this.type)]},addPasteRules(){return[xA(gx,this.type)]}});const Ex=/^```(?<language>[a-z]*)? $/,wx=/^~~~(?<language>[a-z]*)? $/;var Sx=AA.create({name:"codeBlock",defaultOptions:{languageClassPrefix:"language-",HTMLAttributes:{}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:null,parseHTML:e=>{var t;const n=null===(t=e.firstElementChild)||void 0===t?void 0:t.getAttribute("class");if(!n)return null;const r=new RegExp(`^(${this.options.languageClassPrefix})`);return{language:n.replace(r,"")}},renderHTML:e=>e.language?{class:this.options.languageClassPrefix+e.language}:null}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML({HTMLAttributes:e}){return["pre",this.options.HTMLAttributes,["code",e,0]]},addCommands:()=>({setCodeBlock:e=>({commands:t})=>t.setNode("codeBlock",e),toggleCodeBlock:e=>({commands:t})=>t.toggleNode("codeBlock","paragraph",e)}),addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())}}},addInputRules(){return[mN(Ex,this.type,({groups:e})=>e),mN(wx,this.type,({groups:e})=>e)]}});var Tx=AA.create({name:"heading",defaultOptions:{levels:[1,2,3,4,5,6],HTMLAttributes:{}},content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:"h"+e,attrs:{level:e}}))},renderHTML({node:e,HTMLAttributes:t}){return["h"+(this.options.levels.includes(e.attrs.level)?e.attrs.level:this.options.levels[0]),ok(this.options.HTMLAttributes,t),0]},addCommands(){return{setHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.setNode("heading",e),toggleHeading:e=>({commands:t})=>!!this.options.levels.includes(e.level)&&t.toggleNode("heading","paragraph",e)}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,["Mod-Alt-"+t]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>mN(new RegExp(`^(#{1,${e}})\\s$`),this.type,{level:e}))}});var Ox=AA.create({name:"hardBreak",defaultOptions:{HTMLAttributes:{}},inline:!0,group:"inline",selectable:!1,parseHTML:()=>[{tag:"br"}],renderHTML({HTMLAttributes:e}){return["br",ok(this.options.HTMLAttributes,e)]},addCommands(){return{setHardBreak:()=>({commands:e})=>e.first([()=>e.exitCode(),()=>e.insertContent({type:this.name})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}});const Rx=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/gm,Nx=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/gm;var kx=CA.create({name:"strike",defaultOptions:{HTMLAttributes:{}},parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML({HTMLAttributes:e}){return["s",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setStrike:()=>({commands:e})=>e.setMark("strike"),toggleStrike:()=>({commands:e})=>e.toggleMark("strike"),unsetStrike:()=>({commands:e})=>e.unsetMark("strike")}),addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[MA(Rx,this.type)]},addPasteRules(){return[xA(Nx,this.type)]}});const Ax=/^\s*>\s$/gm;var Cx=AA.create({name:"blockquote",defaultOptions:{HTMLAttributes:{}},content:"block*",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML({HTMLAttributes:e}){return["blockquote",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({setBlockquote:()=>({commands:e})=>e.wrapIn("blockquote"),toggleBlockquote:()=>({commands:e})=>e.toggleWrap("blockquote"),unsetBlockquote:()=>({commands:e})=>e.lift("blockquote")}),addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[dN(Ax,this.type)]}});var Mx=AA.create({name:"horizontalRule",defaultOptions:{HTMLAttributes:{}},group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML({HTMLAttributes:e}){return["hr",ok(this.options.HTMLAttributes,e)]},addCommands(){return{setHorizontalRule:()=>({chain:e})=>e().insertContent({type:this.name}).command(({tr:e,dispatch:t})=>{var n;if(t){const{parent:t,pos:r}=e.selection.$from,o=r+1;if(!e.doc.nodeAt(o)){const r=null===(n=t.type.contentMatch.defaultType)||void 0===n?void 0:n.create();r&&(e.insert(o,r),e.setSelection(WS.create(e.doc,o)))}e.scrollIntoView()}return!0}).run()}},addInputRules(){return[(e=/^(?:---|—-|___\s|\*\*\*\s)$/,t=this.type,new hN(e,(e,r,o,i)=>{const a=n instanceof Function?n(r):n,{tr:s}=e;return r[0]&&s.replaceWith(o-1,i,t.create(a)),s}))];var e,t,n}});const xx=/^\s*([-+*])\s$/;var Ix=AA.create({name:"bulletList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",parseHTML:()=>[{tag:"ul"}],renderHTML({HTMLAttributes:e}){return["ul",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({toggleBulletList:()=>({commands:e})=>e.toggleList("bulletList","listItem")}),addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){return[dN(xx,this.type)]}});const _x=/^(\d+)\.\s$/;var Px=AA.create({name:"orderedList",defaultOptions:{HTMLAttributes:{}},group:"block list",content:"listItem+",addAttributes:()=>({start:{default:1,parseHTML:e=>({start:e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1})}}),parseHTML:()=>[{tag:"ol"}],renderHTML({HTMLAttributes:e}){const{start:t,...n}=e;return 1===t?["ol",ok(this.options.HTMLAttributes,n),0]:["ol",ok(this.options.HTMLAttributes,e),0]},addCommands:()=>({toggleOrderedList:()=>({commands:e})=>e.toggleList("orderedList","listItem")}),addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){return[dN(_x,this.type,e=>({order:+e[1]}),(e,t)=>t.childCount+t.attrs.order===+e[1])]}});var Lx=AA.create({name:"listItem",defaultOptions:{HTMLAttributes:{}},content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML({HTMLAttributes:e}){return["li",ok(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem("listItem"),Tab:()=>this.editor.commands.sinkListItem("listItem"),"Shift-Tab":()=>this.editor.commands.liftListItem("listItem")}}});var Fx=dk.create({name:"starterKit",addExtensions(){var e,t,n,r,o,i,a,s,u,c,l,f,h,p,d,m,v,y;const g=[];return!1!==this.options.blockquote&&g.push(Cx.configure(null===(e=this.options)||void 0===e?void 0:e.blockquote)),!1!==this.options.bold&&g.push(hx.configure(null===(t=this.options)||void 0===t?void 0:t.bold)),!1!==this.options.bulletList&&g.push(Ix.configure(null===(n=this.options)||void 0===n?void 0:n.bulletList)),!1!==this.options.code&&g.push(bx.configure(null===(r=this.options)||void 0===r?void 0:r.code)),!1!==this.options.codeBlock&&g.push(Sx.configure(null===(o=this.options)||void 0===o?void 0:o.codeBlock)),!1!==this.options.document&&g.push(VM.configure(null===(i=this.options)||void 0===i?void 0:i.document)),!1!==this.options.dropcursor&&g.push(_M.configure(null===(a=this.options)||void 0===a?void 0:a.dropcursor)),!1!==this.options.gapcursor&&g.push(BM.configure(null===(s=this.options)||void 0===s?void 0:s.gapcursor)),!1!==this.options.hardBreak&&g.push(Ox.configure(null===(u=this.options)||void 0===u?void 0:u.hardBreak)),!1!==this.options.heading&&g.push(Tx.configure(null===(c=this.options)||void 0===c?void 0:c.heading)),!1!==this.options.history&&g.push(sx.configure(null===(l=this.options)||void 0===l?void 0:l.history)),!1!==this.options.horizontalRule&&g.push(Mx.configure(null===(f=this.options)||void 0===f?void 0:f.horizontalRule)),!1!==this.options.italic&&g.push(yx.configure(null===(h=this.options)||void 0===h?void 0:h.italic)),!1!==this.options.listItem&&g.push(Lx.configure(null===(p=this.options)||void 0===p?void 0:p.listItem)),!1!==this.options.orderedList&&g.push(Px.configure(null===(d=this.options)||void 0===d?void 0:d.orderedList)),!1!==this.options.paragraph&&g.push(HM.configure(null===(m=this.options)||void 0===m?void 0:m.paragraph)),!1!==this.options.strike&&g.push(kx.configure(null===(v=this.options)||void 0===v?void 0:v.strike)),!1!==this.options.text&&g.push(GM.configure(null===(y=this.options)||void 0===y?void 0:y.text)),g}});var Dx,Ux,jx=dk.create({name:"textAlign",defaultOptions:{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>({textAlign:e.style.textAlign||this.options.defaultAlignment}),renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:"text-align: "+e.textAlign}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>!!this.options.alignments.includes(e)&&this.options.types.every(n=>t.updateAttributes(n,{textAlign:e})),unsetTextAlign:()=>({commands:e})=>this.options.types.every(t=>e.resetAttributes(t,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}});if("undefined"!=typeof WeakMap){var Bx=new WeakMap;Dx=function(e){return Bx.get(e)},Ux=function(e,t){return Bx.set(e,t),t}}else{var Vx=[],Hx=0;Dx=function(e){for(var t=0;t<Vx.length;t+=2)if(Vx[t]==e)return Vx[t+1]},Ux=function(e,t){return 10==Hx&&(Hx=0),Vx[Hx++]=e,Vx[Hx++]=t}}var Gx=function(e,t,n,r){this.left=e,this.top=t,this.right=n,this.bottom=r},zx=function(e,t,n,r){this.width=e,this.height=t,this.map=n,this.problems=r};function Wx(e){if(e.colwidth)return e.colwidth.slice();for(var t=[],n=0;n<e.colspan;n++)t.push(0);return t}function $x(e){var t=e.cached.tableNodeTypes;if(!t)for(var n in t=e.cached.tableNodeTypes={},e.nodes){var r=e.nodes[n],o=r.spec.tableRole;o&&(t[o]=r)}return t}zx.prototype.findCell=function(e){for(var t=0;t<this.map.length;t++){var n=this.map[t];if(n==e){for(var r=t%this.width,o=t/this.width|0,i=r+1,a=o+1,s=1;i<this.width&&this.map[t+s]==n;s++)i++;for(var u=1;a<this.height&&this.map[t+this.width*u]==n;u++)a++;return new Gx(r,o,i,a)}}throw new RangeError("No cell with offset "+e+" found")},zx.prototype.colCount=function(e){for(var t=0;t<this.map.length;t++)if(this.map[t]==e)return t%this.width;throw new RangeError("No cell with offset "+e+" found")},zx.prototype.nextCell=function(e,t,n){var r=this.findCell(e),o=r.left,i=r.right,a=r.top,s=r.bottom;return"horiz"==t?(n<0?0==o:i==this.width)?null:this.map[a*this.width+(n<0?o-1:i)]:(n<0?0==a:s==this.height)?null:this.map[o+this.width*(n<0?a-1:s)]},zx.prototype.rectBetween=function(e,t){var n=this.findCell(e),r=n.left,o=n.right,i=n.top,a=n.bottom,s=this.findCell(t),u=s.left,c=s.right,l=s.top,f=s.bottom;return new Gx(Math.min(r,u),Math.min(i,l),Math.max(o,c),Math.max(a,f))},zx.prototype.cellsInRect=function(e){for(var t=[],n={},r=e.top;r<e.bottom;r++)for(var o=e.left;o<e.right;o++){var i=r*this.width+o,a=this.map[i];n[a]||(n[a]=!0,o==e.left&&o&&this.map[i-1]==a||r==e.top&&r&&this.map[i-this.width]==a||t.push(a))}return t},zx.prototype.positionAt=function(e,t,n){for(var r=0,o=0;;r++){var i=o+n.child(r).nodeSize;if(r==e){for(var a=t+e*this.width,s=(e+1)*this.width;a<s&&this.map[a]<o;)a++;return a==s?i-1:this.map[a]}o=i}},zx.get=function(e){return Dx(e)||Ux(e,function(e){if("table"!=e.type.spec.tableRole)throw new RangeError("Not a table node: "+e.type.name);for(var t=function(e){for(var t=-1,n=!1,r=0;r<e.childCount;r++){var o=e.child(r),i=0;if(n)for(var a=0;a<r;a++)for(var s=e.child(a),u=0;u<s.childCount;u++){var c=s.child(u);a+c.attrs.rowspan>r&&(i+=c.attrs.colspan)}for(var l=0;l<o.childCount;l++){var f=o.child(l);i+=f.attrs.colspan,f.attrs.rowspan>1&&(n=!0)}-1==t?t=i:t!=i&&(t=Math.max(t,i))}return t}(e),n=e.childCount,r=[],o=0,i=null,a=[],s=0,u=t*n;s<u;s++)r[s]=0;for(var c=0,l=0;c<n;c++){var f=e.child(c);l++;for(var h=0;;h++){for(;o<r.length&&0!=r[o];)o++;if(h==f.childCount)break;for(var p=f.child(h),d=p.attrs,m=d.colspan,v=d.rowspan,y=d.colwidth,g=0;g<v;g++){if(g+c>=n){(i||(i=[])).push({type:"overlong_rowspan",pos:l,n:v-g});break}for(var b=o+g*t,E=0;E<m;E++){0==r[b+E]?r[b+E]=l:(i||(i=[])).push({type:"collision",row:c,pos:l,n:m-E});var w=y&&y[E];if(w){var S=(b+E)%t*2,T=a[S];null==T||T!=w&&1==a[S+1]?(a[S]=w,a[S+1]=1):T==w&&a[S+1]++}}}o+=m,l+=p.nodeSize}for(var O=(c+1)*t,R=0;o<O;)0==r[o++]&&R++;R&&(i||(i=[])).push({type:"missing",row:c,n:R}),l++}for(var N=new zx(t,n,r,i),k=!1,A=0;!k&&A<a.length;A+=2)null!=a[A]&&a[A+1]<n&&(k=!0);k&&function(e,t,n){e.problems||(e.problems=[]);for(var r=0,o={};r<e.map.length;r++){var i=e.map[r];if(!o[i]){o[i]=!0;for(var a=n.nodeAt(i),s=null,u=0;u<a.attrs.colspan;u++){var c=(r+u)%e.width,l=t[2*c];null==l||a.attrs.colwidth&&a.attrs.colwidth[u]==l||((s||(s=Wx(a.attrs)))[u]=l)}s&&e.problems.unshift({type:"colwidth mismatch",pos:i,colwidth:s})}}}(N,a,e);return N}(e))};var Yx=new lT("selectingCells");function Kx(e){for(var t=e.depth-1;t>0;t--)if("row"==e.node(t).type.spec.tableRole)return e.node(0).resolve(e.before(t+1));return null}function qx(e){for(var t=e.selection.$head,n=t.depth;n>0;n--)if("row"==t.node(n).type.spec.tableRole)return!0;return!1}function Xx(e){var t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&"cell"==t.node.type.spec.tableRole?t.$anchor:Kx(t.$head)||function(e){for(var t=e.nodeAfter,n=e.pos;t;t=t.firstChild,n++){var r=t.type.spec.tableRole;if("cell"==r||"header_cell"==r)return e.doc.resolve(n)}for(var o=e.nodeBefore,i=e.pos;o;o=o.lastChild,i--){var a=o.type.spec.tableRole;if("cell"==a||"header_cell"==a)return e.doc.resolve(i-o.nodeSize)}}(t.$head)}function Jx(e){return"row"==e.parent.type.spec.tableRole&&e.nodeAfter}function Qx(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function Zx(e,t,n){var r=e.start(-1),o=zx.get(e.node(-1)).nextCell(e.pos-r,t,n);return null==o?null:e.node(0).resolve(r+o)}function eI(e,t,n){var r={};for(var o in e)r[o]=e[o];return r[t]=n,r}function tI(e,t,n){void 0===n&&(n=1);var r=eI(e,"colspan",e.colspan-n);return r.colwidth&&(r.colwidth=r.colwidth.slice(),r.colwidth.splice(t,n),r.colwidth.some((function(e){return e>0}))||(r.colwidth=null)),r}function nI(e,t,n){void 0===n&&(n=1);var r=eI(e,"colspan",e.colspan+n);if(r.colwidth){r.colwidth=r.colwidth.slice();for(var o=0;o<n;o++)r.colwidth.splice(t,0,0)}return r}var rI=function(e){function t(t,n){void 0===n&&(n=t);var r=t.node(-1),o=zx.get(r),i=t.start(-1),a=o.rectBetween(t.pos-i,n.pos-i),s=t.node(0),u=o.cellsInRect(a).filter((function(e){return e!=n.pos-i}));u.unshift(n.pos-i);var c=u.map((function(e){var t=r.nodeAt(e),n=e+i+1;return new zS(s.resolve(n),s.resolve(n+t.content.size))}));e.call(this,c[0].$from,c[0].$to,c),this.$anchorCell=t,this.$headCell=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(e,n){var r=e.resolve(n.map(this.$anchorCell.pos)),o=e.resolve(n.map(this.$headCell.pos));if(Jx(r)&&Jx(o)&&Qx(r,o)){var i=this.$anchorCell.node(-1)!=r.node(-1);return i&&this.isRowSelection()?t.rowSelection(r,o):i&&this.isColSelection()?t.colSelection(r,o):new t(r,o)}return WS.between(r,o)},t.prototype.content=function(){for(var e=this.$anchorCell.node(-1),t=zx.get(e),n=this.$anchorCell.start(-1),r=t.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n),o={},i=[],a=r.top;a<r.bottom;a++){for(var s=[],u=a*t.width+r.left,c=r.left;c<r.right;c++,u++){var l=t.map[u];if(!o[l]){o[l]=!0;var f=t.findCell(l),h=e.nodeAt(l),p=r.left-f.left,d=f.right-r.right;if(p>0||d>0){var m=h.attrs;p>0&&(m=tI(m,0,p)),d>0&&(m=tI(m,m.colspan-d,d)),h=f.left<r.left?h.type.createAndFill(m):h.type.create(m,h.content)}if(f.top<r.top||f.bottom>r.bottom){var v=eI(h.attrs,"rowspan",Math.min(f.bottom,r.bottom)-Math.max(f.top,r.top));h=f.top<r.top?h.type.createAndFill(v):h.type.create(v,h.content)}s.push(h)}}i.push(e.child(a).copy(qE.from(s)))}var y=this.isColSelection()&&this.isRowSelection()?e:i;return new nw(qE.from(y),1,1)},t.prototype.replace=function(t,n){void 0===n&&(n=nw.empty);for(var r=t.steps.length,o=this.ranges,i=0;i<o.length;i++){var a=o[i],s=a.$from,u=a.$to,c=t.mapping.slice(r);t.replace(c.map(s.pos),c.map(u.pos),i?nw.empty:n)}var l=e.findFrom(t.doc.resolve(t.mapping.slice(r).map(this.to)),-1);l&&t.setSelection(l)},t.prototype.replaceWith=function(e,t){this.replace(e,new nw(qE.from(t),0,0))},t.prototype.forEachCell=function(e){for(var t=this.$anchorCell.node(-1),n=zx.get(t),r=this.$anchorCell.start(-1),o=n.cellsInRect(n.rectBetween(this.$anchorCell.pos-r,this.$headCell.pos-r)),i=0;i<o.length;i++)e(t.nodeAt(o[i]),r+o[i])},t.prototype.isColSelection=function(){var e=this.$anchorCell.index(-1),t=this.$headCell.index(-1);if(Math.min(e,t)>0)return!1;var n=e+this.$anchorCell.nodeAfter.attrs.rowspan,r=t+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(n,r)==this.$headCell.node(-1).childCount},t.colSelection=function(e,n){void 0===n&&(n=e);var r=zx.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),a=r.findCell(n.pos-o),s=e.node(0);return i.top<=a.top?(i.top>0&&(e=s.resolve(o+r.map[i.left])),a.bottom<r.height&&(n=s.resolve(o+r.map[r.width*(r.height-1)+a.right-1]))):(a.top>0&&(n=s.resolve(o+r.map[a.left])),i.bottom<r.height&&(e=s.resolve(o+r.map[r.width*(r.height-1)+i.right-1]))),new t(e,n)},t.prototype.isRowSelection=function(){var e=zx.get(this.$anchorCell.node(-1)),t=this.$anchorCell.start(-1),n=e.colCount(this.$anchorCell.pos-t),r=e.colCount(this.$headCell.pos-t);if(Math.min(n,r)>0)return!1;var o=n+this.$anchorCell.nodeAfter.attrs.colspan,i=r+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,i)==e.width},t.prototype.eq=function(e){return e instanceof t&&e.$anchorCell.pos==this.$anchorCell.pos&&e.$headCell.pos==this.$headCell.pos},t.rowSelection=function(e,n){void 0===n&&(n=e);var r=zx.get(e.node(-1)),o=e.start(-1),i=r.findCell(e.pos-o),a=r.findCell(n.pos-o),s=e.node(0);return i.left<=a.left?(i.left>0&&(e=s.resolve(o+r.map[i.top*r.width])),a.right<r.width&&(n=s.resolve(o+r.map[r.width*(a.top+1)-1]))):(a.left>0&&(n=s.resolve(o+r.map[a.top*r.width])),i.right<r.width&&(e=s.resolve(o+r.map[r.width*(i.top+1)-1]))),new t(e,n)},t.prototype.toJSON=function(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}},t.fromJSON=function(e,n){return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,n,r){return void 0===r&&(r=n),new t(e.resolve(n),e.resolve(r))},t.prototype.getBookmark=function(){return new oI(this.$anchorCell.pos,this.$headCell.pos)},t}(HS);rI.prototype.visible=!1,HS.jsonID("cell",rI);var oI=function(e,t){this.anchor=e,this.head=t};function iI(e){if(!(e.selection instanceof rI))return null;var t=[];return e.selection.forEachCell((function(e,n){t.push(xR.node(n,n+e.nodeSize,{class:"selectedCell"}))})),LR.create(e.doc,t)}function aI(e){if(!e.size)return null;for(var t=e.content,n=e.openStart,r=e.openEnd;1==t.childCount&&(n>0&&r>0||"table"==t.firstChild.type.spec.tableRole);)n--,r--,t=t.firstChild.content;var o=t.firstChild,i=o.type.spec.tableRole,a=o.type.schema,s=[];if("row"==i)for(var u=0;u<t.childCount;u++){var c=t.child(u).content,l=u?0:Math.max(0,n-1),f=u<t.childCount-1?0:Math.max(0,r-1);(l||f)&&(c=sI($x(a).row,new nw(c,l,f)).content),s.push(c)}else{if("cell"!=i&&"header_cell"!=i)return null;s.push(n||r?sI($x(a).row,new nw(t,n,r)).content:t)}return function(e,t){for(var n=[],r=0;r<t.length;r++)for(var o=t[r],i=o.childCount-1;i>=0;i--)for(var a=o.child(i).attrs,s=a.rowspan,u=a.colspan,c=r;c<r+s;c++)n[c]=(n[c]||0)+u;for(var l=0,f=0;f<n.length;f++)l=Math.max(l,n[f]);for(var h=0;h<n.length;h++)if(h>=t.length&&t.push(qE.empty),n[h]<l){for(var p=$x(e).cell.createAndFill(),d=[],m=n[h];m<l;m++)d.push(p);t[h]=t[h].append(qE.from(d))}return{height:t.length,width:l,rows:t}}(a,s)}function sI(e,t){var n=e.createAndFill();return new fS(n).replace(0,n.content.size,t).doc}function uI(e,t,n,r,o,i,a,s){if(0==a||a==t.height)return!1;for(var u=!1,c=o;c<i;c++){var l=a*t.width+c,f=t.map[l];if(t.map[l-t.width]==f){u=!0;var h=n.nodeAt(f),p=t.findCell(f),d=p.top,m=p.left;e.setNodeMarkup(e.mapping.slice(s).map(f+r),null,eI(h.attrs,"rowspan",a-d)),e.insert(e.mapping.slice(s).map(t.positionAt(a,m,n)),h.type.createAndFill(eI(h.attrs,"rowspan",d+h.attrs.rowspan-a))),c+=h.attrs.colspan-1}}return u}function cI(e,t,n,r,o,i,a,s){if(0==a||a==t.width)return!1;for(var u=!1,c=o;c<i;c++){var l=c*t.width+a,f=t.map[l];if(t.map[l-1]==f){u=!0;var h=n.nodeAt(f),p=t.colCount(f),d=e.mapping.slice(s).map(f+r);e.setNodeMarkup(d,null,tI(h.attrs,a-p,h.attrs.colspan-(a-p))),e.insert(d+h.nodeSize,h.type.createAndFill(tI(h.attrs,0,a-p))),c+=h.attrs.rowspan-1}}return u}function lI(e,t,n,r,o){var i=n?e.doc.nodeAt(n-1):e.doc,a=zx.get(i),s=r.top,u=r.left,c=u+o.width,l=s+o.height,f=e.tr,h=0;function p(){i=n?f.doc.nodeAt(n-1):f.doc,a=zx.get(i),h=f.mapping.maps.length}(function(e,t,n,r,o,i,a){var s,u,c=$x(e.doc.type.schema);if(o>t.width)for(var l=0,f=0;l<t.height;l++){var h=n.child(l);f+=h.nodeSize;var p=[],d=void 0;d=null==h.lastChild||h.lastChild.type==c.cell?s||(s=c.cell.createAndFill()):u||(u=c.header_cell.createAndFill());for(var m=t.width;m<o;m++)p.push(d);e.insert(e.mapping.slice(a).map(f-1+r),p)}if(i>t.height){for(var v=[],y=0,g=(t.height-1)*t.width;y<Math.max(t.width,o);y++){var b=!(y>=t.width)&&n.nodeAt(t.map[g+y]).type==c.header_cell;v.push(b?u||(u=c.header_cell.createAndFill()):s||(s=c.cell.createAndFill()))}for(var E=c.row.create(null,qE.from(v)),w=[],S=t.height;S<i;S++)w.push(E);e.insert(e.mapping.slice(a).map(r+n.nodeSize-2),w)}return!(!s&&!u)})(f,a,i,n,c,l,h)&&p(),uI(f,a,i,n,u,c,s,h)&&p(),uI(f,a,i,n,u,c,l,h)&&p(),cI(f,a,i,n,s,l,u,h)&&p(),cI(f,a,i,n,s,l,c,h)&&p();for(var d=s;d<l;d++){var m=a.positionAt(d,u,i),v=a.positionAt(d,c,i);f.replace(f.mapping.slice(h).map(m+n),f.mapping.slice(h).map(v+n),new nw(o.rows[d-s],0,0))}p(),f.setSelection(new rI(f.doc.resolve(n+a.positionAt(s,u,i)),f.doc.resolve(n+a.positionAt(l-1,c-1,i)))),t(f)}oI.prototype.map=function(e){return new oI(e.map(this.anchor),e.map(this.head))},oI.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=e.resolve(this.head);return"row"==t.parent.type.spec.tableRole&&"row"==n.parent.type.spec.tableRole&&t.index()<t.parent.childCount&&n.index()<n.parent.childCount&&Qx(t,n)?new rI(t,n):HS.near(n,1)};var fI=fN({ArrowLeft:pI("horiz",-1),ArrowRight:pI("horiz",1),ArrowUp:pI("vert",-1),ArrowDown:pI("vert",1),"Shift-ArrowLeft":dI("horiz",-1),"Shift-ArrowRight":dI("horiz",1),"Shift-ArrowUp":dI("vert",-1),"Shift-ArrowDown":dI("vert",1),Backspace:mI,"Mod-Backspace":mI,Delete:mI,"Mod-Delete":mI});function hI(e,t,n){return!n.eq(e.selection)&&(t&&t(e.tr.setSelection(n).scrollIntoView()),!0)}function pI(e,t){return function(n,r,o){var i=n.selection;if(i instanceof rI)return hI(n,r,HS.near(i.$headCell,t));if("horiz"!=e&&!i.empty)return!1;var a=bI(o,e,t);if(null==a)return!1;if("horiz"==e)return hI(n,r,HS.near(n.doc.resolve(i.head+t),t));var s,u=n.doc.resolve(a),c=Zx(u,e,t);return s=c?HS.near(c,1):t<0?HS.near(n.doc.resolve(u.before(-1)),-1):HS.near(n.doc.resolve(u.after(-1)),1),hI(n,r,s)}}function dI(e,t){return function(n,r,o){var i=n.selection;if(!(i instanceof rI)){var a=bI(o,e,t);if(null==a)return!1;i=new rI(n.doc.resolve(a))}var s=Zx(i.$headCell,e,t);return!!s&&hI(n,r,new rI(i.$anchorCell,s))}}function mI(e,t){var n=e.selection;if(!(n instanceof rI))return!1;if(t){var r=e.tr,o=$x(e.schema).cell.createAndFill().content;n.forEachCell((function(e,t){e.content.eq(o)||r.replace(r.mapping.map(t+1),r.mapping.map(t+e.nodeSize-1),new nw(o,0,0))})),r.docChanged&&t(r)}return!0}function vI(e,t){var n=Kx(e.state.doc.resolve(t));return!!n&&(e.dispatch(e.state.tr.setSelection(new rI(n))),!0)}function yI(e,t,n){if(!qx(e.state))return!1;var r=aI(n),o=e.state.selection;if(o instanceof rI){r||(r={width:1,height:1,rows:[qE.from(sI($x(e.state.schema).cell,n))]});var i=o.$anchorCell.node(-1),a=o.$anchorCell.start(-1),s=zx.get(i).rectBetween(o.$anchorCell.pos-a,o.$headCell.pos-a);return r=function(e,t,n){var r=e.width,o=e.height,i=e.rows;if(r!=t){for(var a=[],s=[],u=0;u<i.length;u++){for(var c=i[u],l=[],f=a[u]||0,h=0;f<t;h++){var p=c.child(h%c.childCount);f+p.attrs.colspan>t&&(p=p.type.create(tI(p.attrs,p.attrs.colspan,f+p.attrs.colspan-t),p.content)),l.push(p),f+=p.attrs.colspan;for(var d=1;d<p.attrs.rowspan;d++)a[u+d]=(a[u+d]||0)+p.attrs.colspan}s.push(qE.from(l))}i=s,r=t}if(o!=n){for(var m=[],v=0,y=0;v<n;v++,y++){for(var g=[],b=i[y%o],E=0;E<b.childCount;E++){var w=b.child(E);v+w.attrs.rowspan>n&&(w=w.type.create(eI(w.attrs,"rowspan",Math.max(1,n-w.attrs.rowspan)),w.content)),g.push(w)}m.push(qE.from(g))}i=m,o=n}return{width:r,height:o,rows:i}}(r,s.right-s.left,s.bottom-s.top),lI(e.state,e.dispatch,a,s,r),!0}if(r){var u=Xx(e.state),c=u.start(-1);return lI(e.state,e.dispatch,c,zx.get(u.node(-1)).findCell(u.pos-c),r),!0}return!1}function gI(e,t){if(!t.ctrlKey&&!t.metaKey){var n,r=EI(e,t.target);if(t.shiftKey&&e.state.selection instanceof rI)o(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&null!=(n=Kx(e.state.selection.$anchor))&&wI(e,t).pos!=n.pos)o(n,t),t.preventDefault();else if(!r)return;e.root.addEventListener("mouseup",i),e.root.addEventListener("dragstart",i),e.root.addEventListener("mousemove",a)}function o(t,n){var r=wI(e,n),o=null==Yx.getState(e.state);if(!r||!Qx(t,r)){if(!o)return;r=t}var i=new rI(t,r);if(o||!e.state.selection.eq(i)){var a=e.state.tr.setSelection(i);o&&a.setMeta(Yx,t.pos),e.dispatch(a)}}function i(){e.root.removeEventListener("mouseup",i),e.root.removeEventListener("dragstart",i),e.root.removeEventListener("mousemove",a),null!=Yx.getState(e.state)&&e.dispatch(e.state.tr.setMeta(Yx,-1))}function a(n){var a,s=Yx.getState(e.state);if(null!=s)a=e.state.doc.resolve(s);else if(EI(e,n.target)!=r&&!(a=wI(e,t)))return i();a&&o(a,n)}}function bI(e,t,n){if(!(e.state.selection instanceof WS))return null;for(var r=e.state.selection.$head,o=r.depth-1;o>=0;o--){var i=r.node(o);if((n<0?r.index(o):r.indexAfter(o))!=(n<0?0:i.childCount))return null;if("cell"==i.type.spec.tableRole||"header_cell"==i.type.spec.tableRole){var a=r.before(o),s="vert"==t?n>0?"down":"up":n>0?"right":"left";return e.endOfTextblock(s)?a:null}}return null}function EI(e,t){for(;t&&t!=e.dom;t=t.parentNode)if("TD"==t.nodeName||"TH"==t.nodeName)return t}function wI(e,t){var n=e.posAtCoords({left:t.clientX,top:t.clientY});return n&&n?Kx(e.state.doc.resolve(n.pos)):null}var SI=new lT("fix-tables");function TI(e,t){var n,r=function(t,r){"table"==t.type.spec.tableRole&&(n=function(e,t,n,r){var o=zx.get(t);if(!o.problems)return r;r||(r=e.tr);for(var i,a,s=[],u=0;u<o.height;u++)s.push(0);for(var c=0;c<o.problems.length;c++){var l=o.problems[c];if("collision"==l.type){for(var f=t.nodeAt(l.pos),h=0;h<f.attrs.rowspan;h++)s[l.row+h]+=l.n;r.setNodeMarkup(r.mapping.map(n+1+l.pos),null,tI(f.attrs,f.attrs.colspan-l.n,l.n))}else if("missing"==l.type)s[l.row]+=l.n;else if("overlong_rowspan"==l.type){var p=t.nodeAt(l.pos);r.setNodeMarkup(r.mapping.map(n+1+l.pos),null,eI(p.attrs,"rowspan",p.attrs.rowspan-l.n))}else if("colwidth mismatch"==l.type){var d=t.nodeAt(l.pos);r.setNodeMarkup(r.mapping.map(n+1+l.pos),null,eI(d.attrs,"colwidth",l.colwidth))}}for(var m=0;m<s.length;m++)s[m]&&(null==i&&(i=m),a=m);for(var v=0,y=n+1;v<o.height;v++){var g=t.child(v),b=y+g.nodeSize,E=s[v];if(E>0){var w="cell";g.firstChild&&(w=g.firstChild.type.spec.tableRole);for(var S=[],T=0;T<E;T++)S.push($x(e.schema)[w].createAndFill());var O=0!=v&&i!=v-1||a!=v?b-1:y+1;r.insert(r.mapping.map(O),S)}y=b}return r.setMeta(SI,{fixTables:!0})}(e,t,r,n))};return t?t.doc!=e.doc&&function e(t,n,r,o){var i=t.childCount,a=n.childCount;e:for(var s=0,u=0;s<a;s++){for(var c=n.child(s),l=u,f=Math.min(i,s+3);l<f;l++)if(t.child(l)==c){u=l+1,r+=c.nodeSize;continue e}o(c,r),u<i&&t.child(u).sameMarkup(c)?e(t.child(u),c,r+1,o):c.nodesBetween(0,c.content.size,o,r+1),r+=c.nodeSize}}(t.doc,e.doc,0,r):e.doc.descendants(r),n}function OI(e){var t,n=e.selection,r=Xx(e),o=r.node(-1),i=r.start(-1),a=zx.get(o);return(t=n instanceof rI?a.rectBetween(n.$anchorCell.pos-i,n.$headCell.pos-i):a.findCell(r.pos-i)).tableStart=i,t.map=a,t.table=o,t}function RI(e,t,n){var r=t.map,o=t.tableStart,i=t.table,a=n>0?-1:0;(function(e,t,n){for(var r=$x(t.type.schema).header_cell,o=0;o<e.height;o++)if(t.nodeAt(e.map[n+o*e.width]).type!=r)return!1;return!0})(r,i,n+a)&&(a=0==n||n==r.width?null:0);for(var s=0;s<r.height;s++){var u=s*r.width+n;if(n>0&&n<r.width&&r.map[u-1]==r.map[u]){var c=r.map[u],l=i.nodeAt(c);e.setNodeMarkup(e.mapping.map(o+c),null,nI(l.attrs,n-r.colCount(c))),s+=l.attrs.rowspan-1}else{var f=null==a?$x(i.type.schema).cell:i.nodeAt(r.map[u+a]).type,h=r.positionAt(s,n,i);e.insert(e.mapping.map(o+h),f.createAndFill())}}return e}function NI(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,a=e.mapping.maps.length,s=0;s<r.height;){var u=s*r.width+n,c=r.map[u],l=o.nodeAt(c);if(n>0&&r.map[u-1]==c||n<r.width-1&&r.map[u+1]==c)e.setNodeMarkup(e.mapping.slice(a).map(i+c),null,tI(l.attrs,n-r.colCount(c)));else{var f=e.mapping.slice(a).map(i+c);e.delete(f,f+l.nodeSize)}s+=l.attrs.rowspan}}function kI(e,t,n){for(var r=t.map,o=t.tableStart,i=t.table,a=o,s=0;s<n;s++)a+=i.child(s).nodeSize;var u=[],c=n>0?-1:0;(function(e,t,n){for(var r=$x(t.type.schema).header_cell,o=0;o<e.width;o++)if(t.nodeAt(e.map[o+n*e.width]).type!=r)return!1;return!0})(r,i,n+c)&&(c=0==n||n==r.height?null:0);for(var l=0,f=r.width*n;l<r.width;l++,f++)if(n>0&&n<r.height&&r.map[f]==r.map[f-r.width]){var h=r.map[f],p=i.nodeAt(h).attrs;e.setNodeMarkup(o+h,null,eI(p,"rowspan",p.rowspan+1)),l+=p.colspan-1}else{var d=null==c?$x(i.type.schema).cell:i.nodeAt(r.map[f+c*r.width]).type;u.push(d.createAndFill())}return e.insert(a,$x(i.type.schema).row.create(null,u)),e}function AI(e,t,n){for(var r=t.map,o=t.table,i=t.tableStart,a=0,s=0;s<n;s++)a+=o.child(s).nodeSize;var u=a+o.child(n).nodeSize,c=e.mapping.maps.length;e.delete(a+i,u+i);for(var l=0,f=n*r.width;l<r.width;l++,f++){var h=r.map[f];if(n>0&&h==r.map[f-r.width]){var p=o.nodeAt(h).attrs;e.setNodeMarkup(e.mapping.slice(c).map(h+i),null,eI(p,"rowspan",p.rowspan-1)),l+=p.colspan-1}else if(n<r.width&&h==r.map[f+r.width]){var d=o.nodeAt(h),m=d.type.create(eI(d.attrs,"rowspan",d.attrs.rowspan-1),d.content),v=r.positionAt(n+1,l,o);e.insert(e.mapping.slice(c).map(i+v),m),l+=d.attrs.colspan-1}}}function CI(e){var t=e.content;return 1==t.childCount&&t.firstChild.isTextblock&&0==t.firstChild.childCount}function MI(e,t){var n=e.selection;if(!(n instanceof rI)||n.$anchorCell.pos==n.$headCell.pos)return!1;var r=OI(e),o=r.map;if(function(e,t){for(var n=e.width,r=e.height,o=e.map,i=t.top*n+t.left,a=i,s=(t.bottom-1)*n+t.left,u=i+(t.right-t.left-1),c=t.top;c<t.bottom;c++){if(t.left>0&&o[a]==o[a-1]||t.right<n&&o[u]==o[u+1])return!0;a+=n,u+=n}for(var l=t.left;l<t.right;l++){if(t.top>0&&o[i]==o[i-n]||t.bottom<r&&o[s]==o[s+n])return!0;i++,s++}return!1}(o,r))return!1;if(t){for(var i,a,s=e.tr,u={},c=qE.empty,l=r.top;l<r.bottom;l++)for(var f=r.left;f<r.right;f++){var h=o.map[l*o.width+f],p=r.table.nodeAt(h);if(!u[h])if(u[h]=!0,null==i)i=h,a=p;else{CI(p)||(c=c.append(p.content));var d=s.mapping.map(h+r.tableStart);s.delete(d,d+p.nodeSize)}}if(s.setNodeMarkup(i+r.tableStart,null,eI(nI(a.attrs,a.attrs.colspan,r.right-r.left-a.attrs.colspan),"rowspan",r.bottom-r.top)),c.size){var m=i+1+a.content.size,v=CI(a)?i+1:m;s.replaceWith(v+r.tableStart,m+r.tableStart,c)}s.setSelection(new rI(s.doc.resolve(i+r.tableStart))),t(s)}return!0}function xI(e,t){var n,r=$x(e.schema);return(n=function(e){var t=e.node;return r[t.type.spec.tableRole]},function(e,t){var r,o,i=e.selection;if(i instanceof rI){if(i.$anchorCell.pos!=i.$headCell.pos)return!1;r=i.$anchorCell.nodeAfter,o=i.$anchorCell.pos}else{if(!(r=function(e){for(var t=e.depth;t>0;t--){var n=e.node(t).type.spec.tableRole;if("cell"===n||"header_cell"===n)return e.node(t)}return null}(i.$from)))return!1;o=Kx(i.$from).pos}if(1==r.attrs.colspan&&1==r.attrs.rowspan)return!1;if(t){var a=r.attrs,s=[],u=a.colwidth;a.rowspan>1&&(a=eI(a,"rowspan",1)),a.colspan>1&&(a=eI(a,"colspan",1));for(var c,l=OI(e),f=e.tr,h=0;h<l.right-l.left;h++)s.push(u?eI(a,"colwidth",u&&u[h]?[u[h]]:null):a);for(var p=l.top;p<l.bottom;p++){var d=l.map.positionAt(p,l.left,l.table);p==l.top&&(d+=r.nodeSize);for(var m=l.left,v=0;m<l.right;m++,v++)m==l.left&&p==l.top||f.insert(c=f.mapping.map(d+l.tableStart,1),n({node:r,row:p,col:m}).createAndFill(s[v]))}f.setNodeMarkup(o,n({node:r,row:l.top,col:l.left}),s[0]),i instanceof rI&&f.setSelection(new rI(f.doc.resolve(i.$anchorCell.pos),c&&f.doc.resolve(c))),t(f)}return!0})(e,t)}function II(e,t,n){for(var r=t.map.cellsInRect({left:0,top:0,right:"row"==e?t.map.width:1,bottom:"column"==e?t.map.height:1}),o=0;o<r.length;o++){var i=t.table.nodeAt(r[o]);if(i&&i.type!==n.header_cell)return!1}return!0}function _I(e,t){return(t=t||{useDeprecatedLogic:!1}).useDeprecatedLogic?function(e){return function(t,n){if(!qx(t))return!1;if(n){for(var r=$x(t.schema),o=OI(t),i=t.tr,a=o.map.cellsInRect("column"==e?new Gx(o.left,0,o.right,o.map.height):"row"==e?new Gx(0,o.top,o.map.width,o.bottom):o),s=a.map((function(e){return o.table.nodeAt(e)})),u=0;u<a.length;u++)s[u].type==r.header_cell&&i.setNodeMarkup(o.tableStart+a[u],r.cell,s[u].attrs);if(0==i.steps.length)for(var c=0;c<a.length;c++)i.setNodeMarkup(o.tableStart+a[c],r.header_cell,s[c].attrs);n(i)}return!0}}(e):function(t,n){if(!qx(t))return!1;if(n){var r=$x(t.schema),o=OI(t),i=t.tr,a=II("row",o,r),s=II("column",o,r),u=("column"===e?a:"row"===e&&s)?1:0,c="column"==e?new Gx(0,u,1,o.map.height):"row"==e?new Gx(u,0,o.map.width,1):o,l="column"==e?s?r.cell:r.header_cell:"row"==e?a?r.cell:r.header_cell:r.cell;o.map.cellsInRect(c).forEach((function(e){var t=e+o.tableStart,n=i.doc.nodeAt(t);n&&i.setNodeMarkup(t,l,n.attrs)})),n(i)}return!0}}var PI=_I("row",{useDeprecatedLogic:!0}),LI=_I("column",{useDeprecatedLogic:!0}),FI=_I("cell",{useDeprecatedLogic:!0});function DI(e){return function(t,n){if(!qx(t))return!1;var r=function(e,t){if(t<0){var n=e.nodeBefore;if(n)return e.pos-n.nodeSize;for(var r=e.index(-1)-1,o=e.before();r>=0;r--){var i=e.node(-1).child(r);if(i.childCount)return o-1-i.lastChild.nodeSize;o-=i.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;for(var a=e.node(-1),s=e.indexAfter(-1),u=e.after();s<a.childCount;s++){var c=a.child(s);if(c.childCount)return u+1;u+=c.nodeSize}}}(Xx(t),e);if(null!=r){if(n){var o=t.doc.resolve(r);n(t.tr.setSelection(WS.between(o,(i=o,i.node(0).resolve(i.pos+i.nodeAfter.nodeSize)))).scrollIntoView())}var i;return!0}}}var UI=function(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),jI(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))};function jI(e,t,n,r,o,i){for(var a=0,s=!0,u=t.firstChild,c=e.firstChild,l=0,f=0;l<c.childCount;l++)for(var h=c.child(l).attrs,p=h.colspan,d=h.colwidth,m=0;m<p;m++,f++){var v=o==f?i:d&&d[m],y=v?v+"px":"";a+=v||r,v||(s=!1),u?(u.style.width!=y&&(u.style.width=y),u=u.nextSibling):t.appendChild(document.createElement("col")).style.width=y}for(;u;){var g=u.nextSibling;u.parentNode.removeChild(u),u=g}s?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}UI.prototype.update=function(e){return e.type==this.node.type&&(this.node=e,jI(e,this.colgroup,this.table,this.cellMinWidth),!0)},UI.prototype.ignoreMutation=function(e){return"attributes"==e.type&&(e.target==this.table||this.colgroup.contains(e.target))};var BI=new lT("tableColumnResizing");function VI(e){void 0===e&&(e={});var t=e.handleWidth;void 0===t&&(t=5);var n=e.cellMinWidth;void 0===n&&(n=25);var r=e.View;void 0===r&&(r=UI);var o=e.lastColumnResizable;return void 0===o&&(o=!0),new sT({key:BI,state:{init:function(e,t){return this.spec.props.nodeViews[$x(t.schema).table.name]=function(e,t){return new r(e,n,t)},new HI(-1,!1)},apply:function(e,t){return t.apply(e)}},props:{attributes:function(e){return BI.getState(e).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove:function(e,n){!function(e,t,n,r,o){var i=BI.getState(e.state);if(!i.dragging){var a=function(e){for(;e&&"TD"!=e.nodeName&&"TH"!=e.nodeName;)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}(t.target),s=-1;if(a){var u=a.getBoundingClientRect(),c=u.left,l=u.right;t.clientX-c<=n?s=GI(e,t,"left"):l-t.clientX<=n&&(s=GI(e,t,"right"))}if(s!=i.activeHandle){if(!o&&-1!==s){var f=e.state.doc.resolve(s),h=f.node(-1),p=zx.get(h),d=f.start(-1);if(p.colCount(f.pos-d)+f.nodeAfter.attrs.colspan-1==p.width-1)return}WI(e,s)}}}(e,n,t,0,o)},mouseleave:function(e){!function(e){var t=BI.getState(e.state);t.activeHandle>-1&&!t.dragging&&WI(e,-1)}(e)},mousedown:function(e,t){!function(e,t,n){var r=BI.getState(e.state);if(-1==r.activeHandle||r.dragging)return!1;var o=e.state.doc.nodeAt(r.activeHandle),i=function(e,t,n){var r=n.colspan,o=n.colwidth,i=o&&o[o.length-1];if(i)return i;var a=e.domAtPos(t),s=a.node.childNodes[a.offset].offsetWidth,u=r;if(o)for(var c=0;c<r;c++)o[c]&&(s-=o[c],u--);return s/u}(e,r.activeHandle,o.attrs);function a(t){window.removeEventListener("mouseup",a),window.removeEventListener("mousemove",s);var r=BI.getState(e.state);r.dragging&&(!function(e,t,n){for(var r=e.state.doc.resolve(t),o=r.node(-1),i=zx.get(o),a=r.start(-1),s=i.colCount(r.pos-a)+r.nodeAfter.attrs.colspan-1,u=e.state.tr,c=0;c<i.height;c++){var l=c*i.width+s;if(!c||i.map[l]!=i.map[l-i.width]){var f=i.map[l],h=o.nodeAt(f).attrs,p=1==h.colspan?0:s-i.colCount(f);if(!h.colwidth||h.colwidth[p]!=n){var d=h.colwidth?h.colwidth.slice():$I(h.colspan);d[p]=n,u.setNodeMarkup(a+f,null,eI(h,"colwidth",d))}}}u.docChanged&&e.dispatch(u)}(e,r.activeHandle,zI(r.dragging,t,n)),e.dispatch(e.state.tr.setMeta(BI,{setDragging:null})))}function s(t){if(!t.which)return a(t);var r=BI.getState(e.state),o=zI(r.dragging,t,n);!function(e,t,n,r){var o=e.state.doc.resolve(t),i=o.node(-1),a=o.start(-1),s=zx.get(i).colCount(o.pos-a)+o.nodeAfter.attrs.colspan-1,u=e.domAtPos(o.start(-1)).node;for(;"TABLE"!=u.nodeName;)u=u.parentNode;jI(i,u.firstChild,u,r,s,n)}(e,r.activeHandle,o,n)}e.dispatch(e.state.tr.setMeta(BI,{setDragging:{startX:t.clientX,startWidth:i}})),window.addEventListener("mouseup",a),window.addEventListener("mousemove",s),t.preventDefault()}(e,t,n)}},decorations:function(e){var t=BI.getState(e);if(t.activeHandle>-1)return function(e,t){for(var n=[],r=e.doc.resolve(t),o=r.node(-1),i=zx.get(o),a=r.start(-1),s=i.colCount(r.pos-a)+r.nodeAfter.attrs.colspan,u=0;u<i.height;u++){var c=s+u*i.width-1;if(!(s!=i.width&&i.map[c]==i.map[c+1]||0!=u&&i.map[c-1]==i.map[c-1-i.width])){var l=i.map[c],f=a+l+o.nodeAt(l).nodeSize-1,h=document.createElement("div");h.className="column-resize-handle",n.push(xR.widget(f,h))}}return LR.create(e.doc,n)}(e,t.activeHandle)},nodeViews:{}}})}var HI=function(e,t){this.activeHandle=e,this.dragging=t};function GI(e,t,n){var r=e.posAtCoords({left:t.clientX,top:t.clientY});if(!r)return-1;var o=r.pos,i=Kx(e.state.doc.resolve(o));if(!i)return-1;if("right"==n)return i.pos;var a=zx.get(i.node(-1)),s=i.start(-1),u=a.map.indexOf(i.pos-s);return u%a.width==0?-1:s+a.map[u-1]}function zI(e,t,n){var r=t.clientX-e.startX;return Math.max(n,e.startWidth+r)}function WI(e,t){e.dispatch(e.state.tr.setMeta(BI,{setHandle:t}))}function $I(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function YI(e){void 0===e&&(e={});var t=e.allowTableNodeSelection;return void 0===t&&(t=!1),new sT({key:Yx,state:{init:function(){return null},apply:function(e,t){var n=e.getMeta(Yx);if(null!=n)return-1==n?null:n;if(null==t||!e.docChanged)return t;var r=e.mapping.mapResult(t),o=r.deleted,i=r.pos;return o?null:i}},props:{decorations:iI,handleDOMEvents:{mousedown:gI},createSelectionBetween:function(e){if(null!=Yx.getState(e.state))return e.state.selection},handleTripleClick:vI,handleKeyDown:fI,handlePaste:yI},appendTransaction:function(e,n,r){return function(e,t,n){var r,o,i=(t||e).selection,a=(t||e).doc;if(i instanceof YS&&(o=i.node.type.spec.tableRole)){if("cell"==o||"header_cell"==o)r=rI.create(a,i.from);else if("row"==o){var s=a.resolve(i.from+1);r=rI.rowSelection(s,s)}else if(!n){var u=zx.get(i.node),c=i.from+1,l=c+u.map[u.width*u.height-1];r=rI.create(a,c+1,l)}}else i instanceof WS&&function(e){var t=e.$from,n=e.$to;if(t.pos==n.pos||t.pos<t.pos-6)return!1;for(var r=t.pos,o=n.pos,i=t.depth;i>=0&&!(t.after(i+1)<t.end(i));i--,r++);for(var a=n.depth;a>=0&&!(n.before(a+1)>n.start(a));a--,o--);return r==o&&/row|table/.test(t.node(i).type.spec.tableRole)}(i)?r=WS.create(a,i.from):i instanceof WS&&function(e){for(var t,n,r=e.$from,o=e.$to,i=r.depth;i>0;i--){var a=r.node(i);if("cell"===a.type.spec.tableRole||"header_cell"===a.type.spec.tableRole){t=a;break}}for(var s=o.depth;s>0;s--){var u=o.node(s);if("cell"===u.type.spec.tableRole||"header_cell"===u.type.spec.tableRole){n=u;break}}return t!==n&&0===o.parentOffset}(i)&&(r=WS.create(a,i.$from.start(),i.$from.end()));return r&&(t||(t=e.tr)).setSelection(r),t}(r,TI(r,n),t)}})}HI.prototype.apply=function(e){var t=this,n=e.getMeta(BI);if(n&&null!=n.setHandle)return new HI(n.setHandle,null);if(n&&void 0!==n.setDragging)return new HI(t.activeHandle,n.setDragging);if(t.activeHandle>-1&&e.docChanged){var r=e.mapping.map(t.activeHandle,-1);Jx(e.doc.resolve(r))||(r=null),t=new HI(r,t.dragging)}return t};var KI=function(e,t){if(this.content=e,this.size=t||0,null==t)for(var n=0;n<e.length;n++)this.size+=e[n].nodeSize},qI={firstChild:{configurable:!0},lastChild:{configurable:!0},childCount:{configurable:!0}};KI.prototype.nodesBetween=function(e,t,n,r,o){void 0===r&&(r=0);for(var i=0,a=0;a<t;i++){var s=this.content[i],u=a+s.nodeSize;if(u>e&&!1!==n(s,r+a,o,i)&&s.content.size){var c=a+1;s.nodesBetween(Math.max(0,e-c),Math.min(s.content.size,t-c),n,r+c)}a=u}},KI.prototype.descendants=function(e){this.nodesBetween(0,this.size,e)},KI.prototype.textBetween=function(e,t,n,r){var o="",i=!0;return this.nodesBetween(e,t,(function(a,s){a.isText?(o+=a.text.slice(Math.max(e,s)-s,t-s),i=!n):a.isLeaf&&r?(o+=r,i=!n):!i&&a.isBlock&&(o+=n,i=!0)}),0),o},KI.prototype.append=function(e){if(!e.size)return this;if(!this.size)return e;var t=this.lastChild,n=e.firstChild,r=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),o=1);o<e.content.length;o++)r.push(e.content[o]);return new KI(r,this.size+e.size)},KI.prototype.cut=function(e,t){if(null==t&&(t=this.size),0==e&&t==this.size)return this;var n=[],r=0;if(t>e)for(var o=0,i=0;i<t;o++){var a=this.content[o],s=i+a.nodeSize;s>e&&((i<e||s>t)&&(a=a.isText?a.cut(Math.max(0,e-i),Math.min(a.text.length,t-i)):a.cut(Math.max(0,e-i-1),Math.min(a.content.size,t-i-1))),n.push(a),r+=a.nodeSize),i=s}return new KI(n,r)},KI.prototype.cutByIndex=function(e,t){return e==t?KI.empty:0==e&&t==this.content.length?this:new KI(this.content.slice(e,t))},KI.prototype.replaceChild=function(e,t){var n=this.content[e];if(n==t)return this;var r=this.content.slice(),o=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new KI(r,o)},KI.prototype.addToStart=function(e){return new KI([e].concat(this.content),this.size+e.nodeSize)},KI.prototype.addToEnd=function(e){return new KI(this.content.concat(e),this.size+e.nodeSize)},KI.prototype.eq=function(e){if(this.content.length!=e.content.length)return!1;for(var t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0},qI.firstChild.get=function(){return this.content.length?this.content[0]:null},qI.lastChild.get=function(){return this.content.length?this.content[this.content.length-1]:null},qI.childCount.get=function(){return this.content.length},KI.prototype.child=function(e){var t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t},KI.prototype.maybeChild=function(e){return this.content[e]},KI.prototype.forEach=function(e){for(var t=0,n=0;t<this.content.length;t++){var r=this.content[t];e(r,n,t),n+=r.nodeSize}},KI.prototype.findDiffStart=function(e,t){return void 0===t&&(t=0),function e(t,n,r){for(var o=0;;o++){if(o==t.childCount||o==n.childCount)return t.childCount==n.childCount?null:r;var i=t.child(o),a=n.child(o);if(i!=a){if(!i.sameMarkup(a))return r;if(i.isText&&i.text!=a.text){for(var s=0;i.text[s]==a.text[s];s++)r++;return r}if(i.content.size||a.content.size){var u=e(i.content,a.content,r+1);if(null!=u)return u}r+=i.nodeSize}else r+=i.nodeSize}}(this,e,t)},KI.prototype.findDiffEnd=function(e,t,n){return void 0===t&&(t=this.size),void 0===n&&(n=e.size),function e(t,n,r,o){for(var i=t.childCount,a=n.childCount;;){if(0==i||0==a)return i==a?null:{a:r,b:o};var s=t.child(--i),u=n.child(--a),c=s.nodeSize;if(s!=u){if(!s.sameMarkup(u))return{a:r,b:o};if(s.isText&&s.text!=u.text){for(var l=0,f=Math.min(s.text.length,u.text.length);l<f&&s.text[s.text.length-l-1]==u.text[u.text.length-l-1];)l++,r--,o--;return{a:r,b:o}}if(s.content.size||u.content.size){var h=e(s.content,u.content,r-1,o-1);if(h)return h}r-=c,o-=c}else r-=c,o-=c}}(this,e,t,n)},KI.prototype.findIndex=function(e,t){if(void 0===t&&(t=-1),0==e)return JI(0,e);if(e==this.size)return JI(this.content.length,e);if(e>this.size||e<0)throw new RangeError("Position "+e+" outside of fragment ("+this+")");for(var n=0,r=0;;n++){var o=r+this.child(n).nodeSize;if(o>=e)return o==e||t>0?JI(n+1,o):JI(n,r);r=o}},KI.prototype.toString=function(){return"<"+this.toStringInner()+">"},KI.prototype.toStringInner=function(){return this.content.join(", ")},KI.prototype.toJSON=function(){return this.content.length?this.content.map((function(e){return e.toJSON()})):null},KI.fromJSON=function(e,t){if(!t)return KI.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new KI(t.map(e.nodeFromJSON))},KI.fromArray=function(e){if(!e.length)return KI.empty;for(var t,n=0,r=0;r<e.length;r++){var o=e[r];n+=o.nodeSize,r&&o.isText&&e[r-1].sameMarkup(o)?(t||(t=e.slice(0,r)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new KI(t||e,n)},KI.from=function(e){if(!e)return KI.empty;if(e instanceof KI)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new KI([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))},Object.defineProperties(KI.prototype,qI);var XI={index:0,offset:0};function JI(e,t){return XI.index=e,XI.offset=t,XI}function QI(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;var n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(!QI(e[r],t[r]))return!1}else{for(var o in e)if(!(o in t)||!QI(e[o],t[o]))return!1;for(var i in t)if(!(i in e))return!1}return!0}KI.empty=new KI([],0);var ZI=function(e,t){this.type=e,this.attrs=t};function e_(e){var t=Error.call(this,e);return t.__proto__=e_.prototype,t}ZI.prototype.addToSet=function(e){for(var t,n=!1,r=0;r<e.length;r++){var o=e[r];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,r));else{if(o.type.excludes(this.type))return e;!n&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(o)}}return t||(t=e.slice()),n||t.push(this),t},ZI.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e},ZI.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1},ZI.prototype.eq=function(e){return this==e||this.type==e.type&&QI(this.attrs,e.attrs)},ZI.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return e},ZI.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");var n=e.marks[t.type];if(!n)throw new RangeError("There is no mark type "+t.type+" in this schema");return n.create(t.attrs)},ZI.sameSet=function(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(var n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0},ZI.setFrom=function(e){if(!e||0==e.length)return ZI.none;if(e instanceof ZI)return[e];var t=e.slice();return t.sort((function(e,t){return e.type.rank-t.type.rank})),t},ZI.none=[],e_.prototype=Object.create(Error.prototype),e_.prototype.constructor=e_,e_.prototype.name="ReplaceError";var t_=function(e,t,n){this.content=e,this.openStart=t,this.openEnd=n},n_={size:{configurable:!0}};function r_(e,t,n){if(n.openStart>e.depth)throw new e_("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new e_("Inconsistent open depths");return function e(t,n,r,o){var i=t.index(o),a=t.node(o);if(i==n.index(o)&&o<t.depth-r.openStart){var s=e(t,n,r,o+1);return a.copy(a.content.replaceChild(i,s))}if(r.content.size){if(r.openStart||r.openEnd||t.depth!=o||n.depth!=o){var u=function(e,t){for(var n=t.depth-e.openStart,r=t.node(n).copy(e.content),o=n-1;o>=0;o--)r=t.node(o).copy(KI.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(r,t),c=u.start,l=u.end;return u_(a,function e(t,n,r,o,i){var a=t.depth>i&&i_(t,n,i+1),s=o.depth>i&&i_(r,o,i+1),u=[];s_(null,t,i,u),a&&s&&n.index(i)==r.index(i)?(o_(a,s),a_(u_(a,e(t,n,r,o,i+1)),u)):(a&&a_(u_(a,c_(t,n,i+1)),u),s_(n,r,i,u),s&&a_(u_(s,c_(r,o,i+1)),u));return s_(o,null,i,u),new KI(u)}(t,c,l,n,o))}var f=t.parent,h=f.content;return u_(f,h.cut(0,t.parentOffset).append(r.content).append(h.cut(n.parentOffset)))}return u_(a,c_(t,n,o))}(e,t,n,0)}function o_(e,t){if(!t.type.compatibleContent(e.type))throw new e_("Cannot join "+t.type.name+" onto "+e.type.name)}function i_(e,t,n){var r=e.node(n);return o_(r,t.node(n)),r}function a_(e,t){var n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function s_(e,t,n,r){var o=(t||e).node(n),i=0,a=t?t.index(n):o.childCount;e&&(i=e.index(n),e.depth>n?i++:e.textOffset&&(a_(e.nodeAfter,r),i++));for(var s=i;s<a;s++)a_(o.child(s),r);t&&t.depth==n&&t.textOffset&&a_(t.nodeBefore,r)}function u_(e,t){if(!e.type.validContent(t))throw new e_("Invalid content for node "+e.type.name);return e.copy(t)}function c_(e,t,n){var r=[];(s_(null,e,n,r),e.depth>n)&&a_(u_(i_(e,t,n+1),c_(e,t,n+1)),r);return s_(t,null,n,r),new KI(r)}n_.size.get=function(){return this.content.size-this.openStart-this.openEnd},t_.prototype.insertAt=function(e,t){var n=function e(t,n,r,o){var i=t.findIndex(n),a=i.index,s=i.offset,u=t.maybeChild(a);if(s==n||u.isText)return o&&!o.canReplace(a,a,r)?null:t.cut(0,n).append(r).append(t.cut(n));var c=e(u.content,n-s-1,r);return c&&t.replaceChild(a,u.copy(c))}(this.content,e+this.openStart,t,null);return n&&new t_(n,this.openStart,this.openEnd)},t_.prototype.removeBetween=function(e,t){return new t_(function e(t,n,r){var o=t.findIndex(n),i=o.index,a=o.offset,s=t.maybeChild(i),u=t.findIndex(r),c=u.index,l=u.offset;if(a==n||s.isText){if(l!=r&&!t.child(c).isText)throw new RangeError("Removing non-flat range");return t.cut(0,n).append(t.cut(r))}if(i!=c)throw new RangeError("Removing non-flat range");return t.replaceChild(i,s.copy(e(s.content,n-a-1,r-a-1)))}(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)},t_.prototype.eq=function(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd},t_.prototype.toString=function(){return this.content+"("+this.openStart+","+this.openEnd+")"},t_.prototype.toJSON=function(){if(!this.content.size)return null;var e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e},t_.fromJSON=function(e,t){if(!t)return t_.empty;var n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new t_(KI.fromJSON(e,t.content),n,r)},t_.maxOpen=function(e,t){void 0===t&&(t=!0);for(var n=0,r=0,o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)n++;for(var i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new t_(e,n,r)},Object.defineProperties(t_.prototype,n_),t_.empty=new t_(KI.empty,0,0);var l_=function(e,t,n){this.pos=e,this.path=t,this.depth=t.length/3-1,this.parentOffset=n},f_={parent:{configurable:!0},doc:{configurable:!0},textOffset:{configurable:!0},nodeAfter:{configurable:!0},nodeBefore:{configurable:!0}};l_.prototype.resolveDepth=function(e){return null==e?this.depth:e<0?this.depth+e:e},f_.parent.get=function(){return this.node(this.depth)},f_.doc.get=function(){return this.node(0)},l_.prototype.node=function(e){return this.path[3*this.resolveDepth(e)]},l_.prototype.index=function(e){return this.path[3*this.resolveDepth(e)+1]},l_.prototype.indexAfter=function(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)},l_.prototype.start=function(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1},l_.prototype.end=function(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size},l_.prototype.before=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]},l_.prototype.after=function(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize},f_.textOffset.get=function(){return this.pos-this.path[this.path.length-1]},f_.nodeAfter.get=function(){var e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;var n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r},f_.nodeBefore.get=function(){var e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)},l_.prototype.posAtIndex=function(e,t){t=this.resolveDepth(t);for(var n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1,o=0;o<e;o++)r+=n.child(o).nodeSize;return r},l_.prototype.marks=function(){var e=this.parent,t=this.index();if(0==e.content.size)return ZI.none;if(this.textOffset)return e.child(t).marks;var n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){var o=n;n=r,r=o}for(var i=n.marks,a=0;a<i.length;a++)!1!==i[a].type.spec.inclusive||r&&i[a].isInSet(r.marks)||(i=i[a--].removeFromSet(i));return i},l_.prototype.marksAcross=function(e){var t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;for(var n=t.marks,r=e.parent.maybeChild(e.index()),o=0;o<n.length;o++)!1!==n[o].type.spec.inclusive||r&&n[o].isInSet(r.marks)||(n=n[o--].removeFromSet(n));return n},l_.prototype.sharedDepth=function(e){for(var t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0},l_.prototype.blockRange=function(e,t){if(void 0===e&&(e=this),e.pos<this.pos)return e.blockRange(this);for(var n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new m_(this,e,n)},l_.prototype.sameParent=function(e){return this.pos-this.parentOffset==e.pos-e.parentOffset},l_.prototype.max=function(e){return e.pos>this.pos?e:this},l_.prototype.min=function(e){return e.pos<this.pos?e:this},l_.prototype.toString=function(){for(var e="",t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset},l_.resolve=function(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");for(var n=[],r=0,o=t,i=e;;){var a=i.content.findIndex(o),s=a.index,u=a.offset,c=o-u;if(n.push(i,s,r+u),!c)break;if((i=i.child(s)).isText)break;o=c-1,r+=u+1}return new l_(t,n,o)},l_.resolveCached=function(e,t){for(var n=0;n<h_.length;n++){var r=h_[n];if(r.pos==t&&r.doc==e)return r}var o=h_[p_]=l_.resolve(e,t);return p_=(p_+1)%d_,o},Object.defineProperties(l_.prototype,f_);var h_=[],p_=0,d_=12,m_=function(e,t,n){this.$from=e,this.$to=t,this.depth=n},v_={start:{configurable:!0},end:{configurable:!0},parent:{configurable:!0},startIndex:{configurable:!0},endIndex:{configurable:!0}};v_.start.get=function(){return this.$from.before(this.depth+1)},v_.end.get=function(){return this.$to.after(this.depth+1)},v_.parent.get=function(){return this.$from.node(this.depth)},v_.startIndex.get=function(){return this.$from.index(this.depth)},v_.endIndex.get=function(){return this.$to.indexAfter(this.depth)},Object.defineProperties(m_.prototype,v_);var y_=Object.create(null),g_=function(e,t,n,r){this.type=e,this.attrs=t,this.content=n||KI.empty,this.marks=r||ZI.none},b_={nodeSize:{configurable:!0},childCount:{configurable:!0},textContent:{configurable:!0},firstChild:{configurable:!0},lastChild:{configurable:!0},isBlock:{configurable:!0},isTextblock:{configurable:!0},inlineContent:{configurable:!0},isInline:{configurable:!0},isText:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};b_.nodeSize.get=function(){return this.isLeaf?1:2+this.content.size},b_.childCount.get=function(){return this.content.childCount},g_.prototype.child=function(e){return this.content.child(e)},g_.prototype.maybeChild=function(e){return this.content.maybeChild(e)},g_.prototype.forEach=function(e){this.content.forEach(e)},g_.prototype.nodesBetween=function(e,t,n,r){void 0===r&&(r=0),this.content.nodesBetween(e,t,n,r,this)},g_.prototype.descendants=function(e){this.nodesBetween(0,this.content.size,e)},b_.textContent.get=function(){return this.textBetween(0,this.content.size,"")},g_.prototype.textBetween=function(e,t,n,r){return this.content.textBetween(e,t,n,r)},b_.firstChild.get=function(){return this.content.firstChild},b_.lastChild.get=function(){return this.content.lastChild},g_.prototype.eq=function(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)},g_.prototype.sameMarkup=function(e){return this.hasMarkup(e.type,e.attrs,e.marks)},g_.prototype.hasMarkup=function(e,t,n){return this.type==e&&QI(this.attrs,t||e.defaultAttrs||y_)&&ZI.sameSet(this.marks,n||ZI.none)},g_.prototype.copy=function(e){return void 0===e&&(e=null),e==this.content?this:new this.constructor(this.type,this.attrs,e,this.marks)},g_.prototype.mark=function(e){return e==this.marks?this:new this.constructor(this.type,this.attrs,this.content,e)},g_.prototype.cut=function(e,t){return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))},g_.prototype.slice=function(e,t,n){if(void 0===t&&(t=this.content.size),void 0===n&&(n=!1),e==t)return t_.empty;var r=this.resolve(e),o=this.resolve(t),i=n?0:r.sharedDepth(t),a=r.start(i),s=r.node(i).content.cut(r.pos-a,o.pos-a);return new t_(s,r.depth-i,o.depth-i)},g_.prototype.replace=function(e,t,n){return r_(this.resolve(e),this.resolve(t),n)},g_.prototype.nodeAt=function(e){for(var t=this;;){var n=t.content.findIndex(e),r=n.index,o=n.offset;if(!(t=t.maybeChild(r)))return null;if(o==e||t.isText)return t;e-=o+1}},g_.prototype.childAfter=function(e){var t=this.content.findIndex(e),n=t.index,r=t.offset;return{node:this.content.maybeChild(n),index:n,offset:r}},g_.prototype.childBefore=function(e){if(0==e)return{node:null,index:0,offset:0};var t=this.content.findIndex(e),n=t.index,r=t.offset;if(r<e)return{node:this.content.child(n),index:n,offset:r};var o=this.content.child(n-1);return{node:o,index:n-1,offset:r-o.nodeSize}},g_.prototype.resolve=function(e){return l_.resolveCached(this,e)},g_.prototype.resolveNoCache=function(e){return l_.resolve(this,e)},g_.prototype.rangeHasMark=function(e,t,n){var r=!1;return t>e&&this.nodesBetween(e,t,(function(e){return n.isInSet(e.marks)&&(r=!0),!r})),r},b_.isBlock.get=function(){return this.type.isBlock},b_.isTextblock.get=function(){return this.type.isTextblock},b_.inlineContent.get=function(){return this.type.inlineContent},b_.isInline.get=function(){return this.type.isInline},b_.isText.get=function(){return this.type.isText},b_.isLeaf.get=function(){return this.type.isLeaf},b_.isAtom.get=function(){return this.type.isAtom},g_.prototype.toString=function(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);var e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),function(e,t){for(var n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}(this.marks,e)},g_.prototype.contentMatchAt=function(e){var t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t},g_.prototype.canReplace=function(e,t,n,r,o){void 0===n&&(n=KI.empty),void 0===r&&(r=0),void 0===o&&(o=n.childCount);var i=this.contentMatchAt(e).matchFragment(n,r,o),a=i&&i.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(var s=r;s<o;s++)if(!this.type.allowsMarks(n.child(s).marks))return!1;return!0},g_.prototype.canReplaceWith=function(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;var o=this.contentMatchAt(e).matchType(n),i=o&&o.matchFragment(this.content,t);return!!i&&i.validEnd},g_.prototype.canAppend=function(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)},g_.prototype.check=function(){if(!this.type.validContent(this.content))throw new RangeError("Invalid content for node "+this.type.name+": "+this.content.toString().slice(0,50));for(var e=ZI.none,t=0;t<this.marks.length;t++)e=this.marks[t].addToSet(e);if(!ZI.sameSet(e,this.marks))throw new RangeError("Invalid collection of marks for node "+this.type.name+": "+this.marks.map((function(e){return e.type.name})));this.content.forEach((function(e){return e.check()}))},g_.prototype.toJSON=function(){var e={type:this.type.name};for(var t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map((function(e){return e.toJSON()}))),e},g_.fromJSON=function(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");var n=null;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}var r=KI.fromJSON(e,t.content);return e.nodeType(t.type).create(t.attrs,r,n)},Object.defineProperties(g_.prototype,b_);var E_=function(e){this.validEnd=e,this.next=[],this.wrapCache=[]},w_={inlineContent:{configurable:!0},defaultType:{configurable:!0},edgeCount:{configurable:!0}};E_.parse=function(e,t){var n=new S_(e,t);if(null==n.next)return E_.empty;var r=O_(n);n.next&&n.err("Unexpected trailing text");var o=function(e){var t=Object.create(null);return function n(r){var o=[];r.forEach((function(t){e[t].forEach((function(t){var n=t.term,r=t.to;if(n){var i=o.indexOf(n),a=i>-1&&o[i+1];M_(e,r).forEach((function(e){a||o.push(n,a=[]),-1==a.indexOf(e)&&a.push(e)}))}}))}));for(var i=t[r.join(",")]=new E_(r.indexOf(e.length-1)>-1),a=0;a<o.length;a+=2){var s=o[a+1].sort(C_);i.next.push(o[a],t[s.join(",")]||n(s))}return i}(M_(e,0))}(function(e){var t=[[]];return o(function e(t,i){if("choice"==t.type)return t.exprs.reduce((function(t,n){return t.concat(e(n,i))}),[]);if("seq"==t.type)for(var a=0;;a++){var s=e(t.exprs[a],i);if(a==t.exprs.length-1)return s;o(s,i=n())}else{if("star"==t.type){var u=n();return r(i,u),o(e(t.expr,u),u),[r(u)]}if("plus"==t.type){var c=n();return o(e(t.expr,i),c),o(e(t.expr,c),c),[r(c)]}if("opt"==t.type)return[r(i)].concat(e(t.expr,i));if("range"==t.type){for(var l=i,f=0;f<t.min;f++){var h=n();o(e(t.expr,l),h),l=h}if(-1==t.max)o(e(t.expr,l),l);else for(var p=t.min;p<t.max;p++){var d=n();r(l,d),o(e(t.expr,l),d),l=d}return[r(l)]}if("name"==t.type)return[r(i,null,t.value)]}}(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){var o={term:r,to:n};return t[e].push(o),o}function o(e,t){e.forEach((function(e){return e.to=t}))}}(r));return function(e,t){for(var n=0,r=[e];n<r.length;n++){for(var o=r[n],i=!o.validEnd,a=[],s=0;s<o.next.length;s+=2){var u=o.next[s],c=o.next[s+1];a.push(u.name),!i||u.isText||u.hasRequiredAttrs()||(i=!1),-1==r.indexOf(c)&&r.push(c)}i&&t.err("Only non-generatable nodes ("+a.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(o,n),o},E_.prototype.matchType=function(e){for(var t=0;t<this.next.length;t+=2)if(this.next[t]==e)return this.next[t+1];return null},E_.prototype.matchFragment=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.childCount);for(var r=this,o=t;r&&o<n;o++)r=r.matchType(e.child(o).type);return r},w_.inlineContent.get=function(){var e=this.next[0];return!!e&&e.isInline},w_.defaultType.get=function(){for(var e=0;e<this.next.length;e+=2){var t=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}},E_.prototype.compatible=function(e){for(var t=0;t<this.next.length;t+=2)for(var n=0;n<e.next.length;n+=2)if(this.next[t]==e.next[n])return!0;return!1},E_.prototype.fillBefore=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=0);var r=[this];return function o(i,a){var s=i.matchFragment(e,n);if(s&&(!t||s.validEnd))return KI.from(a.map((function(e){return e.createAndFill()})));for(var u=0;u<i.next.length;u+=2){var c=i.next[u],l=i.next[u+1];if(!c.isText&&!c.hasRequiredAttrs()&&-1==r.indexOf(l)){r.push(l);var f=o(l,a.concat(c));if(f)return f}}}(this,[])},E_.prototype.findWrapping=function(e){for(var t=0;t<this.wrapCache.length;t+=2)if(this.wrapCache[t]==e)return this.wrapCache[t+1];var n=this.computeWrapping(e);return this.wrapCache.push(e,n),n},E_.prototype.computeWrapping=function(e){for(var t=Object.create(null),n=[{match:this,type:null,via:null}];n.length;){var r=n.shift(),o=r.match;if(o.matchType(e)){for(var i=[],a=r;a.type;a=a.via)i.push(a.type);return i.reverse()}for(var s=0;s<o.next.length;s+=2){var u=o.next[s];u.isLeaf||u.hasRequiredAttrs()||u.name in t||r.type&&!o.next[s+1].validEnd||(n.push({match:u.contentMatch,type:u,via:r}),t[u.name]=!0)}}},w_.edgeCount.get=function(){return this.next.length>>1},E_.prototype.edge=function(e){var t=e<<1;if(t>=this.next.length)throw new RangeError("There's no "+e+"th edge in this content match");return{type:this.next[t],next:this.next[t+1]}},E_.prototype.toString=function(){var e=[];return function t(n){e.push(n);for(var r=1;r<n.next.length;r+=2)-1==e.indexOf(n.next[r])&&t(n.next[r])}(this),e.map((function(t,n){for(var r=n+(t.validEnd?"*":" ")+" ",o=0;o<t.next.length;o+=2)r+=(o?", ":"")+t.next[o].name+"->"+e.indexOf(t.next[o+1]);return r})).join("\n")},Object.defineProperties(E_.prototype,w_),E_.empty=new E_(!0);var S_=function(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()},T_={next:{configurable:!0}};function O_(e){var t=[];do{t.push(R_(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function R_(e){var t=[];do{t.push(N_(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function N_(e){for(var t=function(e){if(e.eat("(")){var t=O_(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){var n=function(e,t){var n=e.nodeTypes,r=n[t];if(r)return[r];var o=[];for(var i in n){var a=n[i];a.groups.indexOf(t)>-1&&o.push(a)}0==o.length&&e.err("No node type or group '"+t+"' found");return o}(e,e.next).map((function(t){return null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}}));return e.pos++,1==n.length?n[0]:{type:"choice",exprs:n}}e.err("Unexpected token '"+e.next+"'")}(e);;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=A_(e,t)}return t}function k_(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");var t=Number(e.next);return e.pos++,t}function A_(e,t){var n=k_(e),r=n;return e.eat(",")&&(r="}"!=e.next?k_(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function C_(e,t){return t-e}function M_(e,t){var n=[];return function t(r){var o=e[r];if(1==o.length&&!o[0].term)return t(o[0].to);n.push(r);for(var i=0;i<o.length;i++){var a=o[i],s=a.term,u=a.to;s||-1!=n.indexOf(u)||t(u)}}(t),n.sort(C_)}function x_(e){var t=Object.create(null);for(var n in e){var r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function I_(e,t){var n=Object.create(null);for(var r in e){var o=t&&t[r];if(void 0===o){var i=e[r];if(!i.hasDefault)throw new RangeError("No value supplied for attribute "+r);o=i.default}n[r]=o}return n}function __(e){var t=Object.create(null);if(e)for(var n in e)t[n]=new F_(e[n]);return t}T_.next.get=function(){return this.tokens[this.pos]},S_.prototype.eat=function(e){return this.next==e&&(this.pos++||!0)},S_.prototype.err=function(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")},Object.defineProperties(S_.prototype,T_);var P_=function(e,t,n){this.name=e,this.schema=t,this.spec=n,this.groups=n.group?n.group.split(" "):[],this.attrs=__(n.attrs),this.defaultAttrs=x_(this.attrs),this.contentMatch=null,this.markSet=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e},L_={isInline:{configurable:!0},isTextblock:{configurable:!0},isLeaf:{configurable:!0},isAtom:{configurable:!0}};L_.isInline.get=function(){return!this.isBlock},L_.isTextblock.get=function(){return this.isBlock&&this.inlineContent},L_.isLeaf.get=function(){return this.contentMatch==E_.empty},L_.isAtom.get=function(){return this.isLeaf||this.spec.atom},P_.prototype.hasRequiredAttrs=function(){for(var e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1},P_.prototype.compatibleContent=function(e){return this==e||this.contentMatch.compatible(e.contentMatch)},P_.prototype.computeAttrs=function(e){return!e&&this.defaultAttrs?this.defaultAttrs:I_(this.attrs,e)},P_.prototype.create=function(e,t,n){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new g_(this,this.computeAttrs(e),KI.from(t),ZI.setFrom(n))},P_.prototype.createChecked=function(e,t,n){if(t=KI.from(t),!this.validContent(t))throw new RangeError("Invalid content for node "+this.name);return new g_(this,this.computeAttrs(e),t,ZI.setFrom(n))},P_.prototype.createAndFill=function(e,t,n){if(e=this.computeAttrs(e),(t=KI.from(t)).size){var r=this.contentMatch.fillBefore(t);if(!r)return null;t=r.append(t)}var o=this.contentMatch.matchFragment(t).fillBefore(KI.empty,!0);return o?new g_(this,e,t.append(o),ZI.setFrom(n)):null},P_.prototype.validContent=function(e){var t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(var n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0},P_.prototype.allowsMarkType=function(e){return null==this.markSet||this.markSet.indexOf(e)>-1},P_.prototype.allowsMarks=function(e){if(null==this.markSet)return!0;for(var t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0},P_.prototype.allowedMarks=function(e){if(null==this.markSet)return e;for(var t,n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:ZI.empty:e},P_.compile=function(e,t){var n=Object.create(null);e.forEach((function(e,r){return n[e]=new P_(e,t,r)}));var r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(var o in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n},Object.defineProperties(P_.prototype,L_);var F_=function(e){this.hasDefault=Object.prototype.hasOwnProperty.call(e,"default"),this.default=e.default},D_={isRequired:{configurable:!0}};D_.isRequired.get=function(){return!this.hasDefault},Object.defineProperties(F_.prototype,D_);var U_=function(e,t,n,r){this.name=e,this.schema=n,this.spec=r,this.attrs=__(r.attrs),this.rank=t,this.excluded=null;var o=x_(this.attrs);this.instance=o&&new ZI(this,o)};U_.prototype.create=function(e){return!e&&this.instance?this.instance:new ZI(this,I_(this.attrs,e))},U_.compile=function(e,t){var n=Object.create(null),r=0;return e.forEach((function(e,o){return n[e]=new U_(e,r++,t,o)})),n},U_.prototype.removeFromSet=function(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e},U_.prototype.isInSet=function(e){for(var t=0;t<e.length;t++)if(e[t].type==this)return e[t]},U_.prototype.excludes=function(e){return this.excluded.indexOf(e)>-1};var j_={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},B_={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},V_={ol:!0,ul:!0};function H_(e){return(e?1:0)|("full"===e?2:0)}var G_=function(e,t,n,r,o,i,a){this.type=e,this.attrs=t,this.solid=o,this.match=i||(4&a?null:e.contentMatch),this.options=a,this.content=[],this.marks=n,this.activeMarks=ZI.none,this.pendingMarks=r,this.stashMarks=[]};G_.prototype.findWrapping=function(e){if(!this.match){if(!this.type)return[];var t=this.type.contentMatch.fillBefore(KI.from(e));if(!t){var n,r=this.type.contentMatch;return(n=r.findWrapping(e.type))?(this.match=r,n):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)},G_.prototype.finish=function(e){if(!(1&this.options)){var t,n=this.content[this.content.length-1];n&&n.isText&&(t=/[ \t\r\n\u000c]+$/.exec(n.text))&&(n.text.length==t[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-t[0].length)))}var r=KI.from(this.content);return!e&&this.match&&(r=r.append(this.match.fillBefore(KI.empty,!0))),this.type?this.type.create(this.attrs,r,this.marks):r},G_.prototype.popFromStashMark=function(e){for(var t=this.stashMarks.length-1;t>=0;t--)if(e.eq(this.stashMarks[t]))return this.stashMarks.splice(t,1)[0]},G_.prototype.applyPending=function(e){for(var t=0,n=this.pendingMarks;t<n.length;t++){var r=n[t];(this.type?this.type.allowsMarkType(r.type):$_(r.type,e))&&!r.isInSet(this.activeMarks)&&(this.activeMarks=r.addToSet(this.activeMarks),this.pendingMarks=r.removeFromSet(this.pendingMarks))}},G_.prototype.inlineContext=function(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!j_.hasOwnProperty(e.parentNode.nodeName.toLowerCase())};var z_=function(e,t,n){this.parser=e,this.options=t,this.isOpen=n;var r,o=t.topNode,i=H_(t.preserveWhitespace)|(n?4:0);r=o?new G_(o.type,o.attrs,ZI.none,ZI.none,!0,t.topMatch||o.type.contentMatch,i):new G_(n?null:e.schema.topNodeType,null,ZI.none,ZI.none,!0,null,i),this.nodes=[r],this.open=0,this.find=t.findPositions,this.needsBlock=!1},W_={top:{configurable:!0},currentPos:{configurable:!0}};function $_(e,t){var n=t.schema.nodes,r=function(r){var o=n[r];if(o.allowsMarkType(e)){var i=[],a=function(e){i.push(e);for(var n=0;n<e.edgeCount;n++){var r=e.edge(n),o=r.type,s=r.next;if(o==t)return!0;if(i.indexOf(s)<0&&a(s))return!0}};return a(o.contentMatch)?{v:!0}:void 0}};for(var o in n){var i=r(o);if(i)return i.v}}W_.top.get=function(){return this.nodes[this.open]},z_.prototype.addDOM=function(e){if(3==e.nodeType)this.addTextNode(e);else if(1==e.nodeType){var t=e.getAttribute("style"),n=t?this.readStyles(function(e){var t,n=/\s*([\w-]+)\s*:\s*([^;]+)/g,r=[];for(;t=n.exec(e);)r.push(t[1],t[2].trim());return r}(t)):null,r=this.top;if(null!=n)for(var o=0;o<n.length;o++)this.addPendingMark(n[o]);if(this.addElement(e),null!=n)for(var i=0;i<n.length;i++)this.removePendingMark(n[i],r)}},z_.prototype.addTextNode=function(e){var t=e.nodeValue,n=this.top;if(2&n.options||n.inlineContext(e)||/[^ \t\r\n\u000c]/.test(t)){if(1&n.options)t=2&n.options?t.replace(/\r\n?/g,"\n"):t.replace(/\r?\n|\r/g," ");else if(t=t.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(t)&&this.open==this.nodes.length-1){var r=n.content[n.content.length-1],o=e.previousSibling;(!r||o&&"BR"==o.nodeName||r.isText&&/[ \t\r\n\u000c]$/.test(r.text))&&(t=t.slice(1))}t&&this.insertNode(this.parser.schema.text(t)),this.findInText(e)}else this.findInside(e)},z_.prototype.addElement=function(e,t){var n,r=e.nodeName.toLowerCase();V_.hasOwnProperty(r)&&this.parser.normalizeLists&&function(e){for(var t=e.firstChild,n=null;t;t=t.nextSibling){var r=1==t.nodeType?t.nodeName.toLowerCase():null;r&&V_.hasOwnProperty(r)&&n?(n.appendChild(t),t=n):"li"==r?n=t:r&&(n=null)}}(e);var o=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(n=this.parser.matchTag(e,this,t));if(o?o.ignore:B_.hasOwnProperty(r))this.findInside(e),this.ignoreFallback(e);else if(!o||o.skip||o.closeParent){o&&o.closeParent?this.open=Math.max(0,this.open-1):o&&o.skip.nodeType&&(e=o.skip);var i,a=this.top,s=this.needsBlock;if(j_.hasOwnProperty(r))i=!0,a.type||(this.needsBlock=!0);else if(!e.firstChild)return void this.leafFallback(e);this.addAll(e),i&&this.sync(a),this.needsBlock=s}else this.addElementByRule(e,o,!1===o.consuming?n:null)},z_.prototype.leafFallback=function(e){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"))},z_.prototype.ignoreFallback=function(e){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"))},z_.prototype.readStyles=function(e){var t=ZI.none;e:for(var n=0;n<e.length;n+=2)for(var r=null;;){var o=this.parser.matchStyle(e[n],e[n+1],this,r);if(!o)continue e;if(o.ignore)return null;if(t=this.parser.schema.marks[o.mark].create(o.attrs).addToSet(t),!1!==o.consuming)break;r=o}return t},z_.prototype.addElementByRule=function(e,t,n){var r,o,i,a=this;t.node?(o=this.parser.schema.nodes[t.node]).isLeaf?this.insertNode(o.create(t.attrs))||this.leafFallback(e):r=this.enter(o,t.attrs,t.preserveWhitespace):(i=this.parser.schema.marks[t.mark].create(t.attrs),this.addPendingMark(i));var s=this.top;if(o&&o.isLeaf)this.findInside(e);else if(n)this.addElement(e,n);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach((function(e){return a.insertNode(e)}));else{var u=t.contentElement;"string"==typeof u?u=e.querySelector(u):"function"==typeof u&&(u=u(e)),u||(u=e),this.findAround(e,u,!0),this.addAll(u,r)}r&&(this.sync(s),this.open--),i&&this.removePendingMark(i,s)},z_.prototype.addAll=function(e,t,n,r){for(var o=n||0,i=n?e.childNodes[n]:e.firstChild,a=null==r?null:e.childNodes[r];i!=a;i=i.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(i),t&&j_.hasOwnProperty(i.nodeName.toLowerCase())&&this.sync(t);this.findAtPoint(e,o)},z_.prototype.findPlace=function(e){for(var t,n,r=this.open;r>=0;r--){var o=this.nodes[r],i=o.findWrapping(e);if(i&&(!t||t.length>i.length)&&(t=i,n=o,!i.length))break;if(o.solid)break}if(!t)return!1;this.sync(n);for(var a=0;a<t.length;a++)this.enterInner(t[a],null,!1);return!0},z_.prototype.insertNode=function(e){if(e.isInline&&this.needsBlock&&!this.top.type){var t=this.textblockFromContext();t&&this.enterInner(t)}if(this.findPlace(e)){this.closeExtra();var n=this.top;n.applyPending(e.type),n.match&&(n.match=n.match.matchType(e.type));for(var r=n.activeMarks,o=0;o<e.marks.length;o++)n.type&&!n.type.allowsMarkType(e.marks[o].type)||(r=e.marks[o].addToSet(r));return n.content.push(e.mark(r)),!0}return!1},z_.prototype.enter=function(e,t,n){var r=this.findPlace(e.create(t));return r&&this.enterInner(e,t,!0,n),r},z_.prototype.enterInner=function(e,t,n,r){this.closeExtra();var o=this.top;o.applyPending(e),o.match=o.match&&o.match.matchType(e,t);var i=null==r?-5&o.options:H_(r);4&o.options&&0==o.content.length&&(i|=4),this.nodes.push(new G_(e,t,o.activeMarks,o.pendingMarks,n,null,i)),this.open++},z_.prototype.closeExtra=function(e){var t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}},z_.prototype.finish=function(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)},z_.prototype.sync=function(e){for(var t=this.open;t>=0;t--)if(this.nodes[t]==e)return void(this.open=t)},W_.currentPos.get=function(){this.closeExtra();for(var e=0,t=this.open;t>=0;t--){for(var n=this.nodes[t].content,r=n.length-1;r>=0;r--)e+=n[r].nodeSize;t&&e++}return e},z_.prototype.findAtPoint=function(e,t){if(this.find)for(var n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)},z_.prototype.findInside=function(e){if(this.find)for(var t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)},z_.prototype.findAround=function(e,t,n){if(e!=t&&this.find)for(var r=0;r<this.find.length;r++){if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node))t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}},z_.prototype.findInText=function(e){if(this.find)for(var t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))},z_.prototype.matchesContext=function(e){var t=this;if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);var n=e.split("/"),r=this.options.context,o=!(this.isOpen||r&&r.parent.type!=this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),a=function(e,s){for(;e>=0;e--){var u=n[e];if(""==u){if(e==n.length-1||0==e)continue;for(;s>=i;s--)if(a(e-1,s))return!0;return!1}var c=s>0||0==s&&o?t.nodes[s].type:r&&s>=i?r.node(s-i).type:null;if(!c||c.name!=u&&-1==c.groups.indexOf(u))return!1;s--}return!0};return a(n.length-1,this.open)},z_.prototype.textblockFromContext=function(){var e=this.options.context;if(e)for(var t=e.depth;t>=0;t--){var n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(var r in this.parser.schema.nodes){var o=this.parser.schema.nodes[r];if(o.isTextblock&&o.defaultAttrs)return o}},z_.prototype.addPendingMark=function(e){var t=function(e,t){for(var n=0;n<t.length;n++)if(e.eq(t[n]))return t[n]}(e,this.top.pendingMarks);t&&this.top.stashMarks.push(t),this.top.pendingMarks=e.addToSet(this.top.pendingMarks)},z_.prototype.removePendingMark=function(e,t){for(var n=this.open;n>=0;n--){var r=this.nodes[n];if(r.pendingMarks.lastIndexOf(e)>-1)r.pendingMarks=e.removeFromSet(r.pendingMarks);else{r.activeMarks=e.removeFromSet(r.activeMarks);var o=r.popFromStashMark(e);o&&r.type&&r.type.allowsMarkType(o.type)&&(r.activeMarks=o.addToSet(r.activeMarks))}if(r==t)break}},Object.defineProperties(z_.prototype,W_);var Y_=Math.pow(2,16);function K_(e,t){return e+t*Y_}function q_(e){return 65535&e}var X_=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.pos=e,this.deleted=t,this.recover=n},J_=function(e,t){void 0===t&&(t=!1),this.ranges=e,this.inverted=t};J_.prototype.recover=function(e){var t=0,n=q_(e);if(!this.inverted)for(var r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/Y_}(e)},J_.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},J_.prototype.map=function(e,t){return void 0===t&&(t=1),this._map(e,t,!0)},J_.prototype._map=function(e,t,n){for(var r=0,o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?r:0);if(s>e)break;var u=this.ranges[a+o],c=this.ranges[a+i],l=s+u;if(e<=l){var f=s+r+((u?e==s?-1:e==l?1:t:t)<0?0:c);if(n)return f;var h=e==(t<0?s:l)?null:K_(a/3,e-s);return new X_(f,t<0?e!=s:e!=l,h)}r+=c-u}return n?e+r:new X_(e+r)},J_.prototype.touches=function(e,t){for(var n=0,r=q_(t),o=this.inverted?2:1,i=this.inverted?1:2,a=0;a<this.ranges.length;a+=3){var s=this.ranges[a]-(this.inverted?n:0);if(s>e)break;var u=this.ranges[a+o];if(e<=s+u&&a==3*r)return!0;n+=this.ranges[a+i]-u}return!1},J_.prototype.forEach=function(e){for(var t=this.inverted?2:1,n=this.inverted?1:2,r=0,o=0;r<this.ranges.length;r+=3){var i=this.ranges[r],a=i-(this.inverted?o:0),s=i+(this.inverted?0:o),u=this.ranges[r+t],c=this.ranges[r+n];e(a,a+u,s,s+c),o+=c-u}},J_.prototype.invert=function(){return new J_(this.ranges,!this.inverted)},J_.prototype.toString=function(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)},J_.offset=function(e){return 0==e?J_.empty:new J_(e<0?[0,-e,0]:[0,0,e])},J_.empty=new J_([]);var Q_=function(e,t,n,r){this.maps=e||[],this.from=n||0,this.to=null==r?this.maps.length:r,this.mirror=t};function Z_(e){var t=Error.call(this,e);return t.__proto__=Z_.prototype,t}Q_.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.maps.length),new Q_(this.maps,this.mirror,e,t)},Q_.prototype.copy=function(){return new Q_(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)},Q_.prototype.appendMap=function(e,t){this.to=this.maps.push(e),null!=t&&this.setMirror(this.maps.length-1,t)},Q_.prototype.appendMapping=function(e){for(var t=0,n=this.maps.length;t<e.maps.length;t++){var r=e.getMirror(t);this.appendMap(e.maps[t],null!=r&&r<t?n+r:null)}},Q_.prototype.getMirror=function(e){if(this.mirror)for(var t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]},Q_.prototype.setMirror=function(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)},Q_.prototype.appendMappingInverted=function(e){for(var t=e.maps.length-1,n=this.maps.length+e.maps.length;t>=0;t--){var r=e.getMirror(t);this.appendMap(e.maps[t].invert(),null!=r&&r>t?n-r-1:null)}},Q_.prototype.invert=function(){var e=new Q_;return e.appendMappingInverted(this),e},Q_.prototype.map=function(e,t){if(void 0===t&&(t=1),this.mirror)return this._map(e,t,!0);for(var n=this.from;n<this.to;n++)e=this.maps[n].map(e,t);return e},Q_.prototype.mapResult=function(e,t){return void 0===t&&(t=1),this._map(e,t,!1)},Q_.prototype._map=function(e,t,n){for(var r=!1,o=this.from;o<this.to;o++){var i=this.maps[o].mapResult(e,t);if(null!=i.recover){var a=this.getMirror(o);if(null!=a&&a>o&&a<this.to){o=a,e=this.maps[a].recover(i.recover);continue}}i.deleted&&(r=!0),e=i.pos}return n?e:new X_(e,r)},Z_.prototype=Object.create(Error.prototype),Z_.prototype.constructor=Z_,Z_.prototype.name="TransformError";var eP=function(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Q_},tP={before:{configurable:!0},docChanged:{configurable:!0}};function nP(){throw new Error("Override me")}tP.before.get=function(){return this.docs.length?this.docs[0]:this.doc},eP.prototype.step=function(e){var t=this.maybeStep(e);if(t.failed)throw new Z_(t.failed);return this},eP.prototype.maybeStep=function(e){var t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t},tP.docChanged.get=function(){return this.steps.length>0},eP.prototype.addStep=function(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t},Object.defineProperties(eP.prototype,tP);var rP=Object.create(null),oP=function(){};oP.prototype.apply=function(e){return nP()},oP.prototype.getMap=function(){return J_.empty},oP.prototype.invert=function(e){return nP()},oP.prototype.map=function(e){return nP()},oP.prototype.merge=function(e){return null},oP.prototype.toJSON=function(){return nP()},oP.fromJSON=function(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");var n=rP[t.stepType];if(!n)throw new RangeError("No step type "+t.stepType+" defined");return n.fromJSON(e,t)},oP.jsonID=function(e,t){if(e in rP)throw new RangeError("Duplicate use of step JSON ID "+e);return rP[e]=t,t.prototype.jsonID=e,t};var iP=function(e,t){this.doc=e,this.failed=t};iP.ok=function(e){return new iP(e,null)},iP.fail=function(e){return new iP(null,e)},iP.fromReplace=function(e,t,n,r){try{return iP.ok(e.replace(t,n,r))}catch(e){if(e instanceof e_)return iP.fail(e.message);throw e}};var aP=function(e){function t(t,n,r,o){e.call(this),this.from=t,this.to=n,this.slice=r,this.structure=!!o}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){return this.structure&&uP(e,this.from,this.to)?iP.fail("Structure replace would overwrite content"):iP.fromReplace(e,this.from,this.to,this.slice)},t.prototype.getMap=function(){return new J_([this.from,this.to-this.from,this.slice.size])},t.prototype.invert=function(e){return new t(this.from,this.from+this.slice.size,e.slice(this.from,this.to))},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted?null:new t(n.pos,Math.max(n.pos,r.pos),this.slice)},t.prototype.merge=function(e){if(!(e instanceof t)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;var n=this.slice.size+e.slice.size==0?t_.empty:new t_(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new t(e.from,this.to,n,this.structure)}var r=this.slice.size+e.slice.size==0?t_.empty:new t_(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new t(this.from,this.to+(e.to-e.from),r,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new t(n.from,n.to,t_.fromJSON(e,n.slice),!!n.structure)},t}(oP);oP.jsonID("replace",aP);var sP=function(e){function t(t,n,r,o,i,a,s){e.call(this),this.from=t,this.to=n,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=a,this.structure=!!s}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){if(this.structure&&(uP(e,this.from,this.gapFrom)||uP(e,this.gapTo,this.to)))return iP.fail("Structure gap-replace would overwrite content");var t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return iP.fail("Gap is not a flat range");var n=this.slice.insertAt(this.insert,t.content);return n?iP.fromReplace(e,this.from,this.to,n):iP.fail("Content does not fit in gap")},t.prototype.getMap=function(){return new J_([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])},t.prototype.invert=function(e){var n=this.gapTo-this.gapFrom;return new t(this.from,this.from+this.slice.size+n,this.from+this.insert,this.from+this.insert+n,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=e.map(this.gapFrom,-1),i=e.map(this.gapTo,1);return n.deleted&&r.deleted||o<n.pos||i>r.pos?null:new t(n.pos,r.pos,o,i,this.slice,this.insert,this.structure)},t.prototype.toJSON=function(){var e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to||"number"!=typeof n.gapFrom||"number"!=typeof n.gapTo||"number"!=typeof n.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new t(n.from,n.to,n.gapFrom,n.gapTo,t_.fromJSON(e,n.slice),n.insert,!!n.structure)},t}(oP);function uP(e,t,n){for(var r=e.resolve(t),o=n-t,i=r.depth;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0)for(var a=r.node(i).maybeChild(r.indexAfter(i));o>0;){if(!a||a.isLeaf)return!0;a=a.firstChild,o--}return!1}function cP(e,t,n){for(var r=[],o=0;o<e.childCount;o++){var i=e.child(o);i.content.size&&(i=i.copy(cP(i.content,t,i))),i.isInline&&(i=t(i,n,o)),r.push(i)}return KI.fromArray(r)}oP.jsonID("replaceAround",sP),eP.prototype.lift=function(e,t){for(var n=e.$from,r=e.$to,o=e.depth,i=n.before(o+1),a=r.after(o+1),s=i,u=a,c=KI.empty,l=0,f=o,h=!1;f>t;f--)h||n.index(f)>0?(h=!0,c=KI.from(n.node(f).copy(c)),l++):s--;for(var p=KI.empty,d=0,m=o,v=!1;m>t;m--)v||r.after(m+1)<r.end(m)?(v=!0,p=KI.from(r.node(m).copy(p)),d++):u++;return this.step(new sP(s,u,i,a,new t_(c.append(p),l,d),c.size-l,!0))},eP.prototype.wrap=function(e,t){for(var n=KI.empty,r=t.length-1;r>=0;r--)n=KI.from(t[r].type.create(t[r].attrs,n));var o=e.start,i=e.end;return this.step(new sP(o,i,o,i,new t_(n,0,0),t.length,!0))},eP.prototype.setBlockType=function(e,t,n,r){var o=this;if(void 0===t&&(t=e),!n.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");var i=this.steps.length;return this.doc.nodesBetween(e,t,(function(e,t){if(e.isTextblock&&!e.hasMarkup(n,r)&&function(e,t,n){var r=e.resolve(t),o=r.index();return r.parent.canReplaceWith(o,o+1,n)}(o.doc,o.mapping.slice(i).map(t),n)){o.clearIncompatible(o.mapping.slice(i).map(t,1),n);var a=o.mapping.slice(i),s=a.map(t,1),u=a.map(t+e.nodeSize,1);return o.step(new sP(s,u,s+1,u-1,new t_(KI.from(n.create(r,null,e.marks)),0,0),1,!0)),!1}})),this},eP.prototype.setNodeMarkup=function(e,t,n,r){var o=this.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);var i=t.create(n,null,r||o.marks);if(o.isLeaf)return this.replaceWith(e,e+o.nodeSize,i);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);return this.step(new sP(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new t_(KI.from(i),0,0),1,!0))},eP.prototype.split=function(e,t,n){void 0===t&&(t=1);for(var r=this.doc.resolve(e),o=KI.empty,i=KI.empty,a=r.depth,s=r.depth-t,u=t-1;a>s;a--,u--){o=KI.from(r.node(a).copy(o));var c=n&&n[u];i=KI.from(c?c.type.create(c.attrs,i):r.node(a).copy(i))}return this.step(new aP(e,e,new t_(o.append(i),t,t),!0))},eP.prototype.join=function(e,t){void 0===t&&(t=1);var n=new aP(e-t,e+t,t_.empty,!0);return this.step(n)};var lP=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new t_(cP(n.content,(function(e,n){return e.isAtom&&n.type.allowsMarkType(t.mark.type)?e.mark(t.mark.addToSet(e.marks)):e}),o),n.openStart,n.openEnd);return iP.fromReplace(e,this.from,this.to,i)},t.prototype.invert=function(){return new fP(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(oP);oP.jsonID("addMark",lP);var fP=function(e){function t(t,n,r){e.call(this),this.from=t,this.to=n,this.mark=r}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.apply=function(e){var t=this,n=e.slice(this.from,this.to),r=new t_(cP(n.content,(function(e){return e.mark(t.mark.removeFromSet(e.marks))})),n.openStart,n.openEnd);return iP.fromReplace(e,this.from,this.to,r)},t.prototype.invert=function(){return new lP(this.from,this.to,this.mark)},t.prototype.map=function(e){var n=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return n.deleted&&r.deleted||n.pos>=r.pos?null:new t(n.pos,r.pos,this.mark)},t.prototype.merge=function(e){if(e instanceof t&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from)return new t(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark)},t.prototype.toJSON=function(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}},t.fromJSON=function(e,n){if("number"!=typeof n.from||"number"!=typeof n.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new t(n.from,n.to,e.markFromJSON(n.mark))},t}(oP);function hP(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}oP.jsonID("removeMark",fP),eP.prototype.addMark=function(e,t,n){var r=this,o=[],i=[],a=null,s=null;return this.doc.nodesBetween(e,t,(function(r,u,c){if(r.isInline){var l=r.marks;if(!n.isInSet(l)&&c.type.allowsMarkType(n.type)){for(var f=Math.max(u,e),h=Math.min(u+r.nodeSize,t),p=n.addToSet(l),d=0;d<l.length;d++)l[d].isInSet(p)||(a&&a.to==f&&a.mark.eq(l[d])?a.to=h:o.push(a=new fP(f,h,l[d])));s&&s.to==f?s.to=h:i.push(s=new lP(f,h,n))}}})),o.forEach((function(e){return r.step(e)})),i.forEach((function(e){return r.step(e)})),this},eP.prototype.removeMark=function(e,t,n){var r=this;void 0===n&&(n=null);var o=[],i=0;return this.doc.nodesBetween(e,t,(function(r,a){if(r.isInline){i++;var s=null;if(n instanceof U_)for(var u,c=r.marks;u=n.isInSet(c);)(s||(s=[])).push(u),c=u.removeFromSet(c);else n?n.isInSet(r.marks)&&(s=[n]):s=r.marks;if(s&&s.length)for(var l=Math.min(a+r.nodeSize,t),f=0;f<s.length;f++){for(var h=s[f],p=void 0,d=0;d<o.length;d++){var m=o[d];m.step==i-1&&h.eq(o[d].style)&&(p=m)}p?(p.to=l,p.step=i):o.push({style:h,from:Math.max(a,e),to:l,step:i})}}})),o.forEach((function(e){return r.step(new fP(e.from,e.to,e.style))})),this},eP.prototype.clearIncompatible=function(e,t,n){void 0===n&&(n=t.contentMatch);for(var r=this.doc.nodeAt(e),o=[],i=e+1,a=0;a<r.childCount;a++){var s=r.child(a),u=i+s.nodeSize,c=n.matchType(s.type,s.attrs);if(c){n=c;for(var l=0;l<s.marks.length;l++)t.allowsMarkType(s.marks[l].type)||this.step(new fP(i,u,s.marks[l]))}else o.push(new aP(i,u,t_.empty));i=u}if(!n.validEnd){var f=n.fillBefore(KI.empty,!0);this.replace(i,i,new t_(f,0,0))}for(var h=o.length-1;h>=0;h--)this.step(o[h]);return this},eP.prototype.replace=function(e,t,n){void 0===t&&(t=e),void 0===n&&(n=t_.empty);var r=function(e,t,n,r){if(void 0===n&&(n=t),void 0===r&&(r=t_.empty),t==n&&!r.size)return null;var o=e.resolve(t),i=e.resolve(n);return hP(o,i,r)?new aP(t,n,r):new pP(o,i,r).fit()}(this.doc,e,t,n);return r&&this.step(r),this},eP.prototype.replaceWith=function(e,t,n){return this.replace(e,t,new t_(KI.from(n),0,0))},eP.prototype.delete=function(e,t){return this.replace(e,t,t_.empty)},eP.prototype.insert=function(e,t){return this.replaceWith(e,e,t)};var pP=function(e,t,n){this.$to=t,this.$from=e,this.unplaced=n,this.frontier=[];for(var r=0;r<=e.depth;r++){var o=e.node(r);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(r))})}this.placed=KI.empty;for(var i=e.depth;i>0;i--)this.placed=KI.from(e.node(i).copy(this.placed))},dP={depth:{configurable:!0}};function mP(e,t,n){return 0==t?e.cutByIndex(n):e.replaceChild(0,e.firstChild.copy(mP(e.firstChild.content,t-1,n)))}function vP(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(vP(e.lastChild.content,t-1,n)))}function yP(e,t){for(var n=0;n<t;n++)e=e.firstChild.content;return e}function gP(e,t,n){if(t<=0)return e;var r=e.content;return t>1&&(r=r.replaceChild(0,gP(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(KI.empty,!0)))),e.copy(r)}function bP(e,t,n,r,o){var i=e.node(t),a=o?e.indexAfter(t):e.index(t);if(a==i.childCount&&!n.compatibleContent(i.type))return null;var s=r.fillBefore(i.content,!0,a);return s&&!function(e,t,n){for(var r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,i.content,a)?s:null}function EP(e,t,n,r,o){if(t<n){var i=e.firstChild;e=e.replaceChild(0,i.copy(EP(i.content,t+1,n,r,i)))}if(t>r){var a=o.contentMatchAt(0),s=a.fillBefore(e).append(e);e=s.append(a.matchFragment(s).fillBefore(KI.empty,!0))}return e}function wP(e,t){for(var n=[],r=Math.min(e.depth,t.depth);r>=0;r--){var o=e.start(r);if(o<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;o==t.start(r)&&n.push(r)}return n}dP.depth.get=function(){return this.frontier.length-1},pP.prototype.fit=function(){for(;this.unplaced.size;){var e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}var t=this.mustMoveInline(),n=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(t<0?this.$to:r.doc.resolve(t));if(!o)return null;for(var i=this.placed,a=r.depth,s=o.depth;a&&s&&1==i.childCount;)i=i.firstChild.content,a--,s--;var u=new t_(i,a,s);return t>-1?new sP(r.pos,t,this.$to.pos,this.$to.end(),u,n):u.size||r.pos!=this.$to.pos?new aP(r.pos,o.pos,u):void 0},pP.prototype.findFittable=function(){for(var e=1;e<=2;e++)for(var t=this.unplaced.openStart;t>=0;t--)for(var n=void 0,r=(t?(n=yP(this.unplaced.content,t-1).firstChild).content:this.unplaced.content).firstChild,o=this.depth;o>=0;o--){var i=this.frontier[o],a=i.type,s=i.match,u=void 0,c=void 0;if(1==e&&(r?s.matchType(r.type)||(c=s.fillBefore(KI.from(r),!1)):a.compatibleContent(n.type)))return{sliceDepth:t,frontierDepth:o,parent:n,inject:c};if(2==e&&r&&(u=s.findWrapping(r.type)))return{sliceDepth:t,frontierDepth:o,parent:n,wrap:u};if(n&&s.matchType(n.type))break}},pP.prototype.openMore=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=yP(t,n);return!(!o.childCount||o.firstChild.isLeaf)&&(this.unplaced=new t_(t,n+1,Math.max(r,o.size+n>=t.size-r?n+1:0)),!0)},pP.prototype.dropNode=function(){var e=this.unplaced,t=e.content,n=e.openStart,r=e.openEnd,o=yP(t,n);if(o.childCount<=1&&n>0){var i=t.size-n<=n+o.size;this.unplaced=new t_(mP(t,n-1,1),n-1,i?n-1:r)}else this.unplaced=new t_(mP(t,n,1),n,r)},pP.prototype.placeNodes=function(e){for(var t=e.sliceDepth,n=e.frontierDepth,r=e.parent,o=e.inject,i=e.wrap;this.depth>n;)this.closeFrontierNode();if(i)for(var a=0;a<i.length;a++)this.openFrontierNode(i[a]);var s=this.unplaced,u=r?r.content:s.content,c=s.openStart-t,l=0,f=[],h=this.frontier[n],p=h.match,d=h.type;if(o){for(var m=0;m<o.childCount;m++)f.push(o.child(m));p=p.matchFragment(o)}for(var v=u.size+t-(s.content.size-s.openEnd);l<u.childCount;){var y=u.child(l),g=p.matchType(y.type);if(!g)break;(++l>1||0==c||y.content.size)&&(p=g,f.push(gP(y.mark(d.allowedMarks(y.marks)),1==l?c:0,l==u.childCount?v:-1)))}var b=l==u.childCount;b||(v=-1),this.placed=vP(this.placed,n,KI.from(f)),this.frontier[n].match=p,b&&v<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(var E=0,w=u;E<v;E++){var S=w.lastChild;this.frontier.push({type:S.type,match:S.contentMatchAt(S.childCount)}),w=S.content}this.unplaced=b?0==t?t_.empty:new t_(mP(s.content,t-1,1),t-1,v<0?s.openEnd:t-1):new t_(mP(s.content,t,l),s.openStart,s.openEnd)},pP.prototype.mustMoveInline=function(){if(!this.$to.parent.isTextblock||this.$to.end()==this.$to.pos)return-1;var e,t=this.frontier[this.depth];if(!t.type.isTextblock||!bP(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;for(var n=this.$to.depth,r=this.$to.after(n);n>1&&r==this.$to.end(--n);)++r;return r},pP.prototype.findCloseLevel=function(e){e:for(var t=Math.min(this.depth,e.depth);t>=0;t--){var n=this.frontier[t],r=n.match,o=n.type,i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),a=bP(e,t,o,r,i);if(a){for(var s=t-1;s>=0;s--){var u=this.frontier[s],c=u.match,l=bP(e,s,u.type,c,!0);if(!l||l.childCount)continue e}return{depth:t,fit:a,move:i?e.doc.resolve(e.after(t+1)):e}}}},pP.prototype.close=function(e){var t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=vP(this.placed,t.depth,t.fit)),e=t.move;for(var n=t.depth+1;n<=e.depth;n++){var r=e.node(n),o=r.type.contentMatch.fillBefore(r.content,!0,e.index(n));this.openFrontierNode(r.type,r.attrs,o)}return e},pP.prototype.openFrontierNode=function(e,t,n){var r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=vP(this.placed,this.depth,KI.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})},pP.prototype.closeFrontierNode=function(){var e=this.frontier.pop().match.fillBefore(KI.empty,!0);e.childCount&&(this.placed=vP(this.placed,this.frontier.length,e))},Object.defineProperties(pP.prototype,dP),eP.prototype.replaceRange=function(e,t,n){if(!n.size)return this.deleteRange(e,t);var r=this.doc.resolve(e),o=this.doc.resolve(t);if(hP(r,o,n))return this.step(new aP(e,t,n));var i=wP(r,this.doc.resolve(t));0==i[i.length-1]&&i.pop();var a=-(r.depth+1);i.unshift(a);for(var s=r.depth,u=r.pos-1;s>0;s--,u--){var c=r.node(s).type.spec;if(c.defining||c.isolating)break;i.indexOf(s)>-1?a=s:r.before(s)==u&&i.splice(1,0,-s)}for(var l=i.indexOf(a),f=[],h=n.openStart,p=n.content,d=0;;d++){var m=p.firstChild;if(f.push(m),d==n.openStart)break;p=m.content}h>0&&f[h-1].type.spec.defining&&r.node(l).type!=f[h-1].type?h-=1:h>=2&&f[h-1].isTextblock&&f[h-2].type.spec.defining&&r.node(l).type!=f[h-2].type&&(h-=2);for(var v=n.openStart;v>=0;v--){var y=(v+h+1)%(n.openStart+1),g=f[y];if(g)for(var b=0;b<i.length;b++){var E=i[(b+l)%i.length],w=!0;E<0&&(w=!1,E=-E);var S=r.node(E-1),T=r.index(E-1);if(S.canReplaceWith(T,T,g.type,g.marks))return this.replace(r.before(E),w?o.after(E):t,new t_(EP(n.content,0,n.openStart,y),y,n.openEnd))}}for(var O=this.steps.length,R=i.length-1;R>=0&&(this.replace(e,t,n),!(this.steps.length>O));R--){var N=i[R];N<0||(e=r.before(N),t=o.after(N))}return this},eP.prototype.replaceRangeWith=function(e,t,n){if(!n.isInline&&e==t&&this.doc.resolve(e).parent.content.size){var r=function(e,t,n){var r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(var o=r.depth-1;o>=0;o--){var i=r.index(o);if(r.node(o).canReplaceWith(i,i,n))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(var a=r.depth-1;a>=0;a--){var s=r.indexAfter(a);if(r.node(a).canReplaceWith(s,s,n))return r.after(a+1);if(s<r.node(a).childCount)return null}}(this.doc,e,n.type);null!=r&&(e=t=r)}return this.replaceRange(e,t,new t_(KI.from(n),0,0))},eP.prototype.deleteRange=function(e,t){for(var n=this.doc.resolve(e),r=this.doc.resolve(t),o=wP(n,r),i=0;i<o.length;i++){var a=o[i],s=i==o.length-1;if(s&&0==a||n.node(a).type.contentMatch.validEnd)return this.delete(n.start(a),r.end(a));if(a>0&&(s||n.node(a-1).canReplace(n.index(a-1),r.indexAfter(a-1))))return this.delete(n.before(a),r.after(a))}for(var u=1;u<=n.depth&&u<=r.depth;u++)if(e-n.start(u)==n.depth-u&&t>n.end(u)&&r.end(u)-t!=r.depth-u)return this.delete(n.before(u),t);return this.delete(e,t)};var SP=Object.create(null),TP=function(e,t,n){this.ranges=n||[new RP(e.min(t),e.max(t))],this.$anchor=e,this.$head=t},OP={anchor:{configurable:!0},head:{configurable:!0},from:{configurable:!0},to:{configurable:!0},$from:{configurable:!0},$to:{configurable:!0},empty:{configurable:!0}};OP.anchor.get=function(){return this.$anchor.pos},OP.head.get=function(){return this.$head.pos},OP.from.get=function(){return this.$from.pos},OP.to.get=function(){return this.$to.pos},OP.$from.get=function(){return this.ranges[0].$from},OP.$to.get=function(){return this.ranges[0].$to},OP.empty.get=function(){for(var e=this.ranges,t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0},TP.prototype.content=function(){return this.$from.node(0).slice(this.from,this.to,!0)},TP.prototype.replace=function(e,t){void 0===t&&(t=t_.empty);for(var n=t.content.lastChild,r=null,o=0;o<t.openEnd;o++)r=n,n=n.lastChild;for(var i=e.steps.length,a=this.ranges,s=0;s<a.length;s++){var u=a[s],c=u.$from,l=u.$to,f=e.mapping.slice(i);e.replaceRange(f.map(c.pos),f.map(l.pos),s?t_.empty:t),0==s&&_P(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}},TP.prototype.replaceWith=function(e,t){for(var n=e.steps.length,r=this.ranges,o=0;o<r.length;o++){var i=r[o],a=i.$from,s=i.$to,u=e.mapping.slice(n),c=u.map(a.pos),l=u.map(s.pos);o?e.deleteRange(c,l):(e.replaceRangeWith(c,l,t),_P(e,n,t.isInline?-1:1))}},TP.findFrom=function(e,t,n){var r=e.parent.inlineContent?new NP(e):IP(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(var o=e.depth-1;o>=0;o--){var i=t<0?IP(e.node(0),e.node(o),e.before(o+1),e.index(o),t,n):IP(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,n);if(i)return i}},TP.near=function(e,t){return void 0===t&&(t=1),this.findFrom(e,t)||this.findFrom(e,-t)||new MP(e.node(0))},TP.atStart=function(e){return IP(e,e,0,0,1)||new MP(e)},TP.atEnd=function(e){return IP(e,e,e.content.size,e.childCount,-1)||new MP(e)},TP.fromJSON=function(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");var n=SP[t.type];if(!n)throw new RangeError("No selection type "+t.type+" defined");return n.fromJSON(e,t)},TP.jsonID=function(e,t){if(e in SP)throw new RangeError("Duplicate use of selection JSON ID "+e);return SP[e]=t,t.prototype.jsonID=e,t},TP.prototype.getBookmark=function(){return NP.between(this.$anchor,this.$head).getBookmark()},Object.defineProperties(TP.prototype,OP),TP.prototype.visible=!0;var RP=function(e,t){this.$from=e,this.$to=t},NP=function(e){function t(t,n){void 0===n&&(n=t),e.call(this,t,n)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={$cursor:{configurable:!0}};return n.$cursor.get=function(){return this.$anchor.pos==this.$head.pos?this.$head:null},t.prototype.map=function(n,r){var o=n.resolve(r.map(this.head));if(!o.parent.inlineContent)return e.near(o);var i=n.resolve(r.map(this.anchor));return new t(i.parent.inlineContent?i:o,o)},t.prototype.replace=function(t,n){if(void 0===n&&(n=t_.empty),e.prototype.replace.call(this,t,n),n==t_.empty){var r=this.$from.marksAcross(this.$to);r&&t.ensureMarks(r)}},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor&&e.head==this.head},t.prototype.getBookmark=function(){return new kP(this.anchor,this.head)},t.prototype.toJSON=function(){return{type:"text",anchor:this.anchor,head:this.head}},t.fromJSON=function(e,n){if("number"!=typeof n.anchor||"number"!=typeof n.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new t(e.resolve(n.anchor),e.resolve(n.head))},t.create=function(e,t,n){void 0===n&&(n=t);var r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))},t.between=function(n,r,o){var i=n.pos-r.pos;if(o&&!i||(o=i>=0?1:-1),!r.parent.inlineContent){var a=e.findFrom(r,o,!0)||e.findFrom(r,-o,!0);if(!a)return e.near(r,o);r=a.$head}return n.parent.inlineContent||(0==i||(n=(e.findFrom(n,-o,!0)||e.findFrom(n,o,!0)).$anchor).pos<r.pos!=i<0)&&(n=r),new t(n,r)},Object.defineProperties(t.prototype,n),t}(TP);TP.jsonID("text",NP);var kP=function(e,t){this.anchor=e,this.head=t};kP.prototype.map=function(e){return new kP(e.map(this.anchor),e.map(this.head))},kP.prototype.resolve=function(e){return NP.between(e.resolve(this.anchor),e.resolve(this.head))};var AP=function(e){function t(t){var n=t.nodeAfter,r=t.node(0).resolve(t.pos+n.nodeSize);e.call(this,t,r),this.node=n}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.map=function(n,r){var o=r.mapResult(this.anchor),i=o.deleted,a=o.pos,s=n.resolve(a);return i?e.near(s):new t(s)},t.prototype.content=function(){return new t_(KI.from(this.node),0,0)},t.prototype.eq=function(e){return e instanceof t&&e.anchor==this.anchor},t.prototype.toJSON=function(){return{type:"node",anchor:this.anchor}},t.prototype.getBookmark=function(){return new CP(this.anchor)},t.fromJSON=function(e,n){if("number"!=typeof n.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new t(e.resolve(n.anchor))},t.create=function(e,t){return new this(e.resolve(t))},t.isSelectable=function(e){return!e.isText&&!1!==e.type.spec.selectable},t}(TP);AP.prototype.visible=!1,TP.jsonID("node",AP);var CP=function(e){this.anchor=e};CP.prototype.map=function(e){var t=e.mapResult(this.anchor),n=t.deleted,r=t.pos;return n?new kP(r,r):new CP(r)},CP.prototype.resolve=function(e){var t=e.resolve(this.anchor),n=t.nodeAfter;return n&&AP.isSelectable(n)?new AP(t):TP.near(t)};var MP=function(e){function t(t){e.call(this,t.resolve(0),t.resolve(t.content.size))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.replace=function(t,n){if(void 0===n&&(n=t_.empty),n==t_.empty){t.delete(0,t.doc.content.size);var r=e.atStart(t.doc);r.eq(t.selection)||t.setSelection(r)}else e.prototype.replace.call(this,t,n)},t.prototype.toJSON=function(){return{type:"all"}},t.fromJSON=function(e){return new t(e)},t.prototype.map=function(e){return new t(e)},t.prototype.eq=function(e){return e instanceof t},t.prototype.getBookmark=function(){return xP},t}(TP);TP.jsonID("all",MP);var xP={map:function(){return this},resolve:function(e){return new MP(e)}};function IP(e,t,n,r,o,i){if(t.inlineContent)return NP.create(e,n);for(var a=r-(o>0?0:1);o>0?a<t.childCount:a>=0;a+=o){var s=t.child(a);if(s.isAtom){if(!i&&AP.isSelectable(s))return AP.create(e,n-(o<0?s.nodeSize:0))}else{var u=IP(e,s,n+o,o<0?s.childCount:0,o,i);if(u)return u}n+=s.nodeSize*o}}function _P(e,t,n){var r=e.steps.length-1;if(!(r<t)){var o,i=e.steps[r];if(i instanceof aP||i instanceof sP)e.mapping.maps[r].forEach((function(e,t,n,r){null==o&&(o=r)})),e.setSelection(TP.near(e.doc.resolve(o),n))}}var PP=function(e){function t(t){e.call(this,t.doc),this.time=Date.now(),this.curSelection=t.selection,this.curSelectionFor=0,this.storedMarks=t.storedMarks,this.updated=0,this.meta=Object.create(null)}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={selection:{configurable:!0},selectionSet:{configurable:!0},storedMarksSet:{configurable:!0},isGeneric:{configurable:!0},scrolledIntoView:{configurable:!0}};return n.selection.get=function(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection},t.prototype.setSelection=function(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this},n.selectionSet.get=function(){return(1&this.updated)>0},t.prototype.setStoredMarks=function(e){return this.storedMarks=e,this.updated|=2,this},t.prototype.ensureMarks=function(e){return ZI.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this},t.prototype.addStoredMark=function(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))},t.prototype.removeStoredMark=function(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))},n.storedMarksSet.get=function(){return(2&this.updated)>0},t.prototype.addStep=function(t,n){e.prototype.addStep.call(this,t,n),this.updated=-3&this.updated,this.storedMarks=null},t.prototype.setTime=function(e){return this.time=e,this},t.prototype.replaceSelection=function(e){return this.selection.replace(this,e),this},t.prototype.replaceSelectionWith=function(e,t){var n=this.selection;return!1!==t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||ZI.none))),n.replaceWith(this,e),this},t.prototype.deleteSelection=function(){return this.selection.replace(this),this},t.prototype.insertText=function(e,t,n){void 0===n&&(n=t);var r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();if(!e)return this.deleteRange(t,n);var o=this.storedMarks;if(!o){var i=this.doc.resolve(t);o=n==t?i.marks():i.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,o)),this.selection.empty||this.setSelection(TP.near(this.selection.$to)),this},t.prototype.setMeta=function(e,t){return this.meta["string"==typeof e?e:e.key]=t,this},t.prototype.getMeta=function(e){return this.meta["string"==typeof e?e:e.key]},n.isGeneric.get=function(){for(var e in this.meta)return!1;return!0},t.prototype.scrollIntoView=function(){return this.updated|=4,this},n.scrolledIntoView.get=function(){return(4&this.updated)>0},Object.defineProperties(t.prototype,n),t}(eP);function LP(e,t){return t&&e?e.bind(t):e}var FP=function(e,t,n){this.name=e,this.init=LP(t.init,n),this.apply=LP(t.apply,n)},DP=[new FP("doc",{init:function(e){return e.doc||e.schema.topNodeType.createAndFill()},apply:function(e){return e.doc}}),new FP("selection",{init:function(e,t){return e.selection||TP.atStart(t.doc)},apply:function(e){return e.selection}}),new FP("storedMarks",{init:function(e){return e.storedMarks||null},apply:function(e,t,n,r){return r.selection.$cursor?e.storedMarks:null}}),new FP("scrollToSelection",{init:function(){return 0},apply:function(e,t){return e.scrolledIntoView?t+1:t}})],UP=function(e,t){var n=this;this.schema=e,this.fields=DP.concat(),this.plugins=[],this.pluginsByKey=Object.create(null),t&&t.forEach((function(e){if(n.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");n.plugins.push(e),n.pluginsByKey[e.key]=e,e.spec.state&&n.fields.push(new FP(e.key,e.spec.state,e))}))},jP=function(e){this.config=e},BP={schema:{configurable:!0},plugins:{configurable:!0},tr:{configurable:!0}};BP.schema.get=function(){return this.config.schema},BP.plugins.get=function(){return this.config.plugins},jP.prototype.apply=function(e){return this.applyTransaction(e).state},jP.prototype.filterTransaction=function(e,t){void 0===t&&(t=-1);for(var n=0;n<this.config.plugins.length;n++)if(n!=t){var r=this.config.plugins[n];if(r.spec.filterTransaction&&!r.spec.filterTransaction.call(r,e,this))return!1}return!0},jP.prototype.applyTransaction=function(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};for(var t=[e],n=this.applyInner(e),r=null;;){for(var o=!1,i=0;i<this.config.plugins.length;i++){var a=this.config.plugins[i];if(a.spec.appendTransaction){var s=r?r[i].n:0,u=r?r[i].state:this,c=s<t.length&&a.spec.appendTransaction.call(a,s?t.slice(s):t,u,n);if(c&&n.filterTransaction(c,i)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(var l=0;l<this.config.plugins.length;l++)r.push(l<i?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),o=!0}r&&(r[i]={state:n,n:t.length})}}if(!o)return{state:n,transactions:t}}},jP.prototype.applyInner=function(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");for(var t=new jP(this.config),n=this.config.fields,r=0;r<n.length;r++){var o=n[r];t[o.name]=o.apply(e,this[o.name],this,t)}for(var i=0;i<VP.length;i++)VP[i](this,e,t);return t},BP.tr.get=function(){return new PP(this)},jP.create=function(e){for(var t=new UP(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new jP(t),r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n},jP.prototype.reconfigure=function(e){for(var t=new UP(this.schema,e.plugins),n=t.fields,r=new jP(t),o=0;o<n.length;o++){var i=n[o].name;r[i]=this.hasOwnProperty(i)?this[i]:n[o].init(e,r)}return r},jP.prototype.toJSON=function(e){var t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map((function(e){return e.toJSON()}))),e&&"object"==typeof e)for(var n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");var r=e[n],o=r.spec.state;o&&o.toJSON&&(t[n]=o.toJSON.call(r,this[r.key]))}return t},jP.fromJSON=function(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");var r=new UP(e.schema,e.plugins),o=new jP(r);return r.fields.forEach((function(r){if("doc"==r.name)o.doc=g_.fromJSON(e.schema,t.doc);else if("selection"==r.name)o.selection=TP.fromJSON(o.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(var i in n){var a=n[i],s=a.spec.state;if(a.key==r.name&&s&&s.fromJSON&&Object.prototype.hasOwnProperty.call(t,i))return void(o[r.name]=s.fromJSON.call(a,e,t[i],o))}o[r.name]=r.init(e,o)}})),o},jP.addApplyListener=function(e){VP.push(e)},jP.removeApplyListener=function(e){var t=VP.indexOf(e);t>-1&&VP.splice(t,1)},Object.defineProperties(jP.prototype,BP);var VP=[];function HP(e,t){return t?e.createChecked(null,t):e.createAndFill()}function GP(e,t,n,r,o){const i=function(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(n=>{const r=e.nodes[n];r.spec.tableRole&&(t[r.spec.tableRole]=r)}),e.cached.tableNodeTypes=t,t}(e),a=[],s=[];for(let e=0;e<n;e+=1){const e=HP(i.cell,o);if(e&&s.push(e),r){const e=HP(i.header_cell,o);e&&a.push(e)}}const u=[];for(let e=0;e<t;e+=1)u.push(i.row.createChecked(null,r&&0===e?a:s));return i.table.createChecked(null,u)}const zP=({editor:e})=>{const{selection:t}=e.state;if(!(t instanceof rI))return!1;let n=0;const r=fA(t.ranges[0].$from,e=>"table"===e.type.name);null==r||r.node.descendants(e=>{if("table"===e.type.name)return!1;["tableCell","tableHeader"].includes(e.type.name)&&(n+=1)});return n===t.ranges.length&&(e.commands.deleteTable(),!0)};function WP(e,t,n,r,o,i){let a=0,s=!0,u=t.firstChild;const c=e.firstChild;for(let e=0,n=0;e<c.childCount;e+=1){const{colspan:l,colwidth:f}=c.child(e).attrs;for(let e=0;e<l;e+=1,n+=1){const c=o===n?i:f&&f[e],l=c?c+"px":"";a+=c||r,c||(s=!1),u?(u.style.width!==l&&(u.style.width=l),u=u.nextSibling):t.appendChild(document.createElement("col")).style.width=l}}for(;u;){const e=u.nextSibling;u.parentNode.removeChild(u),u=e}s?(n.style.width=a+"px",n.style.minWidth=""):(n.style.width="",n.style.minWidth=a+"px")}var $P=AA.create({name:"table",defaultOptions:{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:class{constructor(e,t){this.node=e,this.cellMinWidth=t,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),WP(e,this.colgroup,this.table,t),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(e){return e.type===this.node.type&&(this.node=e,WP(e,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(e){return"attributes"===e.type&&(e.target===this.table||this.colgroup.contains(e.target))}},lastColumnResizable:!0,allowTableNodeSelection:!1},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML:()=>[{tag:"table"}],renderHTML({HTMLAttributes:e}){return["table",ok(this.options.HTMLAttributes,e),["tbody",0]]},addCommands:()=>({insertTable:({rows:e=3,cols:t=3,withHeaderRow:n=!0}={})=>({tr:r,dispatch:o,editor:i})=>{const a=GP(i.schema,e,t,n);if(o){const e=r.selection.anchor+1;r.replaceSelectionWith(a).scrollIntoView().setSelection(NP.near(r.doc.resolve(e)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e);t(RI(e.tr,n,n.left))}return!0}(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e);t(RI(e.tr,n,n.right))}return!0}(e,t),deleteColumn:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e),r=e.tr;if(0==n.left&&n.right==n.map.width)return!1;for(var o=n.right-1;NI(r,n,o),o!=n.left;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=zx.get(n.table);t(r)}return!0}(e,t),addRowBefore:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e);t(kI(e.tr,n,n.top))}return!0}(e,t),addRowAfter:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e);t(kI(e.tr,n,n.bottom))}return!0}(e,t),deleteRow:()=>({state:e,dispatch:t})=>function(e,t){if(!qx(e))return!1;if(t){var n=OI(e),r=e.tr;if(0==n.top&&n.bottom==n.map.height)return!1;for(var o=n.bottom-1;AI(r,n,o),o!=n.top;o--)n.table=n.tableStart?r.doc.nodeAt(n.tableStart-1):r.doc,n.map=zx.get(n.table);t(r)}return!0}(e,t),deleteTable:()=>({state:e,dispatch:t})=>function(e,t){for(var n=e.selection.$anchor,r=n.depth;r>0;r--){if("table"==n.node(r).type.spec.tableRole)return t&&t(e.tr.delete(n.before(r),n.after(r)).scrollIntoView()),!0}return!1}(e,t),mergeCells:()=>({state:e,dispatch:t})=>MI(e,t),splitCell:()=>({state:e,dispatch:t})=>xI(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>LI(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>PI(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>FI(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>!!MI(e,t)||xI(e,t),setCellAttribute:(e,t)=>({state:n,dispatch:r})=>function(e,t){return function(n,r){if(!qx(n))return!1;var o=Xx(n);if(o.nodeAfter.attrs[e]===t)return!1;if(r){var i=n.tr;n.selection instanceof rI?n.selection.forEachCell((function(n,r){n.attrs[e]!==t&&i.setNodeMarkup(r,null,eI(n.attrs,e,t))})):i.setNodeMarkup(o.pos,null,eI(o.nodeAfter.attrs,e,t)),r(i)}return!0}}(e,t)(n,r),goToNextCell:()=>({state:e,dispatch:t})=>DI(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>DI(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&TI(e),!0),setCellSelection:e=>({tr:t,dispatch:n})=>{if(n){const n=rI.create(t.doc,e.anchorCell,e.headCell);t.setSelection(n)}return!0}}),addKeyboardShortcuts(){return{Tab:()=>!!this.editor.commands.goToNextCell()||!!this.editor.can().addRowAfter()&&this.editor.chain().addRowAfter().goToNextCell().run(),"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:zP,"Mod-Backspace":zP,Delete:zP,"Mod-Delete":zP}},addProseMirrorPlugins(){return[...this.options.resizable?[VI({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],YI({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema:e=>({tableRole:sk(tk(e,"tableRole",{name:e.name,options:e.options}))})});var YP=AA.create({name:"tableRow",defaultOptions:{HTMLAttributes:{}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML:()=>[{tag:"tr"}],renderHTML({HTMLAttributes:e}){return["tr",ok(this.options.HTMLAttributes,e),0]}});var KP=AA.create({name:"tableCell",defaultOptions:{HTMLAttributes:{}},content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return{colwidth:t?[parseInt(t,10)]:null}}}}),tableRole:"cell",isolating:!0,parseHTML:()=>[{tag:"td"}],renderHTML({HTMLAttributes:e}){return["td",ok(this.options.HTMLAttributes,e),0]}});var qP=AA.create({name:"tableHeader",defaultOptions:{HTMLAttributes:{}},content:"block+",addAttributes:()=>({colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return{colwidth:t?[parseInt(t,10)]:null}}}}),tableRole:"header_cell",isolating:!0,parseHTML:()=>[{tag:"th"}],renderHTML({HTMLAttributes:e}){return["th",ok(this.options.HTMLAttributes,e),0]}}),XP={props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0},isActive:{type:Function,default:null},isDisabled:{type:Function,default:null}},methods:{onMouseDown:function(e){e.preventDefault(),this.$emit("onMouseDown",!0)}}},JP=n("KHd+"),QP={components:{MenuItem:Object(JP.a)(XP,(function(){var e=this.$createElement,t=this._self._c||e;return t("b-button",{class:{active:this.isActive?this.isActive():null},attrs:{title:this.title,variant:"light",disabled:this.isDisabled},on:{click:this.action,mousedown:this.onMouseDown}},[t("i",{class:"ri-"+this.icon})])}),[],!1,null,null,null).exports},props:{editor:{type:Object,required:!0}},data:function(){var e=this;return{items:[{icon:"bold",title:"Bold",action:function(){return e.editor.chain().focus().toggleBold().run()},isActive:function(){return e.editor.isActive("bold")}},{icon:"italic",title:"Italic",action:function(){return e.editor.chain().focus().toggleItalic().run()},isActive:function(){return e.editor.isActive("italic")}},{icon:"strikethrough",title:"Strike",action:function(){return e.editor.chain().focus().toggleStrike().run()},isActive:function(){return e.editor.isActive("strike")}},{type:"divider"},{icon:"align-left",title:"Left",action:function(){return e.editor.chain().focus().setTextAlign("left").run()},isActive:function(){return e.editor.isActive({textAlign:"left"})}},{icon:"align-center",title:"Center",action:function(){return e.editor.chain().focus().setTextAlign("center").run()},isActive:function(){return e.editor.isActive({textAlign:"center"})}},{icon:"align-right",title:"Right",action:function(){return e.editor.chain().focus().setTextAlign("right").run()},isActive:function(){return e.editor.isActive({textAlign:"right"})}},{icon:"align-justify",title:"Justify",action:function(){return e.editor.chain().focus().setTextAlign("justify").run()},isActive:function(){return e.editor.isActive({textAlign:"justify"})}},{type:"divider"},{icon:"h-1",title:"Heading 1",action:function(){return e.editor.chain().focus().toggleHeading({level:1}).run()},isActive:function(){return e.editor.isActive("heading",{level:1})}},{icon:"h-2",title:"Heading 2",action:function(){return e.editor.chain().focus().toggleHeading({level:2}).run()},isActive:function(){return e.editor.isActive("heading",{level:2})}},{icon:"paragraph",title:"Paragraph",action:function(){return e.editor.chain().focus().setParagraph().run()},isActive:function(){return e.editor.isActive("paragraph")}},{icon:"list-unordered",title:"Bullet List",action:function(){return e.editor.chain().focus().toggleBulletList().run()},isActive:function(){return e.editor.isActive("bulletList")}},{icon:"list-ordered",title:"Ordered List",action:function(){return e.editor.chain().focus().toggleOrderedList().run()},isActive:function(){return e.editor.isActive("orderedList")}},{type:"divider"},{icon:"double-quotes-l",title:"Blockquote",action:function(){return e.editor.chain().focus().toggleBlockquote().run()},isActive:function(){return e.editor.isActive("blockquote")}},{icon:"separator",title:"Horizontal Rule",action:function(){return e.editor.chain().focus().setHorizontalRule().run()}},{type:"divider"},{icon:"text-wrap",title:"Hard Break",action:function(){return e.editor.chain().focus().setHardBreak().run()}},{icon:"format-clear",title:"Clear Format",action:function(){return e.editor.chain().focus().clearNodes().unsetAllMarks().run()}},{type:"divider"},{icon:"arrow-go-back-line",title:"Undo",action:function(){return e.editor.chain().focus().undo().run()}},{icon:"arrow-go-forward-line",title:"Redo",action:function(){return e.editor.chain().focus().redo().run()}},{type:"divider"},{icon:"table-2",title:"Table",action:function(){return e.editor.chain().focus().insertTable({rows:3,cols:3,withHeaderRow:!0}).run()}}]}},methods:{onMouseDown:function(e){e.preventDefault(),console.log("mouse down"),this.$emit("onButtonMouseDown",!0)}}},ZP=(n("wKEM"),{components:{EditorContent:xM,MenuBar:Object(JP.a)(QP,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button-group",{attrs:{size:"sm"}},[e._l(e.items,(function(t,r){return["divider"===t.type?n("div",{key:r,staticClass:"divider"}):n("menu-item",e._b({key:r,on:{onMouseDown:e.onMouseDown}},"menu-item",t,!1))]})),e._v(" "),n("div",{staticClass:"divider"}),e._v(" "),n("b-button",{attrs:{title:"Remove Table",disabled:!e.editor.can().deleteTable(),variant:"light"},on:{click:function(t){e.editor.chain().focus().deleteTable().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-close-circle-line"})]),e._v(" "),n("b-button",{attrs:{title:"Insert column before",disabled:!e.editor.can().addColumnBefore(),variant:"light"},on:{click:function(t){e.editor.chain().focus().addColumnBefore().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-insert-column-left"})]),e._v(" "),n("b-button",{attrs:{title:"Insert column after",disabled:!e.editor.can().addColumnAfter(),variant:"light"},on:{click:function(t){e.editor.chain().focus().addColumnAfter().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-insert-column-right"})]),e._v(" "),n("b-button",{attrs:{title:"Remove column",disabled:!e.editor.can().deleteColumn(),variant:"light"},on:{click:function(t){e.editor.chain().focus().deleteColumn().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-delete-column"})]),e._v(" "),n("b-button",{attrs:{title:"Insert row top",disabled:!e.editor.can().addRowBefore(),variant:"light"},on:{click:function(t){e.editor.chain().focus().addRowBefore().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-insert-row-top"})]),e._v(" "),n("b-button",{attrs:{title:"Insert row bottom",disabled:!e.editor.can().addRowAfter(),variant:"light"},on:{click:function(t){e.editor.chain().focus().addRowAfter().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-insert-row-bottom"})]),e._v(" "),n("b-button",{attrs:{title:"Remove row",disabled:!e.editor.can().deleteRow(),variant:"light"},on:{click:function(t){e.editor.chain().focus().deleteRow().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-delete-row"})]),e._v(" "),n("b-button",{attrs:{title:"Toggle header cell",disabled:!e.editor.can().toggleHeaderCell(),variant:"light"},on:{click:function(t){e.editor.chain().focus().toggleHeaderCell().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-heading"})]),e._v(" "),n("b-button",{attrs:{title:"Merge cells",disabled:!e.editor.can().mergeCells(),variant:"light"},on:{click:function(t){e.editor.chain().focus().mergeCells().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-merge-cells-horizontal"})]),e._v(" "),n("b-button",{attrs:{title:"Split cell",disabled:!e.editor.can().splitCell(),variant:"light"},on:{click:function(t){e.editor.chain().focus().splitCell().run()},mousedown:e.onMouseDown}},[n("i",{staticClass:"ri-split-cells-horizontal"})])],2)],1)}),[],!1,null,"2dc47bf6",null).exports},props:{value:{type:String,default:""}},data:function(){return{editor:null,isOnFocus:!1}},watch:{value:function(e){this.editor.getHTML()===e||this.editor.commands.setContent(this.value,!1)}},mounted:function(){var e=this;this.editor=new MM({extensions:[Fx,$P.configure({resizable:!0}),YP,qP,KP,jx.configure({types:["heading","paragraph"]})],content:this.value,onUpdate:function(){e.$emit("input",e.editor.getHTML())},onFocus:this.editorOnFocus,onBlur:this.editorOnBlur})},methods:{editorOnFocus:function(){this.isOnFocus=!0},editorOnBlur:function(){this.isOnFocus=!1},onButtonMouseDown:function(e){this.isOnFocus=e}},beforeDestroy:function(){this.editor.destroy()}}),eL=(n("8A4j"),Object(JP.a)(ZP,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.editor?n("div",{staticClass:"editor overflow-auto"},[e.isOnFocus?n("menu-bar",{staticClass:"editor__header",attrs:{editor:e.editor},on:{onButtonMouseDown:e.onButtonMouseDown}}):e._e(),e._v(" "),n("editor-content",{staticClass:"editor__content",attrs:{editor:e.editor}})],1):e._e()}),[],!1,null,null,null).exports),tL=n("YADa");function nL(e,t,n,r,o,i,a){try{var s=e[i](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,o)}function rL(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){nL(i,r,o,a,s,"next",e)}function s(e){nL(i,r,o,a,s,"throw",e)}a(void 0)}))}}function oL(e){return function(e){if(Array.isArray(e))return iL(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return iL(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return iL(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function iL(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sL(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?aL(Object(n),!0).forEach((function(t){uL(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):aL(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function uL(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var cL,lL,fL,hL={metaInfo:{title:"Form Draft Memo"},props:["_token","userinfo","notif","breadcrumbItems","dataMemo","formType","errors","dataPosition","dataTotalCost","dataAttachments","headerCost","columnCost","dataMemoType","__store","__updateApprover","__autoSaveItem","__autoSaveItemCost","__updateAcknowledge","__deleteAcknowledge","__preview","__previewpayment","__attachment","__removeAttachment"],components:{Layout:s.a,FlashMsg:u.a,Breadcrumb:c.a,Editor2:eL,draggable:zE.a,CurrencyInput:$E.a,SelectTypeApprover:WE.a,TableEditApprover:tL.a,FormInvoice:l.a},data:function(){var e=this;return{submitState:!1,isAcknowledgebusy:!1,selectedAcknowledge:null,fieldSaving:"",isSaving:!1,form:{},checkPPNInclude:!1,sub_total:0,pph:0,ppn:0,grand_total:0,manualInputPph:!1,form_modal:{name:"",bank_name:"",bank_account:null,amount:0,remark:"",address:""},dataPayments:[],isSubmitBusy:!1,isModalFormBusy:!1,isFormPaymentEdited:!1,activeItemPayment:{},activeIndex:null,url_data_payment:"user.api.payment.datapayments",updateApproverPayment:"user.api.payment.updateapprover",url_approvers:"user.api.memo.approvers",url_approvers_payment:"user.api.payment.approvers",dataApprovers:[],dataCost:null,colHeaders:this.headerCost,hotSettings:{data:[],colHeaders:function(t){return e.colHeaders[t]},height:"auto",width:"100%",startCols:5,startRows:10,minSpareRows:1,rowHeaders:!0,columns:this.columnCost,manualColumnResize:!0,contextMenu:!0,formulas:{engine:cf.buildEmpty({})},licenseKey:"non-commercial-and-evaluation",afterChange:function(){e.dataFormula=e.hotSettings.formulas.engine.getAllSheetsValues(),e.typing("cost")}},fileRecords:[],uploadUrl:"#",uploadHeaders:{"X-Test-Header":"vue-file-agent","X-CSRF-TOKEN":this._token},fileRecordsForUpload:[]}},mounted:function(){if(this.getData(),!_.isNull(this.dataMemo.cost)){var e=this.dataMemo.cost;e=_.toArray(JSON.parse(e)),this.$refs.formCost.hotInstance.loadData(e)}},watch:{sub_total:function(e){e||(e=0),this.ppn=this.checkPPNInclude?0:.1*parseFloat(e),this.pphValueChange(e),this.grand_total=parseFloat(e)+parseFloat(this.ppn)-parseFloat(this.pph)},pph:function(e){e&&this.sub_total||(e=0),this.grand_total=parseFloat(this.sub_total)+parseFloat(this.ppn)-parseFloat(e)},checkPPNInclude:function(e){this.ppn=e?0:.1*parseFloat(this.sub_total),this.grand_total=parseFloat(this.sub_total)+parseFloat(this.ppn)-parseFloat(this.pph),this.debouncedSaveCost()},"form.is_cost_invoice":function(e){e&&(this.sub_total=0,this.pph=0,this.ppn=0,this.grand_total=0,this.checkPPNInclude=0==this.dataTotalCost.ppn&&!0)},dataTotalCost:function(e){this.fillForm()},dataMemo:function(e){this.fillForm()}},created:function(){this.debouncedSave=_.debounce(this.autoSaveItem,3e3),this.debouncedSaveCost=_.debounce(this.autoSaveItemCost,3e3)},methods:{typing:function(e){this.fieldSaving=e,this.debouncedSave()},autoSaveItem:function(){var e=this;this.isSaving=!0;var t={};t=0!=this.dataFormula.Sheet1.length?_.map(this.dataFormula.Sheet1,(function(t){var n={};for(var r in t)n[e.colHeaders[r]]=t[r];return n})):_.map(this.dataFormula.Sheet2,(function(t){var n={};for(var r in t)n[e.colHeaders[r]]=t[r];return n}));var n=_.map(t,(function(t){var n={};if(t=Object.assign({},t),_.map(e.colHeaders,(function(e){n[e]=t[e]})),n=_.pickBy(n,_.identity),!_.isEmpty(n))return n}));n=_.pickBy(n,_.identity),_.isEmpty(n)||(this.form.cost=JSON.stringify(n)),axios.post(route(this.__autoSaveItem,this.dataMemo.id),this.form).then((function(t){e.form.background=t.data.background,e.form.information=t.data.information,e.form.conclusion=t.data.conclusion,e.form.orientation_paper=t.data.orientation_paper,e.form.is_cost_invoice=t.data.is_cost_invoice,e.fieldSaving="",e.isSaving=!1,t.data.status})).catch((function(t){e.pageFlashes.error=t.response.data.errors}))},autoSaveItemCost:function(){var e=this;this.isSaving=!0,this.form.sub_total=this.sub_total,this.form.pph=this.pph,this.form.ppn=this.ppn,this.form.grand_total=this.grand_total,axios.post(route(this.__autoSaveItemCost,this.dataMemo.id),this.form).then((function(t){e.sub_total=t.data.sub_total,e.pph=t.data.pph,e.ppn=t.data.ppn,e.grand_total=t.data.grand_total,e.isSaving=!1,t.data.status})).catch((function(t){e.pageFlashes.error=t.response.data.errors}))},getOptionLabel:function(e){var t=e.employee?e.employee.firstname:"",n=e.employee?e.employee.lastname:"";return e.position.position_name+" - "+t+" "+n},reset:function(){this.sub_total=this.dataTotalCost.sub_total,this.pph=this.dataTotalCost.pph,this.ppn=this.dataTotalCost.ppn,this.grand_total=this.dataTotalCost.grand_total,this.checkPPNInclude=0==this.dataTotalCost.ppn&&!0},pphValueChange:function(e){this.manualInputPph||(this.pph=.02*parseFloat(e)),this.debouncedSaveCost()},uploadFiles:function(){var e=new FormData;_.each(this.fileRecordsForUpload,(function(t,n){e.append("files[".concat(n,"]"),t.file)})),"payment"==this.formType&&e.append("type","payment"),this.$inertia.post(route(this.__attachment,this.dataMemo.id),e,{forceFormData:!0})},deleteUploadedFile:function(e){this.$refs.vueFileAgent.deleteUpload(this.uploadUrl,this.uploadHeaders,e)},filesSelected:function(e){var t=e.filter((function(e){return!e.error}));this.fileRecordsForUpload=this.fileRecordsForUpload.concat(t)},onBeforeDelete:function(e){var t=this.fileRecordsForUpload.indexOf(e);if(-1!==t){this.fileRecordsForUpload.splice(t,1);var n=this.fileRecords.indexOf(e);-1!==n&&this.fileRecords.splice(n,1)}else confirm("Are you sure you want to delete?")&&this.$refs.vueFileAgent.deleteFileRecord(e)},fileDeleted:function(e){var t=this.fileRecordsForUpload.indexOf(e);-1!==t?this.fileRecordsForUpload.splice(t,1):this.deleteUploadedFile(e)},fillForm:function(){this.form=sL({},this.dataMemo),"payment"!=this.formType&&(this.dataApprovers=oL(this.form.approvers)),this.sub_total=this.dataTotalCost.sub_total,this.pph=this.dataTotalCost.pph,this.ppn=this.dataTotalCost.ppn,this.grand_total=this.dataTotalCost.grand_total,this.checkPPNInclude=0==this.dataTotalCost.ppn&&!0,this.selectedAcknowledge=_.map(this.form.acknowledges,(function(e){return e.position_now}))},removeAttachment:function(e){this.$inertia.delete(route(this.__removeAttachment,e)).then((function(){}))},onHidden:function(){this.$refs.button.focus()},actionAcknowledgeRemoving:function(e){var t=this;this.isAcknowledgebusy=!0,this.$inertia.delete(route(this.__deleteAcknowledge,{memo:this.dataMemo.id,id_employee:e.id_employee,type:this.formType})).then((function(){t.isAcknowledgebusy=!1}))},actionAcknowledgeSelecting:function(e){var t=this;this.isAcknowledgebusy=!0,this.$inertia.post(route(this.__updateAcknowledge,{memo:this.dataMemo.id,type:this.formType}),{acknowledge:e}).then((function(){t.isAcknowledgebusy=!1}))},actionEdit:function(e,t){this.activeIndex=e,this.isFormPaymentEdited=!0,this.activeItemPayment=sL({},this.dataPayments[e])},actionDelete:function(e){var t=this;this.$bvModal.msgBoxConfirm("Please confirm that you want to delete this data vendor.",{title:"Please Confirm",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"YES",cancelTitle:"NO",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(n){return n&&t.submitDelete(e)})).catch((function(e){}))},actionChangeChenckboxManualInput:function(){this.manualInputPph&&(this.pph=0)},submitUpdate:function(e){var t=this;axios.put(route("user.memo.statusmemo.updatepayment",[this.dataMemo.id,e]),this.activeItemPayment).then((function(e){t.dataPayments=_.map(t.dataPayments,(function(e){return e.id===t.activeItemPayment.id&&(e=sL({},t.activeItemPayment)),e})),e.data.success&&(t.pageFlashes.success="Successfull update data vendor"),t.sub_total=t.sub_total,t.ppn=t.ppn,t.pph=t.pph,t.grand_total=t.grand_total,t.activeItemPayment={},t.form_modal.amount=0,t.isFormPaymentEdited=!1}))},submitDelete:function(e){var t=this;axios.delete(route("user.memo.statusmemo.deletepayment",e)).then((function(n){n.data.success&&(t.pageFlashes.success="Successfull delete data vendor",t.dataPayments=_.filter(t.dataPayments,(function(t){return t.id!=e})),t.form.amount=0)}))},actionCancel:function(){this.activeItemPayment={},this.isFormPaymentEdited=!1},handleSubmitPayment:function(){var e=this;this.isModalFormBusy=!0,axios.put(route("user.api.payment.storepayment",this.dataMemo.id),this.form_modal).then((function(t){e.errors={},0===Object.entries(e.errors).length&&e.$nextTick((function(){e.$bvModal.hide("modal-add-payment")})),e.isModalFormBusy=!1;var n=t.data.id;e.form_modal.id=n,e.dataPayments=[].concat(oL(e.dataPayments),[e.form_modal]),e.sub_total=e.sub_total,e.ppn=e.ppn,e.pph=e.pph,e.grand_total=e.grand_total,t.data.status,e.pageFlashes.success=t.data.message})).catch((function(t){t.response&&(e.errors=sL({},t.response.data.errors),e.isModalFormBusy=!1)}))},getData:function(){var e=this;this.isTableApproverbusy=!0,Promise.all([this.getDataApproversPayment(),this.getDataApprovers(),this.getDataPayments()]).then((function(t){e.dataApprovers=t[0].data.length>0?t[0].data:t[1].data,e.dataPayments=t[2].data,e.fillForm()}))},resetModalPayment:function(){this.form_modal={name:"",bank_name:"",bank_account:null,amount:0,remark:"",address:""}},handleOkPayment:function(e){e.preventDefault(),this.handleSubmitPayment()},getDataApprovers:(fL=rL(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(route(this.url_approvers,this.dataMemo.id)));case 1:case"end":return e.stop()}}),e,this)}))),function(){return fL.apply(this,arguments)}),getDataApproversPayment:(lL=rL(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(route(this.url_approvers_payment,this.dataMemo.id)));case 1:case"end":return e.stop()}}),e,this)}))),function(){return lL.apply(this,arguments)}),getDataPayments:(cL=rL(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",axios.get(route(this.url_data_payment,this.dataMemo.id)));case 1:case"end":return e.stop()}}),e,this)}))),function(){return cL.apply(this,arguments)})}},pL=Object(JP.a)(hL,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("layout",{attrs:{userinfo:e.userinfo,notif:e.notif}},[n("flash-msg"),e._v(" "),n("div",{staticClass:"d-sm-flex align-items-center justify-content-between mb-4"},[n("h1",{staticClass:"h3 mb-0 text-gray-800"},[e._v("Memo "+e._s(e.form.doc_no))])]),e._v(" "),n("breadcrumb",{attrs:{items:e.breadcrumbItems}}),e._v(" "),n("div",{staticClass:"row"},[n("div",{staticClass:"col-12"},[n("b-card",{attrs:{"no-body":""}},[0==e.dataMemo.payment?n("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-secondary",attrs:{role:"button",title:"Preview Memo",href:e.route(e.__preview,e.dataMemo.id),target:"_blank"}},[e._v("\n          preview\n        ")]):e._e(),e._v(" "),1==e.dataMemo.payment?n("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"btn btn-secondary",attrs:{role:"button",title:"Preview Payment",href:e.route(e.__previewpayment,e.dataMemo.id),target:"_blank"}},[e._v("\n          preview payment\n        ")]):e._e(),e._v(" "),n("b-form",{attrs:{id:"form"},on:{submit:function(t){return t.preventDefault(),e.submit(t)}}},[n("b-card-body",[n("b-row",{staticClass:"mb-2"},[n("b-col",{staticClass:"mb-4",attrs:{col:"",lg:"12"}},[n("h5",[e._v("Memo Information")]),e._v(" "),n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-bordered"},[n("tbody",[n("tr",[n("td",[e._v("Department")]),e._v(" "),n("td",[e._v("\n                          "+e._s(e.userinfo.employee.position_now.position.department.department_name)+"\n                        ")])]),e._v(" "),n("tr",[n("td",[e._v("Title")]),e._v(" "),n("td",[e._v(e._s(e.form.title))])]),e._v(" "),n("tr",[n("td",[e._v("Doc. No")]),e._v(" "),n("td",[e._v(e._s(e.form.doc_no))])])])])])]),e._v(" "),n("b-col",{staticClass:"mb-4",attrs:{col:"",lg:"12"}},[n("h5",[e._v("Orientation")]),e._v(" "),n("b-form-group",{scopedSlots:e._u([{key:"default",fn:function(t){var r=t.ariaDescribedby;return[n("b-form-radio-group",{attrs:{"aria-describedby":r,name:"orientation-paper"},on:{change:function(t){return e.autoSaveItem()}},model:{value:e.form.orientation_paper,callback:function(t){e.$set(e.form,"orientation_paper",t)},expression:"form.orientation_paper"}},[n("b-form-radio",{attrs:{value:"portrait"}},[e._v("Portrait")]),e._v(" "),n("b-form-radio",{attrs:{value:"landscape"}},[e._v("Landscape")])],1)]}}])})],1),e._v(" "),n("b-col",{staticClass:"mb-4",attrs:{col:"",lg:"12"}},[n("b-row",[n("table-edit-approver",{attrs:{dataPosition:e.dataPosition,dataApprovers:e.dataApprovers,__updateApprover:"payment"==e.formType?e.updateApproverPayment:e.__updateApprover,id_memo:e.dataMemo.id}})],1),e._v(" "),n("b-row",{staticClass:"mb-4"},[n("b-col",["payment"==e.formType?n("h5",[e._v("\n                      Send email after memo payment approved to:\n                    ")]):n("h5",[e._v("Send email after memo approved to:")]),e._v(" "),n("b-form-group",{attrs:{id:"input-group-name","label-for":"input-name"}},[n("b-overlay",{attrs:{show:e.isAcknowledgebusy,opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},[n("v-select",{staticClass:"mb-3",attrs:{multiple:"","get-option-label":e.getOptionLabel,placeholder:"-- Employee --",options:e.dataPosition,reduce:function(e){return e.id_employee}},on:{"option:selected":e.actionAcknowledgeSelecting,"option:deselecting":e.actionAcknowledgeRemoving},model:{value:e.selectedAcknowledge,callback:function(t){e.selectedAcknowledge=t},expression:"selectedAcknowledge"}})],1)],1)],1)],1)],1)],1),e._v(" "),n("b-row",[n("b-col",{staticClass:"mb-4",attrs:{col:"",lg:"12"}},[n("h5",[e._v("Attachment:")]),e._v(" "),n("b-form-group",{attrs:{id:"input-group-text","label-for":"input-text"}},[n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table"},[n("thead",[n("tr",[n("th",[e._v("File")]),e._v(" "),n("th",[e._v("Action")])])]),e._v(" "),n("tbody",e._l(e.dataAttachments,(function(t,r){return n("tr",{key:r},[n("td",[n("a",{attrs:{href:t.name,target:"_blank",rel:"noopener noreferrer"}},[e._v("\n                              "+e._s(t.real_name)+"\n                            ")])]),e._v(" "),n("td",[n("b-button",{attrs:{size:"sm",variant:"danger"},on:{click:function(n){return e.removeAttachment(t.id)}}},[e._v("remove")])],1)])})),0)])]),e._v(" "),n("VueFileAgent",{ref:"vueFileAgent",staticClass:"mb-2",attrs:{theme:"list",multiple:!0,deletable:!0,meta:!0,accept:".rar,.zip,.png,.jpeg,.jpg,.xls,.xlsx,.doc,.docx,.pdf",maxSize:"25MB",maxFiles:10,helpText:"Choose images, pdf, excel, pdf, rar or word files",errorText:{type:"Invalid file type. Only images, excel, pdf, rar, zip and word files allowed",size:"Files should not exceed 25MB in size"}},on:{select:function(t){return e.filesSelected(t)},beforedelete:function(t){return e.onBeforeDelete(t)},delete:function(t){return e.fileDeleted(t)}},model:{value:e.fileRecords,callback:function(t){e.fileRecords=t},expression:"fileRecords"}}),e._v(" "),n("button",{staticClass:"btn btn-primary btn-sm",attrs:{disabled:!e.fileRecordsForUpload.length},on:{click:function(t){return t.preventDefault(),e.uploadFiles()}}},[e._v("\n                    Upload "+e._s(e.fileRecordsForUpload.length)+" files\n                  ")])],1)],1)],1),e._v(" "),n("b-row",[n("div",{staticClass:"col-12 mb-4"},[n("b-row",[n("b-col",[n("h5",{staticClass:"mb-0"},[e._v("Background")])]),e._v(" "),n("b-col",{staticClass:"d-flex justify-content-end"},[n("div",["background"==e.fieldSaving&&e.isSaving?n("b-badge",{attrs:{variant:"info"}},[n("b-spinner",{attrs:{small:"",label:"Floated Right"}}),e._v("\n                        Saving\n                      ")],1):e._e()],1)])],1),e._v(" "),n("b-form-group",{staticClass:"mt-2",attrs:{id:"input-group-text",label:"","label-for":"input-text"}},[n("Editor2",{on:{input:function(t){return e.typing("background")}},model:{value:e.form.background,callback:function(t){e.$set(e.form,"background",t)},expression:"form.background"}})],1)],1)]),e._v(" "),n("b-row",[n("div",{staticClass:"col-12 mb-4"},[n("b-row",[n("b-col",[n("h5",{staticClass:"mb-0"},[e._v("Information")])]),e._v(" "),n("b-col",{staticClass:"d-flex justify-content-end"},[n("div",["information"==e.fieldSaving&&e.isSaving?n("b-badge",{attrs:{variant:"info"}},[n("b-spinner",{attrs:{small:"",label:"Floated Right"}}),e._v("\n                        Saving\n                      ")],1):e._e()],1)])],1),e._v(" "),n("b-form-group",{staticClass:"mt-2",attrs:{id:"input-group-text",label:"","label-for":"input-text"}},[n("Editor2",{on:{input:function(t){return e.typing("information")}},model:{value:e.form.information,callback:function(t){e.$set(e.form,"information",t)},expression:"form.information"}})],1)],1)]),e._v(" "),n("b-row",[n("div",{staticClass:"col-12 mb-4"},[n("b-row",[n("b-col",[n("h5",{staticClass:"mb-0"},[e._v("Conclusion")])]),e._v(" "),n("b-col",{staticClass:"d-flex justify-content-end"},[n("div",["conclusion"==e.fieldSaving&&e.isSaving?n("b-badge",{attrs:{variant:"info"}},[n("b-spinner",{attrs:{small:"",label:"Floated Right"}}),e._v("\n                        Saving\n                      ")],1):e._e()],1)])],1),e._v(" "),n("b-form-group",{staticClass:"mt-2",attrs:{id:"input-group-text",label:"","label-for":"input-text"}},[n("Editor2",{on:{input:function(t){return e.typing("conclusion")}},model:{value:e.form.conclusion,callback:function(t){e.$set(e.form,"conclusion",t)},expression:"form.conclusion"}})],1)],1)]),e._v(" "),n("b-row",[n("div",{staticClass:"col-12 mb-4"},[n("b-row",[n("b-col",[n("h5",{staticClass:"mb-0"},[e._v("Cost/Expense")])]),e._v(" "),n("b-col",{staticClass:"d-flex justify-content-end"},[n("div",["cost"==e.fieldSaving&&e.isSaving?n("b-badge",{attrs:{variant:"info"}},[n("b-spinner",{attrs:{small:"",label:"Floated Right"}}),e._v("\n                        Saving\n                      ")],1):e._e()],1)])],1),e._v(" "),n("b-form-group",{staticClass:"mt-2",attrs:{id:"input-group-text",label:"","label-for":"input-text"}},[n("b-form-checkbox",{staticClass:"mb-2",attrs:{id:"checkbox-2",name:"checkbox-2",value:!0,"unchecked-value":!1},on:{change:function(t){return e.autoSaveItem()}},model:{value:e.form.is_cost_invoice,callback:function(t){e.$set(e.form,"is_cost_invoice",t)},expression:"form.is_cost_invoice"}},[e._v("\n                    use Cost Invoice\n                  ")]),e._v(" "),e.form.is_cost_invoice?n("form-invoice",{attrs:{id_memo:e.dataMemo.id}}):n("hot-table",{ref:"formCost",attrs:{settings:e.hotSettings}})],1)],1)]),e._v(" "),"payment"!=e.formType&&1!=e.dataMemoType.ref_table.with_po||e.form.is_cost_invoice?e._e():n("b-row",[n("div",{staticClass:"col-5"},[n("b-overlay",{attrs:{show:e.isSubmitBusy,opacity:"0.6","spinner-small":"","spineer-variant":"primary"}},[n("b-form-group",{attrs:{id:"input-group-text",label:"","label-for":"input-text"}},[n("b-input-group",{staticClass:"mb-2 mt-5",attrs:{prepend:"Sub Total"}},[n("b-form-input",{attrs:{"aria-label":"sub_total"},on:{change:function(t){return e.debouncedSaveCost()}},model:{value:e.sub_total,callback:function(t){e.sub_total=t},expression:"sub_total"}})],1),e._v(" "),n("b-input-group",{staticClass:"mb-2 mt-2",attrs:{prepend:"Pph 23"}},[n("b-form-input",{attrs:{"aria-label":"pph"},on:{change:e.pphValueChange},model:{value:e.pph,callback:function(t){e.pph=t},expression:"pph"}}),e._v(" "),n("b-form-checkbox",{staticClass:"justify-content-center my-auto ml-2",attrs:{value:!0,"unchecked-value":!1},on:{change:e.actionChangeChenckboxManualInput},model:{value:e.manualInputPph,callback:function(t){e.manualInputPph=t},expression:"manualInputPph"}},[e._v("\n                        Manual input Pph\n                      ")])],1),e._v(" "),n("b-input-group",{staticClass:"mb-2 mt-2",attrs:{prepend:"PPN (10%)"}},[n("b-form-input",{attrs:{disabled:"","aria-label":"ppn"},model:{value:e.ppn,callback:function(t){e.ppn=t},expression:"ppn"}})],1),e._v(" "),n("b-form-checkbox",{attrs:{id:"checkbox-1",name:"checkbox-1",value:!0,"unchecked-value":!1},model:{value:e.checkPPNInclude,callback:function(t){e.checkPPNInclude=t},expression:"checkPPNInclude"}},[e._v("\n                      PPN included with sub total\n                    ")]),e._v(" "),n("b-input-group",{staticClass:"mb-2 mt-2",attrs:{prepend:"Grand Total"}},[n("b-form-input",{attrs:{"aria-label":"grand_total",disabled:""},model:{value:e.grand_total,callback:function(t){e.grand_total=t},expression:"grand_total"}})],1),e._v(" "),n("b-button",{attrs:{size:"sm",text:"Button",variant:"danger"},on:{click:function(t){return e.reset()}}},[e._v("Reset")])],1)],1)],1)]),e._v(" "),n("b-row",[n("div",{staticClass:"col-12"})]),e._v(" "),"payment"==e.formType?n("b-row",[n("b-overlay",{attrs:{show:e.isSubmitBusy,opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},[n("b-button-group",[n("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-add-payment",modifiers:{"modal-add-payment":!0}}],staticClass:"mt-2 ml-2",attrs:{variant:"primary"}},[e._v("\n                    Add Data Vendor\n                  ")])],1)],1)],1):e._e(),e._v(" "),"payment"==e.formType?n("b-overlay",{attrs:{show:e.isSubmitBusy,opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},["payment"==e.formType?n("b-col",{staticClass:"mt-4 p-0 table-responsive"},[n("h5",[e._v("Vendor")]),e._v(" "),n("table",{staticClass:"table table-stripped table-bordered"},[n("thead",{staticClass:"thead-dark"},[n("tr",[n("th",{attrs:{scope:"col"}},[e._v("Vendor Name")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Bank Name")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Bank Account")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Amount")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Remark")]),e._v(" "),n("th",{attrs:{scope:"col"}},[e._v("Address")]),e._v(" "),n("th",[e._v("action")])])]),e._v(" "),n("tbody",e._l(e.dataPayments,(function(t,r){return n("tr",{key:t.id},[e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.activeItemPayment.name,expression:"activeItemPayment.name"}],attrs:{type:"text",name:"name"},domProps:{value:e.activeItemPayment.name},on:{input:function(t){t.target.composing||e.$set(e.activeItemPayment,"name",t.target.value)}}})]):n("td",[e._v(e._s(t.name))]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.activeItemPayment.bank_name,expression:"activeItemPayment.bank_name"}],attrs:{type:"text",name:"bank_name"},domProps:{value:e.activeItemPayment.bank_name},on:{input:function(t){t.target.composing||e.$set(e.activeItemPayment,"bank_name",t.target.value)}}})]):n("td",[e._v(e._s(t.bank_name))]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.activeItemPayment.bank_account,expression:"activeItemPayment.bank_account"}],attrs:{type:"text",name:"bank_account"},domProps:{value:e.activeItemPayment.bank_account},on:{input:function(t){t.target.composing||e.$set(e.activeItemPayment,"bank_account",t.target.value)}}})]):n("td",[e._v(e._s(t.bank_account))]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("CurrencyInput",{model:{value:e.activeItemPayment.amount,callback:function(t){e.$set(e.activeItemPayment,"amount",t)},expression:"activeItemPayment.amount"}})],1):n("td",[e._v("\n                        Rp.\n                        "+e._s(Number(t.amount).toLocaleString("id-ID",{maximumFractionDigits:2}))+"\n                      ")]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:e.activeItemPayment.remark,expression:"activeItemPayment.remark"}],attrs:{type:"text",name:"remark"},domProps:{value:e.activeItemPayment.remark},on:{input:function(t){t.target.composing||e.$set(e.activeItemPayment,"remark",t.target.value)}}})]):n("td",[e._v(e._s(t.remark))]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.activeItemPayment.address,expression:"activeItemPayment.address"}],attrs:{type:"text",name:"address",rows:"3"},domProps:{value:e.activeItemPayment.address},on:{input:function(t){t.target.composing||e.$set(e.activeItemPayment,"address",t.target.value)}}})]):n("td",[e._v(e._s(t.address))]),e._v(" "),e.isFormPaymentEdited&&e.activeIndex==r?n("td",[n("b-button",{attrs:{variant:"primary"},on:{click:function(n){return e.submitUpdate(t.id)}}},[e._v("save")]),e._v(" "),n("b-button",{attrs:{variant:"secondary"},on:{click:e.actionCancel}},[e._v("cancel")])],1):n("td",[n("b-button-group",{attrs:{size:"sm"}},[n("b-button",{attrs:{variant:"primary"},on:{click:function(n){return e.actionEdit(r,t.id)}}},[n("i",{staticClass:"fa fa-edit"})]),e._v(" "),n("b-button",{attrs:{variant:"secondary"},on:{click:function(n){return e.actionDelete(t.id)}}},[n("i",{staticClass:"fa fa-trash"})])],1)],1)])})),0)])]):e._e()],1):e._e()],1)],1)],1)],1)]),e._v(" "),n("b-modal",{attrs:{id:"modal-add-payment",title:"Add Data Vendor","ok-title":"Add","no-close-on-backdrop":""},on:{ok:e.handleOkPayment,hidden:e.resetModalPayment}},[n("b-overlay",{attrs:{show:e.isModalFormBusy,opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},[n("b-form",{ref:"form_modal",on:{submit:function(t){return t.preventDefault(),e.handleSubmitPayment(t)}}},[n("b-card-body",[n("b-col",{attrs:{col:"",lg:"6",md:"auto"}},[n("b-form-group",{attrs:{id:"input-group-title",label:"Vendor Name:","label-for":"input-title","invalid-feedback":e.errors.name?e.errors.name[0]:"",state:!e.errors.name&&null}},[n("b-form-input",{attrs:{id:"input-title",type:"text",name:"name",placeholder:"Vendor Name",state:!e.errors.name&&null,trim:"",required:""},model:{value:e.form_modal.name,callback:function(t){e.$set(e.form_modal,"name",t)},expression:"form_modal.name"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"input-group-title",label:"Bank Name:","label-for":"input-title","invalid-feedback":e.errors.bank_name?e.errors.bank_name[0]:"",state:!e.errors.bank_name&&null}},[n("b-form-input",{attrs:{id:"input-title",type:"text",name:"bank_name",placeholder:"Bank Name",state:!e.errors.bank_name&&null,trim:"",required:""},model:{value:e.form_modal.bank_name,callback:function(t){e.$set(e.form_modal,"bank_name",t)},expression:"form_modal.bank_name"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"input-group-title",label:"Bank Account","label-for":"input-title","invalid-feedback":e.errors.bank_account?e.errors.bank_account[0]:"",state:!e.errors.bank_account&&null}},[n("b-form-input",{attrs:{id:"input-title",type:"text",name:"bank_account",placeholder:"Account Number",state:!e.errors.bank_account&&null,trim:"",required:""},model:{value:e.form_modal.bank_account,callback:function(t){e.$set(e.form_modal,"bank_account",t)},expression:"form_modal.bank_account"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"input-group-title",label:"Amount:","label-for":"input-title","invalid-feedback":e.errors.amount?e.errors.amount[0]:"",state:!e.errors.amount&&null}},[n("CurrencyInput",{model:{value:e.form_modal.amount,callback:function(t){e.$set(e.form_modal,"amount",t)},expression:"form_modal.amount"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"input-group-title",label:"Remark:","label-for":"input-title","invalid-feedback":e.errors.remark?e.errors.remark[0]:"",state:!e.errors.remark&&null}},[n("b-form-input",{attrs:{id:"input-title",type:"text",name:"remark",placeholder:"Remark",state:!e.errors.remark&&null,trim:"",required:""},model:{value:e.form_modal.remark,callback:function(t){e.$set(e.form_modal,"remark",t)},expression:"form_modal.remark"}})],1),e._v(" "),n("b-form-group",{attrs:{id:"input-group-title",label:"Vendor Address","label-for":"textarea","invalid-feedback":e.errors.address?e.errors.address[0]:"",state:!e.errors.address&&null}},[n("b-form-textarea",{attrs:{id:"textarea",type:"text",name:"address",placeholder:"Vendor Address",state:!e.errors.address&&null,rows:"3","max-rows":"6",trim:"",required:""},model:{value:e.form_modal.address,callback:function(t){e.$set(e.form_modal,"address",t)},expression:"form_modal.address"}})],1)],1)],1)],1)],1)],1)],1)}),[],!1,null,null,null);t.default=pL.exports},Nfqw:function(e,t,n){"use strict";function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var i={props:{disabled:{type:Boolean,default:!1},approver:Object},data:function(){return{selectedItem:null,selectapprover:{}}},mounted:function(){this.selectapprover=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},this.approver)},methods:{changeSelected:function(){this.$emit("changeSelected",this.selectapprover)}}},a=n("KHd+"),s=Object(a.a)(i,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-form-select",{staticClass:"mb-3",attrs:{disabled:e.disabled},on:{change:e.changeSelected},model:{value:e.selectapprover.type_approver,callback:function(t){e.$set(e.selectapprover,"type_approver",t)},expression:"selectapprover.type_approver"}},[n("b-form-select-option",{attrs:{value:"approver"}},[e._v("Approver")]),e._v(" "),n("b-form-select-option",{attrs:{value:"acknowledge"}},[e._v("Reviewer")])],1)],1)}),[],!1,null,null,null);t.a=s.exports},OM9Z:function(e,t,n){n("I+eb")({target:"String",proto:!0},{repeat:n("EUja")})},SdS2:function(e,t,n){var r=n("lgEA");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},Uydy:function(e,t,n){var r=n("I+eb"),o=n("HsHA"),i=Math.acosh,a=Math.log,s=Math.sqrt,u=Math.LN2;r({target:"Math",stat:!0,forced:!i||710!=Math.floor(i(Number.MAX_VALUE))||i(1/0)!=1/0},{acosh:function(e){return(e=+e)<1?NaN:e>94906265.62425156?a(e)+u:o(e-1+s(e-1)*s(e+1))}})},Vvqk:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,"nav[data-v-2d278c0c]{border-radius:20px 20px 0 0;padding:.9rem .5rem 0}nav ul.navbar-nav li.nav-item a[data-v-2d278c0c]:hover,nav ul.navbar-nav li.nav-item a:hover.nav-link[data-v-2d278c0c]{color:#006e63}nav ul.navbar-nav li.nav-item a.nav-link[data-v-2d278c0c]{padding:0!important;font-size:24px;display:inline-grid;color:#3a3b45;z-index:1}nav ul.navbar-nav li.nav-item a.nav-link span.title[data-v-2d278c0c]{display:none!important;font-size:10px}nav ul.navbar-nav li.nav-item a.nav-link.active[data-v-2d278c0c]{color:#009688;transform:translateY(-10%);transition:transform .5s cubic-bezier(.075,.82,.165,1);font-size:26px}nav ul.navbar-nav li.nav-item a.nav-link.active>span.title[data-v-2d278c0c],nav ul.navbar-nav li.nav-item a.nav-link.active span.notif-badge[data-v-2d278c0c]{display:block!important}nav ul.navbar-nav li.nav-item .icon-notif[data-v-2d278c0c]{height:28px;position:relative!important;margin-left:auto;margin-right:auto}nav ul.navbar-nav li.nav-item .dropdown[data-v-2d278c0c]{display:block}nav ul.navbar-nav li.nav-item .dropdown .dropdown-item>span.notif-badge[data-v-2d278c0c]{display:inline-block!important;font-size:60%}nav ul.navbar-nav li.nav-item .dropdown .dropdown-item.active>span.notif-badge[data-v-2d278c0c]{background-color:#fff;color:#009688}nav ul.navbar-nav li.nav-item .dropdown .icon-notif>span.notif-badge[data-v-2d278c0c],nav ul.navbar-nav li.nav-item .dropdown a.nav-link.active>.icon-notif>span.notif-badge[data-v-2d278c0c]{position:absolute;top:-3px;right:-4px;display:block;font-size:35%}nav .navbar-nav .active>.nav-link[data-v-2d278c0c],nav .navbar-nav .nav-link.active[data-v-2d278c0c],nav .navbar-nav .nav-link.show[data-v-2d278c0c],nav .navbar-nav .show>.nav-link[data-v-2d278c0c]{color:#009688}.bottom-navbar[data-v-2d278c0c]{background:#fff}",""])},YADa:function(e,t,n){"use strict";var r=n("t2rG"),o=n.n(r),i=n("Nfqw");function a(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var u={components:{draggable:o.a,SelectTypeApprover:i.a},props:["dataPosition","id_memo","dataApprovers","__updateApprover"],data:function(){return{selected:null,approvers:[],isApproverbusy:!1,isApproverEdited:!0,activeSelect:null,form:{}}},watch:{dataApprovers:function(e){this.approvers=e}},methods:{getOptionLabel:function(e){var t=e.employee?e.employee.firstname:"",n=e.employee?e.employee.lastname:"";return e.position.position_name+" - "+t+" "+n},actionApproverSelecting:function(e){this.actionApproverAddItem(e),this.selected=null},actionApproverRemoveAt:function(e){this.approvers.splice(e,1),this.actionApproverSave()},actionApproverAddItem:function(e){if(void 0===this.approvers.find((function(t){return e.id===t.employee.position_now.id}))){var t={id_memo:this.id_memo,id_employee:e.id_employee,type_approver:"approver",employee:{firstname:e.employee.firstname,lastname:e.employee.lastname,id:e.employee.id,position_now:{id:e.id,position:e.position}},status:"edit"};this.approvers=[].concat(a(this.approvers),[t]),this.actionApproverSave()}else this.pageFlashes.danger="Approver ".concat(e.position.position_name," is used")},actionApproverSave:function(){var e=this;this.isApproverbusy=!0,this.$emit("beforeSave"),axios.post(route(this.__updateApprover,this.id_memo),{approver:this.approvers}).then((function(t){e.isApproverbusy=!1,e.isApproverEdited=!0,200==t.data.status&&(e.pageFlashes.success=t.data.message),e.$emit("onSave",t.data)}))},actionApproverCanceled:function(){this.isApproverEdited=!0,this.activeSelect=null,this.approvers=a(this.form.approvers)},changeApproverSelected:function(e){this.approvers=_.map(this.approvers,(function(t){return t.id_employee===e.id_employee&&(t=e),t})),this.activeSelect=null,this.actionApproverSave()},showSelectTypeApprover:function(e){this.activeSelect=e}}},c=n("KHd+"),l=Object(c.a)(u,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("b-overlay",{staticClass:"col",attrs:{show:e.isApproverbusy,opacity:"0.6","spinner-small":"","spinner-variant":"primary"}},[n("b-row",[n("b-col",[n("h5",[e._v("List Approver")])]),e._v(" "),n("b-col",[e.isApproverEdited?e._e():n("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],staticClass:"float-right",attrs:{role:"button",title:"Edit Approver"},on:{click:function(t){e.isApproverEdited=!0}}},[n("i",{staticClass:"fas fa-edit"})])])],1),e._v(" "),e.isApproverEdited?n("b-form-group",{attrs:{id:"input-group-name","label-for":"input-name"}},[n("v-select",{staticClass:"mb-3",attrs:{"get-option-label":e.getOptionLabel,placeholder:"-- Add Approver --",options:e.dataPosition,reduce:function(e){return e.id_employee}},on:{"option:selected":e.actionApproverSelecting},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}})],1):e._e(),e._v(" "),n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-bordered"},[n("thead",{staticClass:"thead-dark"},[n("tr",[n("th",[e._v("Approver Name")]),e._v(" "),n("th",[e._v("Position")]),e._v(" "),n("th",[e._v("Approver Type")]),e._v(" "),n("th",[e._v("Level")]),e._v(" "),e.isApproverEdited?n("th",[e._v("#")]):e._e()])]),e._v(" "),n("draggable",{attrs:{tag:"tbody",handle:".handle",list:e.approvers},on:{change:function(t){return e.actionApproverSave()}}},e._l(e.approvers,(function(t,r){return n("tr",{key:r},[n("td",[e.isApproverEdited?n("i",{staticClass:"fas fa-bars handle",staticStyle:{cursor:"pointer"}}):e._e(),e._v("\n            "+e._s(t.employee.firstname+" "+t.employee.lastname)+"\n          ")]),e._v(" "),n("td",["TERMINATE"==t.employee.position_now.position.position_name?n("strong",{staticClass:"text-danger"},[e._v("\n              User has been terminated\n            ")]):n("strong",[e._v("\n              "+e._s(t.employee.position_now.position.position_name)+"\n            ")])]),e._v(" "),n("td",[e.isApproverEdited?n("div",[n("strong",[e._v("\n                "+e._s("acknowledge"==t.type_approver?"reviewer":t.type_approver)+"\n              ")]),e._v(" "),n("a",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{role:"button",title:"Edit Approver Type"},on:{click:function(t){return e.showSelectTypeApprover(r)}}},[n("i",{staticClass:"fas fa-edit"})])]):n("strong",{staticClass:"text-capitalize"},[e._v("\n              "+e._s("acknowledge"==t.type_approver?"reviewer":t.type_approver)+"\n            ")]),e._v(" "),e.activeSelect==r?n("select-type-approver",{attrs:{approver:t},on:{changeSelected:e.changeApproverSelected}}):e._e()],1),e._v(" "),n("td",[e._v("\n            "+e._s(r+1)+"\n          ")]),e._v(" "),e.isApproverEdited?n("td",[n("b-button",{attrs:{variant:"secondary",size:"sm"},on:{click:function(t){return e.actionApproverRemoveAt(r)}}},[n("i",{staticClass:"fa fa-times"})])],1):e._e()])})),0)],1)])],1)}),[],!1,null,null,null);t.a=l.exports},a5NK:function(e,t,n){var r=n("I+eb"),o=Math.log,i=Math.LOG10E;r({target:"Math",stat:!0},{log10:function(e){return o(e)*i}})},azOx:function(e,t,n){"use strict";var r=n("gNPE");n.n(r).a},d6pH:function(e,t,n){"use strict";function r(e){return e&&0===e.length}function o(e){return null==e?[]:Object.keys(e)}function i(e){for(var t=[],n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}function a(e,t){for(var n=[],r=o(e),i=0;i<r.length;i++){var a=r[i];n.push(t.call(null,e[a],a))}return n}function s(e,t){for(var n=[],r=0;r<e.length;r++)n.push(t.call(null,e[r],r));return n}function u(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];Array.isArray(r)?t=t.concat(u(r)):t.push(r)}return t}function c(e){return r(e)?void 0:e[0]}function l(e){var t=e&&e.length;return t?e[t-1]:void 0}function f(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t.call(null,e[n],n);else{if(!I(e))throw Error("non exhaustive match");var r=o(e);for(n=0;n<r.length;n++){var i=r[n],a=e[i];t.call(null,a,i)}}}function h(e){return"string"==typeof e}function p(e){return void 0===e}function d(e){return e instanceof Function}function m(e,t){return void 0===t&&(t=1),e.slice(t,e.length)}function v(e,t){return void 0===t&&(t=1),e.slice(0,e.length-t)}function y(e,t){var n=[];if(Array.isArray(e))for(var r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function g(e,t){return y(e,(function(e){return!t(e)}))}function b(e,t){for(var n=Object.keys(e),r={},o=0;o<n.length;o++){var i=n[o],a=e[i];t(a)&&(r[i]=a)}return r}function E(e,t){return!!I(e)&&e.hasOwnProperty(t)}function w(e,t){return void 0!==O(e,(function(e){return e===t}))}function S(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n]);return t}function T(e){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}function O(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(t.call(null,r))return r}}function R(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];t.call(null,o)&&n.push(o)}return n}function N(e,t,n){for(var r=Array.isArray(e),a=r?e:i(e),s=r?[]:o(e),u=n,c=0;c<a.length;c++)u=t.call(null,u,a[c],r?c:s[c]);return u}function k(e){return g(e,(function(e){return null==e}))}function A(e,t){void 0===t&&(t=function(e){return e});var n=[];return N(e,(function(e,r){var o=t(r);return w(n,o)?e:(n.push(o),e.concat(r))}),[])}function C(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[null],o=r.concat(t);return Function.bind.apply(e,o)}function M(e){return Array.isArray(e)}function x(e){return e instanceof RegExp}function I(e){return e instanceof Object}function _(e,t){for(var n=0;n<e.length;n++)if(!t(e[n],n))return!1;return!0}function P(e,t){return g(e,(function(e){return w(t,e)}))}function L(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return!0;return!1}function F(e,t){for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1}function D(e,t){var n=S(e);return n.sort((function(e,n){return t(e)-t(n)})),n}function U(e,t){if(e.length!==t.length)throw Error("can't zipObject with different number of keys and values!");for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n}function j(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++)for(var i=t[r],a=o(i),s=0;s<a.length;s++){var u=a[s];e[u]=i[u]}return e}function B(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0;r<t.length;r++){var i=t[r];if(!p(i))for(var a=o(i),s=0;s<a.length;s++){var u=a[s];E(e,u)||(e[u]=i[u])}}return e}function V(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return B.apply(null,[{}].concat(e))}function H(e,t){var n={};return f(e,(function(e){var r=t(e),o=n[r];o?o.push(e):n[r]=[e]})),n}function G(e,t){for(var n=T(e),r=o(t),i=0;i<r.length;i++){var a=r[i],s=t[a];n[a]=s}return n}function z(){}function W(e){return e}function $(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];t.push(void 0!==r?r:void 0)}return t}function Y(e){console&&console.error&&console.error("Error: "+e)}function K(e){console&&console.warn&&console.warn("Warning: "+e)}function q(){return"function"==typeof Map}function X(e,t){t.forEach((function(t){var n=t.prototype;Object.getOwnPropertyNames(n).forEach((function(r){if("constructor"!==r){var o=Object.getOwnPropertyDescriptor(n,r);o&&(o.get||o.set)?Object.defineProperty(e.prototype,r,o):e.prototype[r]=t.prototype[r]}}))}))}function J(e){function t(){}t.prototype=e;var n=new t;function r(){return typeof n.bar}return r(),r(),e}function Q(e){return e[e.length-1]}function Z(e){var t=(new Date).getTime(),n=e();return{time:(new Date).getTime()-t,value:n}}n.d(t,"A",(function(){return r})),n.d(t,"G",(function(){return o})),n.d(t,"U",(function(){return i})),n.d(t,"J",(function(){return a})),n.d(t,"I",(function(){return s})),n.d(t,"t",(function(){return u})),n.d(t,"s",(function(){return c})),n.d(t,"H",(function(){return l})),n.d(t,"u",(function(){return f})),n.d(t,"E",(function(){return h})),n.d(t,"F",(function(){return p})),n.d(t,"B",(function(){return d})),n.d(t,"m",(function(){return m})),n.d(t,"n",(function(){return v})),n.d(t,"p",(function(){return y})),n.d(t,"P",(function(){return g})),n.d(t,"N",(function(){return b})),n.d(t,"w",(function(){return E})),n.d(t,"j",(function(){return w})),n.d(t,"g",(function(){return S})),n.d(t,"h",(function(){return T})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return R})),n.d(t,"O",(function(){return N})),n.d(t,"i",(function(){return k})),n.d(t,"T",(function(){return A})),n.d(t,"y",(function(){return M})),n.d(t,"D",(function(){return x})),n.d(t,"C",(function(){return I})),n.d(t,"o",(function(){return _})),n.d(t,"l",(function(){return P})),n.d(t,"Q",(function(){return L})),n.d(t,"x",(function(){return F})),n.d(t,"f",(function(){return j})),n.d(t,"k",(function(){return V})),n.d(t,"v",(function(){return H})),n.d(t,"K",(function(){return G})),n.d(t,"b",(function(){return z})),n.d(t,"a",(function(){return W})),n.d(t,"L",(function(){return $})),n.d(t,"c",(function(){return Y})),n.d(t,"d",(function(){return K})),n.d(t,"z",(function(){return q})),n.d(t,"e",(function(){return X})),n.d(t,"S",(function(){return J})),n.d(t,"M",(function(){return Q})),n.d(t,"R",(function(){return Z}))},eJiR:function(e,t,n){var r=n("I+eb"),o=n("jrUv"),i=Math.exp;r({target:"Math",stat:!0},{tanh:function(e){var t=o(e=+e),n=o(-e);return t==1/0?1:n==1/0?-1:(t-n)/(i(e)+i(-e))}})},eajv:function(e,t,n){var r=n("I+eb"),o=Math.asinh,i=Math.log,a=Math.sqrt;r({target:"Math",stat:!0,forced:!(o&&1/o(0)>0)},{asinh:function e(t){return isFinite(t=+t)&&0!=t?t<0?-e(-t):i(t+a(t*t+1)):t}})},fZLT:function(e,t,n){"use strict";var r=n("JAR3");n.n(r).a},gNPE:function(e,t,n){var r=n("Bicq");"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n("aET+")(r,o);r.locals&&(e.exports=r.locals)},"iQ+w":function(e,t,n){var r,o,i;"undefined"!=typeof self&&self,o=[],void 0===(i="function"==typeof(r=function(){function e(){}e.prototype.saveState=function(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}},e.prototype.restoreState=function(e){this.idx=e.idx,this.input=e.input,this.groupIdx=e.groupIdx},e.prototype.pattern=function(e){this.idx=0,this.input=e,this.groupIdx=0,this.consumeChar("/");var t=this.disjunction();this.consumeChar("/");for(var n={type:"Flags",global:!1,ignoreCase:!1,multiLine:!1,unicode:!1,sticky:!1};this.isRegExpFlag();)switch(this.popChar()){case"g":s(n,"global");break;case"i":s(n,"ignoreCase");break;case"m":s(n,"multiLine");break;case"u":s(n,"unicode");break;case"y":s(n,"sticky")}if(this.idx!==this.input.length)throw Error("Redundant input: "+this.input.substring(this.idx));return{type:"Pattern",flags:n,value:t}},e.prototype.disjunction=function(){var e=[];for(e.push(this.alternative());"|"===this.peekChar();)this.consumeChar("|"),e.push(this.alternative());return{type:"Disjunction",value:e}},e.prototype.alternative=function(){for(var e=[];this.isTerm();)e.push(this.term());return{type:"Alternative",value:e}},e.prototype.term=function(){return this.isAssertion()?this.assertion():this.atom()},e.prototype.assertion=function(){switch(this.popChar()){case"^":return{type:"StartAnchor"};case"$":return{type:"EndAnchor"};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary"};case"B":return{type:"NonWordBoundary"}}throw Error("Invalid Assertion Escape");case"(":var e;switch(this.consumeChar("?"),this.popChar()){case"=":e="Lookahead";break;case"!":e="NegativeLookahead"}u(e);var t=this.disjunction();return this.consumeChar(")"),{type:e,value:t}}!function(){throw Error("Internal Error - Should never get here!")}()},e.prototype.quantifier=function(e){var t;switch(this.popChar()){case"*":t={atLeast:0,atMost:1/0};break;case"+":t={atLeast:1,atMost:1/0};break;case"?":t={atLeast:0,atMost:1};break;case"{":var n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":t=this.isDigit()?{atLeast:n,atMost:this.integerIncludingZero()}:{atLeast:n,atMost:1/0},this.consumeChar("}")}if(!0===e&&void 0===t)return;u(t)}if(!0!==e||void 0!==t)return u(t),"?"===this.peekChar(0)?(this.consumeChar("?"),t.greedy=!1):t.greedy=!0,t.type="Quantifier",t},e.prototype.atom=function(){var e;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group()}return void 0===e&&this.isPatternCharacter()&&(e=this.patternCharacter()),u(e),this.isQuantifier()&&(e.quantifier=this.quantifier()),e},e.prototype.dotAll=function(){return this.consumeChar("."),{type:"Set",complement:!0,value:[i("\n"),i("\r"),i("\u2028"),i("\u2029")]}},e.prototype.atomEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.decimalEscapeAtom=function(){return{type:"GroupBackReference",value:this.positiveInteger()}},e.prototype.characterClassEscape=function(){var e,t=!1;switch(this.popChar()){case"d":e=c;break;case"D":e=c,t=!0;break;case"s":e=f;break;case"S":e=f,t=!0;break;case"w":e=l;break;case"W":e=l,t=!0}return u(e),{type:"Set",value:e,complement:t}},e.prototype.controlEscapeAtom=function(){var e;switch(this.popChar()){case"f":e=i("\f");break;case"n":e=i("\n");break;case"r":e=i("\r");break;case"t":e=i("\t");break;case"v":e=i("\v")}return u(e),{type:"Character",value:e}},e.prototype.controlLetterEscapeAtom=function(){this.consumeChar("c");var e=this.popChar();if(!1===/[a-zA-Z]/.test(e))throw Error("Invalid ");return{type:"Character",value:e.toUpperCase().charCodeAt(0)-64}},e.prototype.nulCharacterAtom=function(){return this.consumeChar("0"),{type:"Character",value:i("\0")}},e.prototype.hexEscapeSequenceAtom=function(){return this.consumeChar("x"),this.parseHexDigits(2)},e.prototype.regExpUnicodeEscapeSequenceAtom=function(){return this.consumeChar("u"),this.parseHexDigits(4)},e.prototype.identityEscapeAtom=function(){return{type:"Character",value:i(this.popChar())}},e.prototype.classPatternCharacterAtom=function(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:return{type:"Character",value:i(this.popChar())}}},e.prototype.characterClass=function(){var e=[],t=!1;for(this.consumeChar("["),"^"===this.peekChar(0)&&(this.consumeChar("^"),t=!0);this.isClassAtom();){var n=this.classAtom();if("Character"===n.type&&this.isRangeDash()){this.consumeChar("-");var r=this.classAtom();if("Character"===r.type){if(r.value<n.value)throw Error("Range out of order in character class");e.push({from:n.value,to:r.value})}else a(n.value,e),e.push(i("-")),a(r.value,e)}else a(n.value,e)}return this.consumeChar("]"),{type:"Set",complement:t,value:e}},e.prototype.classAtom=function(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}},e.prototype.classEscape=function(){switch(this.consumeChar("\\"),this.peekChar()){case"b":return this.consumeChar("b"),{type:"Character",value:i("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}},e.prototype.group=function(){var e=!0;switch(this.consumeChar("("),this.peekChar(0)){case"?":this.consumeChar("?"),this.consumeChar(":"),e=!1;break;default:this.groupIdx++}var t=this.disjunction();this.consumeChar(")");var n={type:"Group",capturing:e,value:t};return e&&(n.idx=this.groupIdx),n},e.prototype.positiveInteger=function(){var e=this.popChar();if(!1===o.test(e))throw Error("Expecting a positive integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.integerIncludingZero=function(){var e=this.popChar();if(!1===r.test(e))throw Error("Expecting an integer");for(;r.test(this.peekChar(0));)e+=this.popChar();return parseInt(e,10)},e.prototype.patternCharacter=function(){var e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:i(e)}}},e.prototype.isRegExpFlag=function(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return!0;default:return!1}},e.prototype.isRangeDash=function(){return"-"===this.peekChar()&&this.isClassAtom(1)},e.prototype.isDigit=function(){return r.test(this.peekChar(0))},e.prototype.isClassAtom=function(e){switch(void 0===e&&(e=0),this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.isTerm=function(){return this.isAtom()||this.isAssertion()},e.prototype.isAtom=function(){if(this.isPatternCharacter())return!0;switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return!0;default:return!1}},e.prototype.isAssertion=function(){switch(this.peekChar(0)){case"^":case"$":return!0;case"\\":switch(this.peekChar(1)){case"b":case"B":return!0;default:return!1}case"(":return"?"===this.peekChar(1)&&("="===this.peekChar(2)||"!"===this.peekChar(2));default:return!1}},e.prototype.isQuantifier=function(){var e=this.saveState();try{return void 0!==this.quantifier(!0)}catch(e){return!1}finally{this.restoreState(e)}},e.prototype.isPatternCharacter=function(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return!1;default:return!0}},e.prototype.parseHexDigits=function(e){for(var t="",r=0;r<e;r++){var o=this.popChar();if(!1===n.test(o))throw Error("Expecting a HexDecimal digits");t+=o}return{type:"Character",value:parseInt(t,16)}},e.prototype.peekChar=function(e){return void 0===e&&(e=0),this.input[this.idx+e]},e.prototype.popChar=function(){var e=this.peekChar(0);return this.consumeChar(),e},e.prototype.consumeChar=function(e){if(void 0!==e&&this.input[this.idx]!==e)throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx);if(this.idx>=this.input.length)throw Error("Unexpected end of input");this.idx++};var t,n=/[0-9a-fA-F]/,r=/[0-9]/,o=/[1-9]/;function i(e){return e.charCodeAt(0)}function a(e,t){void 0!==e.length?e.forEach((function(e){t.push(e)})):t.push(e)}function s(e,t){if(!0===e[t])throw"duplicate flag "+t;e[t]=!0}function u(e){if(void 0===e)throw Error("Internal Error - Should never get here!")}var c=[];for(t=i("0");t<=i("9");t++)c.push(t);var l=[i("_")].concat(c);for(t=i("a");t<=i("z");t++)l.push(t);for(t=i("A");t<=i("Z");t++)l.push(t);var f=[i(" "),i("\f"),i("\n"),i("\r"),i("\t"),i("\v"),i("\t"),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i(" "),i("\u2028"),i("\u2029"),i(" "),i(" "),i("　"),i("\ufeff")];function h(){}return h.prototype.visitChildren=function(e){for(var t in e){var n=e[t];e.hasOwnProperty(t)&&(void 0!==n.type?this.visit(n):Array.isArray(n)&&n.forEach((function(e){this.visit(e)}),this))}},h.prototype.visit=function(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e)}this.visitChildren(e)},h.prototype.visitPattern=function(e){},h.prototype.visitFlags=function(e){},h.prototype.visitDisjunction=function(e){},h.prototype.visitAlternative=function(e){},h.prototype.visitStartAnchor=function(e){},h.prototype.visitEndAnchor=function(e){},h.prototype.visitWordBoundary=function(e){},h.prototype.visitNonWordBoundary=function(e){},h.prototype.visitLookahead=function(e){},h.prototype.visitNegativeLookahead=function(e){},h.prototype.visitCharacter=function(e){},h.prototype.visitSet=function(e){},h.prototype.visitGroup=function(e){},h.prototype.visitGroupBackReference=function(e){},h.prototype.visitQuantifier=function(e){},{RegExpParser:e,BaseRegExpVisitor:h,VERSION:"0.4.0"}})?r.apply(t,o):r)||(e.exports=i)},jMhu:function(e,t,n){"use strict";var r={props:{items:{type:Array}}},o=n("KHd+"),i=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ol",{staticClass:"breadcrumb"},e._l(e.items,(function(t){return n("li",{key:t.title,staticClass:"breadcrumb-item",class:{active:t.active}},[t.active?n("span",[t.icon?n("i",{staticClass:"fas",class:t.icon}):e._e(),e._v("\n      "+e._s(t.title)+"\n    ")]):n("inertia-link",{attrs:{href:t.param?e.route(t.href,t.param):e.route(t.href)}},[t.icon?n("i",{staticClass:"fas",class:t.icon}):e._e(),e._v("\n      "+e._s(t.title)+"\n    ")])],1)})),0)}),[],!1,null,null,null);t.a=i.exports},jrUv:function(e,t){var n=Math.expm1,r=Math.exp;e.exports=!n||n(10)>22025.465794806718||n(10)<22025.465794806718||-2e-17!=n(-2e-17)?function(e){return 0==(e=+e)?e:e>-1e-6&&e<1e-6?e+e*e/2:r(e)-1}:n},lgEA:function(e,t,n){(e.exports=n("I1BE")(!1)).push([e.i,"body.modal-open{overflow:scroll!important}",""])},ls82:function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",i=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n,r){var o=t&&t.prototype instanceof l?t:l,i=Object.create(o.prototype),a=new S(r||[]);return i._invoke=function(e,t,n){var r="suspendedStart";return function(o,i){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===o)throw i;return O()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===c)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var l=u(e,t,n);if("normal"===l.type){if(r=n.done?"completed":"suspendedYield",l.arg===c)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r="completed",n.method="throw",n.arg=l.arg)}}}(e,n,a),i}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var c={};function l(){}function f(){}function h(){}var p={};p[o]=function(){return this};var d=Object.getPrototypeOf,m=d&&d(d(T([])));m&&m!==t&&n.call(m,o)&&(p=m);var v=h.prototype=l.prototype=Object.create(p);function y(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function g(e,t){var r;this._invoke=function(o,i){function a(){return new t((function(r,a){!function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(c.arg)}(o,i,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return c;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return c}var r=u(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,c;var o=r.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,c):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,c)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function w(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function T(e){if(e){var t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:O}}function O(){return{value:void 0,done:!0}}return f.prototype=v.constructor=h,h.constructor=f,h[a]=f.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(v),e},e.awrap=function(e){return{__await:e}},y(g.prototype),g.prototype[i]=function(){return this},e.AsyncIterator=g,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new g(s(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},y(v),v[a]="Generator",v[o]=function(){return this},v.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=T,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,c):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),c},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),w(n),c}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;w(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:T(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),c}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},"n/mU":function(e,t,n){var r=n("I+eb"),o=Math.atanh,i=Math.log;r({target:"Math",stat:!0,forced:!(o&&1/o(-0)<0)},{atanh:function(e){return 0==(e=+e)?e:i((1+e)/(1-e))/2}})},o0o1:function(e,t,n){e.exports=n("ls82")},qkdH:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(){return(i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){o(e,t,n[t])}))}return e}function s(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.r(t),n.d(t,"MultiDrag",(function(){return bt})),n.d(t,"Sortable",(function(){return Be})),n.d(t,"Swap",(function(){return ut}));function c(e){if("undefined"!=typeof window&&window.navigator)return!!navigator.userAgent.match(e)}var l=c(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),f=c(/Edge/i),h=c(/firefox/i),p=c(/safari/i)&&!c(/chrome/i)&&!c(/android/i),d=c(/iP(ad|od|hone)/i),m=c(/chrome/i)&&c(/android/i),v={capture:!1,passive:!1};function y(e,t,n){e.addEventListener(t,n,!l&&v)}function g(e,t,n){e.removeEventListener(t,n,!l&&v)}function b(e,t){if(t){if(">"===t[0]&&(t=t.substring(1)),e)try{if(e.matches)return e.matches(t);if(e.msMatchesSelector)return e.msMatchesSelector(t);if(e.webkitMatchesSelector)return e.webkitMatchesSelector(t)}catch(e){return!1}return!1}}function E(e){return e.host&&e!==document&&e.host.nodeType?e.host:e.parentNode}function w(e,t,n,r){if(e){n=n||document;do{if(null!=t&&(">"===t[0]?e.parentNode===n&&b(e,t):b(e,t))||r&&e===n)return e;if(e===n)break}while(e=E(e))}return null}var S,T=/\s+/g;function O(e,t,n){if(e&&t)if(e.classList)e.classList[n?"add":"remove"](t);else{var r=(" "+e.className+" ").replace(T," ").replace(" "+t+" "," ");e.className=(r+(n?" "+t:"")).replace(T," ")}}function R(e,t,n){var r=e&&e.style;if(r){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(e,""):e.currentStyle&&(n=e.currentStyle),void 0===t?n:n[t];t in r||-1!==t.indexOf("webkit")||(t="-webkit-"+t),r[t]=n+("string"==typeof n?"":"px")}}function N(e,t){var n="";if("string"==typeof e)n=e;else do{var r=R(e,"transform");r&&"none"!==r&&(n=r+" "+n)}while(!t&&(e=e.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function k(e,t,n){if(e){var r=e.getElementsByTagName(t),o=0,i=r.length;if(n)for(;o<i;o++)n(r[o],o);return r}return[]}function A(){var e=document.scrollingElement;return e||document.documentElement}function C(e,t,n,r,o){if(e.getBoundingClientRect||e===window){var i,a,s,u,c,f,h;if(e!==window&&e!==A()?(a=(i=e.getBoundingClientRect()).top,s=i.left,u=i.bottom,c=i.right,f=i.height,h=i.width):(a=0,s=0,u=window.innerHeight,c=window.innerWidth,f=window.innerHeight,h=window.innerWidth),(t||n)&&e!==window&&(o=o||e.parentNode,!l))do{if(o&&o.getBoundingClientRect&&("none"!==R(o,"transform")||n&&"static"!==R(o,"position"))){var p=o.getBoundingClientRect();a-=p.top+parseInt(R(o,"border-top-width")),s-=p.left+parseInt(R(o,"border-left-width")),u=a+i.height,c=s+i.width;break}}while(o=o.parentNode);if(r&&e!==window){var d=N(o||e),m=d&&d.a,v=d&&d.d;d&&(u=(a/=v)+(f/=v),c=(s/=m)+(h/=m))}return{top:a,left:s,bottom:u,right:c,width:h,height:f}}}function M(e,t,n){for(var r=L(e,!0),o=C(e)[t];r;){var i=C(r)[n];if(!("top"===n||"left"===n?o>=i:o<=i))return r;if(r===A())break;r=L(r,!1)}return!1}function x(e,t,n){for(var r=0,o=0,i=e.children;o<i.length;){if("none"!==i[o].style.display&&i[o]!==Be.ghost&&i[o]!==Be.dragged&&w(i[o],n.draggable,e,!1)){if(r===t)return i[o];r++}o++}return null}function I(e,t){for(var n=e.lastElementChild;n&&(n===Be.ghost||"none"===R(n,"display")||t&&!b(n,t));)n=n.previousElementSibling;return n||null}function _(e,t){var n=0;if(!e||!e.parentNode)return-1;for(;e=e.previousElementSibling;)"TEMPLATE"===e.nodeName.toUpperCase()||e===Be.clone||t&&!b(e,t)||n++;return n}function P(e){var t=0,n=0,r=A();if(e)do{var o=N(e),i=o.a,a=o.d;t+=e.scrollLeft*i,n+=e.scrollTop*a}while(e!==r&&(e=e.parentNode));return[t,n]}function L(e,t){if(!e||!e.getBoundingClientRect)return A();var n=e,r=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=R(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return A();if(r||t)return n;r=!0}}}while(n=n.parentNode);return A()}function F(e,t){return Math.round(e.top)===Math.round(t.top)&&Math.round(e.left)===Math.round(t.left)&&Math.round(e.height)===Math.round(t.height)&&Math.round(e.width)===Math.round(t.width)}function D(e,t){return function(){if(!S){var n=arguments,r=this;1===n.length?e.call(r,n[0]):e.apply(r,n),S=setTimeout((function(){S=void 0}),t)}}}function U(e,t,n){e.scrollLeft+=t,e.scrollTop+=n}function j(e){var t=window.Polymer,n=window.jQuery||window.Zepto;return t&&t.dom?t.dom(e).cloneNode(!0):n?n(e).clone(!0)[0]:e.cloneNode(!0)}function B(e,t){R(e,"position","absolute"),R(e,"top",t.top),R(e,"left",t.left),R(e,"width",t.width),R(e,"height",t.height)}function V(e){R(e,"position",""),R(e,"top",""),R(e,"left",""),R(e,"width",""),R(e,"height","")}var H="Sortable"+(new Date).getTime();function G(){var e,t=[];return{captureAnimationState:function(){(t=[],this.options.animation)&&[].slice.call(this.el.children).forEach((function(e){if("none"!==R(e,"display")&&e!==Be.ghost){t.push({target:e,rect:C(e)});var n=a({},t[t.length-1].rect);if(e.thisAnimationDuration){var r=N(e,!0);r&&(n.top-=r.f,n.left-=r.e)}e.fromRect=n}}))},addAnimationState:function(e){t.push(e)},removeAnimationState:function(e){t.splice(function(e,t){for(var n in e)if(e.hasOwnProperty(n))for(var r in t)if(t.hasOwnProperty(r)&&t[r]===e[n][r])return Number(n);return-1}(t,{target:e}),1)},animateAll:function(n){var r=this;if(!this.options.animation)return clearTimeout(e),void("function"==typeof n&&n());var o=!1,i=0;t.forEach((function(e){var t=0,n=e.target,a=n.fromRect,s=C(n),u=n.prevFromRect,c=n.prevToRect,l=e.rect,f=N(n,!0);f&&(s.top-=f.f,s.left-=f.e),n.toRect=s,n.thisAnimationDuration&&F(u,s)&&!F(a,s)&&(l.top-s.top)/(l.left-s.left)==(a.top-s.top)/(a.left-s.left)&&(t=function(e,t,n,r){return Math.sqrt(Math.pow(t.top-e.top,2)+Math.pow(t.left-e.left,2))/Math.sqrt(Math.pow(t.top-n.top,2)+Math.pow(t.left-n.left,2))*r.animation}(l,u,c,r.options)),F(s,a)||(n.prevFromRect=a,n.prevToRect=s,t||(t=r.options.animation),r.animate(n,l,s,t)),t&&(o=!0,i=Math.max(i,t),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),t),n.thisAnimationDuration=t)})),clearTimeout(e),o?e=setTimeout((function(){"function"==typeof n&&n()}),i):"function"==typeof n&&n(),t=[]},animate:function(e,t,n,r){if(r){R(e,"transition",""),R(e,"transform","");var o=N(this.el),i=o&&o.a,a=o&&o.d,s=(t.left-n.left)/(i||1),u=(t.top-n.top)/(a||1);e.animatingX=!!s,e.animatingY=!!u,R(e,"transform","translate3d("+s+"px,"+u+"px,0)"),function(e){e.offsetWidth}(e),R(e,"transition","transform "+r+"ms"+(this.options.easing?" "+this.options.easing:"")),R(e,"transform","translate3d(0,0,0)"),"number"==typeof e.animated&&clearTimeout(e.animated),e.animated=setTimeout((function(){R(e,"transition",""),R(e,"transform",""),e.animated=!1,e.animatingX=!1,e.animatingY=!1}),r)}}}}var z=[],W={initializeByDefault:!0},$={mount:function(e){for(var t in W)W.hasOwnProperty(t)&&!(t in e)&&(e[t]=W[t]);z.push(e)},pluginEvent:function(e,t,n){var r=this;this.eventCanceled=!1,n.cancel=function(){r.eventCanceled=!0};var o=e+"Global";z.forEach((function(r){t[r.pluginName]&&(t[r.pluginName][o]&&t[r.pluginName][o](a({sortable:t},n)),t.options[r.pluginName]&&t[r.pluginName][e]&&t[r.pluginName][e](a({sortable:t},n)))}))},initializePlugins:function(e,t,n,r){for(var o in z.forEach((function(r){var o=r.pluginName;if(e.options[o]||r.initializeByDefault){var a=new r(e,t,e.options);a.sortable=e,a.options=e.options,e[o]=a,i(n,a.defaults)}})),e.options)if(e.options.hasOwnProperty(o)){var a=this.modifyOption(e,o,e.options[o]);void 0!==a&&(e.options[o]=a)}},getEventProperties:function(e,t){var n={};return z.forEach((function(r){"function"==typeof r.eventProperties&&i(n,r.eventProperties.call(t[r.pluginName],e))})),n},modifyOption:function(e,t,n){var r;return z.forEach((function(o){e[o.pluginName]&&o.optionListeners&&"function"==typeof o.optionListeners[t]&&(r=o.optionListeners[t].call(e[o.pluginName],n))})),r}};function Y(e){var t=e.sortable,n=e.rootEl,r=e.name,o=e.targetEl,i=e.cloneEl,s=e.toEl,u=e.fromEl,c=e.oldIndex,h=e.newIndex,p=e.oldDraggableIndex,d=e.newDraggableIndex,m=e.originalEvent,v=e.putSortable,y=e.extraEventProperties;if(t=t||n&&n[H]){var g,b=t.options,E="on"+r.charAt(0).toUpperCase()+r.substr(1);!window.CustomEvent||l||f?(g=document.createEvent("Event")).initEvent(r,!0,!0):g=new CustomEvent(r,{bubbles:!0,cancelable:!0}),g.to=s||n,g.from=u||n,g.item=o||n,g.clone=i,g.oldIndex=c,g.newIndex=h,g.oldDraggableIndex=p,g.newDraggableIndex=d,g.originalEvent=m,g.pullMode=v?v.lastPutMode:void 0;var w=a({},y,$.getEventProperties(r,t));for(var S in w)g[S]=w[S];n&&n.dispatchEvent(g),b[E]&&b[E].call(t,g)}}var K=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.evt,o=s(n,["evt"]);$.pluginEvent.bind(Be)(e,t,a({dragEl:X,parentEl:J,ghostEl:Q,rootEl:Z,nextEl:ee,lastDownEl:te,cloneEl:ne,cloneHidden:re,dragStarted:ve,putSortable:ce,activeSortable:Be.active,originalEvent:r,oldIndex:oe,oldDraggableIndex:ae,newIndex:ie,newDraggableIndex:se,hideGhostForTarget:Fe,unhideGhostForTarget:De,cloneNowHidden:function(){re=!0},cloneNowShown:function(){re=!1},dispatchSortableEvent:function(e){q({sortable:t,name:e,originalEvent:r})}},o))};function q(e){Y(a({putSortable:ce,cloneEl:ne,targetEl:X,rootEl:Z,oldIndex:oe,oldDraggableIndex:ae,newIndex:ie,newDraggableIndex:se},e))}var X,J,Q,Z,ee,te,ne,re,oe,ie,ae,se,ue,ce,le,fe,he,pe,de,me,ve,ye,ge,be,Ee,we=!1,Se=!1,Te=[],Oe=!1,Re=!1,Ne=[],ke=!1,Ae=[],Ce="undefined"!=typeof document,Me=d,xe=f||l?"cssFloat":"float",Ie=Ce&&!m&&!d&&"draggable"in document.createElement("div"),_e=function(){if(Ce){if(l)return!1;var e=document.createElement("x");return e.style.cssText="pointer-events:auto","auto"===e.style.pointerEvents}}(),Pe=function(e,t){var n=R(e),r=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=x(e,0,t),i=x(e,1,t),a=o&&R(o),s=i&&R(i),u=a&&parseInt(a.marginLeft)+parseInt(a.marginRight)+C(o).width,c=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+C(i).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&a.float&&"none"!==a.float){var l="left"===a.float?"left":"right";return!i||"both"!==s.clear&&s.clear!==l?"horizontal":"vertical"}return o&&("block"===a.display||"flex"===a.display||"table"===a.display||"grid"===a.display||u>=r&&"none"===n[xe]||i&&"none"===n[xe]&&u+c>r)?"vertical":"horizontal"},Le=function(e){function t(e,n){return function(r,o,i,a){var s=r.options.group.name&&o.options.group.name&&r.options.group.name===o.options.group.name;if(null==e&&(n||s))return!0;if(null==e||!1===e)return!1;if(n&&"clone"===e)return e;if("function"==typeof e)return t(e(r,o,i,a),n)(r,o,i,a);var u=(n?r:o).options.group.name;return!0===e||"string"==typeof e&&e===u||e.join&&e.indexOf(u)>-1}}var n={},o=e.group;o&&"object"==r(o)||(o={name:o}),n.name=o.name,n.checkPull=t(o.pull,!0),n.checkPut=t(o.put),n.revertClone=o.revertClone,e.group=n},Fe=function(){!_e&&Q&&R(Q,"display","none")},De=function(){!_e&&Q&&R(Q,"display","")};Ce&&document.addEventListener("click",(function(e){if(Se)return e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.stopImmediatePropagation&&e.stopImmediatePropagation(),Se=!1,!1}),!0);var Ue=function(e){if(X){e=e.touches?e.touches[0]:e;var t=(o=e.clientX,i=e.clientY,Te.some((function(e){if(!I(e)){var t=C(e),n=e[H].options.emptyInsertThreshold,r=o>=t.left-n&&o<=t.right+n,s=i>=t.top-n&&i<=t.bottom+n;return n&&r&&s?a=e:void 0}})),a);if(t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);n.target=n.rootEl=t,n.preventDefault=void 0,n.stopPropagation=void 0,t[H]._onDragOver(n)}}var o,i,a},je=function(e){X&&X.parentNode[H]._isOutsideThisEl(e.target)};function Be(e,t){if(!e||!e.nodeType||1!==e.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(e));this.el=e,this.options=t=i({},t),e[H]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(e.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Pe(e,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(e,t){e.setData("Text",t.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==Be.supportPointer&&"PointerEvent"in window,emptyInsertThreshold:5};for(var r in $.initializePlugins(this,e,n),n)!(r in t)&&(t[r]=n[r]);for(var o in Le(t),this)"_"===o.charAt(0)&&"function"==typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!t.forceFallback&&Ie,this.nativeDraggable&&(this.options.touchStartThreshold=1),t.supportPointer?y(e,"pointerdown",this._onTapStart):(y(e,"mousedown",this._onTapStart),y(e,"touchstart",this._onTapStart)),this.nativeDraggable&&(y(e,"dragover",this),y(e,"dragenter",this)),Te.push(this.el),t.store&&t.store.get&&this.sort(t.store.get(this)||[]),i(this,G())}function Ve(e,t,n,r,o,i,a,s){var u,c,h=e[H],p=h.options.onMove;return!window.CustomEvent||l||f?(u=document.createEvent("Event")).initEvent("move",!0,!0):u=new CustomEvent("move",{bubbles:!0,cancelable:!0}),u.to=t,u.from=e,u.dragged=n,u.draggedRect=r,u.related=o||t,u.relatedRect=i||C(t),u.willInsertAfter=s,u.originalEvent=a,e.dispatchEvent(u),p&&(c=p.call(h,u,a)),c}function He(e){e.draggable=!1}function Ge(){ke=!1}function ze(e){for(var t=e.tagName+e.className+e.src+e.href+e.textContent,n=t.length,r=0;n--;)r+=t.charCodeAt(n);return r.toString(36)}function We(e){return setTimeout(e,0)}function $e(e){return clearTimeout(e)}Be.prototype={constructor:Be,_isOutsideThisEl:function(e){this.el.contains(e)||e===this.el||(ye=null)},_getDirection:function(e,t){return"function"==typeof this.options.direction?this.options.direction.call(this,e,t,X):this.options.direction},_onTapStart:function(e){if(e.cancelable){var t=this,n=this.el,r=this.options,o=r.preventOnFilter,i=e.type,a=e.touches&&e.touches[0]||e.pointerType&&"touch"===e.pointerType&&e,s=(a||e).target,u=e.target.shadowRoot&&(e.path&&e.path[0]||e.composedPath&&e.composedPath()[0])||s,c=r.filter;if(function(e){Ae.length=0;var t=e.getElementsByTagName("input"),n=t.length;for(;n--;){var r=t[n];r.checked&&Ae.push(r)}}(n),!X&&!(/mousedown|pointerdown/.test(i)&&0!==e.button||r.disabled||u.isContentEditable||(s=w(s,r.draggable,n,!1))&&s.animated||te===s)){if(oe=_(s),ae=_(s,r.draggable),"function"==typeof c){if(c.call(this,e,s,this))return q({sortable:t,rootEl:u,name:"filter",targetEl:s,toEl:n,fromEl:n}),K("filter",t,{evt:e}),void(o&&e.cancelable&&e.preventDefault())}else if(c&&(c=c.split(",").some((function(r){if(r=w(u,r.trim(),n,!1))return q({sortable:t,rootEl:r,name:"filter",targetEl:s,fromEl:n,toEl:n}),K("filter",t,{evt:e}),!0}))))return void(o&&e.cancelable&&e.preventDefault());r.handle&&!w(u,r.handle,n,!1)||this._prepareDragStart(e,a,s)}}},_prepareDragStart:function(e,t,n){var r,o=this,i=o.el,a=o.options,s=i.ownerDocument;if(n&&!X&&n.parentNode===i){var u=C(n);if(Z=i,J=(X=n).parentNode,ee=X.nextSibling,te=n,ue=a.group,Be.dragged=X,le={target:X,clientX:(t||e).clientX,clientY:(t||e).clientY},de=le.clientX-u.left,me=le.clientY-u.top,this._lastX=(t||e).clientX,this._lastY=(t||e).clientY,X.style["will-change"]="all",r=function(){K("delayEnded",o,{evt:e}),Be.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!h&&o.nativeDraggable&&(X.draggable=!0),o._triggerDragStart(e,t),q({sortable:o,name:"choose",originalEvent:e}),O(X,a.chosenClass,!0))},a.ignore.split(",").forEach((function(e){k(X,e.trim(),He)})),y(s,"dragover",Ue),y(s,"mousemove",Ue),y(s,"touchmove",Ue),y(s,"mouseup",o._onDrop),y(s,"touchend",o._onDrop),y(s,"touchcancel",o._onDrop),h&&this.nativeDraggable&&(this.options.touchStartThreshold=4,X.draggable=!0),K("delayStart",this,{evt:e}),!a.delay||a.delayOnTouchOnly&&!t||this.nativeDraggable&&(f||l))r();else{if(Be.eventCanceled)return void this._onDrop();y(s,"mouseup",o._disableDelayedDrag),y(s,"touchend",o._disableDelayedDrag),y(s,"touchcancel",o._disableDelayedDrag),y(s,"mousemove",o._delayedDragTouchMoveHandler),y(s,"touchmove",o._delayedDragTouchMoveHandler),a.supportPointer&&y(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(r,a.delay)}}},_delayedDragTouchMoveHandler:function(e){var t=e.touches?e.touches[0]:e;Math.max(Math.abs(t.clientX-this._lastX),Math.abs(t.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){X&&He(X),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._disableDelayedDrag),g(e,"touchend",this._disableDelayedDrag),g(e,"touchcancel",this._disableDelayedDrag),g(e,"mousemove",this._delayedDragTouchMoveHandler),g(e,"touchmove",this._delayedDragTouchMoveHandler),g(e,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(e,t){t=t||"touch"==e.pointerType&&e,!this.nativeDraggable||t?this.options.supportPointer?y(document,"pointermove",this._onTouchMove):y(document,t?"touchmove":"mousemove",this._onTouchMove):(y(X,"dragend",this),y(Z,"dragstart",this._onDragStart));try{document.selection?We((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(e,t){if(we=!1,Z&&X){K("dragStarted",this,{evt:t}),this.nativeDraggable&&y(document,"dragover",je);var n=this.options;!e&&O(X,n.dragClass,!1),O(X,n.ghostClass,!0),Be.active=this,e&&this._appendGhost(),q({sortable:this,name:"start",originalEvent:t})}else this._nulling()},_emulateDragOver:function(){if(fe){this._lastX=fe.clientX,this._lastY=fe.clientY,Fe();for(var e=document.elementFromPoint(fe.clientX,fe.clientY),t=e;e&&e.shadowRoot&&(e=e.shadowRoot.elementFromPoint(fe.clientX,fe.clientY))!==t;)t=e;if(X.parentNode[H]._isOutsideThisEl(e),t)do{if(t[H]){if(t[H]._onDragOver({clientX:fe.clientX,clientY:fe.clientY,target:e,rootEl:t})&&!this.options.dragoverBubble)break}e=t}while(t=t.parentNode);De()}},_onTouchMove:function(e){if(le){var t=this.options,n=t.fallbackTolerance,r=t.fallbackOffset,o=e.touches?e.touches[0]:e,i=Q&&N(Q,!0),a=Q&&i&&i.a,s=Q&&i&&i.d,u=Me&&Ee&&P(Ee),c=(o.clientX-le.clientX+r.x)/(a||1)+(u?u[0]-Ne[0]:0)/(a||1),l=(o.clientY-le.clientY+r.y)/(s||1)+(u?u[1]-Ne[1]:0)/(s||1);if(!Be.active&&!we){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(e,!0)}if(Q){i?(i.e+=c-(he||0),i.f+=l-(pe||0)):i={a:1,b:0,c:0,d:1,e:c,f:l};var f="matrix(".concat(i.a,",").concat(i.b,",").concat(i.c,",").concat(i.d,",").concat(i.e,",").concat(i.f,")");R(Q,"webkitTransform",f),R(Q,"mozTransform",f),R(Q,"msTransform",f),R(Q,"transform",f),he=c,pe=l,fe=o}e.cancelable&&e.preventDefault()}},_appendGhost:function(){if(!Q){var e=this.options.fallbackOnBody?document.body:Z,t=C(X,!0,Me,!0,e),n=this.options;if(Me){for(Ee=e;"static"===R(Ee,"position")&&"none"===R(Ee,"transform")&&Ee!==document;)Ee=Ee.parentNode;Ee!==document.body&&Ee!==document.documentElement?(Ee===document&&(Ee=A()),t.top+=Ee.scrollTop,t.left+=Ee.scrollLeft):Ee=A(),Ne=P(Ee)}O(Q=X.cloneNode(!0),n.ghostClass,!1),O(Q,n.fallbackClass,!0),O(Q,n.dragClass,!0),R(Q,"transition",""),R(Q,"transform",""),R(Q,"box-sizing","border-box"),R(Q,"margin",0),R(Q,"top",t.top),R(Q,"left",t.left),R(Q,"width",t.width),R(Q,"height",t.height),R(Q,"opacity","0.8"),R(Q,"position",Me?"absolute":"fixed"),R(Q,"zIndex","100000"),R(Q,"pointerEvents","none"),Be.ghost=Q,e.appendChild(Q),R(Q,"transform-origin",de/parseInt(Q.style.width)*100+"% "+me/parseInt(Q.style.height)*100+"%")}},_onDragStart:function(e,t){var n=this,r=e.dataTransfer,o=n.options;K("dragStart",this,{evt:e}),Be.eventCanceled?this._onDrop():(K("setupClone",this),Be.eventCanceled||((ne=j(X)).draggable=!1,ne.style["will-change"]="",this._hideClone(),O(ne,this.options.chosenClass,!1),Be.clone=ne),n.cloneId=We((function(){K("clone",n),Be.eventCanceled||(n.options.removeCloneOnHide||Z.insertBefore(ne,X),n._hideClone(),q({sortable:n,name:"clone"}))})),!t&&O(X,o.dragClass,!0),t?(Se=!0,n._loopId=setInterval(n._emulateDragOver,50)):(g(document,"mouseup",n._onDrop),g(document,"touchend",n._onDrop),g(document,"touchcancel",n._onDrop),r&&(r.effectAllowed="move",o.setData&&o.setData.call(n,r,X)),y(document,"drop",n),R(X,"transform","translateZ(0)")),we=!0,n._dragStartId=We(n._dragStarted.bind(n,t,e)),y(document,"selectstart",n),ve=!0,p&&R(document.body,"user-select","none"))},_onDragOver:function(e){var t,n,r,o,i=this.el,s=e.target,u=this.options,c=u.group,l=Be.active,f=ue===c,h=u.sort,p=ce||l,d=this,m=!1;if(!ke){if(void 0!==e.preventDefault&&e.cancelable&&e.preventDefault(),s=w(s,u.draggable,i,!0),F("dragOver"),Be.eventCanceled)return m;if(X.contains(e.target)||s.animated&&s.animatingX&&s.animatingY||d._ignoreWhileAnimating===s)return j(!1);if(Se=!1,l&&!u.disabled&&(f?h||(r=!Z.contains(X)):ce===this||(this.lastPutMode=ue.checkPull(this,l,X,e))&&c.checkPut(this,l,X,e))){if(o="vertical"===this._getDirection(e,s),t=C(X),F("dragOverValid"),Be.eventCanceled)return m;if(r)return J=Z,D(),this._hideClone(),F("revert"),Be.eventCanceled||(ee?Z.insertBefore(X,ee):Z.appendChild(X)),j(!0);var v=I(i,u.draggable);if(!v||function(e,t,n){var r=C(I(n.el,n.options.draggable));return t?e.clientX>r.right+10||e.clientX<=r.right&&e.clientY>r.bottom&&e.clientX>=r.left:e.clientX>r.right&&e.clientY>r.top||e.clientX<=r.right&&e.clientY>r.bottom+10}(e,o,this)&&!v.animated){if(v===X)return j(!1);if(v&&i===e.target&&(s=v),s&&(n=C(s)),!1!==Ve(Z,i,X,t,s,n,e,!!s))return D(),i.appendChild(X),J=i,B(),j(!0)}else if(s.parentNode===i){n=C(s);var y,g,b,E=X.parentNode!==i,S=!function(e,t,n){var r=n?e.left:e.top,o=n?e.right:e.bottom,i=n?e.width:e.height,a=n?t.left:t.top,s=n?t.right:t.bottom,u=n?t.width:t.height;return r===a||o===s||r+i/2===a+u/2}(X.animated&&X.toRect||t,s.animated&&s.toRect||n,o),T=o?"top":"left",N=M(s,"top","top")||M(X,"top","top"),k=N?N.scrollTop:void 0;if(ye!==s&&(g=n[T],Oe=!1,Re=!S&&u.invertSwap||E),0!==(y=function(e,t,n,r,o,i,a,s){var u=r?e.clientY:e.clientX,c=r?n.height:n.width,l=r?n.top:n.left,f=r?n.bottom:n.right,h=!1;if(!a)if(s&&be<c*o){if(!Oe&&(1===ge?u>l+c*i/2:u<f-c*i/2)&&(Oe=!0),Oe)h=!0;else if(1===ge?u<l+be:u>f-be)return-ge}else if(u>l+c*(1-o)/2&&u<f-c*(1-o)/2)return function(e){return _(X)<_(e)?1:-1}(t);if((h=h||a)&&(u<l+c*i/2||u>f-c*i/2))return u>l+c/2?1:-1;return 0}(e,s,n,o,S?1:u.swapThreshold,null==u.invertedSwapThreshold?u.swapThreshold:u.invertedSwapThreshold,Re,ye===s))){var A=_(X);do{A-=y,b=J.children[A]}while(b&&("none"===R(b,"display")||b===Q))}if(0===y||b===s)return j(!1);ye=s,ge=y;var x=s.nextElementSibling,P=!1,L=Ve(Z,i,X,t,s,n,e,P=1===y);if(!1!==L)return 1!==L&&-1!==L||(P=1===L),ke=!0,setTimeout(Ge,30),D(),P&&!x?i.appendChild(X):s.parentNode.insertBefore(X,P?x:s),N&&U(N,0,k-N.scrollTop),J=X.parentNode,void 0===g||Re||(be=Math.abs(g-C(s)[T])),B(),j(!0)}if(i.contains(X))return j(!1)}return!1}function F(u,c){K(u,d,a({evt:e,isOwner:f,axis:o?"vertical":"horizontal",revert:r,dragRect:t,targetRect:n,canSort:h,fromSortable:p,target:s,completed:j,onMove:function(n,r){return Ve(Z,i,X,t,n,C(n),e,r)},changed:B},c))}function D(){F("dragOverAnimationCapture"),d.captureAnimationState(),d!==p&&p.captureAnimationState()}function j(t){return F("dragOverCompleted",{insertion:t}),t&&(f?l._hideClone():l._showClone(d),d!==p&&(O(X,ce?ce.options.ghostClass:l.options.ghostClass,!1),O(X,u.ghostClass,!0)),ce!==d&&d!==Be.active?ce=d:d===Be.active&&ce&&(ce=null),p===d&&(d._ignoreWhileAnimating=s),d.animateAll((function(){F("dragOverAnimationComplete"),d._ignoreWhileAnimating=null})),d!==p&&(p.animateAll(),p._ignoreWhileAnimating=null)),(s===X&&!X.animated||s===i&&!s.animated)&&(ye=null),u.dragoverBubble||e.rootEl||s===document||(X.parentNode[H]._isOutsideThisEl(e.target),!t&&Ue(e)),!u.dragoverBubble&&e.stopPropagation&&e.stopPropagation(),m=!0}function B(){ie=_(X),se=_(X,u.draggable),q({sortable:d,name:"change",toEl:i,newIndex:ie,newDraggableIndex:se,originalEvent:e})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){g(document,"mousemove",this._onTouchMove),g(document,"touchmove",this._onTouchMove),g(document,"pointermove",this._onTouchMove),g(document,"dragover",Ue),g(document,"mousemove",Ue),g(document,"touchmove",Ue)},_offUpEvents:function(){var e=this.el.ownerDocument;g(e,"mouseup",this._onDrop),g(e,"touchend",this._onDrop),g(e,"pointerup",this._onDrop),g(e,"touchcancel",this._onDrop),g(document,"selectstart",this)},_onDrop:function(e){var t=this.el,n=this.options;ie=_(X),se=_(X,n.draggable),K("drop",this,{evt:e}),J=X&&X.parentNode,ie=_(X),se=_(X,n.draggable),Be.eventCanceled||(we=!1,Re=!1,Oe=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),$e(this.cloneId),$e(this._dragStartId),this.nativeDraggable&&(g(document,"drop",this),g(t,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),p&&R(document.body,"user-select",""),R(X,"transform",""),e&&(ve&&(e.cancelable&&e.preventDefault(),!n.dropBubble&&e.stopPropagation()),Q&&Q.parentNode&&Q.parentNode.removeChild(Q),(Z===J||ce&&"clone"!==ce.lastPutMode)&&ne&&ne.parentNode&&ne.parentNode.removeChild(ne),X&&(this.nativeDraggable&&g(X,"dragend",this),He(X),X.style["will-change"]="",ve&&!we&&O(X,ce?ce.options.ghostClass:this.options.ghostClass,!1),O(X,this.options.chosenClass,!1),q({sortable:this,name:"unchoose",toEl:J,newIndex:null,newDraggableIndex:null,originalEvent:e}),Z!==J?(ie>=0&&(q({rootEl:J,name:"add",toEl:J,fromEl:Z,originalEvent:e}),q({sortable:this,name:"remove",toEl:J,originalEvent:e}),q({rootEl:J,name:"sort",toEl:J,fromEl:Z,originalEvent:e}),q({sortable:this,name:"sort",toEl:J,originalEvent:e})),ce&&ce.save()):ie!==oe&&ie>=0&&(q({sortable:this,name:"update",toEl:J,originalEvent:e}),q({sortable:this,name:"sort",toEl:J,originalEvent:e})),Be.active&&(null!=ie&&-1!==ie||(ie=oe,se=ae),q({sortable:this,name:"end",toEl:J,originalEvent:e}),this.save())))),this._nulling()},_nulling:function(){K("nulling",this),Z=X=J=Q=ee=ne=te=re=le=fe=ve=ie=se=oe=ae=ye=ge=ce=ue=Be.dragged=Be.ghost=Be.clone=Be.active=null,Ae.forEach((function(e){e.checked=!0})),Ae.length=he=pe=0},handleEvent:function(e){switch(e.type){case"drop":case"dragend":this._onDrop(e);break;case"dragenter":case"dragover":X&&(this._onDragOver(e),function(e){e.dataTransfer&&(e.dataTransfer.dropEffect="move");e.cancelable&&e.preventDefault()}(e));break;case"selectstart":e.preventDefault()}},toArray:function(){for(var e,t=[],n=this.el.children,r=0,o=n.length,i=this.options;r<o;r++)w(e=n[r],i.draggable,this.el,!1)&&t.push(e.getAttribute(i.dataIdAttr)||ze(e));return t},sort:function(e){var t={},n=this.el;this.toArray().forEach((function(e,r){var o=n.children[r];w(o,this.options.draggable,n,!1)&&(t[e]=o)}),this),e.forEach((function(e){t[e]&&(n.removeChild(t[e]),n.appendChild(t[e]))}))},save:function(){var e=this.options.store;e&&e.set&&e.set(this)},closest:function(e,t){return w(e,t||this.options.draggable,this.el,!1)},option:function(e,t){var n=this.options;if(void 0===t)return n[e];var r=$.modifyOption(this,e,t);n[e]=void 0!==r?r:t,"group"===e&&Le(n)},destroy:function(){K("destroy",this);var e=this.el;e[H]=null,g(e,"mousedown",this._onTapStart),g(e,"touchstart",this._onTapStart),g(e,"pointerdown",this._onTapStart),this.nativeDraggable&&(g(e,"dragover",this),g(e,"dragenter",this)),Array.prototype.forEach.call(e.querySelectorAll("[draggable]"),(function(e){e.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Te.splice(Te.indexOf(this.el),1),this.el=e=null},_hideClone:function(){if(!re){if(K("hideClone",this),Be.eventCanceled)return;R(ne,"display","none"),this.options.removeCloneOnHide&&ne.parentNode&&ne.parentNode.removeChild(ne),re=!0}},_showClone:function(e){if("clone"===e.lastPutMode){if(re){if(K("showClone",this),Be.eventCanceled)return;Z.contains(X)&&!this.options.group.revertClone?Z.insertBefore(ne,X):ee?Z.insertBefore(ne,ee):Z.appendChild(ne),this.options.group.revertClone&&this.animate(X,ne),R(ne,"display",""),re=!1}}else this._hideClone()}},Ce&&y(document,"touchmove",(function(e){(Be.active||we)&&e.cancelable&&e.preventDefault()})),Be.utils={on:y,off:g,css:R,find:k,is:function(e,t){return!!w(e,t,e,!1)},extend:function(e,t){if(e&&t)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e},throttle:D,closest:w,toggleClass:O,clone:j,index:_,nextTick:We,cancelNextTick:$e,detectDirection:Pe,getChild:x},Be.get=function(e){return e[H]},Be.mount=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t[0].constructor===Array&&(t=t[0]),t.forEach((function(e){if(!e.prototype||!e.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(e));e.utils&&(Be.utils=a({},Be.utils,e.utils)),$.mount(e)}))},Be.create=function(e,t){return new Be(e,t)},Be.version="1.10.2";var Ye,Ke,qe,Xe,Je,Qe,Ze=[],et=!1;function tt(){Ze.forEach((function(e){clearInterval(e.pid)})),Ze=[]}function nt(){clearInterval(Qe)}var rt,ot=D((function(e,t,n,r){if(t.scroll){var o,i=(e.touches?e.touches[0]:e).clientX,a=(e.touches?e.touches[0]:e).clientY,s=t.scrollSensitivity,u=t.scrollSpeed,c=A(),l=!1;Ke!==n&&(Ke=n,tt(),Ye=t.scroll,o=t.scrollFn,!0===Ye&&(Ye=L(n,!0)));var f=0,h=Ye;do{var p=h,d=C(p),m=d.top,v=d.bottom,y=d.left,g=d.right,b=d.width,E=d.height,w=void 0,S=void 0,T=p.scrollWidth,O=p.scrollHeight,N=R(p),k=p.scrollLeft,M=p.scrollTop;p===c?(w=b<T&&("auto"===N.overflowX||"scroll"===N.overflowX||"visible"===N.overflowX),S=E<O&&("auto"===N.overflowY||"scroll"===N.overflowY||"visible"===N.overflowY)):(w=b<T&&("auto"===N.overflowX||"scroll"===N.overflowX),S=E<O&&("auto"===N.overflowY||"scroll"===N.overflowY));var x=w&&(Math.abs(g-i)<=s&&k+b<T)-(Math.abs(y-i)<=s&&!!k),I=S&&(Math.abs(v-a)<=s&&M+E<O)-(Math.abs(m-a)<=s&&!!M);if(!Ze[f])for(var _=0;_<=f;_++)Ze[_]||(Ze[_]={});Ze[f].vx==x&&Ze[f].vy==I&&Ze[f].el===p||(Ze[f].el=p,Ze[f].vx=x,Ze[f].vy=I,clearInterval(Ze[f].pid),0==x&&0==I||(l=!0,Ze[f].pid=setInterval(function(){r&&0===this.layer&&Be.active._onTouchMove(Je);var t=Ze[this.layer].vy?Ze[this.layer].vy*u:0,n=Ze[this.layer].vx?Ze[this.layer].vx*u:0;"function"==typeof o&&"continue"!==o.call(Be.dragged.parentNode[H],n,t,e,Je,Ze[this.layer].el)||U(Ze[this.layer].el,n,t)}.bind({layer:f}),24))),f++}while(t.bubbleScroll&&h!==c&&(h=L(h,!1)));et=l}}),30),it=function(e){var t=e.originalEvent,n=e.putSortable,r=e.dragEl,o=e.activeSortable,i=e.dispatchSortableEvent,a=e.hideGhostForTarget,s=e.unhideGhostForTarget;if(t){var u=n||o;a();var c=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:t,l=document.elementFromPoint(c.clientX,c.clientY);s(),u&&!u.el.contains(l)&&(i("spill"),this.onSpill({dragEl:r,putSortable:n}))}};function at(){}function st(){}function ut(){function e(){this.defaults={swapClass:"sortable-swap-highlight"}}return e.prototype={dragStart:function(e){var t=e.dragEl;rt=t},dragOverValid:function(e){var t=e.completed,n=e.target,r=e.onMove,o=e.activeSortable,i=e.changed,a=e.cancel;if(o.options.swap){var s=this.sortable.el,u=this.options;if(n&&n!==s){var c=rt;!1!==r(n)?(O(n,u.swapClass,!0),rt=n):rt=null,c&&c!==rt&&O(c,u.swapClass,!1)}i(),t(!0),a()}},drop:function(e){var t=e.activeSortable,n=e.putSortable,r=e.dragEl,o=n||this.sortable,i=this.options;rt&&O(rt,i.swapClass,!1),rt&&(i.swap||n&&n.options.swap)&&r!==rt&&(o.captureAnimationState(),o!==t&&t.captureAnimationState(),function(e,t){var n,r,o=e.parentNode,i=t.parentNode;if(!o||!i||o.isEqualNode(t)||i.isEqualNode(e))return;n=_(e),r=_(t),o.isEqualNode(i)&&n<r&&r++;o.insertBefore(t,o.children[n]),i.insertBefore(e,i.children[r])}(r,rt),o.animateAll(),o!==t&&t.animateAll())},nulling:function(){rt=null}},i(e,{pluginName:"swap",eventProperties:function(){return{swapItem:rt}}})}at.prototype={startIndex:null,dragStart:function(e){var t=e.oldDraggableIndex;this.startIndex=t},onSpill:function(e){var t=e.dragEl,n=e.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var r=x(this.sortable.el,this.startIndex,this.options);r?this.sortable.el.insertBefore(t,r):this.sortable.el.appendChild(t),this.sortable.animateAll(),n&&n.animateAll()},drop:it},i(at,{pluginName:"revertOnSpill"}),st.prototype={onSpill:function(e){var t=e.dragEl,n=e.putSortable||this.sortable;n.captureAnimationState(),t.parentNode&&t.parentNode.removeChild(t),n.animateAll()},drop:it},i(st,{pluginName:"removeOnSpill"});var ct,lt,ft,ht,pt,dt=[],mt=[],vt=!1,yt=!1,gt=!1;function bt(){function e(e){for(var t in this)"_"===t.charAt(0)&&"function"==typeof this[t]&&(this[t]=this[t].bind(this));e.options.supportPointer?y(document,"pointerup",this._deselectMultiDrag):(y(document,"mouseup",this._deselectMultiDrag),y(document,"touchend",this._deselectMultiDrag)),y(document,"keydown",this._checkKeyDown),y(document,"keyup",this._checkKeyUp),this.defaults={selectedClass:"sortable-selected",multiDragKey:null,setData:function(t,n){var r="";dt.length&&lt===e?dt.forEach((function(e,t){r+=(t?", ":"")+e.textContent})):r=n.textContent,t.setData("Text",r)}}}return e.prototype={multiDragKeyDown:!1,isMultiDrag:!1,delayStartGlobal:function(e){var t=e.dragEl;ft=t},delayEnded:function(){this.isMultiDrag=~dt.indexOf(ft)},setupClone:function(e){var t=e.sortable,n=e.cancel;if(this.isMultiDrag){for(var r=0;r<dt.length;r++)mt.push(j(dt[r])),mt[r].sortableIndex=dt[r].sortableIndex,mt[r].draggable=!1,mt[r].style["will-change"]="",O(mt[r],this.options.selectedClass,!1),dt[r]===ft&&O(mt[r],this.options.chosenClass,!1);t._hideClone(),n()}},clone:function(e){var t=e.sortable,n=e.rootEl,r=e.dispatchSortableEvent,o=e.cancel;this.isMultiDrag&&(this.options.removeCloneOnHide||dt.length&&lt===t&&(Et(!0,n),r("clone"),o()))},showClone:function(e){var t=e.cloneNowShown,n=e.rootEl,r=e.cancel;this.isMultiDrag&&(Et(!1,n),mt.forEach((function(e){R(e,"display","")})),t(),pt=!1,r())},hideClone:function(e){var t=this,n=(e.sortable,e.cloneNowHidden),r=e.cancel;this.isMultiDrag&&(mt.forEach((function(e){R(e,"display","none"),t.options.removeCloneOnHide&&e.parentNode&&e.parentNode.removeChild(e)})),n(),pt=!0,r())},dragStartGlobal:function(e){e.sortable;!this.isMultiDrag&&lt&&lt.multiDrag._deselectMultiDrag(),dt.forEach((function(e){e.sortableIndex=_(e)})),dt=dt.sort((function(e,t){return e.sortableIndex-t.sortableIndex})),gt=!0},dragStarted:function(e){var t=this,n=e.sortable;if(this.isMultiDrag){if(this.options.sort&&(n.captureAnimationState(),this.options.animation)){dt.forEach((function(e){e!==ft&&R(e,"position","absolute")}));var r=C(ft,!1,!0,!0);dt.forEach((function(e){e!==ft&&B(e,r)})),yt=!0,vt=!0}n.animateAll((function(){yt=!1,vt=!1,t.options.animation&&dt.forEach((function(e){V(e)})),t.options.sort&&wt()}))}},dragOver:function(e){var t=e.target,n=e.completed,r=e.cancel;yt&&~dt.indexOf(t)&&(n(!1),r())},revert:function(e){var t=e.fromSortable,n=e.rootEl,r=e.sortable,o=e.dragRect;dt.length>1&&(dt.forEach((function(e){r.addAnimationState({target:e,rect:yt?C(e):o}),V(e),e.fromRect=o,t.removeAnimationState(e)})),yt=!1,function(e,t){dt.forEach((function(n,r){var o=t.children[n.sortableIndex+(e?Number(r):0)];o?t.insertBefore(n,o):t.appendChild(n)}))}(!this.options.removeCloneOnHide,n))},dragOverCompleted:function(e){var t=e.sortable,n=e.isOwner,r=e.insertion,o=e.activeSortable,i=e.parentEl,a=e.putSortable,s=this.options;if(r){if(n&&o._hideClone(),vt=!1,s.animation&&dt.length>1&&(yt||!n&&!o.options.sort&&!a)){var u=C(ft,!1,!0,!0);dt.forEach((function(e){e!==ft&&(B(e,u),i.appendChild(e))})),yt=!0}if(!n)if(yt||wt(),dt.length>1){var c=pt;o._showClone(t),o.options.animation&&!pt&&c&&mt.forEach((function(e){o.addAnimationState({target:e,rect:ht}),e.fromRect=ht,e.thisAnimationDuration=null}))}else o._showClone(t)}},dragOverAnimationCapture:function(e){var t=e.dragRect,n=e.isOwner,r=e.activeSortable;if(dt.forEach((function(e){e.thisAnimationDuration=null})),r.options.animation&&!n&&r.multiDrag.isMultiDrag){ht=i({},t);var o=N(ft,!0);ht.top-=o.f,ht.left-=o.e}},dragOverAnimationComplete:function(){yt&&(yt=!1,wt())},drop:function(e){var t=e.originalEvent,n=e.rootEl,r=e.parentEl,o=e.sortable,i=e.dispatchSortableEvent,a=e.oldIndex,s=e.putSortable,u=s||this.sortable;if(t){var c=this.options,l=r.children;if(!gt)if(c.multiDragKey&&!this.multiDragKeyDown&&this._deselectMultiDrag(),O(ft,c.selectedClass,!~dt.indexOf(ft)),~dt.indexOf(ft))dt.splice(dt.indexOf(ft),1),ct=null,Y({sortable:o,rootEl:n,name:"deselect",targetEl:ft,originalEvt:t});else{if(dt.push(ft),Y({sortable:o,rootEl:n,name:"select",targetEl:ft,originalEvt:t}),t.shiftKey&&ct&&o.el.contains(ct)){var f,h,p=_(ct),d=_(ft);if(~p&&~d&&p!==d)for(d>p?(h=p,f=d):(h=d,f=p+1);h<f;h++)~dt.indexOf(l[h])||(O(l[h],c.selectedClass,!0),dt.push(l[h]),Y({sortable:o,rootEl:n,name:"select",targetEl:l[h],originalEvt:t}))}else ct=ft;lt=u}if(gt&&this.isMultiDrag){if((r[H].options.sort||r!==n)&&dt.length>1){var m=C(ft),v=_(ft,":not(."+this.options.selectedClass+")");if(!vt&&c.animation&&(ft.thisAnimationDuration=null),u.captureAnimationState(),!vt&&(c.animation&&(ft.fromRect=m,dt.forEach((function(e){if(e.thisAnimationDuration=null,e!==ft){var t=yt?C(e):m;e.fromRect=t,u.addAnimationState({target:e,rect:t})}}))),wt(),dt.forEach((function(e){l[v]?r.insertBefore(e,l[v]):r.appendChild(e),v++})),a===_(ft))){var y=!1;dt.forEach((function(e){e.sortableIndex===_(e)||(y=!0)})),y&&i("update")}dt.forEach((function(e){V(e)})),u.animateAll()}lt=u}(n===r||s&&"clone"!==s.lastPutMode)&&mt.forEach((function(e){e.parentNode&&e.parentNode.removeChild(e)}))}},nullingGlobal:function(){this.isMultiDrag=gt=!1,mt.length=0},destroyGlobal:function(){this._deselectMultiDrag(),g(document,"pointerup",this._deselectMultiDrag),g(document,"mouseup",this._deselectMultiDrag),g(document,"touchend",this._deselectMultiDrag),g(document,"keydown",this._checkKeyDown),g(document,"keyup",this._checkKeyUp)},_deselectMultiDrag:function(e){if(!(void 0!==gt&&gt||lt!==this.sortable||e&&w(e.target,this.options.draggable,this.sortable.el,!1)||e&&0!==e.button))for(;dt.length;){var t=dt[0];O(t,this.options.selectedClass,!1),dt.shift(),Y({sortable:this.sortable,rootEl:this.sortable.el,name:"deselect",targetEl:t,originalEvt:e})}},_checkKeyDown:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!0)},_checkKeyUp:function(e){e.key===this.options.multiDragKey&&(this.multiDragKeyDown=!1)}},i(e,{pluginName:"multiDrag",utils:{select:function(e){var t=e.parentNode[H];t&&t.options.multiDrag&&!~dt.indexOf(e)&&(lt&&lt!==t&&(lt.multiDrag._deselectMultiDrag(),lt=t),O(e,t.options.selectedClass,!0),dt.push(e))},deselect:function(e){var t=e.parentNode[H],n=dt.indexOf(e);t&&t.options.multiDrag&&~n&&(O(e,t.options.selectedClass,!1),dt.splice(n,1))}},eventProperties:function(){var e=this,t=[],n=[];return dt.forEach((function(r){var o;t.push({multiDragElement:r,index:r.sortableIndex}),o=yt&&r!==ft?-1:yt?_(r,":not(."+e.options.selectedClass+")"):_(r),n.push({multiDragElement:r,index:o})})),{items:u(dt),clones:[].concat(mt),oldIndicies:t,newIndicies:n}},optionListeners:{multiDragKey:function(e){return"ctrl"===(e=e.toLowerCase())?e="Control":e.length>1&&(e=e.charAt(0).toUpperCase()+e.substr(1)),e}}})}function Et(e,t){mt.forEach((function(n,r){var o=t.children[n.sortableIndex+(e?Number(r):0)];o?t.insertBefore(n,o):t.appendChild(n)}))}function wt(){dt.forEach((function(e){e!==ft&&e.parentNode&&e.parentNode.removeChild(e)}))}Be.mount(new function(){function e(){for(var e in this.defaults={scroll:!0,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===e.charAt(0)&&"function"==typeof this[e]&&(this[e]=this[e].bind(this))}return e.prototype={dragStarted:function(e){var t=e.originalEvent;this.sortable.nativeDraggable?y(document,"dragover",this._handleAutoScroll):this.options.supportPointer?y(document,"pointermove",this._handleFallbackAutoScroll):t.touches?y(document,"touchmove",this._handleFallbackAutoScroll):y(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(e){var t=e.originalEvent;this.options.dragOverBubble||t.rootEl||this._handleAutoScroll(t)},drop:function(){this.sortable.nativeDraggable?g(document,"dragover",this._handleAutoScroll):(g(document,"pointermove",this._handleFallbackAutoScroll),g(document,"touchmove",this._handleFallbackAutoScroll),g(document,"mousemove",this._handleFallbackAutoScroll)),nt(),tt(),clearTimeout(S),S=void 0},nulling:function(){Je=Ke=Ye=et=Qe=qe=Xe=null,Ze.length=0},_handleFallbackAutoScroll:function(e){this._handleAutoScroll(e,!0)},_handleAutoScroll:function(e,t){var n=this,r=(e.touches?e.touches[0]:e).clientX,o=(e.touches?e.touches[0]:e).clientY,i=document.elementFromPoint(r,o);if(Je=e,t||f||l||p){ot(e,this.options,i,t);var a=L(i,!0);!et||Qe&&r===qe&&o===Xe||(Qe&&nt(),Qe=setInterval((function(){var i=L(document.elementFromPoint(r,o),!0);i!==a&&(a=i,tt()),ot(e,n.options,i,t)}),10),qe=r,Xe=o)}else{if(!this.options.bubbleScroll||L(i,!0)===A())return void tt();ot(e,this.options,L(i,!1),!1)}}},i(e,{pluginName:"scroll",initializeByDefault:!0})}),Be.mount(st,at),t.default=Be},"r/Vq":function(e,t,n){n("I+eb")({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991})},rYOV:function(e,t,n){"use strict";var r={props:{items:Array},methods:{isArrayRoutes:function(e){return!(void 0===e.child||!Array.isArray(e.child))},checkStatusRoutes:function(e){if(void 0!==e.child&&Array.isArray(e.child)){for(var t=0;t<e.child.length;t++)if(this.route().current(e.child[t].link))return!0;return!1}if(this.isRoute(e.link))return!0}}},o=n("KHd+"),i=Object(o.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",e._l(e.items,(function(t){return n("li",{key:t.id,staticClass:"nav-item",class:1==e.checkStatusRoutes(t)?"active":""},[1==e.isArrayRoutes(t)?n("div",[n("a",{staticClass:"nav-link",class:1==e.checkStatusRoutes(t)?"":"collapsed",attrs:{href:"#","data-toggle":"collapse","data-target":"#"+t.title+"Page","aria-expanded":"false","aria-controls":t.title+"Page"}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))]),e._v(" "),t.badge?n("span",[n("i",{staticClass:"fas fa-exclamation-circle"})]):e._e()]),e._v(" "),1==e.isArrayRoutes(t)?n("div",{staticClass:"collapse",class:1==e.checkStatusRoutes(t)?"show":"",attrs:{id:t.title+"Page","aria-labelledby":"headingPage","data-parent":"#accordionSidebar"}},[n("div",{staticClass:"bg-white py-2 collapse-inner rounded"},e._l(t.child,(function(t,r){return n("inertia-link",{key:r,class:e.isRoute(t.link)?"collapse-item active":"collapse-item",attrs:{href:e.route(t.index)}},[t.badge?n("span",[n("span",{class:!e.isRoute(t.link)&&"font-weight-bold"},[e._v(e._s(t.title))]),e._v(" "),n("span",{staticClass:"float-right"},[n("i",{staticClass:"fas fa-exclamation-circle"})])]):n("span",[e._v(e._s(t.title)+" ")])])})),1)]):e._e()]):n("inertia-link",{staticClass:"nav-link",attrs:{href:e.route(t.index)}},[n("i",{class:t.icon}),e._v(" "),n("span",[e._v(e._s(t.title))]),e._v(" "),t.badge?n("span",{staticClass:"float-right"},[n("i",{staticClass:"fas fa-exclamation-circle"})]):e._e()])],1)})),0)}),[],!1,null,null,null);t.a=i.exports},t2rG:function(e,t,n){var r;"undefined"!=typeof self&&self,r=function(e){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="fb15")}({"01f9":function(e,t,n){"use strict";var r=n("2d00"),o=n("5ca1"),i=n("2aba"),a=n("32e9"),s=n("84f2"),u=n("41a0"),c=n("7f20"),l=n("38fd"),f=n("2b4c")("iterator"),h=!([].keys&&"next"in[].keys()),p=function(){return this};e.exports=function(e,t,n,d,m,v,y){u(n,t,d);var g,b,E,w=function(e){if(!h&&e in R)return R[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},S=t+" Iterator",T="values"==m,O=!1,R=e.prototype,N=R[f]||R["@@iterator"]||m&&R[m],k=N||w(m),A=m?T?w("entries"):k:void 0,C="Array"==t&&R.entries||N;if(C&&(E=l(C.call(new e)))!==Object.prototype&&E.next&&(c(E,S,!0),r||"function"==typeof E[f]||a(E,f,p)),T&&N&&"values"!==N.name&&(O=!0,k=function(){return N.call(this)}),r&&!y||!h&&!O&&R[f]||a(R,f,k),s[t]=k,s[S]=p,m)if(g={values:T?k:w("values"),keys:v?k:w("keys"),entries:A},y)for(b in g)b in R||i(R,b,g[b]);else o(o.P+o.F*(h||O),t,g);return g}},"02f4":function(e,t,n){var r=n("4588"),o=n("be13");e.exports=function(e){return function(t,n){var i,a,s=String(o(t)),u=r(n),c=s.length;return u<0||u>=c?e?"":void 0:(i=s.charCodeAt(u))<55296||i>56319||u+1===c||(a=s.charCodeAt(u+1))<56320||a>57343?e?s.charAt(u):i:e?s.slice(u,u+2):a-56320+(i-55296<<10)+65536}}},"0390":function(e,t,n){"use strict";var r=n("02f4")(!0);e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},"0bfb":function(e,t,n){"use strict";var r=n("cb7c");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"0d58":function(e,t,n){var r=n("ce10"),o=n("e11e");e.exports=Object.keys||function(e){return r(e,o)}},1495:function(e,t,n){var r=n("86cc"),o=n("cb7c"),i=n("0d58");e.exports=n("9e1e")?Object.defineProperties:function(e,t){o(e);for(var n,a=i(t),s=a.length,u=0;s>u;)r.f(e,n=a[u++],t[n]);return e}},"214f":function(e,t,n){"use strict";n("b0c5");var r=n("2aba"),o=n("32e9"),i=n("79e5"),a=n("be13"),s=n("2b4c"),u=n("520a"),c=s("species"),l=!i((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),f=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2===n.length&&"a"===n[0]&&"b"===n[1]}();e.exports=function(e,t,n){var h=s(e),p=!i((function(){var t={};return t[h]=function(){return 7},7!=""[e](t)})),d=p?!i((function(){var t=!1,n=/a/;return n.exec=function(){return t=!0,null},"split"===e&&(n.constructor={},n.constructor[c]=function(){return n}),n[h](""),!t})):void 0;if(!p||!d||"replace"===e&&!l||"split"===e&&!f){var m=/./[h],v=n(a,h,""[e],(function(e,t,n,r,o){return t.exec===u?p&&!o?{done:!0,value:m.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}})),y=v[0],g=v[1];r(String.prototype,e,y),o(RegExp.prototype,h,2==t?function(e,t){return g.call(e,this,t)}:function(e){return g.call(e,this)})}}},"230e":function(e,t,n){var r=n("d3f4"),o=n("7726").document,i=r(o)&&r(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},"23c6":function(e,t,n){var r=n("2d95"),o=n("2b4c")("toStringTag"),i="Arguments"==r(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),o))?n:i?r(t):"Object"==(a=r(t))&&"function"==typeof t.callee?"Arguments":a}},2621:function(e,t){t.f=Object.getOwnPropertySymbols},"2aba":function(e,t,n){var r=n("7726"),o=n("32e9"),i=n("69a8"),a=n("ca5a")("src"),s=n("fa5b"),u=(""+s).split("toString");n("8378").inspectSource=function(e){return s.call(e)},(e.exports=function(e,t,n,s){var c="function"==typeof n;c&&(i(n,"name")||o(n,"name",t)),e[t]!==n&&(c&&(i(n,a)||o(n,a,e[t]?""+e[t]:u.join(String(t)))),e===r?e[t]=n:s?e[t]?e[t]=n:o(e,t,n):(delete e[t],o(e,t,n)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[a]||s.call(this)}))},"2aeb":function(e,t,n){var r=n("cb7c"),o=n("1495"),i=n("e11e"),a=n("613b")("IE_PROTO"),s=function(){},u=function(){var e,t=n("230e")("iframe"),r=i.length;for(t.style.display="none",n("fab2").appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),u=e.F;r--;)delete u.prototype[i[r]];return u()};e.exports=Object.create||function(e,t){var n;return null!==e?(s.prototype=r(e),n=new s,s.prototype=null,n[a]=e):n=u(),void 0===t?n:o(n,t)}},"2b4c":function(e,t,n){var r=n("5537")("wks"),o=n("ca5a"),i=n("7726").Symbol,a="function"==typeof i;(e.exports=function(e){return r[e]||(r[e]=a&&i[e]||(a?i:o)("Symbol."+e))}).store=r},"2d00":function(e,t){e.exports=!1},"2d95":function(e,t){var n={}.toString;e.exports=function(e){return n.call(e).slice(8,-1)}},"2fdb":function(e,t,n){"use strict";var r=n("5ca1"),o=n("d2c8");r(r.P+r.F*n("5147")("includes"),"String",{includes:function(e){return!!~o(this,e,"includes").indexOf(e,arguments.length>1?arguments[1]:void 0)}})},"32e9":function(e,t,n){var r=n("86cc"),o=n("4630");e.exports=n("9e1e")?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},"38fd":function(e,t,n){var r=n("69a8"),o=n("4bf8"),i=n("613b")("IE_PROTO"),a=Object.prototype;e.exports=Object.getPrototypeOf||function(e){return e=o(e),r(e,i)?e[i]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?a:null}},"41a0":function(e,t,n){"use strict";var r=n("2aeb"),o=n("4630"),i=n("7f20"),a={};n("32e9")(a,n("2b4c")("iterator"),(function(){return this})),e.exports=function(e,t,n){e.prototype=r(a,{next:o(1,n)}),i(e,t+" Iterator")}},"456d":function(e,t,n){var r=n("4bf8"),o=n("0d58");n("5eda")("keys",(function(){return function(e){return o(r(e))}}))},4588:function(e,t){var n=Math.ceil,r=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?r:n)(e)}},4630:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},"4bf8":function(e,t,n){var r=n("be13");e.exports=function(e){return Object(r(e))}},5147:function(e,t,n){var r=n("2b4c")("match");e.exports=function(e){var t=/./;try{"/./"[e](t)}catch(n){try{return t[r]=!1,!"/./"[e](t)}catch(e){}}return!0}},"520a":function(e,t,n){"use strict";var r,o,i=n("0bfb"),a=RegExp.prototype.exec,s=String.prototype.replace,u=a,c=(r=/a/,o=/b*/g,a.call(r,"a"),a.call(o,"a"),0!==r.lastIndex||0!==o.lastIndex),l=void 0!==/()??/.exec("")[1];(c||l)&&(u=function(e){var t,n,r,o,u=this;return l&&(n=new RegExp("^"+u.source+"$(?!\\s)",i.call(u))),c&&(t=u.lastIndex),r=a.call(u,e),c&&r&&(u.lastIndex=u.global?r.index+r[0].length:t),l&&r&&r.length>1&&s.call(r[0],n,(function(){for(o=1;o<arguments.length-2;o++)void 0===arguments[o]&&(r[o]=void 0)})),r}),e.exports=u},"52a7":function(e,t){t.f={}.propertyIsEnumerable},5537:function(e,t,n){var r=n("8378"),o=n("7726"),i=o["__core-js_shared__"]||(o["__core-js_shared__"]={});(e.exports=function(e,t){return i[e]||(i[e]=void 0!==t?t:{})})("versions",[]).push({version:r.version,mode:n("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"5ca1":function(e,t,n){var r=n("7726"),o=n("8378"),i=n("32e9"),a=n("2aba"),s=n("9b43"),u=function(e,t,n){var c,l,f,h,p=e&u.F,d=e&u.G,m=e&u.S,v=e&u.P,y=e&u.B,g=d?r:m?r[t]||(r[t]={}):(r[t]||{}).prototype,b=d?o:o[t]||(o[t]={}),E=b.prototype||(b.prototype={});for(c in d&&(n=t),n)f=((l=!p&&g&&void 0!==g[c])?g:n)[c],h=y&&l?s(f,r):v&&"function"==typeof f?s(Function.call,f):f,g&&a(g,c,f,e&u.U),b[c]!=f&&i(b,c,h),v&&E[c]!=f&&(E[c]=f)};r.core=o,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},"5eda":function(e,t,n){var r=n("5ca1"),o=n("8378"),i=n("79e5");e.exports=function(e,t){var n=(o.Object||{})[e]||Object[e],a={};a[e]=t(n),r(r.S+r.F*i((function(){n(1)})),"Object",a)}},"5f1b":function(e,t,n){"use strict";var r=n("23c6"),o=RegExp.prototype.exec;e.exports=function(e,t){var n=e.exec;if("function"==typeof n){var i=n.call(e,t);if("object"!=typeof i)throw new TypeError("RegExp exec method returned something other than an Object or null");return i}if("RegExp"!==r(e))throw new TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},"613b":function(e,t,n){var r=n("5537")("keys"),o=n("ca5a");e.exports=function(e){return r[e]||(r[e]=o(e))}},"626a":function(e,t,n){var r=n("2d95");e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==r(e)?e.split(""):Object(e)}},6762:function(e,t,n){"use strict";var r=n("5ca1"),o=n("c366")(!0);r(r.P,"Array",{includes:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),n("9c6c")("includes")},6821:function(e,t,n){var r=n("626a"),o=n("be13");e.exports=function(e){return r(o(e))}},"69a8":function(e,t){var n={}.hasOwnProperty;e.exports=function(e,t){return n.call(e,t)}},"6a99":function(e,t,n){var r=n("d3f4");e.exports=function(e,t){if(!r(e))return e;var n,o;if(t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;if("function"==typeof(n=e.valueOf)&&!r(o=n.call(e)))return o;if(!t&&"function"==typeof(n=e.toString)&&!r(o=n.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},7333:function(e,t,n){"use strict";var r=n("0d58"),o=n("2621"),i=n("52a7"),a=n("4bf8"),s=n("626a"),u=Object.assign;e.exports=!u||n("79e5")((function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach((function(e){t[e]=e})),7!=u({},e)[n]||Object.keys(u({},t)).join("")!=r}))?function(e,t){for(var n=a(e),u=arguments.length,c=1,l=o.f,f=i.f;u>c;)for(var h,p=s(arguments[c++]),d=l?r(p).concat(l(p)):r(p),m=d.length,v=0;m>v;)f.call(p,h=d[v++])&&(n[h]=p[h]);return n}:u},7726:function(e,t){var n=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=n)},"77f1":function(e,t,n){var r=n("4588"),o=Math.max,i=Math.min;e.exports=function(e,t){return(e=r(e))<0?o(e+t,0):i(e,t)}},"79e5":function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},"7f20":function(e,t,n){var r=n("86cc").f,o=n("69a8"),i=n("2b4c")("toStringTag");e.exports=function(e,t,n){e&&!o(e=n?e:e.prototype,i)&&r(e,i,{configurable:!0,value:t})}},8378:function(e,t){var n=e.exports={version:"2.6.5"};"number"==typeof __e&&(__e=n)},"84f2":function(e,t){e.exports={}},"86cc":function(e,t,n){var r=n("cb7c"),o=n("c69a"),i=n("6a99"),a=Object.defineProperty;t.f=n("9e1e")?Object.defineProperty:function(e,t,n){if(r(e),t=i(t,!0),r(n),o)try{return a(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},"9b43":function(e,t,n){var r=n("d8e8");e.exports=function(e,t,n){if(r(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,o){return e.call(t,n,r,o)}}return function(){return e.apply(t,arguments)}}},"9c6c":function(e,t,n){var r=n("2b4c")("unscopables"),o=Array.prototype;null==o[r]&&n("32e9")(o,r,{}),e.exports=function(e){o[r][e]=!0}},"9def":function(e,t,n){var r=n("4588"),o=Math.min;e.exports=function(e){return e>0?o(r(e),9007199254740991):0}},"9e1e":function(e,t,n){e.exports=!n("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a352:function(t,n){t.exports=e},a481:function(e,t,n){"use strict";var r=n("cb7c"),o=n("4bf8"),i=n("9def"),a=n("4588"),s=n("0390"),u=n("5f1b"),c=Math.max,l=Math.min,f=Math.floor,h=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g;n("214f")("replace",2,(function(e,t,n,d){return[function(r,o){var i=e(this),a=null==r?void 0:r[t];return void 0!==a?a.call(r,i,o):n.call(String(i),r,o)},function(e,t){var o=d(n,e,this,t);if(o.done)return o.value;var f=r(e),h=String(this),p="function"==typeof t;p||(t=String(t));var v=f.global;if(v){var y=f.unicode;f.lastIndex=0}for(var g=[];;){var b=u(f,h);if(null===b)break;if(g.push(b),!v)break;""===String(b[0])&&(f.lastIndex=s(h,i(f.lastIndex),y))}for(var E,w="",S=0,T=0;T<g.length;T++){b=g[T];for(var O=String(b[0]),R=c(l(a(b.index),h.length),0),N=[],k=1;k<b.length;k++)N.push(void 0===(E=b[k])?E:String(E));var A=b.groups;if(p){var C=[O].concat(N,R,h);void 0!==A&&C.push(A);var M=String(t.apply(void 0,C))}else M=m(O,h,R,N,A,t);R>=S&&(w+=h.slice(S,R)+M,S=R+O.length)}return w+h.slice(S)}];function m(e,t,r,i,a,s){var u=r+e.length,c=i.length,l=p;return void 0!==a&&(a=o(a),l=h),n.call(s,l,(function(n,o){var s;switch(o.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(u);case"<":s=a[o.slice(1,-1)];break;default:var l=+o;if(0===l)return n;if(l>c){var h=f(l/10);return 0===h?n:h<=c?void 0===i[h-1]?o.charAt(1):i[h-1]+o.charAt(1):n}s=i[l-1]}return void 0===s?"":s}))}}))},aae3:function(e,t,n){var r=n("d3f4"),o=n("2d95"),i=n("2b4c")("match");e.exports=function(e){var t;return r(e)&&(void 0!==(t=e[i])?!!t:"RegExp"==o(e))}},ac6a:function(e,t,n){for(var r=n("cadf"),o=n("0d58"),i=n("2aba"),a=n("7726"),s=n("32e9"),u=n("84f2"),c=n("2b4c"),l=c("iterator"),f=c("toStringTag"),h=u.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},d=o(p),m=0;m<d.length;m++){var v,y=d[m],g=p[y],b=a[y],E=b&&b.prototype;if(E&&(E[l]||s(E,l,h),E[f]||s(E,f,y),u[y]=h,g))for(v in r)E[v]||i(E,v,r[v],!0)}},b0c5:function(e,t,n){"use strict";var r=n("520a");n("5ca1")({target:"RegExp",proto:!0,forced:r!==/./.exec},{exec:r})},be13:function(e,t){e.exports=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e}},c366:function(e,t,n){var r=n("6821"),o=n("9def"),i=n("77f1");e.exports=function(e){return function(t,n,a){var s,u=r(t),c=o(u.length),l=i(a,c);if(e&&n!=n){for(;c>l;)if((s=u[l++])!=s)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===n)return e||l||0;return!e&&-1}}},c649:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return u})),n("a481");var r,o,i="undefined"!=typeof window?window.console:e.console,a=/-(\w)/g,s=(r=function(e){return e.replace(a,(function(e,t){return t?t.toUpperCase():""}))},o=Object.create(null),function(e){return o[e]||(o[e]=r(e))});function u(e){null!==e.parentElement&&e.parentElement.removeChild(e)}function c(e,t,n){var r=0===n?e.children[0]:e.children[n-1].nextSibling;e.insertBefore(t,r)}}).call(this,n("c8ba"))},c69a:function(e,t,n){e.exports=!n("9e1e")&&!n("79e5")((function(){return 7!=Object.defineProperty(n("230e")("div"),"a",{get:function(){return 7}}).a}))},c8ba:function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},ca5a:function(e,t){var n=0,r=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++n+r).toString(36))}},cadf:function(e,t,n){"use strict";var r=n("9c6c"),o=n("d53b"),i=n("84f2"),a=n("6821");e.exports=n("01f9")(Array,"Array",(function(e,t){this._t=a(e),this._i=0,this._k=t}),(function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,o(1)):o(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])}),"values"),i.Arguments=i.Array,r("keys"),r("values"),r("entries")},cb7c:function(e,t,n){var r=n("d3f4");e.exports=function(e){if(!r(e))throw TypeError(e+" is not an object!");return e}},ce10:function(e,t,n){var r=n("69a8"),o=n("6821"),i=n("c366")(!1),a=n("613b")("IE_PROTO");e.exports=function(e,t){var n,s=o(e),u=0,c=[];for(n in s)n!=a&&r(s,n)&&c.push(n);for(;t.length>u;)r(s,n=t[u++])&&(~i(c,n)||c.push(n));return c}},d2c8:function(e,t,n){var r=n("aae3"),o=n("be13");e.exports=function(e,t,n){if(r(t))throw TypeError("String#"+n+" doesn't accept regex!");return String(o(e))}},d3f4:function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},d53b:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},d8e8:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},e11e:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},f559:function(e,t,n){"use strict";var r=n("5ca1"),o=n("9def"),i=n("d2c8"),a="".startsWith;r(r.P+r.F*n("5147")("startsWith"),"String",{startsWith:function(e){var t=i(this,e,"startsWith"),n=o(Math.min(arguments.length>1?arguments[1]:void 0,t.length)),r=String(e);return a?a.call(t,r,n):t.slice(n,n+r.length)===r}})},f6fd:function(e,t){!function(e){var t=e.getElementsByTagName("script");"currentScript"in e||Object.defineProperty(e,"currentScript",{get:function(){try{throw new Error}catch(r){var e,n=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(r.stack)||[!1])[1];for(e in t)if(t[e].src==n||"interactive"==t[e].readyState)return t[e];return null}}})}(document)},f751:function(e,t,n){var r=n("5ca1");r(r.S+r.F,"Object",{assign:n("7333")})},fa5b:function(e,t,n){e.exports=n("5537")("native-function-to-string",Function.toString)},fab2:function(e,t,n){var r=n("7726").document;e.exports=r&&r.documentElement},fb15:function(e,t,n){"use strict";var r;function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function i(e,t){if(e){if("string"==typeof e)return o(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}n.r(t),"undefined"!=typeof window&&(n("f6fd"),(r=window.document.currentScript)&&(r=r.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(n.p=r[1])),n("f751"),n("f559"),n("ac6a"),n("cadf"),n("456d"),n("6762"),n("2fdb");var u=n("a352"),c=n.n(u),l=n("c649");function f(e,t){var n=this;this.$nextTick((function(){return n.$emit(e.toLowerCase(),t)}))}function h(e){var t=this;return function(n){null!==t.realList&&t["onDrag"+e](n),f.call(t,e,n)}}function p(e){return["transition-group","TransitionGroup"].includes(e)}function d(e,t,n){return e[n]||(t[n]?t[n]():void 0)}var m=["Start","Add","Remove","Update","End"],v=["Choose","Unchoose","Sort","Filter","Clone"],y=["Move"].concat(m,v).map((function(e){return"on"+e})),g=null,b={name:"draggable",inheritAttrs:!1,props:{options:Object,list:{type:Array,required:!1,default:null},value:{type:Array,required:!1,default:null},noTransitionOnDrag:{type:Boolean,default:!1},clone:{type:Function,default:function(e){return e}},element:{type:String,default:"div"},tag:{type:String,default:null},move:{type:Function,default:null},componentData:{type:Object,required:!1,default:null}},data:function(){return{transitionMode:!1,noneFunctionalComponentMode:!1}},render:function(e){var t=this.$slots.default;this.transitionMode=function(e){if(!e||1!==e.length)return!1;var t=a(e,1)[0].componentOptions;return!!t&&p(t.tag)}(t);var n=function(e,t,n){var r=0,o=0,i=d(t,n,"header");i&&(r=i.length,e=e?[].concat(s(i),s(e)):s(i));var a=d(t,n,"footer");return a&&(o=a.length,e=e?[].concat(s(e),s(a)):s(a)),{children:e,headerOffset:r,footerOffset:o}}(t,this.$slots,this.$scopedSlots),r=n.children,o=n.headerOffset,i=n.footerOffset;this.headerOffset=o,this.footerOffset=i;var u=function(e,t){var n=null,r=function(e,t){n=function(e,t,n){return void 0===n||((e=e||{})[t]=n),e}(n,e,t)};if(r("attrs",Object.keys(e).filter((function(e){return"id"===e||e.startsWith("data-")})).reduce((function(t,n){return t[n]=e[n],t}),{})),!t)return n;var o=t.on,i=t.props,a=t.attrs;return r("on",o),r("props",i),Object.assign(n.attrs,a),n}(this.$attrs,this.componentData);return e(this.getTag(),u,r)},created:function(){null!==this.list&&null!==this.value&&l.b.error("Value and list props are mutually exclusive! Please set one or another."),"div"!==this.element&&l.b.warn("Element props is deprecated please use tag props instead. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#element-props"),void 0!==this.options&&l.b.warn("Options props is deprecated, add sortable options directly as vue.draggable item, or use v-bind. See https://github.com/SortableJS/Vue.Draggable/blob/master/documentation/migrate.md#options-props")},mounted:function(){var e=this;if(this.noneFunctionalComponentMode=this.getTag().toLowerCase()!==this.$el.nodeName.toLowerCase()&&!this.getIsFunctional(),this.noneFunctionalComponentMode&&this.transitionMode)throw new Error("Transition-group inside component is not supported. Please alter tag value or remove transition-group. Current tag value: ".concat(this.getTag()));var t={};m.forEach((function(n){t["on"+n]=h.call(e,n)})),v.forEach((function(n){t["on"+n]=f.bind(e,n)}));var n=Object.keys(this.$attrs).reduce((function(t,n){return t[Object(l.a)(n)]=e.$attrs[n],t}),{}),r=Object.assign({},this.options,n,t,{onMove:function(t,n){return e.onDragMove(t,n)}});!("draggable"in r)&&(r.draggable=">*"),this._sortable=new c.a(this.rootContainer,r),this.computeIndexes()},beforeDestroy:function(){void 0!==this._sortable&&this._sortable.destroy()},computed:{rootContainer:function(){return this.transitionMode?this.$el.children[0]:this.$el},realList:function(){return this.list?this.list:this.value}},watch:{options:{handler:function(e){this.updateOptions(e)},deep:!0},$attrs:{handler:function(e){this.updateOptions(e)},deep:!0},realList:function(){this.computeIndexes()}},methods:{getIsFunctional:function(){var e=this._vnode.fnOptions;return e&&e.functional},getTag:function(){return this.tag||this.element},updateOptions:function(e){for(var t in e){var n=Object(l.a)(t);-1===y.indexOf(n)&&this._sortable.option(n,e[t])}},getChildrenNodes:function(){if(this.noneFunctionalComponentMode)return this.$children[0].$slots.default;var e=this.$slots.default;return this.transitionMode?e[0].child.$slots.default:e},computeIndexes:function(){var e=this;this.$nextTick((function(){e.visibleIndexes=function(e,t,n,r){if(!e)return[];var o=e.map((function(e){return e.elm})),i=t.length-r,a=s(t).map((function(e,t){return t>=i?o.length:o.indexOf(e)}));return n?a.filter((function(e){return-1!==e})):a}(e.getChildrenNodes(),e.rootContainer.children,e.transitionMode,e.footerOffset)}))},getUnderlyingVm:function(e){var t=function(e,t){return e.map((function(e){return e.elm})).indexOf(t)}(this.getChildrenNodes()||[],e);return-1===t?null:{index:t,element:this.realList[t]}},getUnderlyingPotencialDraggableComponent:function(e){var t=e.__vue__;return t&&t.$options&&p(t.$options._componentTag)?t.$parent:!("realList"in t)&&1===t.$children.length&&"realList"in t.$children[0]?t.$children[0]:t},emitChanges:function(e){var t=this;this.$nextTick((function(){t.$emit("change",e)}))},alterList:function(e){if(this.list)e(this.list);else{var t=s(this.value);e(t),this.$emit("input",t)}},spliceList:function(){var e=arguments,t=function(t){return t.splice.apply(t,s(e))};this.alterList(t)},updatePosition:function(e,t){var n=function(n){return n.splice(t,0,n.splice(e,1)[0])};this.alterList(n)},getRelatedContextFromMoveEvent:function(e){var t=e.to,n=e.related,r=this.getUnderlyingPotencialDraggableComponent(t);if(!r)return{component:r};var o=r.realList,i={list:o,component:r};if(t!==n&&o&&r.getUnderlyingVm){var a=r.getUnderlyingVm(n);if(a)return Object.assign(a,i)}return i},getVmIndex:function(e){var t=this.visibleIndexes,n=t.length;return e>n-1?n:t[e]},getComponent:function(){return this.$slots.default[0].componentInstance},resetTransitionData:function(e){if(this.noTransitionOnDrag&&this.transitionMode){this.getChildrenNodes()[e].data=null;var t=this.getComponent();t.children=[],t.kept=void 0}},onDragStart:function(e){this.context=this.getUnderlyingVm(e.item),e.item._underlying_vm_=this.clone(this.context.element),g=e.item},onDragAdd:function(e){var t=e.item._underlying_vm_;if(void 0!==t){Object(l.d)(e.item);var n=this.getVmIndex(e.newIndex);this.spliceList(n,0,t),this.computeIndexes();var r={element:t,newIndex:n};this.emitChanges({added:r})}},onDragRemove:function(e){if(Object(l.c)(this.rootContainer,e.item,e.oldIndex),"clone"!==e.pullMode){var t=this.context.index;this.spliceList(t,1);var n={element:this.context.element,oldIndex:t};this.resetTransitionData(t),this.emitChanges({removed:n})}else Object(l.d)(e.clone)},onDragUpdate:function(e){Object(l.d)(e.item),Object(l.c)(e.from,e.item,e.oldIndex);var t=this.context.index,n=this.getVmIndex(e.newIndex);this.updatePosition(t,n);var r={element:this.context.element,oldIndex:t,newIndex:n};this.emitChanges({moved:r})},updateProperty:function(e,t){e.hasOwnProperty(t)&&(e[t]+=this.headerOffset)},computeFutureIndex:function(e,t){if(!e.element)return 0;var n=s(t.to.children).filter((function(e){return"none"!==e.style.display})),r=n.indexOf(t.related),o=e.component.getVmIndex(r);return-1===n.indexOf(g)&&t.willInsertAfter?o+1:o},onDragMove:function(e,t){var n=this.move;if(!n||!this.realList)return!0;var r=this.getRelatedContextFromMoveEvent(e),o=this.context,i=this.computeFutureIndex(r,e);return Object.assign(o,{futureIndex:i}),n(Object.assign({},e,{relatedContext:r,draggedContext:o}),t)},onDragEnd:function(){this.computeIndexes(),g=null}}};"undefined"!=typeof window&&"Vue"in window&&window.Vue.component("draggable",b);var E=b;t.default=E}}).default},e.exports=r(n("qkdH"))},"tl/u":function(e,t,n){var r=n("I+eb"),o=Math.ceil,i=Math.floor;r({target:"Math",stat:!0},{trunc:function(e){return(e>0?i:o)(e)}})},w7Oj:function(e,t,n){"use strict";var r={props:["value","errors"],data:function(){return{isInputActive:!1}},computed:{displayValue:{get:function(){return this.isInputActive?this.value.toString():new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",maximumFractionDigits:2}).format(this.value)},set:function(e){var t=parseFloat(e.replace(/[^\d\.]/g,""));isNaN(t)&&(t=0),this.$emit("input",t)}}}},o=n("KHd+"),i=Object(o.a)(r,(function(){var e=this,t=e.$createElement;return(e._self._c||t)("b-form-input",{attrs:{type:"text",placeholder:"ex: 1000000",state:!e.errors&&null,trim:"",required:""},on:{blur:function(t){e.isInputActive=!1},focus:function(t){e.isInputActive=!0}},model:{value:e.displayValue,callback:function(t){e.displayValue=t},expression:"displayValue"}})}),[],!1,null,null,null);t.a=i.exports},wKEM:function(e,t,n){"use strict";var r=n("Ertq");n.n(r).a},wOJ8:function(e,t){function n(){}n.prototype={on:function(e,t,n){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var r=this;function o(){r.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=n.length;r<o;r++)n[r].fn.apply(n[r].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),r=n[e],o=[];if(r&&t)for(var i=0,a=r.length;i<a;i++)r[i].fn!==t&&r[i].fn._!==t&&o.push(r[i]);return o.length?n[e]=o:delete n[e],this}},e.exports=n,e.exports.TinyEmitter=n},xpOo:function(e,t,n){"use strict";var r=n("SdS2");n.n(r).a}}]);